"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const f=require("./tiling-plugin-DX16Gr9b.cjs"),b="tiling",v={id:b,name:"Tiling Plugin",version:"1.0.0",provides:["tiling"],requires:["render","scroll","viewport"],optional:[],defaultConfig:{enabled:!0,tileSize:768,overlapPx:2.5,extraRings:0}},P={visibleTiles:{}},S=(i,a)=>{var u,I;switch(a.type){case f.UPDATE_VISIBLE_TILES:{const d=a.payload,o={...i.visibleTiles};for(const p in d){const s=Number(p),t=d[s],g=o[s]??[],T=(u=g.find(c=>!c.isFallback))==null?void 0:u.srcScale,n=t[0].srcScale;if(T!==void 0&&T!==n){const c=g.filter(l=>!l.isFallback&&l.status==="ready").map(l=>({...l,isFallback:!0})),r=c.length>0?[]:g.filter(l=>l.isFallback);o[s]=[...r,...c,...t]}else{const c=new Set(t.map(e=>e.id)),r=[],l=new Set;for(const e of g)(e.isFallback||c.has(e.id))&&(r.push(e),l.add(e.id));for(const e of t)l.has(e.id)||r.push(e);o[s]=r}}return{...i,visibleTiles:o}}case f.MARK_TILE_STATUS:{const{pageIndex:d,tileId:o,status:p}=a.payload,s=((I=i.visibleTiles[d])==null?void 0:I.map(n=>n.id===o?{...n,status:p}:n))??[],t=s.filter(n=>!n.isFallback),T=t.every(n=>n.status==="ready")?t:s;return{...i,visibleTiles:{...i.visibleTiles,[d]:T}}}default:return i}},m={manifest:v,create:(i,a,u)=>new f.TilingPlugin(b,i,u),reducer:(i,a)=>S(i,a),initialState:P};exports.TilingPlugin=f.TilingPlugin;exports.TILING_PLUGIN_ID=b;exports.TilingPluginPackage=m;exports.manifest=v;
//# sourceMappingURL=index.cjs.map
