"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const T=require("@embedpdf/core/preact"),b=require("@embedpdf/plugin-tiling"),a=require("preact/jsx-runtime"),s=require("preact/hooks"),R=require("@embedpdf/models"),L=()=>T.usePlugin(b.TilingPlugin.id),d=()=>T.useCapability(b.TilingPlugin.id);function h({pageIndex:t,tile:i,dpr:u,scale:o}){const{provides:r}=d(),[n,l]=s.useState(),e=s.useRef(null),c=o/i.srcScale;s.useEffect(()=>{if(i.status==="ready"&&e.current||!r)return;const g=r.renderTile({pageIndex:t,tile:i,dpr:u});return g.wait(p=>{const f=URL.createObjectURL(p);e.current=f,l(f)},R.ignore),()=>{e.current?(URL.revokeObjectURL(e.current),e.current=null):g.abort({code:R.PdfErrorCode.Cancelled,message:"canceled render task"})}},[t,i.id]);const y=()=>{e.current&&(URL.revokeObjectURL(e.current),e.current=null)};return n?a.jsx("img",{src:n,onLoad:y,style:{position:"absolute",left:i.screenRect.origin.x*c,top:i.screenRect.origin.y*c,width:i.screenRect.size.width*c,height:i.screenRect.size.height*c,display:"block"}}):null}function j({pageIndex:t,scale:i,style:u,...o}){const{provides:r}=d(),[n,l]=s.useState([]);return s.useEffect(()=>{if(r)return r.onTileRendering(e=>l(e[t]))},[r]),a.jsx("div",{style:{...u},...o,children:n==null?void 0:n.map(e=>a.jsx(h,{pageIndex:t,tile:e,dpr:window.devicePixelRatio,scale:i},e.id))})}exports.TilingLayer=j;exports.useTilingCapability=d;exports.useTilingPlugin=L;
//# sourceMappingURL=index.cjs.map
