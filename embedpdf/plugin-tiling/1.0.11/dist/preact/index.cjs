"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const L=require("preact"),u=require("preact/hooks"),c=require("../tiling-plugin-DX16Gr9b.cjs"),d=require("../jsxRuntime.module-B3sGoTIU.cjs"),R=L.createContext({registry:null,isInitializing:!0,pluginsReady:!1});function b(){const i=u.useContext(R);if(i===void 0)throw new Error("useCapability must be used within a PDFContext.Provider");const{registry:e,isInitializing:n}=i;if(n)return i;if(e===null)throw new Error("PDF registry failed to initialize properly");return i}function p(i){const{registry:e}=b();if(e===null)return{plugin:null,isLoading:!0,ready:new Promise(()=>{})};const n=e.getPlugin(i);if(!n)throw new Error(`Plugin ${i} not found`);return{plugin:n,isLoading:!1,ready:n.ready()}}function h(i){const{plugin:e,isLoading:n,ready:t}=p(i);if(!e)return{provides:null,isLoading:n,ready:t};if(!e.provides)throw new Error(`Plugin ${i} does not provide a capability`);return{provides:e.provides(),isLoading:n,ready:t}}const w=()=>p(c.TilingPlugin.id),g=()=>h(c.TilingPlugin.id);function T({pageIndex:i,tile:e,dpr:n,scale:t}){const{provides:o}=g(),[s,a]=u.useState(),r=u.useRef(null),l=t/e.srcScale;u.useEffect(()=>{if(e.status==="ready"&&r.current||!o)return;const f=o.renderTile({pageIndex:i,tile:e,dpr:n});return f.wait(v=>{const y=URL.createObjectURL(v);r.current=y,a(y)},c.ignore),()=>{r.current?(URL.revokeObjectURL(r.current),r.current=null):f.abort({code:c.PdfErrorCode.Cancelled,message:"canceled render task"})}},[i,e.id]);const P=()=>{r.current&&(URL.revokeObjectURL(r.current),r.current=null)};return s?d.u("img",{src:s,onLoad:P,style:{position:"absolute",left:e.screenRect.origin.x*l,top:e.screenRect.origin.y*l,width:e.screenRect.size.width*l,height:e.screenRect.size.height*l,display:"block"}}):null}function m({pageIndex:i,scale:e,style:n,...t}){const{provides:o}=g(),[s,a]=u.useState([]);return u.useEffect(()=>{if(o)return o.onTileRendering(r=>a(r[i]))},[o]),d.u("div",{style:{...n},...t,children:s==null?void 0:s.map(r=>d.u(T,{pageIndex:i,tile:r,dpr:window.devicePixelRatio,scale:e},r.id))})}exports.TilingLayer=m;exports.useTilingCapability=g;exports.useTilingPlugin=w;
//# sourceMappingURL=index.cjs.map
