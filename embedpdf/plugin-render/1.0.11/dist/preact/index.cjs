"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const g=require("preact"),o=require("preact/hooks"),u=require("../render-plugin-DudUAm2A.cjs"),c=require("../jsxRuntime.module-B3sGoTIU.cjs"),h=g.createContext({registry:null,isInitializing:!0,pluginsReady:!1});function v(){const e=o.useContext(h);if(e===void 0)throw new Error("useCapability must be used within a PDFContext.Provider");const{registry:r,isInitializing:n}=e;if(n)return e;if(r===null)throw new Error("PDF registry failed to initialize properly");return e}function f(e){const{registry:r}=v();if(r===null)return{plugin:null,isLoading:!0,ready:new Promise(()=>{})};const n=r.getPlugin(e);if(!n)throw new Error(`Plugin ${e} not found`);return{plugin:n,isLoading:!1,ready:n.ready()}}function w(e){const{plugin:r,isLoading:n,ready:t}=f(e);if(!r)return{provides:null,isLoading:n,ready:t};if(!r.provides)throw new Error(`Plugin ${e} does not provide a capability`);return{provides:r.provides(),isLoading:n,ready:t}}const b=()=>f(u.RenderPlugin.id),y=()=>w(u.RenderPlugin.id);function m({pageIndex:e,scaleFactor:r=1,dpr:n=1,style:t,...R}){const{provides:s}=y(),[l,P]=o.useState(null),i=o.useRef(null);o.useEffect(()=>{if(s){const d=s.renderPage({pageIndex:e,scaleFactor:r,dpr:n});return d.wait(L=>{const a=URL.createObjectURL(L);P(a),i.current=a},u.ignore),()=>{i.current?(URL.revokeObjectURL(i.current),i.current=null):d.abort({code:u.PdfErrorCode.Cancelled,message:"canceled render task"})}}},[e,r,n,s]);const p=()=>{i.current&&(URL.revokeObjectURL(i.current),i.current=null)};return c.u(g.Fragment,{children:l&&c.u("img",{src:l,onLoad:p,...R,style:{width:"100%",height:"100%",...t||{}}})})}exports.RenderLayer=m;exports.useRenderCapability=y;exports.useRenderPlugin=b;
//# sourceMappingURL=index.cjs.map
