"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const r=require("vue"),s=require("../render-plugin-DudUAm2A.cjs"),v=Symbol("pdfKey");function m(){const n=r.inject(v);if(!n)throw new Error("useRegistry must be used inside <EmbedPDF>");return n}function f(n){const{registry:e}=m(),l=r.shallowRef(null),t=r.ref(!0),o=r.ref(new Promise(()=>{})),u=()=>{var i;if(!e.value)return;const a=e.value.getPlugin(n);if(!a)throw new Error(`Plugin ${n} not found`);l.value=a,t.value=!1,o.value=((i=a.ready)==null?void 0:i.call(a))??Promise.resolve()};return r.onMounted(u),r.watch(e,u),{plugin:l,isLoading:t,ready:o}}function y(n){const{plugin:e,isLoading:l,ready:t}=f(n);return{provides:r.computed(()=>{if(!e.value)return null;if(!e.value.provides)throw new Error(`Plugin ${n} does not implement provides()`);return e.value.provides()}),isLoading:l,ready:t}}const P=()=>f(s.RenderPlugin.id),g=()=>y(s.RenderPlugin.id),R=["src"],b=r.defineComponent({__name:"render-layer",props:{pageIndex:{},scaleFactor:{default:1},dpr:{default:1}},setup(n){const e=n,{provides:l}=g(),t=r.ref(null);let o=null,u=null;function i(){u&&!o&&u.abort({code:s.PdfErrorCode.Cancelled,message:"canceled render task"})}function a(){o&&(URL.revokeObjectURL(o),o=null)}function p(){if(i(),a(),t.value=null,u=null,!l.value)return;const d=l.value.renderPage({pageIndex:e.pageIndex,scaleFactor:e.scaleFactor,dpr:e.dpr});u=d,d.wait(c=>{o=URL.createObjectURL(c),t.value=o,u=null},s.ignore)}return r.watch(()=>[e.pageIndex,e.scaleFactor,e.dpr,l.value],p,{immediate:!0}),r.onBeforeUnmount(()=>{i(),a()}),(d,c)=>t.value?(r.openBlock(),r.createElementBlock("img",{key:0,src:t.value,style:{width:"100%",height:"100%"},onLoad:a},null,40,R)):r.createCommentVNode("",!0)}});exports.RenderLayer=b;exports.useRenderCapability=g;exports.useRenderPlugin=P;
//# sourceMappingURL=index.cjs.map
