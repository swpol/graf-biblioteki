{"version":3,"file":"index.js","sources":["../src/lib/manifest.ts","../src/lib/reducer.ts","../src/lib/index.ts"],"sourcesContent":["import { PluginManifest } from '@embedpdf/core';\n\nimport { ViewportPluginConfig } from './types';\n\nexport const VIEWPORT_PLUGIN_ID = 'viewport';\n\nexport const manifest: PluginManifest<ViewportPluginConfig> = {\n  id: VIEWPORT_PLUGIN_ID,\n  name: 'Viewport Plugin',\n  version: '1.0.0',\n  provides: ['viewport'],\n  requires: [],\n  optional: [],\n  defaultConfig: {\n    enabled: true,\n    viewportGap: 10,\n    scrollEndDelay: 300,\n  },\n};\n","import { Reducer } from '@embedpdf/core';\n\nimport {\n  SET_VIEWPORT_METRICS,\n  SET_VIEWPORT_SCROLL_METRICS,\n  SET_VIEWPORT_GAP,\n  ViewportAction,\n  SET_SCROLL_ACTIVITY,\n} from './actions';\nimport { ViewportState } from './types';\n\nexport const initialState: ViewportState = {\n  viewportGap: 0,\n  viewportMetrics: {\n    width: 0,\n    height: 0,\n    scrollTop: 0,\n    scrollLeft: 0,\n    clientWidth: 0,\n    clientHeight: 0,\n    scrollWidth: 0,\n    scrollHeight: 0,\n    relativePosition: {\n      x: 0,\n      y: 0,\n    },\n  },\n  isScrolling: false,\n};\n\nexport const viewportReducer: Reducer<ViewportState, ViewportAction> = (\n  state = initialState,\n  action,\n) => {\n  switch (action.type) {\n    case SET_VIEWPORT_GAP:\n      return { ...state, viewportGap: action.payload };\n    case SET_VIEWPORT_METRICS:\n      return {\n        ...state,\n        viewportMetrics: {\n          width: action.payload.width,\n          height: action.payload.height,\n          scrollTop: action.payload.scrollTop,\n          scrollLeft: action.payload.scrollLeft,\n          clientWidth: action.payload.clientWidth,\n          clientHeight: action.payload.clientHeight,\n          scrollWidth: action.payload.scrollWidth,\n          scrollHeight: action.payload.scrollHeight,\n          relativePosition: {\n            x:\n              action.payload.scrollWidth <= action.payload.clientWidth\n                ? 0\n                : action.payload.scrollLeft /\n                  (action.payload.scrollWidth - action.payload.clientWidth),\n            y:\n              action.payload.scrollHeight <= action.payload.clientHeight\n                ? 0\n                : action.payload.scrollTop /\n                  (action.payload.scrollHeight - action.payload.clientHeight),\n          },\n        },\n      };\n    case SET_VIEWPORT_SCROLL_METRICS:\n      return {\n        ...state,\n        viewportMetrics: {\n          ...state.viewportMetrics,\n          scrollTop: action.payload.scrollTop,\n          scrollLeft: action.payload.scrollLeft,\n        },\n        isScrolling: true,\n      };\n    case SET_SCROLL_ACTIVITY:\n      return { ...state, isScrolling: action.payload };\n    default:\n      return state;\n  }\n};\n","import { PluginPackage } from '@embedpdf/core';\n\nimport { ViewportAction } from './actions';\nimport { manifest, VIEWPORT_PLUGIN_ID } from './manifest';\nimport { viewportReducer, initialState } from './reducer';\nimport { ViewportPluginConfig, ViewportState } from './types';\nimport { ViewportPlugin } from './viewport-plugin';\n\nexport const ViewportPluginPackage: PluginPackage<\n  ViewportPlugin,\n  ViewportPluginConfig,\n  ViewportState,\n  ViewportAction\n> = {\n  manifest,\n  create: (registry, _engine, config) => new ViewportPlugin(VIEWPORT_PLUGIN_ID, registry, config),\n  reducer: viewportReducer,\n  initialState: initialState,\n};\n\nexport * from './viewport-plugin';\nexport * from './types';\nexport * from './manifest';\n"],"names":["VIEWPORT_PLUGIN_ID","manifest","initialState","viewportReducer","state","action","SET_VIEWPORT_GAP","SET_VIEWPORT_METRICS","SET_VIEWPORT_SCROLL_METRICS","SET_SCROLL_ACTIVITY","ViewportPluginPackage","registry","_engine","config","ViewportPlugin"],"mappings":";AAIO,MAAMA,IAAqB,YAErBC,IAAiD;AAAA,EAC5D,IAAID;AAAA,EACJ,MAAM;AAAA,EACN,SAAS;AAAA,EACT,UAAU,CAAC,UAAU;AAAA,EACrB,UAAU,CAAA;AAAA,EACV,UAAU,CAAA;AAAA,EACV,eAAe;AAAA,IACb,SAAS;AAAA,IACT,aAAa;AAAA,IACb,gBAAgB;AAAA,EAAA;AAEpB,GCPaE,IAA8B;AAAA,EACzC,aAAa;AAAA,EACb,iBAAiB;AAAA,IACf,OAAO;AAAA,IACP,QAAQ;AAAA,IACR,WAAW;AAAA,IACX,YAAY;AAAA,IACZ,aAAa;AAAA,IACb,cAAc;AAAA,IACd,aAAa;AAAA,IACb,cAAc;AAAA,IACd,kBAAkB;AAAA,MAChB,GAAG;AAAA,MACH,GAAG;AAAA,IAAA;AAAA,EACL;AAAA,EAEF,aAAa;AACf,GAEaC,IAA0D,CACrEC,IAAQF,GACRG,MACG;AACH,UAAQA,EAAO,MAAA;AAAA,IACb,KAAKC;AACH,aAAO,EAAE,GAAGF,GAAO,aAAaC,EAAO,QAAA;AAAA,IACzC,KAAKE;AACH,aAAO;AAAA,QACL,GAAGH;AAAA,QACH,iBAAiB;AAAA,UACf,OAAOC,EAAO,QAAQ;AAAA,UACtB,QAAQA,EAAO,QAAQ;AAAA,UACvB,WAAWA,EAAO,QAAQ;AAAA,UAC1B,YAAYA,EAAO,QAAQ;AAAA,UAC3B,aAAaA,EAAO,QAAQ;AAAA,UAC5B,cAAcA,EAAO,QAAQ;AAAA,UAC7B,aAAaA,EAAO,QAAQ;AAAA,UAC5B,cAAcA,EAAO,QAAQ;AAAA,UAC7B,kBAAkB;AAAA,YAChB,GACEA,EAAO,QAAQ,eAAeA,EAAO,QAAQ,cACzC,IACAA,EAAO,QAAQ,cACdA,EAAO,QAAQ,cAAcA,EAAO,QAAQ;AAAA,YACnD,GACEA,EAAO,QAAQ,gBAAgBA,EAAO,QAAQ,eAC1C,IACAA,EAAO,QAAQ,aACdA,EAAO,QAAQ,eAAeA,EAAO,QAAQ;AAAA,UAAA;AAAA,QACtD;AAAA,MACF;AAAA,IAEJ,KAAKG;AACH,aAAO;AAAA,QACL,GAAGJ;AAAA,QACH,iBAAiB;AAAA,UACf,GAAGA,EAAM;AAAA,UACT,WAAWC,EAAO,QAAQ;AAAA,UAC1B,YAAYA,EAAO,QAAQ;AAAA,QAAA;AAAA,QAE7B,aAAa;AAAA,MAAA;AAAA,IAEjB,KAAKI;AACH,aAAO,EAAE,GAAGL,GAAO,aAAaC,EAAO,QAAA;AAAA,IACzC;AACE,aAAOD;AAAA,EAAA;AAEb,GCtEaM,IAKT;AAAA,EACF,UAAAT;AAAA,EACA,QAAQ,CAACU,GAAUC,GAASC,MAAW,IAAIC,EAAed,GAAoBW,GAAUE,CAAM;AAAA,EAC9F,SAASV;AAAA,EACT,cAAAD;AACF;"}