{"version":3,"file":"embedpdf-de22fdf4.js","sources":["../../node_modules/.pnpm/preact@10.26.9/node_modules/preact/dist/preact.module.js","../../node_modules/.pnpm/style-inject@0.3.0/node_modules/style-inject/dist/style-inject.es.js","../../node_modules/.pnpm/preact@10.26.9/node_modules/preact/hooks/dist/hooks.module.js","../../packages/models/dist/index.js","../../packages/core/dist/index.js","../../packages/core/dist/preact/index.js","../../packages/engines/dist/preact.js","../../packages/plugin-viewport/dist/index.js","../../packages/plugin-viewport/dist/preact/index.js","../../packages/plugin-scroll/dist/index.js","../../packages/plugin-scroll/dist/preact/index.js","../../packages/plugin-loader/dist/index.js","../../packages/plugin-loader/dist/preact/index.js","../src/components/ui/button.tsx","../../node_modules/.pnpm/@floating-ui+utils@0.2.10/node_modules/@floating-ui/utils/dist/floating-ui.utils.mjs","../../node_modules/.pnpm/@floating-ui+core@1.7.2/node_modules/@floating-ui/core/dist/floating-ui.core.mjs","../../node_modules/.pnpm/@floating-ui+utils@0.2.10/node_modules/@floating-ui/utils/dist/floating-ui.utils.dom.mjs","../../node_modules/.pnpm/@floating-ui+dom@1.7.2/node_modules/@floating-ui/dom/dist/floating-ui.dom.mjs","../src/components/ui/tooltip.tsx","../../node_modules/.pnpm/preact@10.26.9/node_modules/preact/compat/dist/compat.module.js","../src/components/ui/dropdown.tsx","../../packages/plugin-zoom/dist/preact/index.js","../src/components/ui/icon.tsx","../src/hooks/use-debounce.ts","../src/components/ui/checkbox.tsx","../../packages/plugin-selection/dist/index.js","../../packages/plugin-interaction-manager/dist/utils-plgMhFiX.js","../../packages/plugin-interaction-manager/dist/index.js","../../packages/plugin-interaction-manager/dist/preact/index.js","../../packages/plugin-selection/dist/preact/index.js","../src/components/utils.ts","../src/components/ui/dialog.tsx","../../packages/plugin-print/dist/preact/index.js","../../packages/plugin-print/dist/index.js","../../packages/plugin-annotation/dist/preact/index.js","../src/components/renderers.tsx","../src/hooks/use-swipe-gesture.ts","../../packages/plugin-annotation/dist/index.js","../src/components/annotation-sidebar.tsx","../../packages/plugin-zoom/dist/index.js","../../packages/plugin-render/dist/index.js","../../packages/plugin-render/dist/preact/index.js","../../packages/plugin-rotate/dist/index.js","../../packages/plugin-rotate/dist/preact/index.js","../../packages/plugin-tiling/dist/index.js","../../packages/plugin-tiling/dist/preact/index.js","../../packages/plugin-thumbnail/dist/index.js","../src/components/ui/loading-indicator.tsx","../../packages/plugin-fullscreen/dist/index.js","../../packages/plugin-bookmark/dist/index.js","../../packages/plugin-capture/dist/index.js","../../packages/plugin-history/dist/index.js","../src/components/capture.tsx","../src/components/hint-layer.tsx","../src/components/app.tsx","../src/web-components/container.tsx","../src/embedpdf.ts"],"sourcesContent":["var n,l,u,t,i,r,o,e,f,c,s,a,h,p={},v=[],y=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,w=Array.isArray;function d(n,l){for(var u in l)n[u]=l[u];return n}function g(n){n&&n.parentNode&&n.parentNode.removeChild(n)}function _(l,u,t){var i,r,o,e={};for(o in u)\"key\"==o?i=u[o]:\"ref\"==o?r=u[o]:e[o]=u[o];if(arguments.length>2&&(e.children=arguments.length>3?n.call(arguments,2):t),\"function\"==typeof l&&null!=l.defaultProps)for(o in l.defaultProps)void 0===e[o]&&(e[o]=l.defaultProps[o]);return m(l,e,i,r,null)}function m(n,t,i,r,o){var e={type:n,props:t,key:i,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:null==o?++u:o,__i:-1,__u:0};return null==o&&null!=l.vnode&&l.vnode(e),e}function b(){return{current:null}}function k(n){return n.children}function x(n,l){this.props=n,this.context=l}function S(n,l){if(null==l)return n.__?S(n.__,n.__i+1):null;for(var u;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e)return u.__e;return\"function\"==typeof n.type?S(n):null}function C(n){var l,u;if(null!=(n=n.__)&&null!=n.__c){for(n.__e=n.__c.base=null,l=0;l<n.__k.length;l++)if(null!=(u=n.__k[l])&&null!=u.__e){n.__e=n.__c.base=u.__e;break}return C(n)}}function M(n){(!n.__d&&(n.__d=!0)&&i.push(n)&&!$.__r++||r!=l.debounceRendering)&&((r=l.debounceRendering)||o)($)}function $(){for(var n,u,t,r,o,f,c,s=1;i.length;)i.length>s&&i.sort(e),n=i.shift(),s=i.length,n.__d&&(t=void 0,o=(r=(u=n).__v).__e,f=[],c=[],u.__P&&((t=d({},r)).__v=r.__v+1,l.vnode&&l.vnode(t),O(u.__P,t,r,u.__n,u.__P.namespaceURI,32&r.__u?[o]:null,f,null==o?S(r):o,!!(32&r.__u),c),t.__v=r.__v,t.__.__k[t.__i]=t,z(f,t,c),t.__e!=o&&C(t)));$.__r=0}function I(n,l,u,t,i,r,o,e,f,c,s){var a,h,y,w,d,g,_=t&&t.__k||v,m=l.length;for(f=P(u,l,_,f,m),a=0;a<m;a++)null!=(y=u.__k[a])&&(h=-1==y.__i?p:_[y.__i]||p,y.__i=a,g=O(n,y,h,i,r,o,e,f,c,s),w=y.__e,y.ref&&h.ref!=y.ref&&(h.ref&&q(h.ref,null,y),s.push(y.ref,y.__c||w,y)),null==d&&null!=w&&(d=w),4&y.__u||h.__k===y.__k?f=A(y,f,n):\"function\"==typeof y.type&&void 0!==g?f=g:w&&(f=w.nextSibling),y.__u&=-7);return u.__e=d,f}function P(n,l,u,t,i){var r,o,e,f,c,s=u.length,a=s,h=0;for(n.__k=new Array(i),r=0;r<i;r++)null!=(o=l[r])&&\"boolean\"!=typeof o&&\"function\"!=typeof o?(f=r+h,(o=n.__k[r]=\"string\"==typeof o||\"number\"==typeof o||\"bigint\"==typeof o||o.constructor==String?m(null,o,null,null,null):w(o)?m(k,{children:o},null,null,null):null==o.constructor&&o.__b>0?m(o.type,o.props,o.key,o.ref?o.ref:null,o.__v):o).__=n,o.__b=n.__b+1,e=null,-1!=(c=o.__i=L(o,u,f,a))&&(a--,(e=u[c])&&(e.__u|=2)),null==e||null==e.__v?(-1==c&&(i>s?h--:i<s&&h++),\"function\"!=typeof o.type&&(o.__u|=4)):c!=f&&(c==f-1?h--:c==f+1?h++:(c>f?h--:h++,o.__u|=4))):n.__k[r]=null;if(a)for(r=0;r<s;r++)null!=(e=u[r])&&0==(2&e.__u)&&(e.__e==t&&(t=S(e)),B(e,e));return t}function A(n,l,u){var t,i;if(\"function\"==typeof n.type){for(t=n.__k,i=0;t&&i<t.length;i++)t[i]&&(t[i].__=n,l=A(t[i],l,u));return l}n.__e!=l&&(l&&n.type&&!u.contains(l)&&(l=S(n)),u.insertBefore(n.__e,l||null),l=n.__e);do{l=l&&l.nextSibling}while(null!=l&&8==l.nodeType);return l}function H(n,l){return l=l||[],null==n||\"boolean\"==typeof n||(w(n)?n.some(function(n){H(n,l)}):l.push(n)),l}function L(n,l,u,t){var i,r,o=n.key,e=n.type,f=l[u];if(null===f&&null==n.key||f&&o==f.key&&e==f.type&&0==(2&f.__u))return u;if(t>(null!=f&&0==(2&f.__u)?1:0))for(i=u-1,r=u+1;i>=0||r<l.length;){if(i>=0){if((f=l[i])&&0==(2&f.__u)&&o==f.key&&e==f.type)return i;i--}if(r<l.length){if((f=l[r])&&0==(2&f.__u)&&o==f.key&&e==f.type)return r;r++}}return-1}function T(n,l,u){\"-\"==l[0]?n.setProperty(l,null==u?\"\":u):n[l]=null==u?\"\":\"number\"!=typeof u||y.test(l)?u:u+\"px\"}function j(n,l,u,t,i){var r,o;n:if(\"style\"==l)if(\"string\"==typeof u)n.style.cssText=u;else{if(\"string\"==typeof t&&(n.style.cssText=t=\"\"),t)for(l in t)u&&l in u||T(n.style,l,\"\");if(u)for(l in u)t&&u[l]==t[l]||T(n.style,l,u[l])}else if(\"o\"==l[0]&&\"n\"==l[1])r=l!=(l=l.replace(f,\"$1\")),o=l.toLowerCase(),l=o in n||\"onFocusOut\"==l||\"onFocusIn\"==l?o.slice(2):l.slice(2),n.l||(n.l={}),n.l[l+r]=u,u?t?u.u=t.u:(u.u=c,n.addEventListener(l,r?a:s,r)):n.removeEventListener(l,r?a:s,r);else{if(\"http://www.w3.org/2000/svg\"==i)l=l.replace(/xlink(H|:h)/,\"h\").replace(/sName$/,\"s\");else if(\"width\"!=l&&\"height\"!=l&&\"href\"!=l&&\"list\"!=l&&\"form\"!=l&&\"tabIndex\"!=l&&\"download\"!=l&&\"rowSpan\"!=l&&\"colSpan\"!=l&&\"role\"!=l&&\"popover\"!=l&&l in n)try{n[l]=null==u?\"\":u;break n}catch(n){}\"function\"==typeof u||(null==u||!1===u&&\"-\"!=l[4]?n.removeAttribute(l):n.setAttribute(l,\"popover\"==l&&1==u?\"\":u))}}function F(n){return function(u){if(this.l){var t=this.l[u.type+n];if(null==u.t)u.t=c++;else if(u.t<t.u)return;return t(l.event?l.event(u):u)}}}function O(n,u,t,i,r,o,e,f,c,s){var a,h,p,v,y,_,m,b,S,C,M,$,P,A,H,L,T,j=u.type;if(null!=u.constructor)return null;128&t.__u&&(c=!!(32&t.__u),o=[f=u.__e=t.__e]),(a=l.__b)&&a(u);n:if(\"function\"==typeof j)try{if(b=u.props,S=\"prototype\"in j&&j.prototype.render,C=(a=j.contextType)&&i[a.__c],M=a?C?C.props.value:a.__:i,t.__c?m=(h=u.__c=t.__c).__=h.__E:(S?u.__c=h=new j(b,M):(u.__c=h=new x(b,M),h.constructor=j,h.render=D),C&&C.sub(h),h.props=b,h.state||(h.state={}),h.context=M,h.__n=i,p=h.__d=!0,h.__h=[],h._sb=[]),S&&null==h.__s&&(h.__s=h.state),S&&null!=j.getDerivedStateFromProps&&(h.__s==h.state&&(h.__s=d({},h.__s)),d(h.__s,j.getDerivedStateFromProps(b,h.__s))),v=h.props,y=h.state,h.__v=u,p)S&&null==j.getDerivedStateFromProps&&null!=h.componentWillMount&&h.componentWillMount(),S&&null!=h.componentDidMount&&h.__h.push(h.componentDidMount);else{if(S&&null==j.getDerivedStateFromProps&&b!==v&&null!=h.componentWillReceiveProps&&h.componentWillReceiveProps(b,M),!h.__e&&null!=h.shouldComponentUpdate&&!1===h.shouldComponentUpdate(b,h.__s,M)||u.__v==t.__v){for(u.__v!=t.__v&&(h.props=b,h.state=h.__s,h.__d=!1),u.__e=t.__e,u.__k=t.__k,u.__k.some(function(n){n&&(n.__=u)}),$=0;$<h._sb.length;$++)h.__h.push(h._sb[$]);h._sb=[],h.__h.length&&e.push(h);break n}null!=h.componentWillUpdate&&h.componentWillUpdate(b,h.__s,M),S&&null!=h.componentDidUpdate&&h.__h.push(function(){h.componentDidUpdate(v,y,_)})}if(h.context=M,h.props=b,h.__P=n,h.__e=!1,P=l.__r,A=0,S){for(h.state=h.__s,h.__d=!1,P&&P(u),a=h.render(h.props,h.state,h.context),H=0;H<h._sb.length;H++)h.__h.push(h._sb[H]);h._sb=[]}else do{h.__d=!1,P&&P(u),a=h.render(h.props,h.state,h.context),h.state=h.__s}while(h.__d&&++A<25);h.state=h.__s,null!=h.getChildContext&&(i=d(d({},i),h.getChildContext())),S&&!p&&null!=h.getSnapshotBeforeUpdate&&(_=h.getSnapshotBeforeUpdate(v,y)),L=a,null!=a&&a.type===k&&null==a.key&&(L=N(a.props.children)),f=I(n,w(L)?L:[L],u,t,i,r,o,e,f,c,s),h.base=u.__e,u.__u&=-161,h.__h.length&&e.push(h),m&&(h.__E=h.__=null)}catch(n){if(u.__v=null,c||null!=o)if(n.then){for(u.__u|=c?160:128;f&&8==f.nodeType&&f.nextSibling;)f=f.nextSibling;o[o.indexOf(f)]=null,u.__e=f}else for(T=o.length;T--;)g(o[T]);else u.__e=t.__e,u.__k=t.__k;l.__e(n,u,t)}else null==o&&u.__v==t.__v?(u.__k=t.__k,u.__e=t.__e):f=u.__e=V(t.__e,u,t,i,r,o,e,c,s);return(a=l.diffed)&&a(u),128&u.__u?void 0:f}function z(n,u,t){for(var i=0;i<t.length;i++)q(t[i],t[++i],t[++i]);l.__c&&l.__c(u,n),n.some(function(u){try{n=u.__h,u.__h=[],n.some(function(n){n.call(u)})}catch(n){l.__e(n,u.__v)}})}function N(n){return\"object\"!=typeof n||null==n||n.__b&&n.__b>0?n:w(n)?n.map(N):d({},n)}function V(u,t,i,r,o,e,f,c,s){var a,h,v,y,d,_,m,b=i.props,k=t.props,x=t.type;if(\"svg\"==x?o=\"http://www.w3.org/2000/svg\":\"math\"==x?o=\"http://www.w3.org/1998/Math/MathML\":o||(o=\"http://www.w3.org/1999/xhtml\"),null!=e)for(a=0;a<e.length;a++)if((d=e[a])&&\"setAttribute\"in d==!!x&&(x?d.localName==x:3==d.nodeType)){u=d,e[a]=null;break}if(null==u){if(null==x)return document.createTextNode(k);u=document.createElementNS(o,x,k.is&&k),c&&(l.__m&&l.__m(t,e),c=!1),e=null}if(null==x)b===k||c&&u.data==k||(u.data=k);else{if(e=e&&n.call(u.childNodes),b=i.props||p,!c&&null!=e)for(b={},a=0;a<u.attributes.length;a++)b[(d=u.attributes[a]).name]=d.value;for(a in b)if(d=b[a],\"children\"==a);else if(\"dangerouslySetInnerHTML\"==a)v=d;else if(!(a in k)){if(\"value\"==a&&\"defaultValue\"in k||\"checked\"==a&&\"defaultChecked\"in k)continue;j(u,a,null,d,o)}for(a in k)d=k[a],\"children\"==a?y=d:\"dangerouslySetInnerHTML\"==a?h=d:\"value\"==a?_=d:\"checked\"==a?m=d:c&&\"function\"!=typeof d||b[a]===d||j(u,a,d,b[a],o);if(h)c||v&&(h.__html==v.__html||h.__html==u.innerHTML)||(u.innerHTML=h.__html),t.__k=[];else if(v&&(u.innerHTML=\"\"),I(\"template\"==t.type?u.content:u,w(y)?y:[y],t,i,r,\"foreignObject\"==x?\"http://www.w3.org/1999/xhtml\":o,e,f,e?e[0]:i.__k&&S(i,0),c,s),null!=e)for(a=e.length;a--;)g(e[a]);c||(a=\"value\",\"progress\"==x&&null==_?u.removeAttribute(\"value\"):null!=_&&(_!==u[a]||\"progress\"==x&&!_||\"option\"==x&&_!=b[a])&&j(u,a,_,b[a],o),a=\"checked\",null!=m&&m!=u[a]&&j(u,a,m,b[a],o))}return u}function q(n,u,t){try{if(\"function\"==typeof n){var i=\"function\"==typeof n.__u;i&&n.__u(),i&&null==u||(n.__u=n(u))}else n.current=u}catch(n){l.__e(n,t)}}function B(n,u,t){var i,r;if(l.unmount&&l.unmount(n),(i=n.ref)&&(i.current&&i.current!=n.__e||q(i,null,u)),null!=(i=n.__c)){if(i.componentWillUnmount)try{i.componentWillUnmount()}catch(n){l.__e(n,u)}i.base=i.__P=null}if(i=n.__k)for(r=0;r<i.length;r++)i[r]&&B(i[r],u,t||\"function\"!=typeof n.type);t||g(n.__e),n.__c=n.__=n.__e=void 0}function D(n,l,u){return this.constructor(n,u)}function E(u,t,i){var r,o,e,f;t==document&&(t=document.documentElement),l.__&&l.__(u,t),o=(r=\"function\"==typeof i)?null:i&&i.__k||t.__k,e=[],f=[],O(t,u=(!r&&i||t).__k=_(k,null,[u]),o||p,p,t.namespaceURI,!r&&i?[i]:o?null:t.firstChild?n.call(t.childNodes):null,e,!r&&i?i:o?o.__e:t.firstChild,r,f),z(e,u,f)}function G(n,l){E(n,l,G)}function J(l,u,t){var i,r,o,e,f=d({},l.props);for(o in l.type&&l.type.defaultProps&&(e=l.type.defaultProps),u)\"key\"==o?i=u[o]:\"ref\"==o?r=u[o]:f[o]=void 0===u[o]&&null!=e?e[o]:u[o];return arguments.length>2&&(f.children=arguments.length>3?n.call(arguments,2):t),m(l.type,f,i||l.key,r||l.ref,null)}function K(n){function l(n){var u,t;return this.getChildContext||(u=new Set,(t={})[l.__c]=this,this.getChildContext=function(){return t},this.componentWillUnmount=function(){u=null},this.shouldComponentUpdate=function(n){this.props.value!=n.value&&u.forEach(function(n){n.__e=!0,M(n)})},this.sub=function(n){u.add(n);var l=n.componentWillUnmount;n.componentWillUnmount=function(){u&&u.delete(n),l&&l.call(n)}}),n.children}return l.__c=\"__cC\"+h++,l.__=n,l.Provider=l.__l=(l.Consumer=function(n,l){return n.children(l)}).contextType=l,l}n=v.slice,l={__e:function(n,l,u,t){for(var i,r,o;l=l.__;)if((i=l.__c)&&!i.__)try{if((r=i.constructor)&&null!=r.getDerivedStateFromError&&(i.setState(r.getDerivedStateFromError(n)),o=i.__d),null!=i.componentDidCatch&&(i.componentDidCatch(n,t||{}),o=i.__d),o)return i.__E=i}catch(l){n=l}throw n}},u=0,t=function(n){return null!=n&&null==n.constructor},x.prototype.setState=function(n,l){var u;u=null!=this.__s&&this.__s!=this.state?this.__s:this.__s=d({},this.state),\"function\"==typeof n&&(n=n(d({},u),this.props)),n&&d(u,n),null!=n&&this.__v&&(l&&this._sb.push(l),M(this))},x.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),M(this))},x.prototype.render=k,i=[],o=\"function\"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,e=function(n,l){return n.__v.__b-l.__v.__b},$.__r=0,f=/(PointerCapture)$|Capture$/i,c=0,s=F(!1),a=F(!0),h=0;export{x as Component,k as Fragment,J as cloneElement,K as createContext,_ as createElement,b as createRef,_ as h,G as hydrate,t as isValidElement,l as options,E as render,H as toChildArray};\n//# sourceMappingURL=preact.module.js.map\n","function styleInject(css, ref) {\n  if ( ref === void 0 ) ref = {};\n  var insertAt = ref.insertAt;\n\n  if (!css || typeof document === 'undefined') { return; }\n\n  var head = document.head || document.getElementsByTagName('head')[0];\n  var style = document.createElement('style');\n  style.type = 'text/css';\n\n  if (insertAt === 'top') {\n    if (head.firstChild) {\n      head.insertBefore(style, head.firstChild);\n    } else {\n      head.appendChild(style);\n    }\n  } else {\n    head.appendChild(style);\n  }\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nexport default styleInject;\n","import{options as n}from\"preact\";var t,r,u,i,o=0,f=[],c=n,e=c.__b,a=c.__r,v=c.diffed,l=c.__c,m=c.unmount,s=c.__;function p(n,t){c.__h&&c.__h(r,n,o||t),o=0;var u=r.__H||(r.__H={__:[],__h:[]});return n>=u.__.length&&u.__.push({}),u.__[n]}function d(n){return o=1,h(D,n)}function h(n,u,i){var o=p(t++,2);if(o.t=n,!o.__c&&(o.__=[i?i(u):D(void 0,u),function(n){var t=o.__N?o.__N[0]:o.__[0],r=o.t(t,n);t!==r&&(o.__N=[r,o.__[1]],o.__c.setState({}))}],o.__c=r,!r.__f)){var f=function(n,t,r){if(!o.__c.__H)return!0;var u=o.__c.__H.__.filter(function(n){return!!n.__c});if(u.every(function(n){return!n.__N}))return!c||c.call(this,n,t,r);var i=o.__c.props!==n;return u.forEach(function(n){if(n.__N){var t=n.__[0];n.__=n.__N,n.__N=void 0,t!==n.__[0]&&(i=!0)}}),c&&c.call(this,n,t,r)||i};r.__f=!0;var c=r.shouldComponentUpdate,e=r.componentWillUpdate;r.componentWillUpdate=function(n,t,r){if(this.__e){var u=c;c=void 0,f(n,t,r),c=u}e&&e.call(this,n,t,r)},r.shouldComponentUpdate=f}return o.__N||o.__}function y(n,u){var i=p(t++,3);!c.__s&&C(i.__H,u)&&(i.__=n,i.u=u,r.__H.__h.push(i))}function _(n,u){var i=p(t++,4);!c.__s&&C(i.__H,u)&&(i.__=n,i.u=u,r.__h.push(i))}function A(n){return o=5,T(function(){return{current:n}},[])}function F(n,t,r){o=6,_(function(){if(\"function\"==typeof n){var r=n(t());return function(){n(null),r&&\"function\"==typeof r&&r()}}if(n)return n.current=t(),function(){return n.current=null}},null==r?r:r.concat(n))}function T(n,r){var u=p(t++,7);return C(u.__H,r)&&(u.__=n(),u.__H=r,u.__h=n),u.__}function q(n,t){return o=8,T(function(){return n},t)}function x(n){var u=r.context[n.__c],i=p(t++,9);return i.c=n,u?(null==i.__&&(i.__=!0,u.sub(r)),u.props.value):n.__}function P(n,t){c.useDebugValue&&c.useDebugValue(t?t(n):n)}function b(n){var u=p(t++,10),i=d();return u.__=n,r.componentDidCatch||(r.componentDidCatch=function(n,t){u.__&&u.__(n,t),i[1](n)}),[i[0],function(){i[1](void 0)}]}function g(){var n=p(t++,11);if(!n.__){for(var u=r.__v;null!==u&&!u.__m&&null!==u.__;)u=u.__;var i=u.__m||(u.__m=[0,0]);n.__=\"P\"+i[0]+\"-\"+i[1]++}return n.__}function j(){for(var n;n=f.shift();)if(n.__P&&n.__H)try{n.__H.__h.forEach(z),n.__H.__h.forEach(B),n.__H.__h=[]}catch(t){n.__H.__h=[],c.__e(t,n.__v)}}c.__b=function(n){r=null,e&&e(n)},c.__=function(n,t){n&&t.__k&&t.__k.__m&&(n.__m=t.__k.__m),s&&s(n,t)},c.__r=function(n){a&&a(n),t=0;var i=(r=n.__c).__H;i&&(u===r?(i.__h=[],r.__h=[],i.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(i.__h.forEach(z),i.__h.forEach(B),i.__h=[],t=0)),u=r},c.diffed=function(n){v&&v(n);var t=n.__c;t&&t.__H&&(t.__H.__h.length&&(1!==f.push(t)&&i===c.requestAnimationFrame||((i=c.requestAnimationFrame)||w)(j)),t.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),u=r=null},c.__c=function(n,t){t.some(function(n){try{n.__h.forEach(z),n.__h=n.__h.filter(function(n){return!n.__||B(n)})}catch(r){t.some(function(n){n.__h&&(n.__h=[])}),t=[],c.__e(r,n.__v)}}),l&&l(n,t)},c.unmount=function(n){m&&m(n);var t,r=n.__c;r&&r.__H&&(r.__H.__.forEach(function(n){try{z(n)}catch(n){t=n}}),r.__H=void 0,t&&c.__e(t,r.__v))};var k=\"function\"==typeof requestAnimationFrame;function w(n){var t,r=function(){clearTimeout(u),k&&cancelAnimationFrame(t),setTimeout(n)},u=setTimeout(r,35);k&&(t=requestAnimationFrame(r))}function z(n){var t=r,u=n.__c;\"function\"==typeof u&&(n.__c=void 0,u()),r=t}function B(n){var t=r;n.__c=n.__(),r=t}function C(n,t){return!n||n.length!==t.length||t.some(function(t,r){return t!==n[r]})}function D(n,t){return\"function\"==typeof t?t(n):t}export{q as useCallback,x as useContext,P as useDebugValue,y as useEffect,b as useErrorBoundary,g as useId,F as useImperativeHandle,_ as useLayoutEffect,T as useMemo,h as useReducer,A as useRef,d as useState};\n//# sourceMappingURL=hooks.module.js.map\n","// src/geometry.ts\nvar Rotation = /* @__PURE__ */ ((Rotation2) => {\n  Rotation2[Rotation2[\"Degree0\"] = 0] = \"Degree0\";\n  Rotation2[Rotation2[\"Degree90\"] = 1] = \"Degree90\";\n  Rotation2[Rotation2[\"Degree180\"] = 2] = \"Degree180\";\n  Rotation2[Rotation2[\"Degree270\"] = 3] = \"Degree270\";\n  return Rotation2;\n})(Rotation || {});\nfunction toIntPos(p) {\n  return { x: Math.floor(p.x), y: Math.floor(p.y) };\n}\nfunction toIntSize(s) {\n  return { width: Math.ceil(s.width), height: Math.ceil(s.height) };\n}\nfunction toIntRect(r) {\n  return {\n    origin: toIntPos(r.origin),\n    size: toIntSize(r.size)\n  };\n}\nfunction calculateDegree(rotation) {\n  switch (rotation) {\n    case 0 /* Degree0 */:\n      return 0;\n    case 1 /* Degree90 */:\n      return 90;\n    case 2 /* Degree180 */:\n      return 180;\n    case 3 /* Degree270 */:\n      return 270;\n  }\n}\nfunction calculateAngle(rotation) {\n  return calculateDegree(rotation) * Math.PI / 180;\n}\nfunction swap(size) {\n  const { width, height } = size;\n  return {\n    width: height,\n    height: width\n  };\n}\nfunction transformSize(size, rotation, scaleFactor) {\n  size = rotation % 2 === 0 ? size : swap(size);\n  return {\n    width: size.width * scaleFactor,\n    height: size.height * scaleFactor\n  };\n}\nfunction quadToRect(q) {\n  const xs = [q.p1.x, q.p2.x, q.p3.x, q.p4.x];\n  const ys = [q.p1.y, q.p2.y, q.p3.y, q.p4.y];\n  return {\n    origin: { x: Math.min(...xs), y: Math.min(...ys) },\n    size: {\n      width: Math.max(...xs) - Math.min(...xs),\n      height: Math.max(...ys) - Math.min(...ys)\n    }\n  };\n}\nfunction rectToQuad(r) {\n  return {\n    p1: { x: r.origin.x, y: r.origin.y },\n    p2: { x: r.origin.x + r.size.width, y: r.origin.y },\n    p3: { x: r.origin.x + r.size.width, y: r.origin.y + r.size.height },\n    p4: { x: r.origin.x, y: r.origin.y + r.size.height }\n  };\n}\nfunction rotatePosition(containerSize, position, rotation) {\n  let x = position.x;\n  let y = position.y;\n  switch (rotation) {\n    case 0 /* Degree0 */:\n      x = position.x;\n      y = position.y;\n      break;\n    case 1 /* Degree90 */:\n      x = containerSize.height - position.y;\n      y = position.x;\n      break;\n    case 2 /* Degree180 */:\n      x = containerSize.width - position.x;\n      y = containerSize.height - position.y;\n      break;\n    case 3 /* Degree270 */:\n      x = position.y;\n      y = containerSize.width - position.x;\n      break;\n  }\n  return {\n    x,\n    y\n  };\n}\nfunction scalePosition(position, scaleFactor) {\n  return {\n    x: position.x * scaleFactor,\n    y: position.y * scaleFactor\n  };\n}\nfunction transformPosition(containerSize, position, rotation, scaleFactor) {\n  return scalePosition(rotatePosition(containerSize, position, rotation), scaleFactor);\n}\nfunction restorePosition(containerSize, position, rotation, scaleFactor) {\n  return scalePosition(\n    rotatePosition(containerSize, position, (4 - rotation) % 4),\n    1 / scaleFactor\n  );\n}\nfunction rotateRect(containerSize, rect, rotation) {\n  let x = rect.origin.x;\n  let y = rect.origin.y;\n  let size = rect.size;\n  switch (rotation) {\n    case 0 /* Degree0 */:\n      break;\n    case 1 /* Degree90 */:\n      x = containerSize.height - rect.origin.y - rect.size.height;\n      y = rect.origin.x;\n      size = swap(rect.size);\n      break;\n    case 2 /* Degree180 */:\n      x = containerSize.width - rect.origin.x - rect.size.width;\n      y = containerSize.height - rect.origin.y - rect.size.height;\n      break;\n    case 3 /* Degree270 */:\n      x = rect.origin.y;\n      y = containerSize.width - rect.origin.x - rect.size.width;\n      size = swap(rect.size);\n      break;\n  }\n  return {\n    origin: {\n      x,\n      y\n    },\n    size: {\n      width: size.width,\n      height: size.height\n    }\n  };\n}\nfunction scaleRect(rect, scaleFactor) {\n  return {\n    origin: {\n      x: rect.origin.x * scaleFactor,\n      y: rect.origin.y * scaleFactor\n    },\n    size: {\n      width: rect.size.width * scaleFactor,\n      height: rect.size.height * scaleFactor\n    }\n  };\n}\nfunction transformRect(containerSize, rect, rotation, scaleFactor) {\n  return scaleRect(rotateRect(containerSize, rect, rotation), scaleFactor);\n}\nfunction restoreRect(containerSize, rect, rotation, scaleFactor) {\n  return scaleRect(rotateRect(containerSize, rect, (4 - rotation) % 4), 1 / scaleFactor);\n}\nfunction restoreOffset(offset, rotation, scaleFactor) {\n  let offsetX = offset.x;\n  let offsetY = offset.y;\n  switch (rotation) {\n    case 0 /* Degree0 */:\n      offsetX = offset.x / scaleFactor;\n      offsetY = offset.y / scaleFactor;\n      break;\n    case 1 /* Degree90 */:\n      offsetX = offset.y / scaleFactor;\n      offsetY = -offset.x / scaleFactor;\n      break;\n    case 2 /* Degree180 */:\n      offsetX = -offset.x / scaleFactor;\n      offsetY = -offset.y / scaleFactor;\n      break;\n    case 3 /* Degree270 */:\n      offsetX = -offset.y / scaleFactor;\n      offsetY = offset.x / scaleFactor;\n      break;\n  }\n  return {\n    x: offsetX,\n    y: offsetY\n  };\n}\nfunction boundingRect(rects) {\n  if (rects.length === 0) return null;\n  let minX = rects[0].origin.x, minY = rects[0].origin.y, maxX = rects[0].origin.x + rects[0].size.width, maxY = rects[0].origin.y + rects[0].size.height;\n  for (const r of rects) {\n    minX = Math.min(minX, r.origin.x);\n    minY = Math.min(minY, r.origin.y);\n    maxX = Math.max(maxX, r.origin.x + r.size.width);\n    maxY = Math.max(maxY, r.origin.y + r.size.height);\n  }\n  return {\n    origin: {\n      x: minX,\n      y: minY\n    },\n    size: {\n      width: maxX - minX,\n      height: maxY - minY\n    }\n  };\n}\nvar makeMatrix = (rectangle, rotation, scaleFactor) => {\n  const { width, height } = rectangle.size;\n  switch (rotation) {\n    case 0 /* Degree0 */:\n      return {\n        a: scaleFactor,\n        b: 0,\n        c: 0,\n        d: -scaleFactor,\n        e: 0,\n        f: height * scaleFactor\n      };\n    case 1 /* Degree90 */:\n      return {\n        a: 0,\n        b: scaleFactor,\n        c: scaleFactor,\n        d: 0,\n        e: 0,\n        f: 0\n      };\n    case 2 /* Degree180 */:\n      return {\n        a: -scaleFactor,\n        b: 0,\n        c: 0,\n        d: scaleFactor,\n        e: width * scaleFactor,\n        f: 0\n      };\n    case 3 /* Degree270 */:\n      return {\n        a: 0,\n        b: -scaleFactor,\n        c: -scaleFactor,\n        d: 0,\n        e: height * scaleFactor,\n        f: width * scaleFactor\n      };\n  }\n};\n\n// src/logger.ts\nvar NoopLogger = class {\n  /** {@inheritDoc Logger.debug} */\n  debug() {\n  }\n  /** {@inheritDoc Logger.info} */\n  info() {\n  }\n  /** {@inheritDoc Logger.warn} */\n  warn() {\n  }\n  /** {@inheritDoc Logger.error} */\n  error() {\n  }\n  /** {@inheritDoc Logger.perf} */\n  perf() {\n  }\n};\nvar ConsoleLogger = class {\n  /** {@inheritDoc Logger.debug} */\n  debug(source, category, ...args) {\n    console.debug(`${source}.${category}`, ...args);\n  }\n  /** {@inheritDoc Logger.info} */\n  info(source, category, ...args) {\n    console.info(`${source}.${category}`, ...args);\n  }\n  /** {@inheritDoc Logger.warn} */\n  warn(source, category, ...args) {\n    console.warn(`${source}.${category}`, ...args);\n  }\n  /** {@inheritDoc Logger.error} */\n  error(source, category, ...args) {\n    console.error(`${source}.${category}`, ...args);\n  }\n  /** {@inheritDoc Logger.perf} */\n  perf(source, category, event, phase, ...args) {\n    console.info(`${source}.${category}.${event}.${phase}`, ...args);\n  }\n};\nvar LogLevel = /* @__PURE__ */ ((LogLevel2) => {\n  LogLevel2[LogLevel2[\"Debug\"] = 0] = \"Debug\";\n  LogLevel2[LogLevel2[\"Info\"] = 1] = \"Info\";\n  LogLevel2[LogLevel2[\"Warn\"] = 2] = \"Warn\";\n  LogLevel2[LogLevel2[\"Error\"] = 3] = \"Error\";\n  return LogLevel2;\n})(LogLevel || {});\nvar LevelLogger = class {\n  /**\n   * create new LevelLogger\n   * @param logger - the original logger\n   * @param level - log level that used for filtering, all logs lower than this level will be filtered out\n   */\n  constructor(logger, level) {\n    this.logger = logger;\n    this.level = level;\n  }\n  /** {@inheritDoc Logger.debug} */\n  debug(source, category, ...args) {\n    if (this.level <= 0 /* Debug */) {\n      this.logger.debug(source, category, ...args);\n    }\n  }\n  /** {@inheritDoc Logger.info} */\n  info(source, category, ...args) {\n    if (this.level <= 1 /* Info */) {\n      this.logger.info(source, category, ...args);\n    }\n  }\n  /** {@inheritDoc Logger.warn} */\n  warn(source, category, ...args) {\n    if (this.level <= 2 /* Warn */) {\n      this.logger.warn(source, category, ...args);\n    }\n  }\n  /** {@inheritDoc Logger.error} */\n  error(source, category, ...args) {\n    if (this.level <= 3 /* Error */) {\n      this.logger.error(source, category, ...args);\n    }\n  }\n  /** {@inheritDoc Logger.perf} */\n  perf(source, category, event, phase, ...args) {\n    this.logger.perf(source, category, event, phase, ...args);\n  }\n};\nvar PerfLogger = class {\n  /**\n   * create new PerfLogger\n   */\n  constructor() {\n  }\n  /** {@inheritDoc Logger.debug} */\n  debug(source, category, ...args) {\n  }\n  /** {@inheritDoc Logger.info} */\n  info(source, category, ...args) {\n  }\n  /** {@inheritDoc Logger.warn} */\n  warn(source, category, ...args) {\n  }\n  /** {@inheritDoc Logger.error} */\n  error(source, category, ...args) {\n  }\n  /** {@inheritDoc Logger.perf} */\n  perf(source, category, event, phase, identifier, ...args) {\n    switch (phase) {\n      case \"Begin\":\n        window.performance.mark(`${source}.${category}.${event}.${phase}.${identifier}`, {\n          detail: args\n        });\n        break;\n      case \"End\":\n        window.performance.mark(`${source}.${category}.${event}.${phase}.${identifier}`, {\n          detail: args\n        });\n        window.performance.measure(\n          `${source}.${category}.${event}.Measure.${identifier}`,\n          `${source}.${category}.${event}.Begin.${identifier}`,\n          `${source}.${category}.${event}.End.${identifier}`\n        );\n        break;\n    }\n  }\n};\nvar AllLogger = class {\n  /**\n   * create new PerfLogger\n   */\n  constructor(loggers) {\n    this.loggers = loggers;\n  }\n  /** {@inheritDoc Logger.debug} */\n  debug(source, category, ...args) {\n    for (const logger of this.loggers) {\n      logger.debug(source, category, ...args);\n    }\n  }\n  /** {@inheritDoc Logger.info} */\n  info(source, category, ...args) {\n    for (const logger of this.loggers) {\n      logger.info(source, category, ...args);\n    }\n  }\n  /** {@inheritDoc Logger.warn} */\n  warn(source, category, ...args) {\n    for (const logger of this.loggers) {\n      logger.warn(source, category, ...args);\n    }\n  }\n  /** {@inheritDoc Logger.error} */\n  error(source, category, ...args) {\n    for (const logger of this.loggers) {\n      logger.error(source, category, ...args);\n    }\n  }\n  /** {@inheritDoc Logger.perf} */\n  perf(source, category, event, phase, ...args) {\n    for (const logger of this.loggers) {\n      logger.perf(source, category, event, phase, ...args);\n    }\n  }\n};\n\n// src/task.ts\nvar TaskStage = /* @__PURE__ */ ((TaskStage2) => {\n  TaskStage2[TaskStage2[\"Pending\"] = 0] = \"Pending\";\n  TaskStage2[TaskStage2[\"Resolved\"] = 1] = \"Resolved\";\n  TaskStage2[TaskStage2[\"Rejected\"] = 2] = \"Rejected\";\n  TaskStage2[TaskStage2[\"Aborted\"] = 3] = \"Aborted\";\n  return TaskStage2;\n})(TaskStage || {});\nvar TaskAbortedError = class extends Error {\n  constructor(reason) {\n    super(`Task aborted: ${JSON.stringify(reason)}`);\n    this.name = \"TaskAbortedError\";\n  }\n};\nvar TaskRejectedError = class extends Error {\n  constructor(reason) {\n    super(`Task rejected: ${JSON.stringify(reason)}`);\n    this.name = \"TaskRejectedError\";\n  }\n};\nvar Task = class _Task {\n  constructor() {\n    this.state = {\n      stage: 0 /* Pending */\n    };\n    /**\n     * callbacks that will be executed when task is resolved\n     */\n    this.resolvedCallbacks = [];\n    /**\n     * callbacks that will be executed when task is rejected\n     */\n    this.rejectedCallbacks = [];\n    /**\n     * Promise that will be resolved when task is settled\n     */\n    this._promise = null;\n  }\n  /**\n   * Convert task to promise\n   * @returns promise that will be resolved when task is settled\n   */\n  toPromise() {\n    if (!this._promise) {\n      this._promise = new Promise((resolve, reject) => {\n        this.wait(\n          (result) => resolve(result),\n          (error) => {\n            if (error.type === \"abort\") {\n              reject(new TaskAbortedError(error.reason));\n            } else {\n              reject(new TaskRejectedError(error.reason));\n            }\n          }\n        );\n      });\n    }\n    return this._promise;\n  }\n  /**\n   * wait for task to be settled\n   * @param resolvedCallback - callback for resolved value\n   * @param rejectedCallback - callback for rejected value\n   */\n  wait(resolvedCallback, rejectedCallback) {\n    switch (this.state.stage) {\n      case 0 /* Pending */:\n        this.resolvedCallbacks.push(resolvedCallback);\n        this.rejectedCallbacks.push(rejectedCallback);\n        break;\n      case 1 /* Resolved */:\n        resolvedCallback(this.state.result);\n        break;\n      case 2 /* Rejected */:\n        rejectedCallback({\n          type: \"reject\",\n          reason: this.state.reason\n        });\n        break;\n      case 3 /* Aborted */:\n        rejectedCallback({\n          type: \"abort\",\n          reason: this.state.reason\n        });\n        break;\n    }\n  }\n  /**\n   * resolve task with specific result\n   * @param result - result value\n   */\n  resolve(result) {\n    if (this.state.stage === 0 /* Pending */) {\n      this.state = {\n        stage: 1 /* Resolved */,\n        result\n      };\n      for (const resolvedCallback of this.resolvedCallbacks) {\n        try {\n          resolvedCallback(result);\n        } catch (e) {\n        }\n      }\n      this.resolvedCallbacks = [];\n      this.rejectedCallbacks = [];\n    }\n  }\n  /**\n   * reject task with specific reason\n   * @param reason - abort reason\n   *\n   */\n  reject(reason) {\n    if (this.state.stage === 0 /* Pending */) {\n      this.state = {\n        stage: 2 /* Rejected */,\n        reason\n      };\n      for (const rejectedCallback of this.rejectedCallbacks) {\n        try {\n          rejectedCallback({\n            type: \"reject\",\n            reason\n          });\n        } catch (e) {\n        }\n      }\n      this.resolvedCallbacks = [];\n      this.rejectedCallbacks = [];\n    }\n  }\n  /**\n   * abort task with specific reason\n   * @param reason - abort reason\n   */\n  abort(reason) {\n    if (this.state.stage === 0 /* Pending */) {\n      this.state = {\n        stage: 3 /* Aborted */,\n        reason\n      };\n      for (const rejectedCallback of this.rejectedCallbacks) {\n        try {\n          rejectedCallback({\n            type: \"abort\",\n            reason\n          });\n        } catch (e) {\n        }\n      }\n      this.resolvedCallbacks = [];\n      this.rejectedCallbacks = [];\n    }\n  }\n  /**\n   * fail task with a TaskError from another task\n   * This is a convenience method for error propagation between tasks\n   * @param error - TaskError from another task\n   */\n  fail(error) {\n    if (error.type === \"abort\") {\n      this.abort(error.reason);\n    } else {\n      this.reject(error.reason);\n    }\n  }\n  /**\n   * Static method to wait for all tasks to resolve\n   * Returns a new task that resolves with an array of all results\n   * Rejects immediately if any task fails\n   *\n   * @param tasks - array of tasks to wait for\n   * @returns new task that resolves when all input tasks resolve\n   * @public\n   */\n  static all(tasks) {\n    const combinedTask = new _Task();\n    if (tasks.length === 0) {\n      combinedTask.resolve([]);\n      return combinedTask;\n    }\n    const results = new Array(tasks.length);\n    let resolvedCount = 0;\n    let isSettled = false;\n    tasks.forEach((task, index) => {\n      task.wait(\n        (result) => {\n          if (isSettled) return;\n          results[index] = result;\n          resolvedCount++;\n          if (resolvedCount === tasks.length) {\n            isSettled = true;\n            combinedTask.resolve(results);\n          }\n        },\n        (error) => {\n          if (isSettled) return;\n          isSettled = true;\n          if (error.type === \"abort\") {\n            combinedTask.abort(error.reason);\n          } else {\n            combinedTask.reject(error.reason);\n          }\n        }\n      );\n    });\n    return combinedTask;\n  }\n  /**\n   * Static method to wait for all tasks to settle (resolve, reject, or abort)\n   * Always resolves with an array of settlement results\n   *\n   * @param tasks - array of tasks to wait for\n   * @returns new task that resolves when all input tasks settle\n   * @public\n   */\n  static allSettled(tasks) {\n    const combinedTask = new _Task();\n    if (tasks.length === 0) {\n      combinedTask.resolve([]);\n      return combinedTask;\n    }\n    const results = new Array(tasks.length);\n    let settledCount = 0;\n    tasks.forEach((task, index) => {\n      task.wait(\n        (result) => {\n          results[index] = { status: \"resolved\", value: result };\n          settledCount++;\n          if (settledCount === tasks.length) {\n            combinedTask.resolve(results);\n          }\n        },\n        (error) => {\n          results[index] = {\n            status: error.type === \"abort\" ? \"aborted\" : \"rejected\",\n            reason: error.reason\n          };\n          settledCount++;\n          if (settledCount === tasks.length) {\n            combinedTask.resolve(results);\n          }\n        }\n      );\n    });\n    return combinedTask;\n  }\n  /**\n   * Static method that resolves/rejects with the first task that settles\n   *\n   * @param tasks - array of tasks to race\n   * @returns new task that settles with the first input task that settles\n   * @public\n   */\n  static race(tasks) {\n    const combinedTask = new _Task();\n    if (tasks.length === 0) {\n      combinedTask.reject(\"No tasks provided\");\n      return combinedTask;\n    }\n    let isSettled = false;\n    tasks.forEach((task) => {\n      task.wait(\n        (result) => {\n          if (isSettled) return;\n          isSettled = true;\n          combinedTask.resolve(result);\n        },\n        (error) => {\n          if (isSettled) return;\n          isSettled = true;\n          if (error.type === \"abort\") {\n            combinedTask.abort(error.reason);\n          } else {\n            combinedTask.reject(error.reason);\n          }\n        }\n      );\n    });\n    return combinedTask;\n  }\n  /**\n   * Utility to track progress of multiple tasks\n   *\n   * @param tasks - array of tasks to track\n   * @param onProgress - callback called when any task completes\n   * @returns new task that resolves when all input tasks resolve\n   * @public\n   */\n  static withProgress(tasks, onProgress) {\n    const combinedTask = _Task.all(tasks);\n    if (onProgress) {\n      let completedCount = 0;\n      tasks.forEach((task) => {\n        task.wait(\n          () => {\n            completedCount++;\n            onProgress(completedCount, tasks.length);\n          },\n          () => {\n            completedCount++;\n            onProgress(completedCount, tasks.length);\n          }\n        );\n      });\n    }\n    return combinedTask;\n  }\n};\n\n// src/pdf.ts\nvar PdfSoftHyphenMarker = \"\\xAD\";\nvar PdfZeroWidthSpace = \"\\u200B\";\nvar PdfWordJoiner = \"\\u2060\";\nvar PdfBomOrZwnbsp = \"\\uFEFF\";\nvar PdfNonCharacterFFFE = \"\\uFFFE\";\nvar PdfNonCharacterFFFF = \"\\uFFFF\";\nvar PdfUnwantedTextMarkers = Object.freeze([\n  PdfSoftHyphenMarker,\n  PdfZeroWidthSpace,\n  PdfWordJoiner,\n  PdfBomOrZwnbsp,\n  PdfNonCharacterFFFE,\n  PdfNonCharacterFFFF\n]);\nvar PdfUnwantedTextRegex = new RegExp(`[${PdfUnwantedTextMarkers.join(\"\")}]`, \"g\");\nfunction stripPdfUnwantedMarkers(text) {\n  return text.replace(PdfUnwantedTextRegex, \"\");\n}\nvar PdfZoomMode = /* @__PURE__ */ ((PdfZoomMode2) => {\n  PdfZoomMode2[PdfZoomMode2[\"Unknown\"] = 0] = \"Unknown\";\n  PdfZoomMode2[PdfZoomMode2[\"XYZ\"] = 1] = \"XYZ\";\n  PdfZoomMode2[PdfZoomMode2[\"FitPage\"] = 2] = \"FitPage\";\n  PdfZoomMode2[PdfZoomMode2[\"FitHorizontal\"] = 3] = \"FitHorizontal\";\n  PdfZoomMode2[PdfZoomMode2[\"FitVertical\"] = 4] = \"FitVertical\";\n  PdfZoomMode2[PdfZoomMode2[\"FitRectangle\"] = 5] = \"FitRectangle\";\n  return PdfZoomMode2;\n})(PdfZoomMode || {});\nvar PdfBlendMode = /* @__PURE__ */ ((PdfBlendMode2) => {\n  PdfBlendMode2[PdfBlendMode2[\"Normal\"] = 0] = \"Normal\";\n  PdfBlendMode2[PdfBlendMode2[\"Multiply\"] = 1] = \"Multiply\";\n  PdfBlendMode2[PdfBlendMode2[\"Screen\"] = 2] = \"Screen\";\n  PdfBlendMode2[PdfBlendMode2[\"Overlay\"] = 3] = \"Overlay\";\n  PdfBlendMode2[PdfBlendMode2[\"Darken\"] = 4] = \"Darken\";\n  PdfBlendMode2[PdfBlendMode2[\"Lighten\"] = 5] = \"Lighten\";\n  PdfBlendMode2[PdfBlendMode2[\"ColorDodge\"] = 6] = \"ColorDodge\";\n  PdfBlendMode2[PdfBlendMode2[\"ColorBurn\"] = 7] = \"ColorBurn\";\n  PdfBlendMode2[PdfBlendMode2[\"HardLight\"] = 8] = \"HardLight\";\n  PdfBlendMode2[PdfBlendMode2[\"SoftLight\"] = 9] = \"SoftLight\";\n  PdfBlendMode2[PdfBlendMode2[\"Difference\"] = 10] = \"Difference\";\n  PdfBlendMode2[PdfBlendMode2[\"Exclusion\"] = 11] = \"Exclusion\";\n  PdfBlendMode2[PdfBlendMode2[\"Hue\"] = 12] = \"Hue\";\n  PdfBlendMode2[PdfBlendMode2[\"Saturation\"] = 13] = \"Saturation\";\n  PdfBlendMode2[PdfBlendMode2[\"Color\"] = 14] = \"Color\";\n  PdfBlendMode2[PdfBlendMode2[\"Luminosity\"] = 15] = \"Luminosity\";\n  return PdfBlendMode2;\n})(PdfBlendMode || {});\nvar MixedBlendMode = Symbol(\"mixed\");\nvar BLEND_MODE_INFOS = Object.freeze([\n  { id: 0 /* Normal */, label: \"Normal\", css: \"normal\" },\n  { id: 1 /* Multiply */, label: \"Multiply\", css: \"multiply\" },\n  { id: 2 /* Screen */, label: \"Screen\", css: \"screen\" },\n  { id: 3 /* Overlay */, label: \"Overlay\", css: \"overlay\" },\n  { id: 4 /* Darken */, label: \"Darken\", css: \"darken\" },\n  { id: 5 /* Lighten */, label: \"Lighten\", css: \"lighten\" },\n  { id: 6 /* ColorDodge */, label: \"Color Dodge\", css: \"color-dodge\" },\n  { id: 7 /* ColorBurn */, label: \"Color Burn\", css: \"color-burn\" },\n  { id: 8 /* HardLight */, label: \"Hard Light\", css: \"hard-light\" },\n  { id: 9 /* SoftLight */, label: \"Soft Light\", css: \"soft-light\" },\n  { id: 10 /* Difference */, label: \"Difference\", css: \"difference\" },\n  { id: 11 /* Exclusion */, label: \"Exclusion\", css: \"exclusion\" },\n  { id: 12 /* Hue */, label: \"Hue\", css: \"hue\" },\n  { id: 13 /* Saturation */, label: \"Saturation\", css: \"saturation\" },\n  { id: 14 /* Color */, label: \"Color\", css: \"color\" },\n  { id: 15 /* Luminosity */, label: \"Luminosity\", css: \"luminosity\" }\n]);\nvar enumToInfo = BLEND_MODE_INFOS.reduce(\n  (m, info) => {\n    m[info.id] = info;\n    return m;\n  },\n  {}\n);\nvar cssToEnum = BLEND_MODE_INFOS.reduce((m, info) => {\n  m[info.css] = info.id;\n  return m;\n}, {});\nfunction getBlendModeInfo(mode) {\n  return enumToInfo[mode] ?? enumToInfo[0 /* Normal */];\n}\nfunction blendModeToCss(mode) {\n  return getBlendModeInfo(mode).css;\n}\nfunction cssToBlendMode(value) {\n  return cssToEnum[value];\n}\nfunction blendModeLabel(mode) {\n  return getBlendModeInfo(mode).label;\n}\nfunction reduceBlendModes(modes) {\n  if (!modes.length) return 0 /* Normal */;\n  const first = modes[0];\n  return modes.every((m) => m === first) ? first : MixedBlendMode;\n}\nvar blendModeSelectOptions = BLEND_MODE_INFOS.map((info) => ({\n  value: info.id,\n  label: info.label\n}));\nfunction uiBlendModeDisplay(value) {\n  return value === MixedBlendMode ? \"(mixed)\" : blendModeLabel(value);\n}\nvar PdfActionType = /* @__PURE__ */ ((PdfActionType2) => {\n  PdfActionType2[PdfActionType2[\"Unsupported\"] = 0] = \"Unsupported\";\n  PdfActionType2[PdfActionType2[\"Goto\"] = 1] = \"Goto\";\n  PdfActionType2[PdfActionType2[\"RemoteGoto\"] = 2] = \"RemoteGoto\";\n  PdfActionType2[PdfActionType2[\"URI\"] = 3] = \"URI\";\n  PdfActionType2[PdfActionType2[\"LaunchAppOrOpenFile\"] = 4] = \"LaunchAppOrOpenFile\";\n  return PdfActionType2;\n})(PdfActionType || {});\nvar PdfAnnotationSubtype = /* @__PURE__ */ ((PdfAnnotationSubtype2) => {\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"UNKNOWN\"] = 0] = \"UNKNOWN\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"TEXT\"] = 1] = \"TEXT\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"LINK\"] = 2] = \"LINK\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"FREETEXT\"] = 3] = \"FREETEXT\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"LINE\"] = 4] = \"LINE\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"SQUARE\"] = 5] = \"SQUARE\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"CIRCLE\"] = 6] = \"CIRCLE\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"POLYGON\"] = 7] = \"POLYGON\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"POLYLINE\"] = 8] = \"POLYLINE\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"HIGHLIGHT\"] = 9] = \"HIGHLIGHT\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"UNDERLINE\"] = 10] = \"UNDERLINE\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"SQUIGGLY\"] = 11] = \"SQUIGGLY\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"STRIKEOUT\"] = 12] = \"STRIKEOUT\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"STAMP\"] = 13] = \"STAMP\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"CARET\"] = 14] = \"CARET\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"INK\"] = 15] = \"INK\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"POPUP\"] = 16] = \"POPUP\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"FILEATTACHMENT\"] = 17] = \"FILEATTACHMENT\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"SOUND\"] = 18] = \"SOUND\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"MOVIE\"] = 19] = \"MOVIE\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"WIDGET\"] = 20] = \"WIDGET\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"SCREEN\"] = 21] = \"SCREEN\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"PRINTERMARK\"] = 22] = \"PRINTERMARK\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"TRAPNET\"] = 23] = \"TRAPNET\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"WATERMARK\"] = 24] = \"WATERMARK\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"THREED\"] = 25] = \"THREED\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"RICHMEDIA\"] = 26] = \"RICHMEDIA\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"XFAWIDGET\"] = 27] = \"XFAWIDGET\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"REDACT\"] = 28] = \"REDACT\";\n  return PdfAnnotationSubtype2;\n})(PdfAnnotationSubtype || {});\nvar PdfAnnotationSubtypeName = {\n  [0 /* UNKNOWN */]: \"unknow\",\n  [1 /* TEXT */]: \"text\",\n  [2 /* LINK */]: \"link\",\n  [3 /* FREETEXT */]: \"freetext\",\n  [4 /* LINE */]: \"line\",\n  [5 /* SQUARE */]: \"square\",\n  [6 /* CIRCLE */]: \"circle\",\n  [7 /* POLYGON */]: \"polygon\",\n  [8 /* POLYLINE */]: \"polyline\",\n  [9 /* HIGHLIGHT */]: \"highlight\",\n  [10 /* UNDERLINE */]: \"underline\",\n  [11 /* SQUIGGLY */]: \"squiggly\",\n  [12 /* STRIKEOUT */]: \"strikeout\",\n  [13 /* STAMP */]: \"stamp\",\n  [14 /* CARET */]: \"caret\",\n  [15 /* INK */]: \"ink\",\n  [16 /* POPUP */]: \"popup\",\n  [17 /* FILEATTACHMENT */]: \"fileattachment\",\n  [18 /* SOUND */]: \"sound\",\n  [19 /* MOVIE */]: \"movie\",\n  [20 /* WIDGET */]: \"widget\",\n  [21 /* SCREEN */]: \"screen\",\n  [22 /* PRINTERMARK */]: \"printermark\",\n  [23 /* TRAPNET */]: \"trapnet\",\n  [24 /* WATERMARK */]: \"watermark\",\n  [25 /* THREED */]: \"threed\",\n  [26 /* RICHMEDIA */]: \"richmedia\",\n  [27 /* XFAWIDGET */]: \"xfawidget\",\n  [28 /* REDACT */]: \"redact\"\n};\nvar PdfAnnotationObjectStatus = /* @__PURE__ */ ((PdfAnnotationObjectStatus2) => {\n  PdfAnnotationObjectStatus2[PdfAnnotationObjectStatus2[\"Created\"] = 0] = \"Created\";\n  PdfAnnotationObjectStatus2[PdfAnnotationObjectStatus2[\"Committed\"] = 1] = \"Committed\";\n  return PdfAnnotationObjectStatus2;\n})(PdfAnnotationObjectStatus || {});\nvar AppearanceMode = /* @__PURE__ */ ((AppearanceMode2) => {\n  AppearanceMode2[AppearanceMode2[\"Normal\"] = 0] = \"Normal\";\n  AppearanceMode2[AppearanceMode2[\"Rollover\"] = 1] = \"Rollover\";\n  AppearanceMode2[AppearanceMode2[\"Down\"] = 2] = \"Down\";\n  return AppearanceMode2;\n})(AppearanceMode || {});\nvar PdfAnnotationState = /* @__PURE__ */ ((PdfAnnotationState2) => {\n  PdfAnnotationState2[\"Marked\"] = \"Marked\";\n  PdfAnnotationState2[\"Unmarked\"] = \"Unmarked\";\n  PdfAnnotationState2[\"Accepted\"] = \"Accepted\";\n  PdfAnnotationState2[\"Rejected\"] = \"Rejected\";\n  PdfAnnotationState2[\"Complete\"] = \"Complete\";\n  PdfAnnotationState2[\"Cancelled\"] = \"Cancelled\";\n  PdfAnnotationState2[\"None\"] = \"None\";\n  return PdfAnnotationState2;\n})(PdfAnnotationState || {});\nvar PdfAnnotationStateModel = /* @__PURE__ */ ((PdfAnnotationStateModel2) => {\n  PdfAnnotationStateModel2[\"Marked\"] = \"Marked\";\n  PdfAnnotationStateModel2[\"Reviewed\"] = \"Reviewed\";\n  return PdfAnnotationStateModel2;\n})(PdfAnnotationStateModel || {});\nvar PDF_FORM_FIELD_TYPE = /* @__PURE__ */ ((PDF_FORM_FIELD_TYPE2) => {\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2[\"UNKNOWN\"] = 0] = \"UNKNOWN\";\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2[\"PUSHBUTTON\"] = 1] = \"PUSHBUTTON\";\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2[\"CHECKBOX\"] = 2] = \"CHECKBOX\";\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2[\"RADIOBUTTON\"] = 3] = \"RADIOBUTTON\";\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2[\"COMBOBOX\"] = 4] = \"COMBOBOX\";\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2[\"LISTBOX\"] = 5] = \"LISTBOX\";\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2[\"TEXTFIELD\"] = 6] = \"TEXTFIELD\";\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2[\"SIGNATURE\"] = 7] = \"SIGNATURE\";\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2[\"XFA\"] = 8] = \"XFA\";\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2[\"XFA_CHECKBOX\"] = 9] = \"XFA_CHECKBOX\";\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2[\"XFA_COMBOBOX\"] = 10] = \"XFA_COMBOBOX\";\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2[\"XFA_IMAGEFIELD\"] = 11] = \"XFA_IMAGEFIELD\";\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2[\"XFA_LISTBOX\"] = 12] = \"XFA_LISTBOX\";\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2[\"XFA_PUSHBUTTON\"] = 13] = \"XFA_PUSHBUTTON\";\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2[\"XFA_SIGNATURE\"] = 14] = \"XFA_SIGNATURE\";\n  PDF_FORM_FIELD_TYPE2[PDF_FORM_FIELD_TYPE2[\"XFA_TEXTFIELD\"] = 15] = \"XFA_TEXTFIELD\";\n  return PDF_FORM_FIELD_TYPE2;\n})(PDF_FORM_FIELD_TYPE || {});\nvar PdfAnnotationColorType = /* @__PURE__ */ ((PdfAnnotationColorType2) => {\n  PdfAnnotationColorType2[PdfAnnotationColorType2[\"Color\"] = 0] = \"Color\";\n  PdfAnnotationColorType2[PdfAnnotationColorType2[\"InteriorColor\"] = 1] = \"InteriorColor\";\n  return PdfAnnotationColorType2;\n})(PdfAnnotationColorType || {});\nvar PdfAnnotationBorderStyle = /* @__PURE__ */ ((PdfAnnotationBorderStyle2) => {\n  PdfAnnotationBorderStyle2[PdfAnnotationBorderStyle2[\"UNKNOWN\"] = 0] = \"UNKNOWN\";\n  PdfAnnotationBorderStyle2[PdfAnnotationBorderStyle2[\"SOLID\"] = 1] = \"SOLID\";\n  PdfAnnotationBorderStyle2[PdfAnnotationBorderStyle2[\"DASHED\"] = 2] = \"DASHED\";\n  PdfAnnotationBorderStyle2[PdfAnnotationBorderStyle2[\"BEVELED\"] = 3] = \"BEVELED\";\n  PdfAnnotationBorderStyle2[PdfAnnotationBorderStyle2[\"INSET\"] = 4] = \"INSET\";\n  PdfAnnotationBorderStyle2[PdfAnnotationBorderStyle2[\"UNDERLINE\"] = 5] = \"UNDERLINE\";\n  PdfAnnotationBorderStyle2[PdfAnnotationBorderStyle2[\"CLOUDY\"] = 6] = \"CLOUDY\";\n  return PdfAnnotationBorderStyle2;\n})(PdfAnnotationBorderStyle || {});\nvar PdfAnnotationFlags = /* @__PURE__ */ ((PdfAnnotationFlags2) => {\n  PdfAnnotationFlags2[PdfAnnotationFlags2[\"NONE\"] = 0] = \"NONE\";\n  PdfAnnotationFlags2[PdfAnnotationFlags2[\"INVISIBLE\"] = 1] = \"INVISIBLE\";\n  PdfAnnotationFlags2[PdfAnnotationFlags2[\"HIDDEN\"] = 2] = \"HIDDEN\";\n  PdfAnnotationFlags2[PdfAnnotationFlags2[\"PRINT\"] = 4] = \"PRINT\";\n  PdfAnnotationFlags2[PdfAnnotationFlags2[\"NO_ZOOM\"] = 8] = \"NO_ZOOM\";\n  PdfAnnotationFlags2[PdfAnnotationFlags2[\"NO_ROTATE\"] = 16] = \"NO_ROTATE\";\n  PdfAnnotationFlags2[PdfAnnotationFlags2[\"NO_VIEW\"] = 32] = \"NO_VIEW\";\n  PdfAnnotationFlags2[PdfAnnotationFlags2[\"READ_ONLY\"] = 64] = \"READ_ONLY\";\n  PdfAnnotationFlags2[PdfAnnotationFlags2[\"LOCKED\"] = 128] = \"LOCKED\";\n  PdfAnnotationFlags2[PdfAnnotationFlags2[\"TOGGLE_NOVIEW\"] = 256] = \"TOGGLE_NOVIEW\";\n  return PdfAnnotationFlags2;\n})(PdfAnnotationFlags || {});\nvar PDF_FORM_FIELD_FLAG = /* @__PURE__ */ ((PDF_FORM_FIELD_FLAG2) => {\n  PDF_FORM_FIELD_FLAG2[PDF_FORM_FIELD_FLAG2[\"NONE\"] = 0] = \"NONE\";\n  PDF_FORM_FIELD_FLAG2[PDF_FORM_FIELD_FLAG2[\"READONLY\"] = 1] = \"READONLY\";\n  PDF_FORM_FIELD_FLAG2[PDF_FORM_FIELD_FLAG2[\"REQUIRED\"] = 2] = \"REQUIRED\";\n  PDF_FORM_FIELD_FLAG2[PDF_FORM_FIELD_FLAG2[\"NOEXPORT\"] = 4] = \"NOEXPORT\";\n  PDF_FORM_FIELD_FLAG2[PDF_FORM_FIELD_FLAG2[\"TEXT_MULTIPLINE\"] = 4096] = \"TEXT_MULTIPLINE\";\n  PDF_FORM_FIELD_FLAG2[PDF_FORM_FIELD_FLAG2[\"TEXT_PASSWORD\"] = 8192] = \"TEXT_PASSWORD\";\n  PDF_FORM_FIELD_FLAG2[PDF_FORM_FIELD_FLAG2[\"CHOICE_COMBO\"] = 131072] = \"CHOICE_COMBO\";\n  PDF_FORM_FIELD_FLAG2[PDF_FORM_FIELD_FLAG2[\"CHOICE_EDIT\"] = 262144] = \"CHOICE_EDIT\";\n  PDF_FORM_FIELD_FLAG2[PDF_FORM_FIELD_FLAG2[\"CHOICE_MULTL_SELECT\"] = 2097152] = \"CHOICE_MULTL_SELECT\";\n  return PDF_FORM_FIELD_FLAG2;\n})(PDF_FORM_FIELD_FLAG || {});\nvar PdfPageObjectType = /* @__PURE__ */ ((PdfPageObjectType2) => {\n  PdfPageObjectType2[PdfPageObjectType2[\"UNKNOWN\"] = 0] = \"UNKNOWN\";\n  PdfPageObjectType2[PdfPageObjectType2[\"TEXT\"] = 1] = \"TEXT\";\n  PdfPageObjectType2[PdfPageObjectType2[\"PATH\"] = 2] = \"PATH\";\n  PdfPageObjectType2[PdfPageObjectType2[\"IMAGE\"] = 3] = \"IMAGE\";\n  PdfPageObjectType2[PdfPageObjectType2[\"SHADING\"] = 4] = \"SHADING\";\n  PdfPageObjectType2[PdfPageObjectType2[\"FORM\"] = 5] = \"FORM\";\n  return PdfPageObjectType2;\n})(PdfPageObjectType || {});\nvar PdfAnnotationFlagName = Object.freeze({\n  [1 /* INVISIBLE */]: \"invisible\",\n  [2 /* HIDDEN */]: \"hidden\",\n  [4 /* PRINT */]: \"print\",\n  [8 /* NO_ZOOM */]: \"noZoom\",\n  [16 /* NO_ROTATE */]: \"noRotate\",\n  [32 /* NO_VIEW */]: \"noView\",\n  [64 /* READ_ONLY */]: \"readOnly\",\n  [128 /* LOCKED */]: \"locked\",\n  [256 /* TOGGLE_NOVIEW */]: \"toggleNoView\"\n});\nvar PdfAnnotationFlagValue = Object.entries(\n  PdfAnnotationFlagName\n).reduce(\n  (acc, [bit, name]) => {\n    acc[name] = Number(bit);\n    return acc;\n  },\n  {}\n);\nfunction flagsToNames(raw) {\n  return Object.keys(PdfAnnotationFlagName).filter((flag) => (raw & flag) !== 0).map((flag) => PdfAnnotationFlagName[flag]);\n}\nfunction namesToFlags(names) {\n  return names.reduce(\n    (mask, name) => mask | PdfAnnotationFlagValue[name],\n    0 /* NONE */\n  );\n}\nvar PdfSegmentObjectType = /* @__PURE__ */ ((PdfSegmentObjectType2) => {\n  PdfSegmentObjectType2[PdfSegmentObjectType2[\"UNKNOWN\"] = -1] = \"UNKNOWN\";\n  PdfSegmentObjectType2[PdfSegmentObjectType2[\"LINETO\"] = 0] = \"LINETO\";\n  PdfSegmentObjectType2[PdfSegmentObjectType2[\"BEZIERTO\"] = 1] = \"BEZIERTO\";\n  PdfSegmentObjectType2[PdfSegmentObjectType2[\"MOVETO\"] = 2] = \"MOVETO\";\n  return PdfSegmentObjectType2;\n})(PdfSegmentObjectType || {});\nvar PdfEngineFeature = /* @__PURE__ */ ((PdfEngineFeature2) => {\n  PdfEngineFeature2[PdfEngineFeature2[\"RenderPage\"] = 0] = \"RenderPage\";\n  PdfEngineFeature2[PdfEngineFeature2[\"RenderPageRect\"] = 1] = \"RenderPageRect\";\n  PdfEngineFeature2[PdfEngineFeature2[\"Thumbnails\"] = 2] = \"Thumbnails\";\n  PdfEngineFeature2[PdfEngineFeature2[\"Bookmarks\"] = 3] = \"Bookmarks\";\n  PdfEngineFeature2[PdfEngineFeature2[\"Annotations\"] = 4] = \"Annotations\";\n  return PdfEngineFeature2;\n})(PdfEngineFeature || {});\nvar PdfEngineOperation = /* @__PURE__ */ ((PdfEngineOperation2) => {\n  PdfEngineOperation2[PdfEngineOperation2[\"Create\"] = 0] = \"Create\";\n  PdfEngineOperation2[PdfEngineOperation2[\"Read\"] = 1] = \"Read\";\n  PdfEngineOperation2[PdfEngineOperation2[\"Update\"] = 2] = \"Update\";\n  PdfEngineOperation2[PdfEngineOperation2[\"Delete\"] = 3] = \"Delete\";\n  return PdfEngineOperation2;\n})(PdfEngineOperation || {});\nvar MatchFlag = /* @__PURE__ */ ((MatchFlag2) => {\n  MatchFlag2[MatchFlag2[\"None\"] = 0] = \"None\";\n  MatchFlag2[MatchFlag2[\"MatchCase\"] = 1] = \"MatchCase\";\n  MatchFlag2[MatchFlag2[\"MatchWholeWord\"] = 2] = \"MatchWholeWord\";\n  MatchFlag2[MatchFlag2[\"MatchConsecutive\"] = 4] = \"MatchConsecutive\";\n  return MatchFlag2;\n})(MatchFlag || {});\nfunction unionFlags(flags) {\n  return flags.reduce((flag, currFlag) => {\n    return flag | currFlag;\n  }, 0 /* None */);\n}\nfunction compareSearchTarget(targetA, targetB) {\n  const flagA = unionFlags(targetA.flags);\n  const flagB = unionFlags(targetB.flags);\n  return flagA === flagB && targetA.keyword === targetB.keyword;\n}\nvar PdfPermission = /* @__PURE__ */ ((PdfPermission2) => {\n  PdfPermission2[PdfPermission2[\"PrintDocument\"] = 8] = \"PrintDocument\";\n  PdfPermission2[PdfPermission2[\"ModifyContent\"] = 16] = \"ModifyContent\";\n  PdfPermission2[PdfPermission2[\"CopyOrExtract\"] = 32] = \"CopyOrExtract\";\n  PdfPermission2[PdfPermission2[\"AddOrModifyTextAnnot\"] = 64] = \"AddOrModifyTextAnnot\";\n  PdfPermission2[PdfPermission2[\"FillInExistingForm\"] = 512] = \"FillInExistingForm\";\n  PdfPermission2[PdfPermission2[\"ExtractTextOrGraphics\"] = 1024] = \"ExtractTextOrGraphics\";\n  PdfPermission2[PdfPermission2[\"AssembleDocument\"] = 2048] = \"AssembleDocument\";\n  PdfPermission2[PdfPermission2[\"PrintHighQuality\"] = 4096] = \"PrintHighQuality\";\n  return PdfPermission2;\n})(PdfPermission || {});\nvar PdfPageFlattenFlag = /* @__PURE__ */ ((PdfPageFlattenFlag2) => {\n  PdfPageFlattenFlag2[PdfPageFlattenFlag2[\"Display\"] = 0] = \"Display\";\n  PdfPageFlattenFlag2[PdfPageFlattenFlag2[\"Print\"] = 1] = \"Print\";\n  return PdfPageFlattenFlag2;\n})(PdfPageFlattenFlag || {});\nvar PdfPageFlattenResult = /* @__PURE__ */ ((PdfPageFlattenResult2) => {\n  PdfPageFlattenResult2[PdfPageFlattenResult2[\"Fail\"] = 0] = \"Fail\";\n  PdfPageFlattenResult2[PdfPageFlattenResult2[\"Success\"] = 1] = \"Success\";\n  PdfPageFlattenResult2[PdfPageFlattenResult2[\"NothingToDo\"] = 2] = \"NothingToDo\";\n  return PdfPageFlattenResult2;\n})(PdfPageFlattenResult || {});\nvar PdfErrorCode = /* @__PURE__ */ ((PdfErrorCode2) => {\n  PdfErrorCode2[PdfErrorCode2[\"Ok\"] = 0] = \"Ok\";\n  PdfErrorCode2[PdfErrorCode2[\"Unknown\"] = 1] = \"Unknown\";\n  PdfErrorCode2[PdfErrorCode2[\"NotFound\"] = 2] = \"NotFound\";\n  PdfErrorCode2[PdfErrorCode2[\"WrongFormat\"] = 3] = \"WrongFormat\";\n  PdfErrorCode2[PdfErrorCode2[\"Password\"] = 4] = \"Password\";\n  PdfErrorCode2[PdfErrorCode2[\"Security\"] = 5] = \"Security\";\n  PdfErrorCode2[PdfErrorCode2[\"PageError\"] = 6] = \"PageError\";\n  PdfErrorCode2[PdfErrorCode2[\"XFALoad\"] = 7] = \"XFALoad\";\n  PdfErrorCode2[PdfErrorCode2[\"XFALayout\"] = 8] = \"XFALayout\";\n  PdfErrorCode2[PdfErrorCode2[\"Cancelled\"] = 9] = \"Cancelled\";\n  PdfErrorCode2[PdfErrorCode2[\"Initialization\"] = 10] = \"Initialization\";\n  PdfErrorCode2[PdfErrorCode2[\"NotReady\"] = 11] = \"NotReady\";\n  PdfErrorCode2[PdfErrorCode2[\"NotSupport\"] = 12] = \"NotSupport\";\n  PdfErrorCode2[PdfErrorCode2[\"LoadDoc\"] = 13] = \"LoadDoc\";\n  PdfErrorCode2[PdfErrorCode2[\"DocNotOpen\"] = 14] = \"DocNotOpen\";\n  PdfErrorCode2[PdfErrorCode2[\"CantCloseDoc\"] = 15] = \"CantCloseDoc\";\n  PdfErrorCode2[PdfErrorCode2[\"CantCreateNewDoc\"] = 16] = \"CantCreateNewDoc\";\n  PdfErrorCode2[PdfErrorCode2[\"CantImportPages\"] = 17] = \"CantImportPages\";\n  PdfErrorCode2[PdfErrorCode2[\"CantCreateAnnot\"] = 18] = \"CantCreateAnnot\";\n  PdfErrorCode2[PdfErrorCode2[\"CantSetAnnotRect\"] = 19] = \"CantSetAnnotRect\";\n  PdfErrorCode2[PdfErrorCode2[\"CantSetAnnotContent\"] = 20] = \"CantSetAnnotContent\";\n  PdfErrorCode2[PdfErrorCode2[\"CantRemoveInkList\"] = 21] = \"CantRemoveInkList\";\n  PdfErrorCode2[PdfErrorCode2[\"CantAddInkStoke\"] = 22] = \"CantAddInkStoke\";\n  PdfErrorCode2[PdfErrorCode2[\"CantReadAttachmentSize\"] = 23] = \"CantReadAttachmentSize\";\n  PdfErrorCode2[PdfErrorCode2[\"CantReadAttachmentContent\"] = 24] = \"CantReadAttachmentContent\";\n  PdfErrorCode2[PdfErrorCode2[\"CantFocusAnnot\"] = 25] = \"CantFocusAnnot\";\n  PdfErrorCode2[PdfErrorCode2[\"CantSelectText\"] = 26] = \"CantSelectText\";\n  PdfErrorCode2[PdfErrorCode2[\"CantSelectOption\"] = 27] = \"CantSelectOption\";\n  PdfErrorCode2[PdfErrorCode2[\"CantCheckField\"] = 28] = \"CantCheckField\";\n  return PdfErrorCode2;\n})(PdfErrorCode || {});\nvar PdfTaskHelper = class {\n  /**\n   * Create a task\n   * @returns new task\n   */\n  static create() {\n    return new Task();\n  }\n  /**\n   * Create a task that has been resolved with value\n   * @param result - resolved value\n   * @returns resolved task\n   */\n  static resolve(result) {\n    const task = new Task();\n    task.resolve(result);\n    return task;\n  }\n  /**\n   * Create a task that has been rejected with error\n   * @param reason - rejected error\n   * @returns rejected task\n   */\n  static reject(reason) {\n    const task = new Task();\n    task.reject(reason);\n    return task;\n  }\n  /**\n   * Create a task that has been aborted with error\n   * @param reason - aborted error\n   * @returns aborted task\n   */\n  static abort(reason) {\n    const task = new Task();\n    task.reject(reason);\n    return task;\n  }\n};\n\n// src/color.ts\nfunction pdfAlphaColorToWebAlphaColor(c) {\n  const clamp = (n) => Math.max(0, Math.min(255, n));\n  const toHex = (n) => clamp(n).toString(16).padStart(2, \"0\");\n  const color = `#${toHex(c.red)}${toHex(c.green)}${toHex(c.blue)}`;\n  const opacity = clamp(c.alpha) / 255;\n  return { color, opacity };\n}\nfunction webAlphaColorToPdfAlphaColor({ color, opacity }) {\n  if (/^#?[0-9a-f]{3}$/i.test(color)) {\n    color = color.replace(/^#?([0-9a-f])([0-9a-f])([0-9a-f])$/i, \"#$1$1$2$2$3$3\").toLowerCase();\n  }\n  const [, r, g, b] = /^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(color) ?? (() => {\n    throw new Error(`Invalid hex colour: \\u201C${color}\\u201D`);\n  })();\n  const clamp = (n, hi = 255) => Math.max(0, Math.min(hi, n));\n  return {\n    red: parseInt(r, 16),\n    green: parseInt(g, 16),\n    blue: parseInt(b, 16),\n    alpha: clamp(Math.round(opacity * 255))\n  };\n}\n\n// src/date.ts\nfunction pdfDateToDate(pdf) {\n  if (!pdf?.startsWith(\"D:\") || pdf.length < 16) return;\n  const y = +pdf.slice(2, 6);\n  const mo = +pdf.slice(6, 8) - 1;\n  const d = +pdf.slice(8, 10);\n  const H = +pdf.slice(10, 12);\n  const M = +pdf.slice(12, 14);\n  const S = +pdf.slice(14, 16);\n  return new Date(Date.UTC(y, mo, d, H, M, S));\n}\nfunction dateToPdfDate(date = /* @__PURE__ */ new Date()) {\n  const z = (n, len = 2) => n.toString().padStart(len, \"0\");\n  const YYYY = date.getUTCFullYear();\n  const MM = z(date.getUTCMonth() + 1);\n  const DD = z(date.getUTCDate());\n  const HH = z(date.getUTCHours());\n  const mm = z(date.getUTCMinutes());\n  const SS = z(date.getUTCSeconds());\n  return `D:${YYYY}${MM}${DD}${HH}${mm}${SS}`;\n}\n\n// src/index.ts\nfunction ignore() {\n}\nexport {\n  AllLogger,\n  AppearanceMode,\n  ConsoleLogger,\n  LevelLogger,\n  LogLevel,\n  MatchFlag,\n  MixedBlendMode,\n  NoopLogger,\n  PDF_FORM_FIELD_FLAG,\n  PDF_FORM_FIELD_TYPE,\n  PdfActionType,\n  PdfAnnotationBorderStyle,\n  PdfAnnotationColorType,\n  PdfAnnotationFlagName,\n  PdfAnnotationFlags,\n  PdfAnnotationObjectStatus,\n  PdfAnnotationState,\n  PdfAnnotationStateModel,\n  PdfAnnotationSubtype,\n  PdfAnnotationSubtypeName,\n  PdfBlendMode,\n  PdfBomOrZwnbsp,\n  PdfEngineFeature,\n  PdfEngineOperation,\n  PdfErrorCode,\n  PdfNonCharacterFFFE,\n  PdfNonCharacterFFFF,\n  PdfPageFlattenFlag,\n  PdfPageFlattenResult,\n  PdfPageObjectType,\n  PdfPermission,\n  PdfSegmentObjectType,\n  PdfSoftHyphenMarker,\n  PdfTaskHelper,\n  PdfUnwantedTextMarkers,\n  PdfUnwantedTextRegex,\n  PdfWordJoiner,\n  PdfZeroWidthSpace,\n  PdfZoomMode,\n  PerfLogger,\n  Rotation,\n  Task,\n  TaskAbortedError,\n  TaskRejectedError,\n  TaskStage,\n  blendModeLabel,\n  blendModeSelectOptions,\n  blendModeToCss,\n  boundingRect,\n  calculateAngle,\n  calculateDegree,\n  compareSearchTarget,\n  cssToBlendMode,\n  dateToPdfDate,\n  flagsToNames,\n  getBlendModeInfo,\n  ignore,\n  makeMatrix,\n  namesToFlags,\n  pdfAlphaColorToWebAlphaColor,\n  pdfDateToDate,\n  quadToRect,\n  rectToQuad,\n  reduceBlendModes,\n  restoreOffset,\n  restorePosition,\n  restoreRect,\n  rotatePosition,\n  rotateRect,\n  scalePosition,\n  scaleRect,\n  stripPdfUnwantedMarkers,\n  swap,\n  toIntPos,\n  toIntRect,\n  toIntSize,\n  transformPosition,\n  transformRect,\n  transformSize,\n  uiBlendModeDisplay,\n  unionFlags,\n  webAlphaColorToPdfAlphaColor\n};\n//# sourceMappingURL=index.js.map","import { Rotation as T, transformSize as A } from \"@embedpdf/models\";\nclass C {\n  constructor() {\n    this.dependencyGraph = /* @__PURE__ */ new Map();\n  }\n  addNode(t, e = []) {\n    this.dependencyGraph.set(t, new Set(e));\n  }\n  hasCircularDependencies() {\n    const t = /* @__PURE__ */ new Set(), e = /* @__PURE__ */ new Set(), i = (r) => {\n      t.add(r), e.add(r);\n      const n = this.dependencyGraph.get(r) || /* @__PURE__ */ new Set();\n      for (const o of n)\n        if (t.has(o)) {\n          if (e.has(o))\n            return !0;\n        } else if (i(o)) return !0;\n      return e.delete(r), !1;\n    };\n    for (const r of this.dependencyGraph.keys())\n      if (!t.has(r) && i(r))\n        return !0;\n    return !1;\n  }\n  resolveLoadOrder() {\n    if (this.hasCircularDependencies())\n      throw new Error(\"Circular dependencies detected\");\n    const t = [], e = /* @__PURE__ */ new Set(), i = /* @__PURE__ */ new Set(), r = (n) => {\n      if (i.has(n)) throw new Error(\"Circular dependency\");\n      if (e.has(n)) return;\n      i.add(n);\n      const o = this.dependencyGraph.get(n) || /* @__PURE__ */ new Set();\n      for (const a of o)\n        r(a);\n      i.delete(n), e.add(n), t.push(n);\n    };\n    for (const n of this.dependencyGraph.keys())\n      e.has(n) || r(n);\n    return t;\n  }\n}\nclass u extends Error {\n  constructor(t) {\n    super(t), this.name = \"PluginRegistrationError\";\n  }\n}\nclass d extends Error {\n  constructor(t) {\n    super(t), this.name = \"PluginNotFoundError\";\n  }\n}\nclass z extends Error {\n  constructor(t) {\n    super(t), this.name = \"CircularDependencyError\";\n  }\n}\nclass j extends Error {\n  constructor(t) {\n    super(t), this.name = \"CapabilityNotFoundError\";\n  }\n}\nclass G extends Error {\n  constructor(t) {\n    super(t), this.name = \"CapabilityConflictError\";\n  }\n}\nclass x extends Error {\n  constructor(t) {\n    super(t), this.name = \"PluginInitializationError\";\n  }\n}\nclass O extends Error {\n  constructor(t) {\n    super(t), this.name = \"PluginConfigurationError\";\n  }\n}\nclass M {\n  /**\n   * Initializes the PluginStore with the main store and plugin ID.\n   * @param store The main store instance.\n   * @param pluginId The unique identifier for the plugin.\n   */\n  constructor(t, e) {\n    this.store = t, this.pluginId = e;\n  }\n  /**\n   * Gets the current state of the plugin.\n   * @returns The plugin's state.\n   */\n  getState() {\n    return this.store.getState().plugins[this.pluginId];\n  }\n  /**\n   * Dispatches an action for the plugin and returns the *new* global state.\n   * If you only need the plugins updated state, call `getState()` afterward.\n   * @param action The action to dispatch.\n   * @returns The updated global store state (after plugin reducer).\n   */\n  dispatch(t) {\n    return this.store.dispatchToPlugin(this.pluginId, t);\n  }\n  /**\n   * Subscribes to state changes only for this specific plugin.\n   * You now receive (action, newPluginState, oldPluginState) in the callback.\n   *\n   * @param listener The callback to invoke when plugin state changes.\n   * @returns A function to unsubscribe the listener.\n   */\n  subscribeToState(t) {\n    return this.store.subscribeToPlugin(this.pluginId, (e, i, r) => {\n      t(\n        e,\n        i,\n        r\n      );\n    });\n  }\n  /**\n   * Subscribes to a specific action type for the plugin.\n   * This still uses the main store's `onAction`, so you get the *global*\n   * old/new store states there. If you specifically want old/new plugin state,\n   * use `subscribeToState` instead.\n   *\n   * @param type The action type to listen for.\n   * @param handler The callback to invoke when the action occurs.\n   * @returns A function to unsubscribe the handler.\n   */\n  onAction(t, e) {\n    return this.store.onAction(t, (i, r, n) => {\n      e(\n        i,\n        r.plugins[this.pluginId],\n        n.plugins[this.pluginId]\n      );\n    });\n  }\n}\nconst S = \"LOAD_DOCUMENT\", m = \"SET_DOCUMENT\", b = \"SET_DOCUMENT_ERROR\", E = \"SET_SCALE\", P = \"SET_ROTATION\", R = \"SET_PAGES\", D = [\n  S,\n  m,\n  b,\n  E,\n  P,\n  R\n], K = () => ({ type: S }), B = (s) => ({\n  type: m,\n  payload: s\n}), W = (s) => ({\n  type: b,\n  payload: s\n}), Y = (s) => ({ type: E, payload: s }), H = (s) => ({\n  type: P,\n  payload: s\n}), J = (s) => ({\n  type: R,\n  payload: s\n});\nclass $ {\n  /**\n   * Initializes the store with the provided core state.\n   * @param reducer          The core reducer function\n   * @param initialCoreState The initial core state\n   */\n  constructor(t, e) {\n    this.initialCoreState = e, this.pluginReducers = {}, this.listeners = [], this.pluginListeners = {}, this.state = { core: e, plugins: {} }, this.coreReducer = t;\n  }\n  /**\n   * Adds a reducer for a plugin-specific state.\n   * @param pluginId The unique identifier for the plugin.\n   * @param reducer The reducer function for the plugin state.\n   * @param initialState The initial state for the plugin.\n   */\n  addPluginReducer(t, e, i) {\n    this.state.plugins[t] = i, this.pluginReducers[t] = e;\n  }\n  /**\n   * Dispatches an action *only* to the core reducer.\n   * Notifies the global store listeners with (action, newState, oldState).\n   *\n   * @param action The action to dispatch, typed as CoreAction\n   * @returns The updated *global* store state\n   */\n  dispatchToCore(t) {\n    if (!this.coreReducer)\n      return this.getState();\n    const e = this.getState();\n    this.state.core = this.coreReducer(this.state.core, t);\n    const i = this.getState();\n    return this.listeners.forEach((r) => r(t, i, e)), i;\n  }\n  /**\n   * Dispatches an action *only* to a specific plugin.\n   * Optionally notifies global store listeners if `notifyGlobal` is true.\n   * Always notifies plugin-specific listeners with (action, newPluginState, oldPluginState).\n   *\n   * @param pluginId   The plugin identifier\n   * @param action     The plugin action to dispatch\n   * @param notifyGlobal Whether to also notify global store listeners\n   * @returns The updated *global* store state\n   */\n  dispatchToPlugin(t, e, i = !0) {\n    const r = this.getState(), n = this.pluginReducers[t];\n    if (!n)\n      return r;\n    const o = r.plugins[t], a = n(o, e);\n    this.state.plugins[t] = a;\n    const l = this.getState();\n    return i && this.listeners.forEach((h) => h(e, l, r)), this.pluginListeners[t] && this.pluginListeners[t].forEach((h) => {\n      h(e, a, o);\n    }), a;\n  }\n  /**\n   * Dispatches an action to update the state using:\n   * - the core reducer (if it's a CoreAction)\n   * - *all* plugin reducers (regardless of action type), with no global notify for each plugin\n   *\n   * Returns the new *global* store state after all reducers have processed the action.\n   *\n   * @param action The action to dispatch (can be CoreAction or any Action).\n   */\n  dispatch(t) {\n    const e = this.getState();\n    this.isCoreAction(t) && (this.state.core = this.coreReducer(this.state.core, t));\n    for (const r in this.pluginReducers) {\n      const n = this.pluginReducers[r], o = e.plugins[r];\n      n && (this.state.plugins[r] = n(o, t));\n    }\n    const i = this.getState();\n    return this.listeners.forEach((r) => r(t, i, e)), i;\n  }\n  /**\n   * Returns a shallow copy of the current state.\n   * @returns The current store state.\n   */\n  getState() {\n    return {\n      core: { ...this.state.core },\n      plugins: { ...this.state.plugins }\n    };\n  }\n  /**\n   * Subscribes a listener to *global* state changes.\n   * The callback signature is now (action, newState, oldState).\n   *\n   * @param listener The callback to invoke on state changes\n   * @returns A function to unsubscribe the listener\n   */\n  subscribe(t) {\n    return this.listeners.push(t), () => {\n      this.listeners = this.listeners.filter((e) => e !== t);\n    };\n  }\n  /**\n   * Subscribes a listener to *plugin-specific* state changes.\n   * The callback signature is now (action, newPluginState, oldPluginState).\n   *\n   * @param pluginId The unique identifier for the plugin.\n   * @param listener The callback to invoke on plugin state changes.\n   * @returns A function to unsubscribe the listener.\n   */\n  subscribeToPlugin(t, e) {\n    if (!(t in this.state.plugins))\n      throw new Error(\n        `Plugin state not found for plugin \"${t}\". Did you forget to call addPluginReducer?`\n      );\n    return this.pluginListeners[t] || (this.pluginListeners[t] = []), this.pluginListeners[t].push(e), () => {\n      this.pluginListeners[t] = this.pluginListeners[t].filter((i) => i !== e), this.pluginListeners[t].length === 0 && delete this.pluginListeners[t];\n    };\n  }\n  /**\n   * Subscribes to a specific action type (only from the core's action union).\n   * The callback signature is (action, newState, oldState).\n   *\n   * @param type The action type to listen for.\n   * @param handler The callback to invoke when the action occurs.\n   * @returns A function to unsubscribe the handler.\n   */\n  onAction(t, e) {\n    return this.subscribe((i, r, n) => {\n      i.type === t && e(i, r, n);\n    });\n  }\n  /**\n   * Gets a PluginStore handle for a specific plugin.\n   * @param pluginId The unique identifier for the plugin.\n   * @returns A PluginStore instance for the plugin.\n   */\n  getPluginStore(t) {\n    if (!(t in this.state.plugins))\n      throw new Error(\n        `Plugin state not found for plugin \"${t}\". Did you forget to call addPluginReducer?`\n      );\n    return new M(this, t);\n  }\n  /**\n   * Helper method to check if an action is a CoreAction.\n   * Adjust if you have a more refined way to differentiate CoreAction vs. any other Action.\n   */\n  isCoreAction(t) {\n    return D.includes(t.type);\n  }\n  /**\n   * Destroy the store: drop every listener and plugin reducer\n   */\n  destroy() {\n    var t, e;\n    this.listeners.length = 0;\n    for (const i in this.pluginListeners)\n      (e = (t = this.pluginListeners[i]) == null ? void 0 : t.splice) == null || e.call(t, 0);\n    this.pluginListeners = {}, this.pluginReducers = {}, this.state.plugins = {}, this.state.core = { ...this.initialCoreState };\n  }\n}\nconst _ = (s) => ({\n  scale: (s == null ? void 0 : s.scale) ?? 1,\n  rotation: (s == null ? void 0 : s.rotation) ?? T.Degree0,\n  document: null,\n  pages: [],\n  loading: !1,\n  error: null\n}), Q = (s) => s.pages.map(\n  (t) => t.map((e) => ({\n    ...e,\n    rotatedSize: A(e.size, s.rotation, 1)\n  }))\n), L = (s, t) => {\n  switch (t.type) {\n    case S:\n      return {\n        ...s,\n        loading: !0,\n        error: null\n      };\n    case m:\n      return {\n        ...s,\n        document: t.payload,\n        pages: t.payload.pages.map((e) => [e]),\n        loading: !1,\n        error: null\n      };\n    case P:\n      return {\n        ...s,\n        rotation: t.payload\n      };\n    case R:\n      return {\n        ...s,\n        pages: t.payload\n      };\n    case b:\n      return {\n        ...s,\n        loading: !1,\n        error: t.payload\n      };\n    case E:\n      return {\n        ...s,\n        scale: t.payload\n      };\n    default:\n      return s;\n  }\n};\nclass V {\n  constructor(t, e) {\n    this.plugins = /* @__PURE__ */ new Map(), this.manifests = /* @__PURE__ */ new Map(), this.capabilities = /* @__PURE__ */ new Map(), this.status = /* @__PURE__ */ new Map(), this.configurations = /* @__PURE__ */ new Map(), this.engineInitialized = !1, this.initPromise = null, this.pendingRegistrations = [], this.processingRegistrations = [], this.initialized = !1, this.isInitializing = !1, this.pluginsReadyPromise = null, this.destroyed = !1, this.resolver = new C(), this.engine = t, this.initialCoreState = _(e), this.store = new $(L, this.initialCoreState);\n  }\n  /**\n   * Ensure engine is initialized before proceeding\n   */\n  async ensureEngineInitialized() {\n    this.engineInitialized || (this.engine.initialize ? (await this.engine.initialize().toPromise(), this.engineInitialized = !0) : this.engineInitialized = !0);\n  }\n  /**\n   * Register a plugin without initializing it\n   */\n  registerPlugin(t, e) {\n    if (this.initialized && !this.isInitializing)\n      throw new u(\"Cannot register plugins after initialization\");\n    this.validateManifest(t.manifest), this.store.addPluginReducer(\n      t.manifest.id,\n      // We need one type assertion here since we can't fully reconcile TAction with Action\n      // due to TypeScript's type system limitations with generic variance\n      t.reducer,\n      typeof t.initialState == \"function\" ? t.initialState(\n        this.initialCoreState,\n        {\n          ...t.manifest.defaultConfig,\n          ...e\n        }\n      ) : t.initialState\n    ), this.pendingRegistrations.push({\n      package: t,\n      config: e\n    });\n  }\n  /**\n   * Get the central store instance\n   */\n  getStore() {\n    return this.store;\n  }\n  /**\n   * Get the engine instance\n   */\n  getEngine() {\n    return this.engine;\n  }\n  /**\n   * Get a promise that resolves when all plugins are ready\n   */\n  pluginsReady() {\n    return this.pluginsReadyPromise ? this.pluginsReadyPromise : (this.pluginsReadyPromise = (async () => {\n      this.initialized || await this.initialize();\n      const t = Array.from(this.plugins.values()).map(\n        (e) => typeof e.ready == \"function\" ? e.ready() : Promise.resolve()\n      );\n      await Promise.all(t);\n    })(), this.pluginsReadyPromise);\n  }\n  /**\n   * INITIALISE THE REGISTRY  runs once no-matter-how-many calls   *\n   */\n  async initialize() {\n    if (this.destroyed)\n      throw new u(\"Registry has been destroyed\");\n    return this.initPromise ? this.initPromise : (this.initPromise = (async () => {\n      var t;\n      if (this.initialized)\n        throw new u(\"Registry is already initialized\");\n      this.isInitializing = !0;\n      try {\n        if (await this.ensureEngineInitialized(), this.destroyed)\n          return;\n        for (; this.pendingRegistrations.length > 0; ) {\n          if (this.destroyed)\n            return;\n          this.processingRegistrations = [...this.pendingRegistrations], this.pendingRegistrations = [];\n          for (const i of this.processingRegistrations) {\n            const r = /* @__PURE__ */ new Set(), n = [...i.package.manifest.requires, ...i.package.manifest.optional];\n            for (const o of n) {\n              const a = this.processingRegistrations.find(\n                (l) => l.package.manifest.provides.includes(o)\n              );\n              a && r.add(a.package.manifest.id);\n            }\n            this.resolver.addNode(i.package.manifest.id, [...r]);\n          }\n          const e = this.resolver.resolveLoadOrder();\n          for (const i of e) {\n            const r = this.processingRegistrations.find((n) => n.package.manifest.id === i);\n            await this.initializePlugin(r.package.manifest, r.package.create, r.config);\n          }\n          this.processingRegistrations = [], this.resolver = new C();\n        }\n        for (const e of this.plugins.values())\n          await ((t = e.postInitialize) == null ? void 0 : t.call(e).catch((i) => {\n            console.error(`Error in postInitialize for plugin ${e.id}`, i), this.status.set(e.id, \"error\");\n          }));\n        this.initialized = !0;\n      } catch (e) {\n        throw e instanceof Error ? new z(\n          `Failed to resolve plugin dependencies: ${e.message}`\n        ) : e;\n      } finally {\n        this.isInitializing = !1;\n      }\n    })(), this.initPromise);\n  }\n  /**\n   * Initialize a single plugin with all necessary checks\n   */\n  async initializePlugin(t, e, i) {\n    const r = {\n      ...t.defaultConfig,\n      ...i\n    };\n    this.validateConfig(t.id, r, t.defaultConfig);\n    const n = e(this, this.engine, r);\n    this.validatePlugin(n);\n    for (const o of t.requires)\n      if (!this.capabilities.has(o))\n        throw new u(\n          `Missing required capability: ${o} for plugin ${t.id}`\n        );\n    for (const o of t.optional)\n      this.capabilities.has(o) && console.debug(`Optional capability ${o} is available for plugin ${t.id}`);\n    console.log(\"initializePlugin\", t.id, t.provides);\n    for (const o of t.provides) {\n      if (this.capabilities.has(o))\n        throw new u(\n          `Capability ${o} is already provided by plugin ${this.capabilities.get(o)}`\n        );\n      this.capabilities.set(o, t.id);\n    }\n    this.plugins.set(t.id, n), this.manifests.set(t.id, t), this.status.set(t.id, \"registered\"), this.configurations.set(t.id, r);\n    try {\n      n.initialize && await n.initialize(r), this.status.set(t.id, \"active\");\n    } catch (o) {\n      throw this.plugins.delete(t.id), this.manifests.delete(t.id), console.log(\"initializePlugin failed\", t.id, t.provides), t.provides.forEach((a) => this.capabilities.delete(a)), o;\n    }\n  }\n  getPluginConfig(t) {\n    const e = this.configurations.get(t);\n    if (!e)\n      throw new d(`Configuration for plugin ${t} not found`);\n    return e;\n  }\n  validateConfig(t, e, i) {\n    const n = Object.keys(i).filter((o) => !e.hasOwnProperty(o));\n    if (n.length > 0)\n      throw new O(\n        `Missing required configuration keys for plugin ${t}: ${n.join(\", \")}`\n      );\n  }\n  async updatePluginConfig(t, e) {\n    const i = this.getPlugin(t);\n    if (!i)\n      throw new d(`Plugin ${t} not found`);\n    const r = this.manifests.get(t), n = this.configurations.get(t);\n    if (!r || !n)\n      throw new d(`Plugin ${t} not found`);\n    const o = {\n      ...n,\n      ...e\n    };\n    this.validateConfig(t, o, r.defaultConfig), this.configurations.set(t, o), i.initialize && await i.initialize(o);\n  }\n  /**\n   * Register multiple plugins at once\n   */\n  registerPluginBatch(t) {\n    for (const e of t)\n      this.registerPlugin(e.package, e.config);\n  }\n  /**\n   * Unregister a plugin\n   */\n  async unregisterPlugin(t) {\n    const e = this.plugins.get(t);\n    if (!e)\n      throw new d(`Plugin ${t} is not registered`);\n    const i = this.manifests.get(t);\n    if (!i)\n      throw new d(`Manifest for plugin ${t} not found`);\n    for (const [r, n] of this.manifests.entries()) {\n      if (r === t) continue;\n      if ([...n.requires, ...n.optional].some(\n        (a) => i.provides.includes(a)\n      ))\n        throw new u(\n          `Cannot unregister plugin ${t}: plugin ${r} depends on it`\n        );\n    }\n    try {\n      e.destroy && await e.destroy();\n      for (const r of i.provides)\n        this.capabilities.delete(r);\n      this.plugins.delete(t), this.manifests.delete(t), this.status.delete(t);\n    } catch (r) {\n      throw r instanceof Error ? new Error(`Failed to unregister plugin ${t}: ${r.message}`) : r;\n    }\n  }\n  /**\n   * Get a plugin instance\n   * @param pluginId The ID of the plugin to get\n   * @returns The plugin instance or null if not found\n   */\n  getPlugin(t) {\n    const e = this.plugins.get(t);\n    return e || null;\n  }\n  /**\n   * Get a plugin that provides a specific capability\n   * @param capability The capability to get a provider for\n   * @returns The plugin providing the capability or null if not found\n   */\n  getCapabilityProvider(t) {\n    const e = this.capabilities.get(t);\n    return e ? this.getPlugin(e) : null;\n  }\n  /**\n   * Check if a capability is available\n   */\n  hasCapability(t) {\n    return this.capabilities.has(t);\n  }\n  /**\n   * Get all registered plugins\n   */\n  getAllPlugins() {\n    return Array.from(this.plugins.values());\n  }\n  /**\n   * Get plugin status\n   */\n  getPluginStatus(t) {\n    const e = this.status.get(t);\n    if (!e)\n      throw new d(`Plugin ${t} not found`);\n    return e;\n  }\n  /**\n   * Validate plugin object\n   */\n  validatePlugin(t) {\n    if (!t.id)\n      throw new u(\"Plugin must have an id\");\n  }\n  /**\n   * Validate plugin manifest\n   */\n  validateManifest(t) {\n    if (!t.id)\n      throw new u(\"Manifest must have an id\");\n    if (!t.name)\n      throw new u(\"Manifest must have a name\");\n    if (!t.version)\n      throw new u(\"Manifest must have a version\");\n    if (!Array.isArray(t.provides))\n      throw new u(\"Manifest must have a provides array\");\n    if (!Array.isArray(t.requires))\n      throw new u(\"Manifest must have a requires array\");\n    if (!Array.isArray(t.optional))\n      throw new u(\"Manifest must have an optional array\");\n  }\n  isDestroyed() {\n    return this.destroyed;\n  }\n  /**\n   * DESTROY EVERYTHING  waits for any ongoing initialise(), once  *\n   */\n  async destroy() {\n    var t;\n    if (this.destroyed) throw new u(\"Registry has already been destroyed\");\n    this.destroyed = !0;\n    try {\n      await this.initPromise;\n    } catch {\n    }\n    for (const e of Array.from(this.plugins.values()).reverse())\n      await ((t = e.destroy) == null ? void 0 : t.call(e));\n    this.store.destroy(), this.plugins.clear(), this.manifests.clear(), this.capabilities.clear(), this.status.clear(), this.pendingRegistrations.length = 0, this.processingRegistrations.length = 0;\n  }\n}\nfunction X(s, t) {\n  return {\n    package: s,\n    config: t\n  };\n}\nclass Z {\n  constructor(t, e) {\n    if (this.id = t, this.registry = e, this.debouncedActions = {}, this.unsubscribeFromState = null, this.unsubscribeFromCoreStore = null, t !== this.constructor.id)\n      throw new Error(\n        `Plugin ID mismatch: ${t} !== ${this.constructor.id}`\n      );\n    this.coreStore = this.registry.getStore(), this.pluginStore = this.coreStore.getPluginStore(this.id), this.unsubscribeFromState = this.pluginStore.subscribeToState((i, r, n) => {\n      this.onStoreUpdated(n, r);\n    }), this.unsubscribeFromCoreStore = this.coreStore.subscribe((i, r, n) => {\n      this.onCoreStoreUpdated(n, r);\n    }), this.readyPromise = new Promise((i) => {\n      this.readyResolve = i;\n    }), this.readyResolve();\n  }\n  provides() {\n    if (!this._capability) {\n      const t = this.buildCapability();\n      this._capability = Object.freeze(t);\n    }\n    return this._capability;\n  }\n  /**\n   *  Get a copy of the current state\n   */\n  get state() {\n    return this.pluginStore.getState();\n  }\n  /**\n   *  Get a copy of the current core state\n   */\n  get coreState() {\n    return this.coreStore.getState();\n  }\n  /**\n   * @deprecated  use `this.state` Get a copy of the current state\n   */\n  getState() {\n    return this.pluginStore.getState();\n  }\n  /**\n   * @deprecated  use `this.coreState` Get a copy of the current core state\n   */\n  getCoreState() {\n    return this.coreStore.getState();\n  }\n  /**\n   * Core Dispatch\n   */\n  dispatchCoreAction(t) {\n    return this.coreStore.dispatchToCore(t);\n  }\n  /**\n   * Dispatch an action to all plugins\n   */\n  dispatchToAllPlugins(t) {\n    return this.coreStore.dispatch(t);\n  }\n  /**\n   * Dispatch an action\n   */\n  dispatch(t) {\n    return this.pluginStore.dispatch(t);\n  }\n  /**\n   * Dispatch an action with debouncing to prevent rapid repeated calls\n   * @param action The action to dispatch\n   * @param debounceTime Time in ms to debounce (default: 100ms)\n   * @returns boolean indicating whether the action was dispatched or debounced\n   */\n  debouncedDispatch(t, e = 100) {\n    const i = Date.now(), r = this.debouncedActions[t.type] || 0;\n    return i - r >= e ? (this.debouncedActions[t.type] = i, this.dispatch(t), !0) : !1;\n  }\n  /**\n   * Subscribe to state changes\n   */\n  subscribe(t) {\n    return this.pluginStore.subscribeToState(t);\n  }\n  /**\n   * Subscribe to core store changes\n   */\n  subscribeToCoreStore(t) {\n    return this.coreStore.subscribe(t);\n  }\n  /**\n   * Called when the plugin store state is updated\n   * @param oldState Previous state\n   * @param newState New state\n   */\n  onStoreUpdated(t, e) {\n  }\n  /**\n   * Called when the core store state is updated\n   * @param oldState Previous state\n   * @param newState New state\n   */\n  onCoreStoreUpdated(t, e) {\n  }\n  /**\n   * Cleanup method to be called when plugin is being destroyed\n   */\n  destroy() {\n    this.unsubscribeFromState && (this.unsubscribeFromState(), this.unsubscribeFromState = null), this.unsubscribeFromCoreStore && (this.unsubscribeFromCoreStore(), this.unsubscribeFromCoreStore = null);\n  }\n  /**\n   * Returns a promise that resolves when the plugin is ready\n   */\n  ready() {\n    return this.readyPromise;\n  }\n  /**\n   * Mark the plugin as ready\n   */\n  markReady() {\n    this.readyResolve();\n  }\n  /**\n   * Reset the ready state (useful for plugins that need to reinitialize)\n   */\n  resetReady() {\n    this.readyPromise = new Promise((t) => {\n      this.readyResolve = t;\n    });\n  }\n}\nclass N {\n  constructor(t, e) {\n    this.handler = t, this.options = e, this.lastRun = 0, this.handle = (i) => {\n      this.options.mode === \"debounce\" ? this.debounce(i) : this.throttle(i);\n    };\n  }\n  debounce(t) {\n    this.timeoutId && window.clearTimeout(this.timeoutId), this.timeoutId = window.setTimeout(() => {\n      this.handler(t), this.timeoutId = void 0;\n    }, this.options.wait);\n  }\n  throttle(t) {\n    if (this.options.mode === \"debounce\") return;\n    const e = Date.now(), i = this.options.throttleMode || \"leading-trailing\";\n    e - this.lastRun >= this.options.wait && (i === \"leading-trailing\" && this.handler(t), this.lastRun = e), this.timeoutId && window.clearTimeout(this.timeoutId), this.timeoutId = window.setTimeout(\n      () => {\n        this.handler(t), this.lastRun = Date.now(), this.timeoutId = void 0;\n      },\n      this.options.wait - (e - this.lastRun)\n    );\n  }\n  destroy() {\n    this.timeoutId && window.clearTimeout(this.timeoutId);\n  }\n}\nfunction tt(s, t, e) {\n  return s < t ? t : s > e ? e : s;\n}\nfunction f(s, t, e) {\n  if (s === t)\n    return !0;\n  if (s == null || t == null)\n    return s === t;\n  const i = typeof s;\n  if (i !== typeof t) return !1;\n  if (i === \"object\") {\n    e || (e = /* @__PURE__ */ new Set());\n    const n = F(s, t);\n    if (e.has(n))\n      return !0;\n    e.add(n);\n    const o = Array.isArray(s), a = Array.isArray(t);\n    return o && a ? q(s, t, e) : !o && !a ? I(s, t, e) : !1;\n  }\n  return !1;\n}\nfunction F(s, t) {\n  return `${v(s)}__${v(t)}`;\n}\nlet k = 0;\nconst w = /* @__PURE__ */ new WeakMap();\nfunction v(s) {\n  return w.has(s) || w.set(s, ++k), w.get(s);\n}\nfunction q(s, t, e) {\n  if (s.length !== t.length) return !1;\n  const i = new Array(t.length).fill(!1);\n  t: for (let r = 0; r < s.length; r++) {\n    const n = s[r];\n    for (let o = 0; o < t.length; o++)\n      if (!i[o] && f(n, t[o], e)) {\n        i[o] = !0;\n        continue t;\n      }\n    return !1;\n  }\n  return !0;\n}\nfunction I(s, t, e) {\n  const i = Object.keys(s).sort(), r = Object.keys(t).sort();\n  if (i.length !== r.length) return !1;\n  for (let n = 0; n < i.length; n++)\n    if (i[n] !== r[n]) return !1;\n  for (const n of i) {\n    const o = s[n], a = t[n];\n    if (!f(o, a, e))\n      return !1;\n  }\n  return !0;\n}\nfunction et() {\n  const s = /* @__PURE__ */ new Set();\n  return {\n    emit: (e = void 0) => s.forEach((i) => i(e)),\n    on: (e) => (s.add(e), () => s.delete(e)),\n    off: (e) => s.delete(e),\n    clear: () => s.clear()\n  };\n}\nfunction it(s, t = f) {\n  const e = /* @__PURE__ */ new Set(), i = /* @__PURE__ */ new Map();\n  let r = s;\n  const n = (a) => e.forEach((l) => l(a)), o = (a, l) => {\n    let h = a, g = () => {\n    };\n    if (l) {\n      const c = new N(a, l);\n      h = c.handle, g = () => c.destroy(), i.set(a, { wrapped: h, destroy: g });\n    }\n    return r !== void 0 && h(r), e.add(h), () => {\n      e.delete(h), g(), i.delete(a);\n    };\n  };\n  return {\n    /* emitter behaviour ---------------------------------------- */\n    get value() {\n      return r;\n    },\n    emit(a = void 0) {\n      (r === void 0 || !t(r, a)) && (r = a, n(a));\n    },\n    on: o,\n    off(a) {\n      const l = i.get(a);\n      l ? (e.delete(l.wrapped), l.destroy(), i.delete(a)) : e.delete(a);\n    },\n    clear() {\n      e.clear(), i.forEach((a) => a.destroy()), i.clear();\n    },\n    /* derived hook --------------------------------------------- */\n    select(a, l = f) {\n      return (h, g) => {\n        let c;\n        if (r !== void 0) {\n          const p = a(r);\n          c = p, h(p);\n        }\n        return o(\n          (p) => {\n            const y = a(p);\n            (c === void 0 || !l(c, y)) && (c = y, h(y));\n          },\n          g\n        );\n      };\n    }\n  };\n}\nfunction st(s) {\n  return Object.entries(s).map(([t, e]) => {\n    const i = Number(t);\n    return [Number.isFinite(i) && t.trim() !== \"\" ? i : t, e];\n  });\n}\nexport {\n  Z as BasePlugin,\n  D as CORE_ACTION_TYPES,\n  G as CapabilityConflictError,\n  j as CapabilityNotFoundError,\n  z as CircularDependencyError,\n  C as DependencyResolver,\n  N as EventControl,\n  S as LOAD_DOCUMENT,\n  O as PluginConfigurationError,\n  x as PluginInitializationError,\n  d as PluginNotFoundError,\n  u as PluginRegistrationError,\n  V as PluginRegistry,\n  m as SET_DOCUMENT,\n  b as SET_DOCUMENT_ERROR,\n  R as SET_PAGES,\n  P as SET_ROTATION,\n  E as SET_SCALE,\n  f as arePropsEqual,\n  tt as clamp,\n  it as createBehaviorEmitter,\n  et as createEmitter,\n  X as createPluginRegistration,\n  st as enumEntries,\n  Q as getPagesWithRotatedSize,\n  _ as initialCoreState,\n  K as loadDocument,\n  B as setDocument,\n  W as setDocumentError,\n  J as setPages,\n  H as setRotation,\n  Y as setScale\n};\n//# sourceMappingURL=index.js.map\n","import { createContext as b } from \"preact\";\nimport { jsx as w } from \"preact/jsx-runtime\";\nimport { useState as a, useRef as m, useEffect as f, useContext as S } from \"preact/hooks\";\nimport { PluginRegistry as v, arePropsEqual as C } from \"@embedpdf/core\";\nconst P = b({\n  registry: null,\n  isInitializing: !0,\n  pluginsReady: !1\n});\nfunction F({ engine: t, onInitialized: r, plugins: e, children: i }) {\n  const [o, s] = a(null), [u, c] = a(!0), [y, d] = a(!1), l = m(r);\n  return f(() => {\n    l.current = r;\n  }, [r]), f(() => {\n    const n = new v(t);\n    return n.registerPluginBatch(e), (async () => {\n      var p;\n      await n.initialize(), !n.isDestroyed() && (await ((p = l.current) == null ? void 0 : p.call(l, n)), !n.isDestroyed() && (n.pluginsReady().then(() => {\n        n.isDestroyed() || d(!0);\n      }), s(n), c(!1)));\n    })().catch(console.error), () => {\n      n.destroy(), s(null), c(!0), d(!1);\n    };\n  }, [t, e]), /* @__PURE__ */ w(P.Provider, { value: { registry: o, isInitializing: u, pluginsReady: y }, children: typeof i == \"function\" ? i({ registry: o, isInitializing: u, pluginsReady: y }) : i });\n}\nfunction g() {\n  const t = S(P);\n  if (t === void 0)\n    throw new Error(\"useCapability must be used within a PDFContext.Provider\");\n  const { registry: r, isInitializing: e } = t;\n  if (e)\n    return t;\n  if (r === null)\n    throw new Error(\"PDF registry failed to initialize properly\");\n  return t;\n}\nfunction h(t) {\n  const { registry: r } = g();\n  if (r === null)\n    return {\n      plugin: null,\n      isLoading: !0,\n      ready: new Promise(() => {\n      })\n    };\n  const e = r.getPlugin(t);\n  if (!e)\n    throw new Error(`Plugin ${t} not found`);\n  return {\n    plugin: e,\n    isLoading: !1,\n    ready: e.ready()\n  };\n}\nfunction L(t) {\n  const { plugin: r, isLoading: e, ready: i } = h(t);\n  if (!r)\n    return {\n      provides: null,\n      isLoading: e,\n      ready: i\n    };\n  if (!r.provides)\n    throw new Error(`Plugin ${t} does not provide a capability`);\n  return {\n    provides: r.provides(),\n    isLoading: e,\n    ready: i\n  };\n}\nfunction V() {\n  const { registry: t } = g(), [r, e] = a(null);\n  return f(() => {\n    if (!t) return;\n    e(t.getStore().getState());\n    const i = t.getStore().subscribe((o, s) => {\n      e(s);\n    });\n    return () => i();\n  }, [t]), r;\n}\nfunction $() {\n  const { registry: t } = g(), [r, e] = a(null);\n  return f(() => {\n    if (!t) return;\n    const i = t.getStore();\n    e(i.getState().core);\n    const o = i.subscribe((s, u, c) => {\n      i.isCoreAction(s) && !C(u.core, c.core) && e(u.core);\n    });\n    return () => o();\n  }, [t]), r;\n}\nexport {\n  F as EmbedPDF,\n  P as PDFContext,\n  L as useCapability,\n  $ as useCoreState,\n  h as usePlugin,\n  g as useRegistry,\n  V as useStoreState\n};\n//# sourceMappingURL=index.js.map\n","import { useState, useRef, useEffect } from 'preact/hooks';\n\nconst defaultWasmUrl = `https://cdn.jsdelivr.net/npm/@embedpdf/pdfium@1.0.11/dist/pdfium.wasm`;\nfunction usePdfiumEngine(config) {\n    const { wasmUrl = defaultWasmUrl, worker = true, logger } = config ?? {};\n    const [engine, setEngine] = useState(null);\n    const [loading, setLoading] = useState(true);\n    const [error, setError] = useState(null);\n    const engineRef = useRef(null);\n    useEffect(() => {\n        let cancelled = false;\n        (async () => {\n            try {\n                const { createPdfiumEngine } = worker\n                    ? await import('@embedpdf/engines/pdfium-worker-engine')\n                    : await import('@embedpdf/engines/pdfium-direct-engine');\n                const pdfEngine = await createPdfiumEngine(wasmUrl, logger);\n                engineRef.current = pdfEngine;\n                setEngine(pdfEngine);\n                setLoading(false);\n            }\n            catch (e) {\n                if (!cancelled) {\n                    setError(e);\n                    setLoading(false);\n                }\n            }\n        })();\n        return () => {\n            cancelled = true;\n            engineRef.current?.destroy();\n            engineRef.current = null;\n        };\n    }, [wasmUrl, worker, logger]);\n    return { engine, isLoading: loading, error };\n}\n\nexport { usePdfiumEngine };\n//# sourceMappingURL=preact.js.map\n","import { BasePlugin as g, createBehaviorEmitter as l, createEmitter as R } from \"@embedpdf/core\";\nconst h = \"viewport\", S = {\n  id: h,\n  name: \"Viewport Plugin\",\n  version: \"1.0.0\",\n  provides: [\"viewport\"],\n  requires: [],\n  optional: [],\n  defaultConfig: {\n    enabled: !0,\n    viewportGap: 10,\n    scrollEndDelay: 300\n  }\n}, a = \"SET_VIEWPORT_METRICS\", d = \"SET_VIEWPORT_SCROLL_METRICS\", n = \"SET_VIEWPORT_GAP\", y = \"SET_SCROLL_ACTIVITY\";\nfunction E(e) {\n  return {\n    type: n,\n    payload: e\n  };\n}\nfunction f(e) {\n  return {\n    type: a,\n    payload: e\n  };\n}\nfunction M(e) {\n  return {\n    type: d,\n    payload: e\n  };\n}\nfunction _(e) {\n  return { type: y, payload: e };\n}\nconst v = {\n  viewportGap: 0,\n  viewportMetrics: {\n    width: 0,\n    height: 0,\n    scrollTop: 0,\n    scrollLeft: 0,\n    clientWidth: 0,\n    clientHeight: 0,\n    scrollWidth: 0,\n    scrollHeight: 0,\n    relativePosition: {\n      x: 0,\n      y: 0\n    }\n  },\n  isScrolling: !1\n}, $ = (e = v, t) => {\n  switch (t.type) {\n    case n:\n      return { ...e, viewportGap: t.payload };\n    case a:\n      return {\n        ...e,\n        viewportMetrics: {\n          width: t.payload.width,\n          height: t.payload.height,\n          scrollTop: t.payload.scrollTop,\n          scrollLeft: t.payload.scrollLeft,\n          clientWidth: t.payload.clientWidth,\n          clientHeight: t.payload.clientHeight,\n          scrollWidth: t.payload.scrollWidth,\n          scrollHeight: t.payload.scrollHeight,\n          relativePosition: {\n            x: t.payload.scrollWidth <= t.payload.clientWidth ? 0 : t.payload.scrollLeft / (t.payload.scrollWidth - t.payload.clientWidth),\n            y: t.payload.scrollHeight <= t.payload.clientHeight ? 0 : t.payload.scrollTop / (t.payload.scrollHeight - t.payload.clientHeight)\n          }\n        }\n      };\n    case d:\n      return {\n        ...e,\n        viewportMetrics: {\n          ...e.viewportMetrics,\n          scrollTop: t.payload.scrollTop,\n          scrollLeft: t.payload.scrollLeft\n        },\n        isScrolling: !0\n      };\n    case y:\n      return { ...e, isScrolling: t.payload };\n    default:\n      return e;\n  }\n}, o = class o extends g {\n  constructor(t, i, r) {\n    super(t, i), this.id = t, this.viewportResize$ = l(), this.viewportMetrics$ = l(), this.scrollMetrics$ = l(), this.scrollReq$ = R(), this.scrollActivity$ = l(), this.rectProvider = null, r.viewportGap && this.dispatch(E(r.viewportGap)), this.scrollEndDelay = r.scrollEndDelay || 300;\n  }\n  buildCapability() {\n    return {\n      getViewportGap: () => this.state.viewportGap,\n      getMetrics: () => this.state.viewportMetrics,\n      getBoundingRect: () => {\n        var t;\n        return ((t = this.rectProvider) == null ? void 0 : t.call(this)) ?? {\n          origin: { x: 0, y: 0 },\n          size: { width: 0, height: 0 }\n        };\n      },\n      scrollTo: (t) => this.scrollTo(t),\n      isScrolling: () => this.state.isScrolling,\n      onScrollChange: this.scrollMetrics$.on,\n      onViewportChange: this.viewportMetrics$.on,\n      onViewportResize: this.viewportResize$.on,\n      onScrollActivity: this.scrollActivity$.on\n    };\n  }\n  setViewportResizeMetrics(t) {\n    this.dispatch(f(t)), this.viewportResize$.emit(this.state.viewportMetrics);\n  }\n  setViewportScrollMetrics(t) {\n    (t.scrollTop !== this.state.viewportMetrics.scrollTop || t.scrollLeft !== this.state.viewportMetrics.scrollLeft) && (this.dispatch(M(t)), this.bumpScrollActivity(), this.scrollMetrics$.emit({\n      scrollTop: t.scrollTop,\n      scrollLeft: t.scrollLeft\n    }));\n  }\n  onScrollRequest(t) {\n    return this.scrollReq$.on(t);\n  }\n  registerBoundingRectProvider(t) {\n    this.rectProvider = t;\n  }\n  bumpScrollActivity() {\n    this.debouncedDispatch(_(!1), this.scrollEndDelay);\n  }\n  scrollTo(t) {\n    const { x: i, y: r, center: w, behavior: c = \"auto\" } = t;\n    if (w) {\n      const p = this.state.viewportMetrics, T = i - p.clientWidth / 2, u = r - p.clientHeight / 2;\n      this.scrollReq$.emit({\n        x: T,\n        y: u,\n        behavior: c\n      });\n    } else\n      this.scrollReq$.emit({\n        x: i,\n        y: r,\n        behavior: c\n      });\n  }\n  // Subscribe to store changes to notify onViewportChange\n  onStoreUpdated(t, i) {\n    t !== i && (this.viewportMetrics$.emit(i.viewportMetrics), t.isScrolling !== i.isScrolling && this.scrollActivity$.emit(i.isScrolling));\n  }\n  async initialize(t) {\n  }\n  async destroy() {\n    super.destroy(), this.viewportMetrics$.clear(), this.viewportResize$.clear(), this.scrollMetrics$.clear(), this.scrollReq$.clear(), this.scrollActivity$.clear(), this.rectProvider = null, this.scrollEndTimer && clearTimeout(this.scrollEndTimer);\n  }\n};\no.id = \"viewport\";\nlet s = o;\nconst P = {\n  manifest: S,\n  create: (e, t, i) => new s(h, e, i),\n  reducer: $,\n  initialState: v\n};\nexport {\n  h as VIEWPORT_PLUGIN_ID,\n  s as ViewportPlugin,\n  P as ViewportPluginPackage,\n  S as manifest\n};\n//# sourceMappingURL=index.js.map\n","import { usePlugin as f, useCapability as d } from \"@embedpdf/core/preact\";\nimport { ViewportPlugin as c } from \"@embedpdf/plugin-viewport\";\nimport { jsx as g } from \"preact/jsx-runtime\";\nimport { useRef as h, useLayoutEffect as w, useState as a, useEffect as v } from \"preact/hooks\";\nconst R = () => f(c.id), m = () => d(c.id);\nfunction V() {\n  const { plugin: t } = R(), i = h(null);\n  return w(() => {\n    if (!t) return;\n    const e = i.current;\n    if (!e) return;\n    const l = () => {\n      const o = e.getBoundingClientRect();\n      return {\n        origin: { x: o.left, y: o.top },\n        size: { width: o.width, height: o.height }\n      };\n    };\n    t.registerBoundingRectProvider(l);\n    const s = () => {\n      t.setViewportScrollMetrics({\n        scrollTop: e.scrollTop,\n        scrollLeft: e.scrollLeft\n      });\n    };\n    e.addEventListener(\"scroll\", s);\n    const r = new ResizeObserver(() => {\n      t.setViewportResizeMetrics({\n        width: e.offsetWidth,\n        height: e.offsetHeight,\n        clientWidth: e.clientWidth,\n        clientHeight: e.clientHeight,\n        scrollTop: e.scrollTop,\n        scrollLeft: e.scrollLeft,\n        scrollWidth: e.scrollWidth,\n        scrollHeight: e.scrollHeight\n      });\n    });\n    r.observe(e);\n    const n = t.onScrollRequest(\n      ({ x: o, y: p, behavior: u = \"auto\" }) => {\n        requestAnimationFrame(() => {\n          e.scrollTo({ left: o, top: p, behavior: u });\n        });\n      }\n    );\n    return () => {\n      t.registerBoundingRectProvider(null), e.removeEventListener(\"scroll\", s), r.disconnect(), n();\n    };\n  }, [t]), i;\n}\nfunction H({ children: t, ...i }) {\n  const [e, l] = a(0), s = V(), { provides: r } = m();\n  v(() => {\n    r && l(r.getViewportGap());\n  }, [r]);\n  const { style: n, ...o } = i;\n  return /* @__PURE__ */ g(\n    \"div\",\n    {\n      ...o,\n      ref: s,\n      style: {\n        ...typeof n == \"object\" ? n : {},\n        padding: `${e}px`\n      },\n      children: t\n    }\n  );\n}\nexport {\n  H as Viewport,\n  m as useViewportCapability,\n  R as useViewportPlugin\n};\n//# sourceMappingURL=index.js.map\n","import { BasePlugin as F, createBehaviorEmitter as p, SET_DOCUMENT as H, getPagesWithRotatedSize as P, SET_ROTATION as I, SET_PAGES as W, SET_SCALE as D } from \"@embedpdf/core\";\nimport { scalePosition as v, transformPosition as U, transformRect as B, Rotation as X } from \"@embedpdf/models\";\nvar y = /* @__PURE__ */ ((a) => (a.Vertical = \"vertical\", a.Horizontal = \"horizontal\", a))(y || {});\nclass G {\n  constructor(t) {\n    this.pageGap = t.pageGap ?? 20, this.viewportGap = t.viewportGap ?? 20, this.bufferSize = t.bufferSize ?? 2;\n  }\n  getVisibleRange(t, e, i) {\n    const r = this.getScrollOffset(t), s = this.getClientSize(t), n = r, c = r + s;\n    let h = 0;\n    for (; h < e.length && (e[h].offset + e[h].height) * i <= n; )\n      h++;\n    let g = h;\n    for (; g < e.length && e[g].offset * i <= c; )\n      g++;\n    return {\n      start: Math.max(0, h - this.bufferSize),\n      end: Math.min(e.length - 1, g + this.bufferSize - 1)\n    };\n  }\n  handleScroll(t, e, i) {\n    const r = this.getVisibleRange(t, e, i), s = e.slice(r.start, r.end + 1), n = this.calculatePageVisibility(s, t, i), c = n.map((d) => d.pageNumber), h = e.slice(r.start, r.end + 1).flatMap((d) => d.index), g = this.determineCurrentPage(n), o = e[r.start], l = e[r.end], u = o ? o.offset * i : 0, S = l ? (e[e.length - 1].offset + // end of content\n    e[e.length - 1].height) * i - // minus\n    (l.offset + l.height) * i : 0;\n    return {\n      currentPage: g,\n      visiblePages: c,\n      pageVisibilityMetrics: n,\n      renderedPageIndexes: h,\n      scrollOffset: { x: t.scrollLeft, y: t.scrollTop },\n      startSpacing: u,\n      endSpacing: S\n    };\n  }\n  calculatePageVisibility(t, e, i) {\n    const r = [];\n    return t.forEach((s) => {\n      s.pageLayouts.forEach((n) => {\n        const c = s.x * i, h = s.y * i, g = c + n.x * i, o = h + n.y * i, l = n.rotatedWidth * i, u = n.rotatedHeight * i, S = e.scrollLeft, d = e.scrollTop, _ = S + e.clientWidth, A = d + e.clientHeight, f = Math.max(g, S), m = Math.max(o, d), T = Math.min(g + l, _), C = Math.min(o + u, A);\n        if (f < T && m < C) {\n          const w = T - f, x = C - m, O = l * u, V = w * x;\n          r.push({\n            pageNumber: n.pageNumber,\n            viewportX: f - S,\n            viewportY: m - d,\n            visiblePercentage: V / O * 100,\n            original: {\n              pageX: (f - g) / i,\n              pageY: (m - o) / i,\n              visibleWidth: w / i,\n              visibleHeight: x / i,\n              scale: 1\n            },\n            scaled: {\n              pageX: f - g,\n              pageY: m - o,\n              visibleWidth: w,\n              visibleHeight: x,\n              scale: i\n            }\n          });\n        }\n      });\n    }), r;\n  }\n  determineCurrentPage(t) {\n    if (t.length === 0) return 1;\n    const e = Math.max(...t.map((r) => r.visiblePercentage)), i = t.filter((r) => r.visiblePercentage === e);\n    return i.length === 1 ? i[0].pageNumber : i.sort((r, s) => r.pageNumber - s.pageNumber)[0].pageNumber;\n  }\n  getRectLocationForPage(t, e) {\n    const i = e.find((s) => s.pageNumbers.includes(t));\n    if (!i) return null;\n    const r = i.pageLayouts.find((s) => s.pageNumber === t);\n    return r ? {\n      origin: {\n        x: i.x + r.x,\n        y: i.y + r.y\n      },\n      size: {\n        width: r.width,\n        height: r.height\n      }\n    } : null;\n  }\n  getScrollPositionForPage(t, e, i, r, s) {\n    const n = this.getRectLocationForPage(t, e);\n    if (!n) return null;\n    const c = v(n.origin, i);\n    if (s) {\n      const h = U(\n        {\n          width: n.size.width,\n          height: n.size.height\n        },\n        {\n          x: s.x,\n          y: s.y\n        },\n        r,\n        i\n      );\n      return {\n        x: c.x + h.x + this.viewportGap,\n        y: c.y + h.y + this.viewportGap\n      };\n    }\n    return {\n      x: c.x + this.viewportGap,\n      y: c.y + this.viewportGap\n    };\n  }\n  getRectPositionForPage(t, e, i, r, s) {\n    const n = this.getRectLocationForPage(t, e);\n    if (!n) return null;\n    const c = v(n.origin, i), h = B(\n      {\n        width: n.size.width,\n        height: n.size.height\n      },\n      s,\n      r,\n      i\n    );\n    return {\n      origin: {\n        x: c.x + h.origin.x,\n        y: c.y + h.origin.y\n      },\n      size: h.size\n    };\n  }\n}\nclass b extends G {\n  constructor(t) {\n    super(t);\n  }\n  createVirtualItems(t) {\n    let e = 0;\n    return t.map((i, r) => {\n      let s = 0;\n      const n = i.map((o) => {\n        const l = {\n          pageNumber: o.index + 1,\n          pageIndex: o.index,\n          x: s,\n          y: 0,\n          width: o.size.width,\n          height: o.size.height,\n          rotatedWidth: o.rotatedSize.width,\n          rotatedHeight: o.rotatedSize.height\n        };\n        return s += o.rotatedSize.width + this.pageGap, l;\n      }), c = i.reduce(\n        (o, l, u) => o + l.rotatedSize.width + (u < i.length - 1 ? this.pageGap : 0),\n        0\n      ), h = Math.max(...i.map((o) => o.rotatedSize.height)), g = {\n        id: `item-${r}`,\n        x: 0,\n        y: e,\n        offset: e,\n        width: c,\n        height: h,\n        pageLayouts: n,\n        pageNumbers: i.map((o) => o.index + 1),\n        index: r\n      };\n      return e += h + this.pageGap, g;\n    });\n  }\n  getTotalContentSize(t) {\n    if (t.length === 0) return { width: 0, height: 0 };\n    const e = Math.max(...t.map((r) => r.width)), i = t[t.length - 1].y + t[t.length - 1].height;\n    return {\n      width: e,\n      height: i\n    };\n  }\n  getScrollOffset(t) {\n    return t.scrollTop;\n  }\n  getClientSize(t) {\n    return t.clientHeight;\n  }\n}\nclass z extends G {\n  constructor(t) {\n    super(t);\n  }\n  createVirtualItems(t) {\n    let e = 0;\n    return t.map((i, r) => {\n      let s = 0;\n      const n = i.map((o) => {\n        const l = {\n          pageNumber: o.index + 1,\n          pageIndex: o.index,\n          x: s,\n          y: 0,\n          width: o.size.width,\n          height: o.size.height,\n          rotatedWidth: o.rotatedSize.width,\n          rotatedHeight: o.rotatedSize.height\n        };\n        return s += o.rotatedSize.width + this.pageGap, l;\n      }), c = i.reduce(\n        (o, l, u) => o + l.rotatedSize.width + (u < i.length - 1 ? this.pageGap : 0),\n        0\n      ), h = Math.max(...i.map((o) => o.rotatedSize.height)), g = {\n        id: `item-${r}`,\n        x: e,\n        y: 0,\n        offset: e,\n        width: c,\n        height: h,\n        pageLayouts: n,\n        pageNumbers: i.map((o) => o.index + 1),\n        index: r\n      };\n      return e += c + this.pageGap, g;\n    });\n  }\n  getTotalContentSize(t) {\n    if (t.length === 0) return { width: 0, height: 0 };\n    const e = t[t.length - 1].x + t[t.length - 1].width, i = Math.max(...t.map((r) => r.height));\n    return {\n      width: e,\n      height: i\n    };\n  }\n  getScrollOffset(t) {\n    return t.scrollLeft;\n  }\n  getClientSize(t) {\n    return t.clientWidth;\n  }\n}\nconst $ = \"UPDATE_SCROLL_STATE\", Y = \"SET_DESIRED_SCROLL_POSITION\", E = \"UPDATE_TOTAL_PAGES\";\nfunction M(a) {\n  return { type: $, payload: a };\n}\nfunction k(a) {\n  return { type: E, payload: a };\n}\nconst q = (a, t) => ({\n  startSpacing: a.startSpacing,\n  endSpacing: a.endSpacing,\n  totalWidth: a.totalContentSize.width * t,\n  totalHeight: a.totalContentSize.height * t,\n  pageGap: a.pageGap * t,\n  strategy: a.strategy,\n  items: a.renderedPageIndexes.map((e) => ({\n    ...a.virtualItems[e],\n    pageLayouts: a.virtualItems[e].pageLayouts.map((i) => ({\n      ...i,\n      rotatedWidth: i.rotatedWidth * t,\n      rotatedHeight: i.rotatedHeight * t,\n      width: i.width * t,\n      height: i.height * t\n    }))\n  }))\n}), R = class R extends F {\n  constructor(t, e, i) {\n    var r, s, n, c;\n    super(t, e), this.id = t, this.config = i, this.currentScale = 1, this.currentRotation = X.Degree0, this.currentPage = 1, this.layoutReady = !1, this.layout$ = p(), this.scroll$ = p(), this.state$ = p(), this.scrollerLayout$ = p(), this.pageChange$ = p(), this.layoutReady$ = p(), this.viewport = this.registry.getPlugin(\"viewport\").provides(), this.strategyConfig = {\n      pageGap: ((r = this.config) == null ? void 0 : r.pageGap) ?? 10,\n      viewportGap: this.viewport.getViewportGap(),\n      bufferSize: ((s = this.config) == null ? void 0 : s.bufferSize) ?? 2\n    }, this.strategy = ((n = this.config) == null ? void 0 : n.strategy) === y.Horizontal ? new z(this.strategyConfig) : new b(this.strategyConfig), this.initialPage = (c = this.config) == null ? void 0 : c.initialPage, this.currentScale = this.coreState.core.scale, this.currentRotation = this.coreState.core.rotation, this.viewport.onViewportChange((h) => this.commitMetrics(this.computeMetrics(h)), {\n      mode: \"throttle\",\n      wait: 250\n    }), this.coreStore.onAction(H, (h, g) => {\n      const o = g.core.pages.length;\n      this.dispatch(k(o)), this.pageChange$.emit({ pageNumber: this.currentPage, totalPages: o }), this.refreshAll(P(g.core), this.viewport.getMetrics());\n    }), this.coreStore.onAction(\n      I,\n      (h, g) => this.refreshAll(P(g.core), this.viewport.getMetrics())\n    ), this.coreStore.onAction(\n      W,\n      (h, g) => this.refreshAll(P(g.core), this.viewport.getMetrics())\n    );\n  }\n  /* ------------------------------------------------------------------ */\n  /*  s                                                       */\n  /* ------------------------------------------------------------------ */\n  computeLayout(t) {\n    const e = this.strategy.createVirtualItems(t), i = this.strategy.getTotalContentSize(e);\n    return { virtualItems: e, totalContentSize: i };\n  }\n  computeMetrics(t, e = this.state.virtualItems) {\n    return this.strategy.handleScroll(t, e, this.currentScale);\n  }\n  /* ------------------------------------------------------------------ */\n  /*    (single source of truth)                                  */\n  /* ------------------------------------------------------------------ */\n  commit(t, e) {\n    this.dispatch(M(t)), e != null && e.layout && this.layout$.emit(e.layout), e != null && e.metrics && (this.scroll$.emit(e.metrics), e.metrics.currentPage !== this.currentPage && (this.currentPage = e.metrics.currentPage, this.pageChange$.emit({ pageNumber: this.currentPage, totalPages: this.state.totalPages }))), this.scrollerLayout$.emit(this.getScrollerLayoutFromState());\n  }\n  /* convenience wrappers */\n  commitMetrics(t) {\n    this.commit(t, { metrics: t });\n  }\n  /* full re-compute after page-spread or initialisation */\n  refreshAll(t, e) {\n    const i = this.computeLayout(t), r = this.computeMetrics(e, i.virtualItems);\n    this.commit({ ...i, ...r }, { layout: i, metrics: r });\n  }\n  getVirtualItemsFromState() {\n    return this.state.virtualItems || [];\n  }\n  getScrollerLayoutFromState() {\n    const t = this.coreState.core.scale;\n    return q(this.state, t);\n  }\n  pushScrollLayout() {\n    this.scrollerLayout$.emit(this.getScrollerLayoutFromState());\n  }\n  onStoreUpdated(t, e) {\n    this.pushScrollLayout();\n  }\n  onCoreStoreUpdated(t, e) {\n    t.core.scale !== e.core.scale && (this.currentScale = e.core.scale, this.commitMetrics(this.computeMetrics(this.viewport.getMetrics()))), t.core.rotation !== e.core.rotation && (this.currentRotation = e.core.rotation);\n  }\n  /**\n   * Change the scroll strategy at runtime (e.g., vertical <-> horizontal)\n   * @param newStrategy ScrollStrategy.Horizontal or ScrollStrategy.Vertical\n   */\n  setScrollStrategy(t) {\n    if (t === y.Horizontal && this.strategy instanceof z || t === y.Vertical && this.strategy instanceof b)\n      return;\n    this.strategy = t === y.Horizontal ? new z(this.strategyConfig) : new b(this.strategyConfig), this.dispatch(\n      M({\n        strategy: t\n      })\n    );\n    const e = P(this.coreState.core);\n    this.refreshAll(e, this.viewport.getMetrics());\n  }\n  setLayoutReady() {\n    this.layoutReady || (this.layoutReady = !0, this.layoutReady$.emit(!0));\n  }\n  buildCapability() {\n    return {\n      onStateChange: this.state$.on,\n      onLayoutChange: this.layout$.on,\n      onScroll: this.scroll$.on,\n      onPageChange: this.pageChange$.on,\n      onScrollerData: this.scrollerLayout$.on,\n      onLayoutReady: this.layoutReady$.on,\n      getCurrentPage: () => this.currentPage,\n      getTotalPages: () => this.state.totalPages,\n      scrollToPage: (t) => {\n        const { pageNumber: e, behavior: i = \"smooth\", pageCoordinates: r, center: s = !1 } = t, n = this.getVirtualItemsFromState(), c = this.strategy.getScrollPositionForPage(\n          e,\n          n,\n          this.currentScale,\n          this.currentRotation,\n          r\n        );\n        c && this.viewport.scrollTo({ ...c, behavior: i, center: s });\n      },\n      scrollToNextPage: (t = \"smooth\") => {\n        const e = this.getVirtualItemsFromState(), i = e.findIndex(\n          (r) => r.pageNumbers.includes(this.currentPage)\n        );\n        if (i >= 0 && i < e.length - 1) {\n          const r = e[i + 1], s = this.strategy.getScrollPositionForPage(\n            r.pageNumbers[0],\n            e,\n            this.currentScale,\n            this.currentRotation\n          );\n          s && this.viewport.scrollTo({ ...s, behavior: t });\n        }\n      },\n      scrollToPreviousPage: (t = \"smooth\") => {\n        const e = this.getVirtualItemsFromState(), i = e.findIndex(\n          (r) => r.pageNumbers.includes(this.currentPage)\n        );\n        if (i > 0) {\n          const r = e[i - 1], s = this.strategy.getScrollPositionForPage(\n            r.pageNumbers[0],\n            e,\n            this.currentScale,\n            this.currentRotation\n          );\n          s && this.viewport.scrollTo({ ...s, behavior: t });\n        }\n      },\n      getMetrics: this.getMetrics.bind(this),\n      getLayout: this.getLayout.bind(this),\n      getRectPositionForPage: this.getRectPositionForPage.bind(this),\n      getPageGap: () => this.state.pageGap,\n      getScrollerLayout: () => this.getScrollerLayoutFromState(),\n      setScrollStrategy: (t) => this.setScrollStrategy(t)\n    };\n  }\n  getMetrics(t) {\n    const e = t || this.viewport.getMetrics(), i = this.getVirtualItemsFromState();\n    return this.strategy.handleScroll(e, i, this.currentScale);\n  }\n  getLayout() {\n    return {\n      virtualItems: this.state.virtualItems,\n      totalContentSize: this.state.totalContentSize\n    };\n  }\n  getRectPositionForPage(t, e, i, r) {\n    return this.strategy.getRectPositionForPage(\n      t + 1,\n      this.state.virtualItems,\n      i ?? this.currentScale,\n      r ?? this.currentRotation,\n      e\n    );\n  }\n  async initialize() {\n  }\n  async destroy() {\n    this.layout$.clear(), this.scroll$.clear(), this.pageChange$.clear(), this.state$.clear(), this.scrollerLayout$.clear(), this.layoutReady$.clear(), super.destroy();\n  }\n};\nR.id = \"scroll\";\nlet L = R;\nconst N = \"scroll\", j = {\n  id: N,\n  name: \"Scroll Plugin\",\n  version: \"1.0.0\",\n  provides: [\"scroll\"],\n  requires: [\"viewport\"],\n  optional: [],\n  defaultConfig: {\n    enabled: !0,\n    pageGap: 10\n  }\n}, J = {\n  currentPage: 1,\n  visiblePages: [],\n  pageVisibilityMetrics: [],\n  renderedPageIndexes: [],\n  scrollOffset: { x: 0, y: 0 },\n  startSpacing: 0,\n  endSpacing: 0\n}, K = (a, t) => ({\n  virtualItems: [],\n  totalPages: a.pages.length,\n  totalContentSize: { width: 0, height: 0 },\n  desiredScrollPosition: { x: 0, y: 0 },\n  strategy: t.strategy ?? y.Vertical,\n  pageGap: t.pageGap ?? 10,\n  scale: a.scale,\n  ...J\n}), Q = (a, t) => {\n  switch (t.type) {\n    case E:\n      return { ...a, totalPages: t.payload };\n    case D:\n      return { ...a, scale: t.payload };\n    case $:\n      return { ...a, ...t.payload };\n    case Y:\n      return { ...a, desiredScrollPosition: t.payload };\n    default:\n      return a;\n  }\n}, et = {\n  manifest: j,\n  create: (a, t, e) => new L(N, a, e),\n  reducer: Q,\n  initialState: (a, t) => K(a, t)\n};\nexport {\n  N as SCROLL_PLUGIN_ID,\n  L as ScrollPlugin,\n  et as ScrollPluginPackage,\n  y as ScrollStrategy,\n  j as manifest\n};\n//# sourceMappingURL=index.js.map\n","import { usePlugin as S, useCapability as m, useRegistry as x } from \"@embedpdf/core/preact\";\nimport { ScrollPlugin as h, ScrollStrategy as a } from \"@embedpdf/plugin-scroll\";\nimport { useState as u, useEffect as d } from \"preact/hooks\";\nimport { jsxs as b, jsx as o } from \"preact/jsx-runtime\";\nconst v = () => S(h.id), f = () => m(h.id), C = () => {\n  const { provides: r } = f(), [s, c] = u(1), [e, i] = u(1);\n  return d(() => {\n    if (r)\n      return r.onPageChange(({ pageNumber: n, totalPages: t }) => {\n        c(n), i(t);\n      });\n  }, [r]), {\n    ...r,\n    currentPage: s,\n    totalPages: e\n  };\n};\nfunction L({ renderPage: r, overlayElements: s, ...c }) {\n  const { provides: e } = f(), { plugin: i } = v(), { registry: n } = x(), [t, y] = u(\n    () => (e == null ? void 0 : e.getScrollerLayout()) ?? null\n  );\n  if (d(() => {\n    if (e)\n      return e.onScrollerData(y);\n  }, [e]), d(() => {\n    i && i.setLayoutReady();\n  }, [i]), !t || !n) return null;\n  const g = n.getStore().getState();\n  return /* @__PURE__ */ b(\n    \"div\",\n    {\n      ...c,\n      style: {\n        width: `${t.totalWidth}px`,\n        height: `${t.totalHeight}px`,\n        position: \"relative\",\n        boxSizing: \"border-box\",\n        margin: \"0 auto\",\n        ...t.strategy === a.Horizontal && {\n          display: \"flex\",\n          flexDirection: \"row\"\n        }\n      },\n      children: [\n        /* @__PURE__ */ o(\n          \"div\",\n          {\n            style: {\n              ...t.strategy === a.Horizontal ? {\n                width: t.startSpacing,\n                height: \"100%\",\n                flexShrink: 0\n              } : {\n                height: t.startSpacing,\n                width: \"100%\"\n              }\n            }\n          }\n        ),\n        /* @__PURE__ */ o(\n          \"div\",\n          {\n            style: {\n              gap: t.pageGap,\n              display: \"flex\",\n              alignItems: \"center\",\n              position: \"relative\",\n              boxSizing: \"border-box\",\n              ...t.strategy === a.Horizontal ? {\n                flexDirection: \"row\",\n                minHeight: \"100%\"\n              } : {\n                flexDirection: \"column\",\n                minWidth: \"fit-content\"\n              }\n            },\n            children: t.items.map((p) => /* @__PURE__ */ o(\n              \"div\",\n              {\n                style: {\n                  display: \"flex\",\n                  justifyContent: \"center\",\n                  gap: t.pageGap\n                },\n                children: p.pageLayouts.map((l) => /* @__PURE__ */ o(\n                  \"div\",\n                  {\n                    style: {\n                      width: `${l.rotatedWidth}px`,\n                      height: `${l.rotatedHeight}px`\n                    },\n                    children: r({\n                      ...l,\n                      rotation: g.core.rotation,\n                      scale: g.core.scale,\n                      document: g.core.document\n                    })\n                  },\n                  l.pageNumber\n                ))\n              },\n              p.pageNumbers[0]\n            ))\n          }\n        ),\n        /* @__PURE__ */ o(\n          \"div\",\n          {\n            style: {\n              ...t.strategy === a.Horizontal ? {\n                width: t.endSpacing,\n                height: \"100%\",\n                flexShrink: 0\n              } : {\n                height: t.endSpacing,\n                width: \"100%\"\n              }\n            }\n          }\n        ),\n        s\n      ]\n    }\n  );\n}\nexport {\n  L as Scroller,\n  C as useScroll,\n  f as useScrollCapability,\n  v as useScrollPlugin\n};\n//# sourceMappingURL=index.js.map\n","import { BasePlugin as h, createBehaviorEmitter as u, createEmitter as m, loadDocument as y, setDocument as p } from \"@embedpdf/core\";\nclass f {\n  async load(e) {\n    const { pdfFile: t, options: r, engine: n } = e, i = n.openDocumentUrl(t, r);\n    return new Promise((d, a) => {\n      i.wait(\n        // Success callback\n        (o) => d(o),\n        // Error callback\n        (o) => {\n          o.type === \"abort\" ? a(new Error(`PDF loading aborted: ${o.reason}`)) : a(new Error(`PDF loading failed: ${o.reason}`));\n        }\n      );\n    });\n  }\n}\nclass D {\n  async load(e) {\n    const { pdfFile: t, options: r, engine: n } = e, i = n.openDocumentFromBuffer(t, (r == null ? void 0 : r.password) || \"\");\n    return new Promise((d, a) => {\n      i.wait(\n        // Success callback\n        (o) => d(o),\n        // Error callback\n        (o) => {\n          o.type === \"abort\" ? a(new Error(`PDF loading aborted: ${o.reason}`)) : a(new Error(`PDF loading failed: ${o.reason}`));\n        }\n      );\n    });\n  }\n}\nclass w {\n  constructor() {\n    this.strategies = /* @__PURE__ */ new Map(), this.strategyResolvers = [];\n    const e = new D();\n    this.registerStrategy(\"url\", new f()), this.registerStrategy(\"buffer\", e), this.addStrategyResolver((t) => S(t) ? this.strategies.get(\"url\") : this.strategies.get(\"buffer\"));\n  }\n  registerStrategy(e, t) {\n    this.strategies.set(e, t);\n  }\n  getStrategy(e) {\n    return this.strategies.get(e);\n  }\n  addStrategyResolver(e) {\n    this.strategyResolvers.push(e);\n  }\n  async loadDocument(e) {\n    try {\n      const t = this.resolveStrategy(e);\n      if (!t)\n        throw new Error(\"No suitable strategy found for the given options\");\n      return await t.load(e);\n    } catch (t) {\n      throw console.error(\"Error loading document:\", t), t;\n    }\n  }\n  resolveStrategy(e) {\n    for (const t of this.strategyResolvers) {\n      const r = t(e);\n      if (r)\n        return r;\n    }\n  }\n}\nfunction S(s) {\n  return s.type === \"url\";\n}\nconst c = class c extends h {\n  constructor(e, t, r) {\n    super(e, t), this.id = e, this.engine = r, this.loaderHandlers$ = u(), this.documentLoadedHandlers$ = u(), this.openFileRequest$ = m(), this.documentLoader = new w();\n  }\n  buildCapability() {\n    return {\n      onLoaderEvent: this.loaderHandlers$.on,\n      onDocumentLoaded: this.documentLoadedHandlers$.on,\n      onOpenFileRequest: this.openFileRequest$.on,\n      openFileDialog: () => this.openFileRequest$.emit(\"open\"),\n      loadDocument: (e) => this.loadDocument(e),\n      registerStrategy: (e, t) => this.documentLoader.registerStrategy(e, t),\n      getDocument: () => this.loadedDocument,\n      addStrategyResolver: (e) => this.documentLoader.addStrategyResolver(e)\n    };\n  }\n  async initialize(e) {\n    e.defaultStrategies && Object.entries(e.defaultStrategies).forEach(([t, r]) => {\n      this.documentLoader.registerStrategy(t, r);\n    }), e.loadingOptions && (this.loadingOptions = e.loadingOptions);\n  }\n  async postInitialize() {\n    this.loadingOptions && await this.loadDocument(this.loadingOptions);\n  }\n  async loadDocument(e) {\n    try {\n      this.loaderHandlers$.emit({ type: \"start\", documentId: e.pdfFile.id }), this.dispatchCoreAction(y());\n      const t = await this.documentLoader.loadDocument({\n        ...e,\n        engine: this.engine\n      });\n      return this.dispatchCoreAction(p(t)), this.loadedDocument = t, this.loaderHandlers$.emit({ type: \"complete\", documentId: e.pdfFile.id }), this.documentLoadedHandlers$.emit(t), t;\n    } catch (t) {\n      const r = {\n        type: \"error\",\n        documentId: e.pdfFile.id,\n        error: t instanceof Error ? t : new Error(String(t))\n      };\n      throw this.loaderHandlers$.emit(r), t;\n    }\n  }\n  async destroy() {\n    this.loaderHandlers$.clear(), this.documentLoadedHandlers$.clear(), this.openFileRequest$.clear(), super.destroy();\n  }\n};\nc.id = \"loader\";\nlet l = c;\nconst g = \"loader\", F = {\n  id: g,\n  name: \"Loader Plugin\",\n  version: \"1.0.0\",\n  provides: [\"loader\"],\n  requires: [],\n  optional: [],\n  metadata: {\n    name: \"Loader Plugin\",\n    description: \"A plugin for loading PDF documents\",\n    version: \"1.0.0\",\n    author: \"EmbedPDF\",\n    license: \"MIT\"\n  },\n  defaultConfig: {\n    enabled: !0\n  }\n}, $ = {\n  manifest: F,\n  create: (s, e) => new l(g, s, e),\n  reducer: () => {\n  },\n  initialState: {}\n};\nexport {\n  g as LOADER_PLUGIN_ID,\n  l as LoaderPlugin,\n  $ as LoaderPluginPackage,\n  F as manifest\n};\n//# sourceMappingURL=index.js.map\n","import { usePlugin as a, useCapability as s } from \"@embedpdf/core/preact\";\nimport { LoaderPlugin as u } from \"@embedpdf/plugin-loader\";\nimport { jsx as o, Fragment as c } from \"preact/jsx-runtime\";\nimport { useRef as f, useEffect as p } from \"preact/hooks\";\nconst h = () => a(u.id), l = () => s(u.id);\nfunction C() {\n  const { provides: e } = l(), t = f(null);\n  return p(() => e ? e.onOpenFileRequest((n) => {\n    n === \"open\" && t.current && t.current.click();\n  }) : void 0, [e]), /* @__PURE__ */ o(c, { children: /* @__PURE__ */ o(\n    \"input\",\n    {\n      ref: t,\n      type: \"file\",\n      accept: \"application/pdf\",\n      style: { display: \"none\" },\n      onChange: async (i) => {\n        var r;\n        const n = (r = i.currentTarget.files) == null ? void 0 : r[0];\n        n && e && await e.loadDocument({\n          type: \"buffer\",\n          pdfFile: {\n            id: Math.random().toString(36).substring(2, 15),\n            content: await n.arrayBuffer()\n          }\n        });\n      }\n    }\n  ) });\n}\nexport {\n  C as FilePicker,\n  l as useLoaderCapability,\n  h as useLoaderPlugin\n};\n//# sourceMappingURL=index.js.map\n","import { h, ComponentChildren, Ref, JSX } from 'preact';\n\ntype ButtonProps = JSX.ButtonHTMLAttributes<HTMLButtonElement> & {\n  id?: string;\n  children: ComponentChildren;\n  onClick?: h.JSX.MouseEventHandler<HTMLButtonElement> | undefined;\n  active?: boolean;\n  disabled?: boolean;\n  className?: string;\n  tooltip?: string;\n  ref?: Ref<HTMLButtonElement>;\n};\n\nexport function Button({\n  id,\n  children,\n  onClick,\n  active = false,\n  disabled = false,\n  className = '',\n  tooltip,\n  ref,\n  ...props\n}: ButtonProps) {\n  return (\n    <button\n      id={id}\n      ref={ref}\n      onClick={onClick}\n      className={`flex h-[32px] w-auto min-w-[32px] items-center justify-center rounded-md p-[5px] transition-colors ${\n        active\n          ? 'border-none bg-blue-50 text-blue-500 shadow ring ring-blue-500'\n          : 'hover:bg-gray-100 hover:ring hover:ring-[#1a466b]'\n      } ${disabled ? 'cursor-not-allowed opacity-50 hover:bg-transparent hover:ring-0' : 'cursor-pointer'} ${className} `}\n      title={tooltip}\n      {...props}\n    >\n      {children}\n    </button>\n  );\n}\n","/**\n * Custom positioning reference element.\n * @see https://floating-ui.com/docs/virtual-elements\n */\n\nconst sides = ['top', 'right', 'bottom', 'left'];\nconst alignments = ['start', 'end'];\nconst placements = /*#__PURE__*/sides.reduce((acc, side) => acc.concat(side, side + \"-\" + alignments[0], side + \"-\" + alignments[1]), []);\nconst min = Math.min;\nconst max = Math.max;\nconst round = Math.round;\nconst floor = Math.floor;\nconst createCoords = v => ({\n  x: v,\n  y: v\n});\nconst oppositeSideMap = {\n  left: 'right',\n  right: 'left',\n  bottom: 'top',\n  top: 'bottom'\n};\nconst oppositeAlignmentMap = {\n  start: 'end',\n  end: 'start'\n};\nfunction clamp(start, value, end) {\n  return max(start, min(value, end));\n}\nfunction evaluate(value, param) {\n  return typeof value === 'function' ? value(param) : value;\n}\nfunction getSide(placement) {\n  return placement.split('-')[0];\n}\nfunction getAlignment(placement) {\n  return placement.split('-')[1];\n}\nfunction getOppositeAxis(axis) {\n  return axis === 'x' ? 'y' : 'x';\n}\nfunction getAxisLength(axis) {\n  return axis === 'y' ? 'height' : 'width';\n}\nconst yAxisSides = /*#__PURE__*/new Set(['top', 'bottom']);\nfunction getSideAxis(placement) {\n  return yAxisSides.has(getSide(placement)) ? 'y' : 'x';\n}\nfunction getAlignmentAxis(placement) {\n  return getOppositeAxis(getSideAxis(placement));\n}\nfunction getAlignmentSides(placement, rects, rtl) {\n  if (rtl === void 0) {\n    rtl = false;\n  }\n  const alignment = getAlignment(placement);\n  const alignmentAxis = getAlignmentAxis(placement);\n  const length = getAxisLength(alignmentAxis);\n  let mainAlignmentSide = alignmentAxis === 'x' ? alignment === (rtl ? 'end' : 'start') ? 'right' : 'left' : alignment === 'start' ? 'bottom' : 'top';\n  if (rects.reference[length] > rects.floating[length]) {\n    mainAlignmentSide = getOppositePlacement(mainAlignmentSide);\n  }\n  return [mainAlignmentSide, getOppositePlacement(mainAlignmentSide)];\n}\nfunction getExpandedPlacements(placement) {\n  const oppositePlacement = getOppositePlacement(placement);\n  return [getOppositeAlignmentPlacement(placement), oppositePlacement, getOppositeAlignmentPlacement(oppositePlacement)];\n}\nfunction getOppositeAlignmentPlacement(placement) {\n  return placement.replace(/start|end/g, alignment => oppositeAlignmentMap[alignment]);\n}\nconst lrPlacement = ['left', 'right'];\nconst rlPlacement = ['right', 'left'];\nconst tbPlacement = ['top', 'bottom'];\nconst btPlacement = ['bottom', 'top'];\nfunction getSideList(side, isStart, rtl) {\n  switch (side) {\n    case 'top':\n    case 'bottom':\n      if (rtl) return isStart ? rlPlacement : lrPlacement;\n      return isStart ? lrPlacement : rlPlacement;\n    case 'left':\n    case 'right':\n      return isStart ? tbPlacement : btPlacement;\n    default:\n      return [];\n  }\n}\nfunction getOppositeAxisPlacements(placement, flipAlignment, direction, rtl) {\n  const alignment = getAlignment(placement);\n  let list = getSideList(getSide(placement), direction === 'start', rtl);\n  if (alignment) {\n    list = list.map(side => side + \"-\" + alignment);\n    if (flipAlignment) {\n      list = list.concat(list.map(getOppositeAlignmentPlacement));\n    }\n  }\n  return list;\n}\nfunction getOppositePlacement(placement) {\n  return placement.replace(/left|right|bottom|top/g, side => oppositeSideMap[side]);\n}\nfunction expandPaddingObject(padding) {\n  return {\n    top: 0,\n    right: 0,\n    bottom: 0,\n    left: 0,\n    ...padding\n  };\n}\nfunction getPaddingObject(padding) {\n  return typeof padding !== 'number' ? expandPaddingObject(padding) : {\n    top: padding,\n    right: padding,\n    bottom: padding,\n    left: padding\n  };\n}\nfunction rectToClientRect(rect) {\n  const {\n    x,\n    y,\n    width,\n    height\n  } = rect;\n  return {\n    width,\n    height,\n    top: y,\n    left: x,\n    right: x + width,\n    bottom: y + height,\n    x,\n    y\n  };\n}\n\nexport { alignments, clamp, createCoords, evaluate, expandPaddingObject, floor, getAlignment, getAlignmentAxis, getAlignmentSides, getAxisLength, getExpandedPlacements, getOppositeAlignmentPlacement, getOppositeAxis, getOppositeAxisPlacements, getOppositePlacement, getPaddingObject, getSide, getSideAxis, max, min, placements, rectToClientRect, round, sides };\n","import { getSideAxis, getAlignmentAxis, getAxisLength, getSide, getAlignment, evaluate, getPaddingObject, rectToClientRect, min, clamp, placements, getAlignmentSides, getOppositeAlignmentPlacement, getOppositePlacement, getExpandedPlacements, getOppositeAxisPlacements, sides, max, getOppositeAxis } from '@floating-ui/utils';\nexport { rectToClientRect } from '@floating-ui/utils';\n\nfunction computeCoordsFromPlacement(_ref, placement, rtl) {\n  let {\n    reference,\n    floating\n  } = _ref;\n  const sideAxis = getSideAxis(placement);\n  const alignmentAxis = getAlignmentAxis(placement);\n  const alignLength = getAxisLength(alignmentAxis);\n  const side = getSide(placement);\n  const isVertical = sideAxis === 'y';\n  const commonX = reference.x + reference.width / 2 - floating.width / 2;\n  const commonY = reference.y + reference.height / 2 - floating.height / 2;\n  const commonAlign = reference[alignLength] / 2 - floating[alignLength] / 2;\n  let coords;\n  switch (side) {\n    case 'top':\n      coords = {\n        x: commonX,\n        y: reference.y - floating.height\n      };\n      break;\n    case 'bottom':\n      coords = {\n        x: commonX,\n        y: reference.y + reference.height\n      };\n      break;\n    case 'right':\n      coords = {\n        x: reference.x + reference.width,\n        y: commonY\n      };\n      break;\n    case 'left':\n      coords = {\n        x: reference.x - floating.width,\n        y: commonY\n      };\n      break;\n    default:\n      coords = {\n        x: reference.x,\n        y: reference.y\n      };\n  }\n  switch (getAlignment(placement)) {\n    case 'start':\n      coords[alignmentAxis] -= commonAlign * (rtl && isVertical ? -1 : 1);\n      break;\n    case 'end':\n      coords[alignmentAxis] += commonAlign * (rtl && isVertical ? -1 : 1);\n      break;\n  }\n  return coords;\n}\n\n/**\n * Computes the `x` and `y` coordinates that will place the floating element\n * next to a given reference element.\n *\n * This export does not have any `platform` interface logic. You will need to\n * write one for the platform you are using Floating UI with.\n */\nconst computePosition = async (reference, floating, config) => {\n  const {\n    placement = 'bottom',\n    strategy = 'absolute',\n    middleware = [],\n    platform\n  } = config;\n  const validMiddleware = middleware.filter(Boolean);\n  const rtl = await (platform.isRTL == null ? void 0 : platform.isRTL(floating));\n  let rects = await platform.getElementRects({\n    reference,\n    floating,\n    strategy\n  });\n  let {\n    x,\n    y\n  } = computeCoordsFromPlacement(rects, placement, rtl);\n  let statefulPlacement = placement;\n  let middlewareData = {};\n  let resetCount = 0;\n  for (let i = 0; i < validMiddleware.length; i++) {\n    const {\n      name,\n      fn\n    } = validMiddleware[i];\n    const {\n      x: nextX,\n      y: nextY,\n      data,\n      reset\n    } = await fn({\n      x,\n      y,\n      initialPlacement: placement,\n      placement: statefulPlacement,\n      strategy,\n      middlewareData,\n      rects,\n      platform,\n      elements: {\n        reference,\n        floating\n      }\n    });\n    x = nextX != null ? nextX : x;\n    y = nextY != null ? nextY : y;\n    middlewareData = {\n      ...middlewareData,\n      [name]: {\n        ...middlewareData[name],\n        ...data\n      }\n    };\n    if (reset && resetCount <= 50) {\n      resetCount++;\n      if (typeof reset === 'object') {\n        if (reset.placement) {\n          statefulPlacement = reset.placement;\n        }\n        if (reset.rects) {\n          rects = reset.rects === true ? await platform.getElementRects({\n            reference,\n            floating,\n            strategy\n          }) : reset.rects;\n        }\n        ({\n          x,\n          y\n        } = computeCoordsFromPlacement(rects, statefulPlacement, rtl));\n      }\n      i = -1;\n    }\n  }\n  return {\n    x,\n    y,\n    placement: statefulPlacement,\n    strategy,\n    middlewareData\n  };\n};\n\n/**\n * Resolves with an object of overflow side offsets that determine how much the\n * element is overflowing a given clipping boundary on each side.\n * - positive = overflowing the boundary by that number of pixels\n * - negative = how many pixels left before it will overflow\n * - 0 = lies flush with the boundary\n * @see https://floating-ui.com/docs/detectOverflow\n */\nasync function detectOverflow(state, options) {\n  var _await$platform$isEle;\n  if (options === void 0) {\n    options = {};\n  }\n  const {\n    x,\n    y,\n    platform,\n    rects,\n    elements,\n    strategy\n  } = state;\n  const {\n    boundary = 'clippingAncestors',\n    rootBoundary = 'viewport',\n    elementContext = 'floating',\n    altBoundary = false,\n    padding = 0\n  } = evaluate(options, state);\n  const paddingObject = getPaddingObject(padding);\n  const altContext = elementContext === 'floating' ? 'reference' : 'floating';\n  const element = elements[altBoundary ? altContext : elementContext];\n  const clippingClientRect = rectToClientRect(await platform.getClippingRect({\n    element: ((_await$platform$isEle = await (platform.isElement == null ? void 0 : platform.isElement(element))) != null ? _await$platform$isEle : true) ? element : element.contextElement || (await (platform.getDocumentElement == null ? void 0 : platform.getDocumentElement(elements.floating))),\n    boundary,\n    rootBoundary,\n    strategy\n  }));\n  const rect = elementContext === 'floating' ? {\n    x,\n    y,\n    width: rects.floating.width,\n    height: rects.floating.height\n  } : rects.reference;\n  const offsetParent = await (platform.getOffsetParent == null ? void 0 : platform.getOffsetParent(elements.floating));\n  const offsetScale = (await (platform.isElement == null ? void 0 : platform.isElement(offsetParent))) ? (await (platform.getScale == null ? void 0 : platform.getScale(offsetParent))) || {\n    x: 1,\n    y: 1\n  } : {\n    x: 1,\n    y: 1\n  };\n  const elementClientRect = rectToClientRect(platform.convertOffsetParentRelativeRectToViewportRelativeRect ? await platform.convertOffsetParentRelativeRectToViewportRelativeRect({\n    elements,\n    rect,\n    offsetParent,\n    strategy\n  }) : rect);\n  return {\n    top: (clippingClientRect.top - elementClientRect.top + paddingObject.top) / offsetScale.y,\n    bottom: (elementClientRect.bottom - clippingClientRect.bottom + paddingObject.bottom) / offsetScale.y,\n    left: (clippingClientRect.left - elementClientRect.left + paddingObject.left) / offsetScale.x,\n    right: (elementClientRect.right - clippingClientRect.right + paddingObject.right) / offsetScale.x\n  };\n}\n\n/**\n * Provides data to position an inner element of the floating element so that it\n * appears centered to the reference element.\n * @see https://floating-ui.com/docs/arrow\n */\nconst arrow = options => ({\n  name: 'arrow',\n  options,\n  async fn(state) {\n    const {\n      x,\n      y,\n      placement,\n      rects,\n      platform,\n      elements,\n      middlewareData\n    } = state;\n    // Since `element` is required, we don't Partial<> the type.\n    const {\n      element,\n      padding = 0\n    } = evaluate(options, state) || {};\n    if (element == null) {\n      return {};\n    }\n    const paddingObject = getPaddingObject(padding);\n    const coords = {\n      x,\n      y\n    };\n    const axis = getAlignmentAxis(placement);\n    const length = getAxisLength(axis);\n    const arrowDimensions = await platform.getDimensions(element);\n    const isYAxis = axis === 'y';\n    const minProp = isYAxis ? 'top' : 'left';\n    const maxProp = isYAxis ? 'bottom' : 'right';\n    const clientProp = isYAxis ? 'clientHeight' : 'clientWidth';\n    const endDiff = rects.reference[length] + rects.reference[axis] - coords[axis] - rects.floating[length];\n    const startDiff = coords[axis] - rects.reference[axis];\n    const arrowOffsetParent = await (platform.getOffsetParent == null ? void 0 : platform.getOffsetParent(element));\n    let clientSize = arrowOffsetParent ? arrowOffsetParent[clientProp] : 0;\n\n    // DOM platform can return `window` as the `offsetParent`.\n    if (!clientSize || !(await (platform.isElement == null ? void 0 : platform.isElement(arrowOffsetParent)))) {\n      clientSize = elements.floating[clientProp] || rects.floating[length];\n    }\n    const centerToReference = endDiff / 2 - startDiff / 2;\n\n    // If the padding is large enough that it causes the arrow to no longer be\n    // centered, modify the padding so that it is centered.\n    const largestPossiblePadding = clientSize / 2 - arrowDimensions[length] / 2 - 1;\n    const minPadding = min(paddingObject[minProp], largestPossiblePadding);\n    const maxPadding = min(paddingObject[maxProp], largestPossiblePadding);\n\n    // Make sure the arrow doesn't overflow the floating element if the center\n    // point is outside the floating element's bounds.\n    const min$1 = minPadding;\n    const max = clientSize - arrowDimensions[length] - maxPadding;\n    const center = clientSize / 2 - arrowDimensions[length] / 2 + centerToReference;\n    const offset = clamp(min$1, center, max);\n\n    // If the reference is small enough that the arrow's padding causes it to\n    // to point to nothing for an aligned placement, adjust the offset of the\n    // floating element itself. To ensure `shift()` continues to take action,\n    // a single reset is performed when this is true.\n    const shouldAddOffset = !middlewareData.arrow && getAlignment(placement) != null && center !== offset && rects.reference[length] / 2 - (center < min$1 ? minPadding : maxPadding) - arrowDimensions[length] / 2 < 0;\n    const alignmentOffset = shouldAddOffset ? center < min$1 ? center - min$1 : center - max : 0;\n    return {\n      [axis]: coords[axis] + alignmentOffset,\n      data: {\n        [axis]: offset,\n        centerOffset: center - offset - alignmentOffset,\n        ...(shouldAddOffset && {\n          alignmentOffset\n        })\n      },\n      reset: shouldAddOffset\n    };\n  }\n});\n\nfunction getPlacementList(alignment, autoAlignment, allowedPlacements) {\n  const allowedPlacementsSortedByAlignment = alignment ? [...allowedPlacements.filter(placement => getAlignment(placement) === alignment), ...allowedPlacements.filter(placement => getAlignment(placement) !== alignment)] : allowedPlacements.filter(placement => getSide(placement) === placement);\n  return allowedPlacementsSortedByAlignment.filter(placement => {\n    if (alignment) {\n      return getAlignment(placement) === alignment || (autoAlignment ? getOppositeAlignmentPlacement(placement) !== placement : false);\n    }\n    return true;\n  });\n}\n/**\n * Optimizes the visibility of the floating element by choosing the placement\n * that has the most space available automatically, without needing to specify a\n * preferred placement. Alternative to `flip`.\n * @see https://floating-ui.com/docs/autoPlacement\n */\nconst autoPlacement = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    name: 'autoPlacement',\n    options,\n    async fn(state) {\n      var _middlewareData$autoP, _middlewareData$autoP2, _placementsThatFitOnE;\n      const {\n        rects,\n        middlewareData,\n        placement,\n        platform,\n        elements\n      } = state;\n      const {\n        crossAxis = false,\n        alignment,\n        allowedPlacements = placements,\n        autoAlignment = true,\n        ...detectOverflowOptions\n      } = evaluate(options, state);\n      const placements$1 = alignment !== undefined || allowedPlacements === placements ? getPlacementList(alignment || null, autoAlignment, allowedPlacements) : allowedPlacements;\n      const overflow = await detectOverflow(state, detectOverflowOptions);\n      const currentIndex = ((_middlewareData$autoP = middlewareData.autoPlacement) == null ? void 0 : _middlewareData$autoP.index) || 0;\n      const currentPlacement = placements$1[currentIndex];\n      if (currentPlacement == null) {\n        return {};\n      }\n      const alignmentSides = getAlignmentSides(currentPlacement, rects, await (platform.isRTL == null ? void 0 : platform.isRTL(elements.floating)));\n\n      // Make `computeCoords` start from the right place.\n      if (placement !== currentPlacement) {\n        return {\n          reset: {\n            placement: placements$1[0]\n          }\n        };\n      }\n      const currentOverflows = [overflow[getSide(currentPlacement)], overflow[alignmentSides[0]], overflow[alignmentSides[1]]];\n      const allOverflows = [...(((_middlewareData$autoP2 = middlewareData.autoPlacement) == null ? void 0 : _middlewareData$autoP2.overflows) || []), {\n        placement: currentPlacement,\n        overflows: currentOverflows\n      }];\n      const nextPlacement = placements$1[currentIndex + 1];\n\n      // There are more placements to check.\n      if (nextPlacement) {\n        return {\n          data: {\n            index: currentIndex + 1,\n            overflows: allOverflows\n          },\n          reset: {\n            placement: nextPlacement\n          }\n        };\n      }\n      const placementsSortedByMostSpace = allOverflows.map(d => {\n        const alignment = getAlignment(d.placement);\n        return [d.placement, alignment && crossAxis ?\n        // Check along the mainAxis and main crossAxis side.\n        d.overflows.slice(0, 2).reduce((acc, v) => acc + v, 0) :\n        // Check only the mainAxis.\n        d.overflows[0], d.overflows];\n      }).sort((a, b) => a[1] - b[1]);\n      const placementsThatFitOnEachSide = placementsSortedByMostSpace.filter(d => d[2].slice(0,\n      // Aligned placements should not check their opposite crossAxis\n      // side.\n      getAlignment(d[0]) ? 2 : 3).every(v => v <= 0));\n      const resetPlacement = ((_placementsThatFitOnE = placementsThatFitOnEachSide[0]) == null ? void 0 : _placementsThatFitOnE[0]) || placementsSortedByMostSpace[0][0];\n      if (resetPlacement !== placement) {\n        return {\n          data: {\n            index: currentIndex + 1,\n            overflows: allOverflows\n          },\n          reset: {\n            placement: resetPlacement\n          }\n        };\n      }\n      return {};\n    }\n  };\n};\n\n/**\n * Optimizes the visibility of the floating element by flipping the `placement`\n * in order to keep it in view when the preferred placement(s) will overflow the\n * clipping boundary. Alternative to `autoPlacement`.\n * @see https://floating-ui.com/docs/flip\n */\nconst flip = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    name: 'flip',\n    options,\n    async fn(state) {\n      var _middlewareData$arrow, _middlewareData$flip;\n      const {\n        placement,\n        middlewareData,\n        rects,\n        initialPlacement,\n        platform,\n        elements\n      } = state;\n      const {\n        mainAxis: checkMainAxis = true,\n        crossAxis: checkCrossAxis = true,\n        fallbackPlacements: specifiedFallbackPlacements,\n        fallbackStrategy = 'bestFit',\n        fallbackAxisSideDirection = 'none',\n        flipAlignment = true,\n        ...detectOverflowOptions\n      } = evaluate(options, state);\n\n      // If a reset by the arrow was caused due to an alignment offset being\n      // added, we should skip any logic now since `flip()` has already done its\n      // work.\n      // https://github.com/floating-ui/floating-ui/issues/2549#issuecomment-1719601643\n      if ((_middlewareData$arrow = middlewareData.arrow) != null && _middlewareData$arrow.alignmentOffset) {\n        return {};\n      }\n      const side = getSide(placement);\n      const initialSideAxis = getSideAxis(initialPlacement);\n      const isBasePlacement = getSide(initialPlacement) === initialPlacement;\n      const rtl = await (platform.isRTL == null ? void 0 : platform.isRTL(elements.floating));\n      const fallbackPlacements = specifiedFallbackPlacements || (isBasePlacement || !flipAlignment ? [getOppositePlacement(initialPlacement)] : getExpandedPlacements(initialPlacement));\n      const hasFallbackAxisSideDirection = fallbackAxisSideDirection !== 'none';\n      if (!specifiedFallbackPlacements && hasFallbackAxisSideDirection) {\n        fallbackPlacements.push(...getOppositeAxisPlacements(initialPlacement, flipAlignment, fallbackAxisSideDirection, rtl));\n      }\n      const placements = [initialPlacement, ...fallbackPlacements];\n      const overflow = await detectOverflow(state, detectOverflowOptions);\n      const overflows = [];\n      let overflowsData = ((_middlewareData$flip = middlewareData.flip) == null ? void 0 : _middlewareData$flip.overflows) || [];\n      if (checkMainAxis) {\n        overflows.push(overflow[side]);\n      }\n      if (checkCrossAxis) {\n        const sides = getAlignmentSides(placement, rects, rtl);\n        overflows.push(overflow[sides[0]], overflow[sides[1]]);\n      }\n      overflowsData = [...overflowsData, {\n        placement,\n        overflows\n      }];\n\n      // One or more sides is overflowing.\n      if (!overflows.every(side => side <= 0)) {\n        var _middlewareData$flip2, _overflowsData$filter;\n        const nextIndex = (((_middlewareData$flip2 = middlewareData.flip) == null ? void 0 : _middlewareData$flip2.index) || 0) + 1;\n        const nextPlacement = placements[nextIndex];\n        if (nextPlacement) {\n          const ignoreCrossAxisOverflow = checkCrossAxis === 'alignment' ? initialSideAxis !== getSideAxis(nextPlacement) : false;\n          if (!ignoreCrossAxisOverflow ||\n          // We leave the current main axis only if every placement on that axis\n          // overflows the main axis.\n          overflowsData.every(d => d.overflows[0] > 0 && getSideAxis(d.placement) === initialSideAxis)) {\n            // Try next placement and re-run the lifecycle.\n            return {\n              data: {\n                index: nextIndex,\n                overflows: overflowsData\n              },\n              reset: {\n                placement: nextPlacement\n              }\n            };\n          }\n        }\n\n        // First, find the candidates that fit on the mainAxis side of overflow,\n        // then find the placement that fits the best on the main crossAxis side.\n        let resetPlacement = (_overflowsData$filter = overflowsData.filter(d => d.overflows[0] <= 0).sort((a, b) => a.overflows[1] - b.overflows[1])[0]) == null ? void 0 : _overflowsData$filter.placement;\n\n        // Otherwise fallback.\n        if (!resetPlacement) {\n          switch (fallbackStrategy) {\n            case 'bestFit':\n              {\n                var _overflowsData$filter2;\n                const placement = (_overflowsData$filter2 = overflowsData.filter(d => {\n                  if (hasFallbackAxisSideDirection) {\n                    const currentSideAxis = getSideAxis(d.placement);\n                    return currentSideAxis === initialSideAxis ||\n                    // Create a bias to the `y` side axis due to horizontal\n                    // reading directions favoring greater width.\n                    currentSideAxis === 'y';\n                  }\n                  return true;\n                }).map(d => [d.placement, d.overflows.filter(overflow => overflow > 0).reduce((acc, overflow) => acc + overflow, 0)]).sort((a, b) => a[1] - b[1])[0]) == null ? void 0 : _overflowsData$filter2[0];\n                if (placement) {\n                  resetPlacement = placement;\n                }\n                break;\n              }\n            case 'initialPlacement':\n              resetPlacement = initialPlacement;\n              break;\n          }\n        }\n        if (placement !== resetPlacement) {\n          return {\n            reset: {\n              placement: resetPlacement\n            }\n          };\n        }\n      }\n      return {};\n    }\n  };\n};\n\nfunction getSideOffsets(overflow, rect) {\n  return {\n    top: overflow.top - rect.height,\n    right: overflow.right - rect.width,\n    bottom: overflow.bottom - rect.height,\n    left: overflow.left - rect.width\n  };\n}\nfunction isAnySideFullyClipped(overflow) {\n  return sides.some(side => overflow[side] >= 0);\n}\n/**\n * Provides data to hide the floating element in applicable situations, such as\n * when it is not in the same clipping context as the reference element.\n * @see https://floating-ui.com/docs/hide\n */\nconst hide = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    name: 'hide',\n    options,\n    async fn(state) {\n      const {\n        rects\n      } = state;\n      const {\n        strategy = 'referenceHidden',\n        ...detectOverflowOptions\n      } = evaluate(options, state);\n      switch (strategy) {\n        case 'referenceHidden':\n          {\n            const overflow = await detectOverflow(state, {\n              ...detectOverflowOptions,\n              elementContext: 'reference'\n            });\n            const offsets = getSideOffsets(overflow, rects.reference);\n            return {\n              data: {\n                referenceHiddenOffsets: offsets,\n                referenceHidden: isAnySideFullyClipped(offsets)\n              }\n            };\n          }\n        case 'escaped':\n          {\n            const overflow = await detectOverflow(state, {\n              ...detectOverflowOptions,\n              altBoundary: true\n            });\n            const offsets = getSideOffsets(overflow, rects.floating);\n            return {\n              data: {\n                escapedOffsets: offsets,\n                escaped: isAnySideFullyClipped(offsets)\n              }\n            };\n          }\n        default:\n          {\n            return {};\n          }\n      }\n    }\n  };\n};\n\nfunction getBoundingRect(rects) {\n  const minX = min(...rects.map(rect => rect.left));\n  const minY = min(...rects.map(rect => rect.top));\n  const maxX = max(...rects.map(rect => rect.right));\n  const maxY = max(...rects.map(rect => rect.bottom));\n  return {\n    x: minX,\n    y: minY,\n    width: maxX - minX,\n    height: maxY - minY\n  };\n}\nfunction getRectsByLine(rects) {\n  const sortedRects = rects.slice().sort((a, b) => a.y - b.y);\n  const groups = [];\n  let prevRect = null;\n  for (let i = 0; i < sortedRects.length; i++) {\n    const rect = sortedRects[i];\n    if (!prevRect || rect.y - prevRect.y > prevRect.height / 2) {\n      groups.push([rect]);\n    } else {\n      groups[groups.length - 1].push(rect);\n    }\n    prevRect = rect;\n  }\n  return groups.map(rect => rectToClientRect(getBoundingRect(rect)));\n}\n/**\n * Provides improved positioning for inline reference elements that can span\n * over multiple lines, such as hyperlinks or range selections.\n * @see https://floating-ui.com/docs/inline\n */\nconst inline = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    name: 'inline',\n    options,\n    async fn(state) {\n      const {\n        placement,\n        elements,\n        rects,\n        platform,\n        strategy\n      } = state;\n      // A MouseEvent's client{X,Y} coords can be up to 2 pixels off a\n      // ClientRect's bounds, despite the event listener being triggered. A\n      // padding of 2 seems to handle this issue.\n      const {\n        padding = 2,\n        x,\n        y\n      } = evaluate(options, state);\n      const nativeClientRects = Array.from((await (platform.getClientRects == null ? void 0 : platform.getClientRects(elements.reference))) || []);\n      const clientRects = getRectsByLine(nativeClientRects);\n      const fallback = rectToClientRect(getBoundingRect(nativeClientRects));\n      const paddingObject = getPaddingObject(padding);\n      function getBoundingClientRect() {\n        // There are two rects and they are disjoined.\n        if (clientRects.length === 2 && clientRects[0].left > clientRects[1].right && x != null && y != null) {\n          // Find the first rect in which the point is fully inside.\n          return clientRects.find(rect => x > rect.left - paddingObject.left && x < rect.right + paddingObject.right && y > rect.top - paddingObject.top && y < rect.bottom + paddingObject.bottom) || fallback;\n        }\n\n        // There are 2 or more connected rects.\n        if (clientRects.length >= 2) {\n          if (getSideAxis(placement) === 'y') {\n            const firstRect = clientRects[0];\n            const lastRect = clientRects[clientRects.length - 1];\n            const isTop = getSide(placement) === 'top';\n            const top = firstRect.top;\n            const bottom = lastRect.bottom;\n            const left = isTop ? firstRect.left : lastRect.left;\n            const right = isTop ? firstRect.right : lastRect.right;\n            const width = right - left;\n            const height = bottom - top;\n            return {\n              top,\n              bottom,\n              left,\n              right,\n              width,\n              height,\n              x: left,\n              y: top\n            };\n          }\n          const isLeftSide = getSide(placement) === 'left';\n          const maxRight = max(...clientRects.map(rect => rect.right));\n          const minLeft = min(...clientRects.map(rect => rect.left));\n          const measureRects = clientRects.filter(rect => isLeftSide ? rect.left === minLeft : rect.right === maxRight);\n          const top = measureRects[0].top;\n          const bottom = measureRects[measureRects.length - 1].bottom;\n          const left = minLeft;\n          const right = maxRight;\n          const width = right - left;\n          const height = bottom - top;\n          return {\n            top,\n            bottom,\n            left,\n            right,\n            width,\n            height,\n            x: left,\n            y: top\n          };\n        }\n        return fallback;\n      }\n      const resetRects = await platform.getElementRects({\n        reference: {\n          getBoundingClientRect\n        },\n        floating: elements.floating,\n        strategy\n      });\n      if (rects.reference.x !== resetRects.reference.x || rects.reference.y !== resetRects.reference.y || rects.reference.width !== resetRects.reference.width || rects.reference.height !== resetRects.reference.height) {\n        return {\n          reset: {\n            rects: resetRects\n          }\n        };\n      }\n      return {};\n    }\n  };\n};\n\nconst originSides = /*#__PURE__*/new Set(['left', 'top']);\n\n// For type backwards-compatibility, the `OffsetOptions` type was also\n// Derivable.\n\nasync function convertValueToCoords(state, options) {\n  const {\n    placement,\n    platform,\n    elements\n  } = state;\n  const rtl = await (platform.isRTL == null ? void 0 : platform.isRTL(elements.floating));\n  const side = getSide(placement);\n  const alignment = getAlignment(placement);\n  const isVertical = getSideAxis(placement) === 'y';\n  const mainAxisMulti = originSides.has(side) ? -1 : 1;\n  const crossAxisMulti = rtl && isVertical ? -1 : 1;\n  const rawValue = evaluate(options, state);\n\n  // eslint-disable-next-line prefer-const\n  let {\n    mainAxis,\n    crossAxis,\n    alignmentAxis\n  } = typeof rawValue === 'number' ? {\n    mainAxis: rawValue,\n    crossAxis: 0,\n    alignmentAxis: null\n  } : {\n    mainAxis: rawValue.mainAxis || 0,\n    crossAxis: rawValue.crossAxis || 0,\n    alignmentAxis: rawValue.alignmentAxis\n  };\n  if (alignment && typeof alignmentAxis === 'number') {\n    crossAxis = alignment === 'end' ? alignmentAxis * -1 : alignmentAxis;\n  }\n  return isVertical ? {\n    x: crossAxis * crossAxisMulti,\n    y: mainAxis * mainAxisMulti\n  } : {\n    x: mainAxis * mainAxisMulti,\n    y: crossAxis * crossAxisMulti\n  };\n}\n\n/**\n * Modifies the placement by translating the floating element along the\n * specified axes.\n * A number (shorthand for `mainAxis` or distance), or an axes configuration\n * object may be passed.\n * @see https://floating-ui.com/docs/offset\n */\nconst offset = function (options) {\n  if (options === void 0) {\n    options = 0;\n  }\n  return {\n    name: 'offset',\n    options,\n    async fn(state) {\n      var _middlewareData$offse, _middlewareData$arrow;\n      const {\n        x,\n        y,\n        placement,\n        middlewareData\n      } = state;\n      const diffCoords = await convertValueToCoords(state, options);\n\n      // If the placement is the same and the arrow caused an alignment offset\n      // then we don't need to change the positioning coordinates.\n      if (placement === ((_middlewareData$offse = middlewareData.offset) == null ? void 0 : _middlewareData$offse.placement) && (_middlewareData$arrow = middlewareData.arrow) != null && _middlewareData$arrow.alignmentOffset) {\n        return {};\n      }\n      return {\n        x: x + diffCoords.x,\n        y: y + diffCoords.y,\n        data: {\n          ...diffCoords,\n          placement\n        }\n      };\n    }\n  };\n};\n\n/**\n * Optimizes the visibility of the floating element by shifting it in order to\n * keep it in view when it will overflow the clipping boundary.\n * @see https://floating-ui.com/docs/shift\n */\nconst shift = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    name: 'shift',\n    options,\n    async fn(state) {\n      const {\n        x,\n        y,\n        placement\n      } = state;\n      const {\n        mainAxis: checkMainAxis = true,\n        crossAxis: checkCrossAxis = false,\n        limiter = {\n          fn: _ref => {\n            let {\n              x,\n              y\n            } = _ref;\n            return {\n              x,\n              y\n            };\n          }\n        },\n        ...detectOverflowOptions\n      } = evaluate(options, state);\n      const coords = {\n        x,\n        y\n      };\n      const overflow = await detectOverflow(state, detectOverflowOptions);\n      const crossAxis = getSideAxis(getSide(placement));\n      const mainAxis = getOppositeAxis(crossAxis);\n      let mainAxisCoord = coords[mainAxis];\n      let crossAxisCoord = coords[crossAxis];\n      if (checkMainAxis) {\n        const minSide = mainAxis === 'y' ? 'top' : 'left';\n        const maxSide = mainAxis === 'y' ? 'bottom' : 'right';\n        const min = mainAxisCoord + overflow[minSide];\n        const max = mainAxisCoord - overflow[maxSide];\n        mainAxisCoord = clamp(min, mainAxisCoord, max);\n      }\n      if (checkCrossAxis) {\n        const minSide = crossAxis === 'y' ? 'top' : 'left';\n        const maxSide = crossAxis === 'y' ? 'bottom' : 'right';\n        const min = crossAxisCoord + overflow[minSide];\n        const max = crossAxisCoord - overflow[maxSide];\n        crossAxisCoord = clamp(min, crossAxisCoord, max);\n      }\n      const limitedCoords = limiter.fn({\n        ...state,\n        [mainAxis]: mainAxisCoord,\n        [crossAxis]: crossAxisCoord\n      });\n      return {\n        ...limitedCoords,\n        data: {\n          x: limitedCoords.x - x,\n          y: limitedCoords.y - y,\n          enabled: {\n            [mainAxis]: checkMainAxis,\n            [crossAxis]: checkCrossAxis\n          }\n        }\n      };\n    }\n  };\n};\n/**\n * Built-in `limiter` that will stop `shift()` at a certain point.\n */\nconst limitShift = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    options,\n    fn(state) {\n      const {\n        x,\n        y,\n        placement,\n        rects,\n        middlewareData\n      } = state;\n      const {\n        offset = 0,\n        mainAxis: checkMainAxis = true,\n        crossAxis: checkCrossAxis = true\n      } = evaluate(options, state);\n      const coords = {\n        x,\n        y\n      };\n      const crossAxis = getSideAxis(placement);\n      const mainAxis = getOppositeAxis(crossAxis);\n      let mainAxisCoord = coords[mainAxis];\n      let crossAxisCoord = coords[crossAxis];\n      const rawOffset = evaluate(offset, state);\n      const computedOffset = typeof rawOffset === 'number' ? {\n        mainAxis: rawOffset,\n        crossAxis: 0\n      } : {\n        mainAxis: 0,\n        crossAxis: 0,\n        ...rawOffset\n      };\n      if (checkMainAxis) {\n        const len = mainAxis === 'y' ? 'height' : 'width';\n        const limitMin = rects.reference[mainAxis] - rects.floating[len] + computedOffset.mainAxis;\n        const limitMax = rects.reference[mainAxis] + rects.reference[len] - computedOffset.mainAxis;\n        if (mainAxisCoord < limitMin) {\n          mainAxisCoord = limitMin;\n        } else if (mainAxisCoord > limitMax) {\n          mainAxisCoord = limitMax;\n        }\n      }\n      if (checkCrossAxis) {\n        var _middlewareData$offse, _middlewareData$offse2;\n        const len = mainAxis === 'y' ? 'width' : 'height';\n        const isOriginSide = originSides.has(getSide(placement));\n        const limitMin = rects.reference[crossAxis] - rects.floating[len] + (isOriginSide ? ((_middlewareData$offse = middlewareData.offset) == null ? void 0 : _middlewareData$offse[crossAxis]) || 0 : 0) + (isOriginSide ? 0 : computedOffset.crossAxis);\n        const limitMax = rects.reference[crossAxis] + rects.reference[len] + (isOriginSide ? 0 : ((_middlewareData$offse2 = middlewareData.offset) == null ? void 0 : _middlewareData$offse2[crossAxis]) || 0) - (isOriginSide ? computedOffset.crossAxis : 0);\n        if (crossAxisCoord < limitMin) {\n          crossAxisCoord = limitMin;\n        } else if (crossAxisCoord > limitMax) {\n          crossAxisCoord = limitMax;\n        }\n      }\n      return {\n        [mainAxis]: mainAxisCoord,\n        [crossAxis]: crossAxisCoord\n      };\n    }\n  };\n};\n\n/**\n * Provides data that allows you to change the size of the floating element \n * for instance, prevent it from overflowing the clipping boundary or match the\n * width of the reference element.\n * @see https://floating-ui.com/docs/size\n */\nconst size = function (options) {\n  if (options === void 0) {\n    options = {};\n  }\n  return {\n    name: 'size',\n    options,\n    async fn(state) {\n      var _state$middlewareData, _state$middlewareData2;\n      const {\n        placement,\n        rects,\n        platform,\n        elements\n      } = state;\n      const {\n        apply = () => {},\n        ...detectOverflowOptions\n      } = evaluate(options, state);\n      const overflow = await detectOverflow(state, detectOverflowOptions);\n      const side = getSide(placement);\n      const alignment = getAlignment(placement);\n      const isYAxis = getSideAxis(placement) === 'y';\n      const {\n        width,\n        height\n      } = rects.floating;\n      let heightSide;\n      let widthSide;\n      if (side === 'top' || side === 'bottom') {\n        heightSide = side;\n        widthSide = alignment === ((await (platform.isRTL == null ? void 0 : platform.isRTL(elements.floating))) ? 'start' : 'end') ? 'left' : 'right';\n      } else {\n        widthSide = side;\n        heightSide = alignment === 'end' ? 'top' : 'bottom';\n      }\n      const maximumClippingHeight = height - overflow.top - overflow.bottom;\n      const maximumClippingWidth = width - overflow.left - overflow.right;\n      const overflowAvailableHeight = min(height - overflow[heightSide], maximumClippingHeight);\n      const overflowAvailableWidth = min(width - overflow[widthSide], maximumClippingWidth);\n      const noShift = !state.middlewareData.shift;\n      let availableHeight = overflowAvailableHeight;\n      let availableWidth = overflowAvailableWidth;\n      if ((_state$middlewareData = state.middlewareData.shift) != null && _state$middlewareData.enabled.x) {\n        availableWidth = maximumClippingWidth;\n      }\n      if ((_state$middlewareData2 = state.middlewareData.shift) != null && _state$middlewareData2.enabled.y) {\n        availableHeight = maximumClippingHeight;\n      }\n      if (noShift && !alignment) {\n        const xMin = max(overflow.left, 0);\n        const xMax = max(overflow.right, 0);\n        const yMin = max(overflow.top, 0);\n        const yMax = max(overflow.bottom, 0);\n        if (isYAxis) {\n          availableWidth = width - 2 * (xMin !== 0 || xMax !== 0 ? xMin + xMax : max(overflow.left, overflow.right));\n        } else {\n          availableHeight = height - 2 * (yMin !== 0 || yMax !== 0 ? yMin + yMax : max(overflow.top, overflow.bottom));\n        }\n      }\n      await apply({\n        ...state,\n        availableWidth,\n        availableHeight\n      });\n      const nextDimensions = await platform.getDimensions(elements.floating);\n      if (width !== nextDimensions.width || height !== nextDimensions.height) {\n        return {\n          reset: {\n            rects: true\n          }\n        };\n      }\n      return {};\n    }\n  };\n};\n\nexport { arrow, autoPlacement, computePosition, detectOverflow, flip, hide, inline, limitShift, offset, shift, size };\n","function hasWindow() {\n  return typeof window !== 'undefined';\n}\nfunction getNodeName(node) {\n  if (isNode(node)) {\n    return (node.nodeName || '').toLowerCase();\n  }\n  // Mocked nodes in testing environments may not be instances of Node. By\n  // returning `#document` an infinite loop won't occur.\n  // https://github.com/floating-ui/floating-ui/issues/2317\n  return '#document';\n}\nfunction getWindow(node) {\n  var _node$ownerDocument;\n  return (node == null || (_node$ownerDocument = node.ownerDocument) == null ? void 0 : _node$ownerDocument.defaultView) || window;\n}\nfunction getDocumentElement(node) {\n  var _ref;\n  return (_ref = (isNode(node) ? node.ownerDocument : node.document) || window.document) == null ? void 0 : _ref.documentElement;\n}\nfunction isNode(value) {\n  if (!hasWindow()) {\n    return false;\n  }\n  return value instanceof Node || value instanceof getWindow(value).Node;\n}\nfunction isElement(value) {\n  if (!hasWindow()) {\n    return false;\n  }\n  return value instanceof Element || value instanceof getWindow(value).Element;\n}\nfunction isHTMLElement(value) {\n  if (!hasWindow()) {\n    return false;\n  }\n  return value instanceof HTMLElement || value instanceof getWindow(value).HTMLElement;\n}\nfunction isShadowRoot(value) {\n  if (!hasWindow() || typeof ShadowRoot === 'undefined') {\n    return false;\n  }\n  return value instanceof ShadowRoot || value instanceof getWindow(value).ShadowRoot;\n}\nconst invalidOverflowDisplayValues = /*#__PURE__*/new Set(['inline', 'contents']);\nfunction isOverflowElement(element) {\n  const {\n    overflow,\n    overflowX,\n    overflowY,\n    display\n  } = getComputedStyle(element);\n  return /auto|scroll|overlay|hidden|clip/.test(overflow + overflowY + overflowX) && !invalidOverflowDisplayValues.has(display);\n}\nconst tableElements = /*#__PURE__*/new Set(['table', 'td', 'th']);\nfunction isTableElement(element) {\n  return tableElements.has(getNodeName(element));\n}\nconst topLayerSelectors = [':popover-open', ':modal'];\nfunction isTopLayer(element) {\n  return topLayerSelectors.some(selector => {\n    try {\n      return element.matches(selector);\n    } catch (_e) {\n      return false;\n    }\n  });\n}\nconst transformProperties = ['transform', 'translate', 'scale', 'rotate', 'perspective'];\nconst willChangeValues = ['transform', 'translate', 'scale', 'rotate', 'perspective', 'filter'];\nconst containValues = ['paint', 'layout', 'strict', 'content'];\nfunction isContainingBlock(elementOrCss) {\n  const webkit = isWebKit();\n  const css = isElement(elementOrCss) ? getComputedStyle(elementOrCss) : elementOrCss;\n\n  // https://developer.mozilla.org/en-US/docs/Web/CSS/Containing_block#identifying_the_containing_block\n  // https://drafts.csswg.org/css-transforms-2/#individual-transforms\n  return transformProperties.some(value => css[value] ? css[value] !== 'none' : false) || (css.containerType ? css.containerType !== 'normal' : false) || !webkit && (css.backdropFilter ? css.backdropFilter !== 'none' : false) || !webkit && (css.filter ? css.filter !== 'none' : false) || willChangeValues.some(value => (css.willChange || '').includes(value)) || containValues.some(value => (css.contain || '').includes(value));\n}\nfunction getContainingBlock(element) {\n  let currentNode = getParentNode(element);\n  while (isHTMLElement(currentNode) && !isLastTraversableNode(currentNode)) {\n    if (isContainingBlock(currentNode)) {\n      return currentNode;\n    } else if (isTopLayer(currentNode)) {\n      return null;\n    }\n    currentNode = getParentNode(currentNode);\n  }\n  return null;\n}\nfunction isWebKit() {\n  if (typeof CSS === 'undefined' || !CSS.supports) return false;\n  return CSS.supports('-webkit-backdrop-filter', 'none');\n}\nconst lastTraversableNodeNames = /*#__PURE__*/new Set(['html', 'body', '#document']);\nfunction isLastTraversableNode(node) {\n  return lastTraversableNodeNames.has(getNodeName(node));\n}\nfunction getComputedStyle(element) {\n  return getWindow(element).getComputedStyle(element);\n}\nfunction getNodeScroll(element) {\n  if (isElement(element)) {\n    return {\n      scrollLeft: element.scrollLeft,\n      scrollTop: element.scrollTop\n    };\n  }\n  return {\n    scrollLeft: element.scrollX,\n    scrollTop: element.scrollY\n  };\n}\nfunction getParentNode(node) {\n  if (getNodeName(node) === 'html') {\n    return node;\n  }\n  const result =\n  // Step into the shadow DOM of the parent of a slotted node.\n  node.assignedSlot ||\n  // DOM Element detected.\n  node.parentNode ||\n  // ShadowRoot detected.\n  isShadowRoot(node) && node.host ||\n  // Fallback.\n  getDocumentElement(node);\n  return isShadowRoot(result) ? result.host : result;\n}\nfunction getNearestOverflowAncestor(node) {\n  const parentNode = getParentNode(node);\n  if (isLastTraversableNode(parentNode)) {\n    return node.ownerDocument ? node.ownerDocument.body : node.body;\n  }\n  if (isHTMLElement(parentNode) && isOverflowElement(parentNode)) {\n    return parentNode;\n  }\n  return getNearestOverflowAncestor(parentNode);\n}\nfunction getOverflowAncestors(node, list, traverseIframes) {\n  var _node$ownerDocument2;\n  if (list === void 0) {\n    list = [];\n  }\n  if (traverseIframes === void 0) {\n    traverseIframes = true;\n  }\n  const scrollableAncestor = getNearestOverflowAncestor(node);\n  const isBody = scrollableAncestor === ((_node$ownerDocument2 = node.ownerDocument) == null ? void 0 : _node$ownerDocument2.body);\n  const win = getWindow(scrollableAncestor);\n  if (isBody) {\n    const frameElement = getFrameElement(win);\n    return list.concat(win, win.visualViewport || [], isOverflowElement(scrollableAncestor) ? scrollableAncestor : [], frameElement && traverseIframes ? getOverflowAncestors(frameElement) : []);\n  }\n  return list.concat(scrollableAncestor, getOverflowAncestors(scrollableAncestor, [], traverseIframes));\n}\nfunction getFrameElement(win) {\n  return win.parent && Object.getPrototypeOf(win.parent) ? win.frameElement : null;\n}\n\nexport { getComputedStyle, getContainingBlock, getDocumentElement, getFrameElement, getNearestOverflowAncestor, getNodeName, getNodeScroll, getOverflowAncestors, getParentNode, getWindow, isContainingBlock, isElement, isHTMLElement, isLastTraversableNode, isNode, isOverflowElement, isShadowRoot, isTableElement, isTopLayer, isWebKit };\n","import { rectToClientRect, arrow as arrow$1, autoPlacement as autoPlacement$1, detectOverflow as detectOverflow$1, flip as flip$1, hide as hide$1, inline as inline$1, limitShift as limitShift$1, offset as offset$1, shift as shift$1, size as size$1, computePosition as computePosition$1 } from '@floating-ui/core';\nimport { round, createCoords, max, min, floor } from '@floating-ui/utils';\nimport { getComputedStyle, isHTMLElement, isElement, getWindow, isWebKit, getFrameElement, getNodeScroll, getDocumentElement, isTopLayer, getNodeName, isOverflowElement, getOverflowAncestors, getParentNode, isLastTraversableNode, isContainingBlock, isTableElement, getContainingBlock } from '@floating-ui/utils/dom';\nexport { getOverflowAncestors } from '@floating-ui/utils/dom';\n\nfunction getCssDimensions(element) {\n  const css = getComputedStyle(element);\n  // In testing environments, the `width` and `height` properties are empty\n  // strings for SVG elements, returning NaN. Fallback to `0` in this case.\n  let width = parseFloat(css.width) || 0;\n  let height = parseFloat(css.height) || 0;\n  const hasOffset = isHTMLElement(element);\n  const offsetWidth = hasOffset ? element.offsetWidth : width;\n  const offsetHeight = hasOffset ? element.offsetHeight : height;\n  const shouldFallback = round(width) !== offsetWidth || round(height) !== offsetHeight;\n  if (shouldFallback) {\n    width = offsetWidth;\n    height = offsetHeight;\n  }\n  return {\n    width,\n    height,\n    $: shouldFallback\n  };\n}\n\nfunction unwrapElement(element) {\n  return !isElement(element) ? element.contextElement : element;\n}\n\nfunction getScale(element) {\n  const domElement = unwrapElement(element);\n  if (!isHTMLElement(domElement)) {\n    return createCoords(1);\n  }\n  const rect = domElement.getBoundingClientRect();\n  const {\n    width,\n    height,\n    $\n  } = getCssDimensions(domElement);\n  let x = ($ ? round(rect.width) : rect.width) / width;\n  let y = ($ ? round(rect.height) : rect.height) / height;\n\n  // 0, NaN, or Infinity should always fallback to 1.\n\n  if (!x || !Number.isFinite(x)) {\n    x = 1;\n  }\n  if (!y || !Number.isFinite(y)) {\n    y = 1;\n  }\n  return {\n    x,\n    y\n  };\n}\n\nconst noOffsets = /*#__PURE__*/createCoords(0);\nfunction getVisualOffsets(element) {\n  const win = getWindow(element);\n  if (!isWebKit() || !win.visualViewport) {\n    return noOffsets;\n  }\n  return {\n    x: win.visualViewport.offsetLeft,\n    y: win.visualViewport.offsetTop\n  };\n}\nfunction shouldAddVisualOffsets(element, isFixed, floatingOffsetParent) {\n  if (isFixed === void 0) {\n    isFixed = false;\n  }\n  if (!floatingOffsetParent || isFixed && floatingOffsetParent !== getWindow(element)) {\n    return false;\n  }\n  return isFixed;\n}\n\nfunction getBoundingClientRect(element, includeScale, isFixedStrategy, offsetParent) {\n  if (includeScale === void 0) {\n    includeScale = false;\n  }\n  if (isFixedStrategy === void 0) {\n    isFixedStrategy = false;\n  }\n  const clientRect = element.getBoundingClientRect();\n  const domElement = unwrapElement(element);\n  let scale = createCoords(1);\n  if (includeScale) {\n    if (offsetParent) {\n      if (isElement(offsetParent)) {\n        scale = getScale(offsetParent);\n      }\n    } else {\n      scale = getScale(element);\n    }\n  }\n  const visualOffsets = shouldAddVisualOffsets(domElement, isFixedStrategy, offsetParent) ? getVisualOffsets(domElement) : createCoords(0);\n  let x = (clientRect.left + visualOffsets.x) / scale.x;\n  let y = (clientRect.top + visualOffsets.y) / scale.y;\n  let width = clientRect.width / scale.x;\n  let height = clientRect.height / scale.y;\n  if (domElement) {\n    const win = getWindow(domElement);\n    const offsetWin = offsetParent && isElement(offsetParent) ? getWindow(offsetParent) : offsetParent;\n    let currentWin = win;\n    let currentIFrame = getFrameElement(currentWin);\n    while (currentIFrame && offsetParent && offsetWin !== currentWin) {\n      const iframeScale = getScale(currentIFrame);\n      const iframeRect = currentIFrame.getBoundingClientRect();\n      const css = getComputedStyle(currentIFrame);\n      const left = iframeRect.left + (currentIFrame.clientLeft + parseFloat(css.paddingLeft)) * iframeScale.x;\n      const top = iframeRect.top + (currentIFrame.clientTop + parseFloat(css.paddingTop)) * iframeScale.y;\n      x *= iframeScale.x;\n      y *= iframeScale.y;\n      width *= iframeScale.x;\n      height *= iframeScale.y;\n      x += left;\n      y += top;\n      currentWin = getWindow(currentIFrame);\n      currentIFrame = getFrameElement(currentWin);\n    }\n  }\n  return rectToClientRect({\n    width,\n    height,\n    x,\n    y\n  });\n}\n\n// If <html> has a CSS width greater than the viewport, then this will be\n// incorrect for RTL.\nfunction getWindowScrollBarX(element, rect) {\n  const leftScroll = getNodeScroll(element).scrollLeft;\n  if (!rect) {\n    return getBoundingClientRect(getDocumentElement(element)).left + leftScroll;\n  }\n  return rect.left + leftScroll;\n}\n\nfunction getHTMLOffset(documentElement, scroll, ignoreScrollbarX) {\n  if (ignoreScrollbarX === void 0) {\n    ignoreScrollbarX = false;\n  }\n  const htmlRect = documentElement.getBoundingClientRect();\n  const x = htmlRect.left + scroll.scrollLeft - (ignoreScrollbarX ? 0 :\n  // RTL <body> scrollbar.\n  getWindowScrollBarX(documentElement, htmlRect));\n  const y = htmlRect.top + scroll.scrollTop;\n  return {\n    x,\n    y\n  };\n}\n\nfunction convertOffsetParentRelativeRectToViewportRelativeRect(_ref) {\n  let {\n    elements,\n    rect,\n    offsetParent,\n    strategy\n  } = _ref;\n  const isFixed = strategy === 'fixed';\n  const documentElement = getDocumentElement(offsetParent);\n  const topLayer = elements ? isTopLayer(elements.floating) : false;\n  if (offsetParent === documentElement || topLayer && isFixed) {\n    return rect;\n  }\n  let scroll = {\n    scrollLeft: 0,\n    scrollTop: 0\n  };\n  let scale = createCoords(1);\n  const offsets = createCoords(0);\n  const isOffsetParentAnElement = isHTMLElement(offsetParent);\n  if (isOffsetParentAnElement || !isOffsetParentAnElement && !isFixed) {\n    if (getNodeName(offsetParent) !== 'body' || isOverflowElement(documentElement)) {\n      scroll = getNodeScroll(offsetParent);\n    }\n    if (isHTMLElement(offsetParent)) {\n      const offsetRect = getBoundingClientRect(offsetParent);\n      scale = getScale(offsetParent);\n      offsets.x = offsetRect.x + offsetParent.clientLeft;\n      offsets.y = offsetRect.y + offsetParent.clientTop;\n    }\n  }\n  const htmlOffset = documentElement && !isOffsetParentAnElement && !isFixed ? getHTMLOffset(documentElement, scroll, true) : createCoords(0);\n  return {\n    width: rect.width * scale.x,\n    height: rect.height * scale.y,\n    x: rect.x * scale.x - scroll.scrollLeft * scale.x + offsets.x + htmlOffset.x,\n    y: rect.y * scale.y - scroll.scrollTop * scale.y + offsets.y + htmlOffset.y\n  };\n}\n\nfunction getClientRects(element) {\n  return Array.from(element.getClientRects());\n}\n\n// Gets the entire size of the scrollable document area, even extending outside\n// of the `<html>` and `<body>` rect bounds if horizontally scrollable.\nfunction getDocumentRect(element) {\n  const html = getDocumentElement(element);\n  const scroll = getNodeScroll(element);\n  const body = element.ownerDocument.body;\n  const width = max(html.scrollWidth, html.clientWidth, body.scrollWidth, body.clientWidth);\n  const height = max(html.scrollHeight, html.clientHeight, body.scrollHeight, body.clientHeight);\n  let x = -scroll.scrollLeft + getWindowScrollBarX(element);\n  const y = -scroll.scrollTop;\n  if (getComputedStyle(body).direction === 'rtl') {\n    x += max(html.clientWidth, body.clientWidth) - width;\n  }\n  return {\n    width,\n    height,\n    x,\n    y\n  };\n}\n\nfunction getViewportRect(element, strategy) {\n  const win = getWindow(element);\n  const html = getDocumentElement(element);\n  const visualViewport = win.visualViewport;\n  let width = html.clientWidth;\n  let height = html.clientHeight;\n  let x = 0;\n  let y = 0;\n  if (visualViewport) {\n    width = visualViewport.width;\n    height = visualViewport.height;\n    const visualViewportBased = isWebKit();\n    if (!visualViewportBased || visualViewportBased && strategy === 'fixed') {\n      x = visualViewport.offsetLeft;\n      y = visualViewport.offsetTop;\n    }\n  }\n  return {\n    width,\n    height,\n    x,\n    y\n  };\n}\n\nconst absoluteOrFixed = /*#__PURE__*/new Set(['absolute', 'fixed']);\n// Returns the inner client rect, subtracting scrollbars if present.\nfunction getInnerBoundingClientRect(element, strategy) {\n  const clientRect = getBoundingClientRect(element, true, strategy === 'fixed');\n  const top = clientRect.top + element.clientTop;\n  const left = clientRect.left + element.clientLeft;\n  const scale = isHTMLElement(element) ? getScale(element) : createCoords(1);\n  const width = element.clientWidth * scale.x;\n  const height = element.clientHeight * scale.y;\n  const x = left * scale.x;\n  const y = top * scale.y;\n  return {\n    width,\n    height,\n    x,\n    y\n  };\n}\nfunction getClientRectFromClippingAncestor(element, clippingAncestor, strategy) {\n  let rect;\n  if (clippingAncestor === 'viewport') {\n    rect = getViewportRect(element, strategy);\n  } else if (clippingAncestor === 'document') {\n    rect = getDocumentRect(getDocumentElement(element));\n  } else if (isElement(clippingAncestor)) {\n    rect = getInnerBoundingClientRect(clippingAncestor, strategy);\n  } else {\n    const visualOffsets = getVisualOffsets(element);\n    rect = {\n      x: clippingAncestor.x - visualOffsets.x,\n      y: clippingAncestor.y - visualOffsets.y,\n      width: clippingAncestor.width,\n      height: clippingAncestor.height\n    };\n  }\n  return rectToClientRect(rect);\n}\nfunction hasFixedPositionAncestor(element, stopNode) {\n  const parentNode = getParentNode(element);\n  if (parentNode === stopNode || !isElement(parentNode) || isLastTraversableNode(parentNode)) {\n    return false;\n  }\n  return getComputedStyle(parentNode).position === 'fixed' || hasFixedPositionAncestor(parentNode, stopNode);\n}\n\n// A \"clipping ancestor\" is an `overflow` element with the characteristic of\n// clipping (or hiding) child elements. This returns all clipping ancestors\n// of the given element up the tree.\nfunction getClippingElementAncestors(element, cache) {\n  const cachedResult = cache.get(element);\n  if (cachedResult) {\n    return cachedResult;\n  }\n  let result = getOverflowAncestors(element, [], false).filter(el => isElement(el) && getNodeName(el) !== 'body');\n  let currentContainingBlockComputedStyle = null;\n  const elementIsFixed = getComputedStyle(element).position === 'fixed';\n  let currentNode = elementIsFixed ? getParentNode(element) : element;\n\n  // https://developer.mozilla.org/en-US/docs/Web/CSS/Containing_block#identifying_the_containing_block\n  while (isElement(currentNode) && !isLastTraversableNode(currentNode)) {\n    const computedStyle = getComputedStyle(currentNode);\n    const currentNodeIsContaining = isContainingBlock(currentNode);\n    if (!currentNodeIsContaining && computedStyle.position === 'fixed') {\n      currentContainingBlockComputedStyle = null;\n    }\n    const shouldDropCurrentNode = elementIsFixed ? !currentNodeIsContaining && !currentContainingBlockComputedStyle : !currentNodeIsContaining && computedStyle.position === 'static' && !!currentContainingBlockComputedStyle && absoluteOrFixed.has(currentContainingBlockComputedStyle.position) || isOverflowElement(currentNode) && !currentNodeIsContaining && hasFixedPositionAncestor(element, currentNode);\n    if (shouldDropCurrentNode) {\n      // Drop non-containing blocks.\n      result = result.filter(ancestor => ancestor !== currentNode);\n    } else {\n      // Record last containing block for next iteration.\n      currentContainingBlockComputedStyle = computedStyle;\n    }\n    currentNode = getParentNode(currentNode);\n  }\n  cache.set(element, result);\n  return result;\n}\n\n// Gets the maximum area that the element is visible in due to any number of\n// clipping ancestors.\nfunction getClippingRect(_ref) {\n  let {\n    element,\n    boundary,\n    rootBoundary,\n    strategy\n  } = _ref;\n  const elementClippingAncestors = boundary === 'clippingAncestors' ? isTopLayer(element) ? [] : getClippingElementAncestors(element, this._c) : [].concat(boundary);\n  const clippingAncestors = [...elementClippingAncestors, rootBoundary];\n  const firstClippingAncestor = clippingAncestors[0];\n  const clippingRect = clippingAncestors.reduce((accRect, clippingAncestor) => {\n    const rect = getClientRectFromClippingAncestor(element, clippingAncestor, strategy);\n    accRect.top = max(rect.top, accRect.top);\n    accRect.right = min(rect.right, accRect.right);\n    accRect.bottom = min(rect.bottom, accRect.bottom);\n    accRect.left = max(rect.left, accRect.left);\n    return accRect;\n  }, getClientRectFromClippingAncestor(element, firstClippingAncestor, strategy));\n  return {\n    width: clippingRect.right - clippingRect.left,\n    height: clippingRect.bottom - clippingRect.top,\n    x: clippingRect.left,\n    y: clippingRect.top\n  };\n}\n\nfunction getDimensions(element) {\n  const {\n    width,\n    height\n  } = getCssDimensions(element);\n  return {\n    width,\n    height\n  };\n}\n\nfunction getRectRelativeToOffsetParent(element, offsetParent, strategy) {\n  const isOffsetParentAnElement = isHTMLElement(offsetParent);\n  const documentElement = getDocumentElement(offsetParent);\n  const isFixed = strategy === 'fixed';\n  const rect = getBoundingClientRect(element, true, isFixed, offsetParent);\n  let scroll = {\n    scrollLeft: 0,\n    scrollTop: 0\n  };\n  const offsets = createCoords(0);\n\n  // If the <body> scrollbar appears on the left (e.g. RTL systems). Use\n  // Firefox with layout.scrollbar.side = 3 in about:config to test this.\n  function setLeftRTLScrollbarOffset() {\n    offsets.x = getWindowScrollBarX(documentElement);\n  }\n  if (isOffsetParentAnElement || !isOffsetParentAnElement && !isFixed) {\n    if (getNodeName(offsetParent) !== 'body' || isOverflowElement(documentElement)) {\n      scroll = getNodeScroll(offsetParent);\n    }\n    if (isOffsetParentAnElement) {\n      const offsetRect = getBoundingClientRect(offsetParent, true, isFixed, offsetParent);\n      offsets.x = offsetRect.x + offsetParent.clientLeft;\n      offsets.y = offsetRect.y + offsetParent.clientTop;\n    } else if (documentElement) {\n      setLeftRTLScrollbarOffset();\n    }\n  }\n  if (isFixed && !isOffsetParentAnElement && documentElement) {\n    setLeftRTLScrollbarOffset();\n  }\n  const htmlOffset = documentElement && !isOffsetParentAnElement && !isFixed ? getHTMLOffset(documentElement, scroll) : createCoords(0);\n  const x = rect.left + scroll.scrollLeft - offsets.x - htmlOffset.x;\n  const y = rect.top + scroll.scrollTop - offsets.y - htmlOffset.y;\n  return {\n    x,\n    y,\n    width: rect.width,\n    height: rect.height\n  };\n}\n\nfunction isStaticPositioned(element) {\n  return getComputedStyle(element).position === 'static';\n}\n\nfunction getTrueOffsetParent(element, polyfill) {\n  if (!isHTMLElement(element) || getComputedStyle(element).position === 'fixed') {\n    return null;\n  }\n  if (polyfill) {\n    return polyfill(element);\n  }\n  let rawOffsetParent = element.offsetParent;\n\n  // Firefox returns the <html> element as the offsetParent if it's non-static,\n  // while Chrome and Safari return the <body> element. The <body> element must\n  // be used to perform the correct calculations even if the <html> element is\n  // non-static.\n  if (getDocumentElement(element) === rawOffsetParent) {\n    rawOffsetParent = rawOffsetParent.ownerDocument.body;\n  }\n  return rawOffsetParent;\n}\n\n// Gets the closest ancestor positioned element. Handles some edge cases,\n// such as table ancestors and cross browser bugs.\nfunction getOffsetParent(element, polyfill) {\n  const win = getWindow(element);\n  if (isTopLayer(element)) {\n    return win;\n  }\n  if (!isHTMLElement(element)) {\n    let svgOffsetParent = getParentNode(element);\n    while (svgOffsetParent && !isLastTraversableNode(svgOffsetParent)) {\n      if (isElement(svgOffsetParent) && !isStaticPositioned(svgOffsetParent)) {\n        return svgOffsetParent;\n      }\n      svgOffsetParent = getParentNode(svgOffsetParent);\n    }\n    return win;\n  }\n  let offsetParent = getTrueOffsetParent(element, polyfill);\n  while (offsetParent && isTableElement(offsetParent) && isStaticPositioned(offsetParent)) {\n    offsetParent = getTrueOffsetParent(offsetParent, polyfill);\n  }\n  if (offsetParent && isLastTraversableNode(offsetParent) && isStaticPositioned(offsetParent) && !isContainingBlock(offsetParent)) {\n    return win;\n  }\n  return offsetParent || getContainingBlock(element) || win;\n}\n\nconst getElementRects = async function (data) {\n  const getOffsetParentFn = this.getOffsetParent || getOffsetParent;\n  const getDimensionsFn = this.getDimensions;\n  const floatingDimensions = await getDimensionsFn(data.floating);\n  return {\n    reference: getRectRelativeToOffsetParent(data.reference, await getOffsetParentFn(data.floating), data.strategy),\n    floating: {\n      x: 0,\n      y: 0,\n      width: floatingDimensions.width,\n      height: floatingDimensions.height\n    }\n  };\n};\n\nfunction isRTL(element) {\n  return getComputedStyle(element).direction === 'rtl';\n}\n\nconst platform = {\n  convertOffsetParentRelativeRectToViewportRelativeRect,\n  getDocumentElement,\n  getClippingRect,\n  getOffsetParent,\n  getElementRects,\n  getClientRects,\n  getDimensions,\n  getScale,\n  isElement,\n  isRTL\n};\n\nfunction rectsAreEqual(a, b) {\n  return a.x === b.x && a.y === b.y && a.width === b.width && a.height === b.height;\n}\n\n// https://samthor.au/2021/observing-dom/\nfunction observeMove(element, onMove) {\n  let io = null;\n  let timeoutId;\n  const root = getDocumentElement(element);\n  function cleanup() {\n    var _io;\n    clearTimeout(timeoutId);\n    (_io = io) == null || _io.disconnect();\n    io = null;\n  }\n  function refresh(skip, threshold) {\n    if (skip === void 0) {\n      skip = false;\n    }\n    if (threshold === void 0) {\n      threshold = 1;\n    }\n    cleanup();\n    const elementRectForRootMargin = element.getBoundingClientRect();\n    const {\n      left,\n      top,\n      width,\n      height\n    } = elementRectForRootMargin;\n    if (!skip) {\n      onMove();\n    }\n    if (!width || !height) {\n      return;\n    }\n    const insetTop = floor(top);\n    const insetRight = floor(root.clientWidth - (left + width));\n    const insetBottom = floor(root.clientHeight - (top + height));\n    const insetLeft = floor(left);\n    const rootMargin = -insetTop + \"px \" + -insetRight + \"px \" + -insetBottom + \"px \" + -insetLeft + \"px\";\n    const options = {\n      rootMargin,\n      threshold: max(0, min(1, threshold)) || 1\n    };\n    let isFirstUpdate = true;\n    function handleObserve(entries) {\n      const ratio = entries[0].intersectionRatio;\n      if (ratio !== threshold) {\n        if (!isFirstUpdate) {\n          return refresh();\n        }\n        if (!ratio) {\n          // If the reference is clipped, the ratio is 0. Throttle the refresh\n          // to prevent an infinite loop of updates.\n          timeoutId = setTimeout(() => {\n            refresh(false, 1e-7);\n          }, 1000);\n        } else {\n          refresh(false, ratio);\n        }\n      }\n      if (ratio === 1 && !rectsAreEqual(elementRectForRootMargin, element.getBoundingClientRect())) {\n        // It's possible that even though the ratio is reported as 1, the\n        // element is not actually fully within the IntersectionObserver's root\n        // area anymore. This can happen under performance constraints. This may\n        // be a bug in the browser's IntersectionObserver implementation. To\n        // work around this, we compare the element's bounding rect now with\n        // what it was at the time we created the IntersectionObserver. If they\n        // are not equal then the element moved, so we refresh.\n        refresh();\n      }\n      isFirstUpdate = false;\n    }\n\n    // Older browsers don't support a `document` as the root and will throw an\n    // error.\n    try {\n      io = new IntersectionObserver(handleObserve, {\n        ...options,\n        // Handle <iframe>s\n        root: root.ownerDocument\n      });\n    } catch (_e) {\n      io = new IntersectionObserver(handleObserve, options);\n    }\n    io.observe(element);\n  }\n  refresh(true);\n  return cleanup;\n}\n\n/**\n * Automatically updates the position of the floating element when necessary.\n * Should only be called when the floating element is mounted on the DOM or\n * visible on the screen.\n * @returns cleanup function that should be invoked when the floating element is\n * removed from the DOM or hidden from the screen.\n * @see https://floating-ui.com/docs/autoUpdate\n */\nfunction autoUpdate(reference, floating, update, options) {\n  if (options === void 0) {\n    options = {};\n  }\n  const {\n    ancestorScroll = true,\n    ancestorResize = true,\n    elementResize = typeof ResizeObserver === 'function',\n    layoutShift = typeof IntersectionObserver === 'function',\n    animationFrame = false\n  } = options;\n  const referenceEl = unwrapElement(reference);\n  const ancestors = ancestorScroll || ancestorResize ? [...(referenceEl ? getOverflowAncestors(referenceEl) : []), ...getOverflowAncestors(floating)] : [];\n  ancestors.forEach(ancestor => {\n    ancestorScroll && ancestor.addEventListener('scroll', update, {\n      passive: true\n    });\n    ancestorResize && ancestor.addEventListener('resize', update);\n  });\n  const cleanupIo = referenceEl && layoutShift ? observeMove(referenceEl, update) : null;\n  let reobserveFrame = -1;\n  let resizeObserver = null;\n  if (elementResize) {\n    resizeObserver = new ResizeObserver(_ref => {\n      let [firstEntry] = _ref;\n      if (firstEntry && firstEntry.target === referenceEl && resizeObserver) {\n        // Prevent update loops when using the `size` middleware.\n        // https://github.com/floating-ui/floating-ui/issues/1740\n        resizeObserver.unobserve(floating);\n        cancelAnimationFrame(reobserveFrame);\n        reobserveFrame = requestAnimationFrame(() => {\n          var _resizeObserver;\n          (_resizeObserver = resizeObserver) == null || _resizeObserver.observe(floating);\n        });\n      }\n      update();\n    });\n    if (referenceEl && !animationFrame) {\n      resizeObserver.observe(referenceEl);\n    }\n    resizeObserver.observe(floating);\n  }\n  let frameId;\n  let prevRefRect = animationFrame ? getBoundingClientRect(reference) : null;\n  if (animationFrame) {\n    frameLoop();\n  }\n  function frameLoop() {\n    const nextRefRect = getBoundingClientRect(reference);\n    if (prevRefRect && !rectsAreEqual(prevRefRect, nextRefRect)) {\n      update();\n    }\n    prevRefRect = nextRefRect;\n    frameId = requestAnimationFrame(frameLoop);\n  }\n  update();\n  return () => {\n    var _resizeObserver2;\n    ancestors.forEach(ancestor => {\n      ancestorScroll && ancestor.removeEventListener('scroll', update);\n      ancestorResize && ancestor.removeEventListener('resize', update);\n    });\n    cleanupIo == null || cleanupIo();\n    (_resizeObserver2 = resizeObserver) == null || _resizeObserver2.disconnect();\n    resizeObserver = null;\n    if (animationFrame) {\n      cancelAnimationFrame(frameId);\n    }\n  };\n}\n\n/**\n * Resolves with an object of overflow side offsets that determine how much the\n * element is overflowing a given clipping boundary on each side.\n * - positive = overflowing the boundary by that number of pixels\n * - negative = how many pixels left before it will overflow\n * - 0 = lies flush with the boundary\n * @see https://floating-ui.com/docs/detectOverflow\n */\nconst detectOverflow = detectOverflow$1;\n\n/**\n * Modifies the placement by translating the floating element along the\n * specified axes.\n * A number (shorthand for `mainAxis` or distance), or an axes configuration\n * object may be passed.\n * @see https://floating-ui.com/docs/offset\n */\nconst offset = offset$1;\n\n/**\n * Optimizes the visibility of the floating element by choosing the placement\n * that has the most space available automatically, without needing to specify a\n * preferred placement. Alternative to `flip`.\n * @see https://floating-ui.com/docs/autoPlacement\n */\nconst autoPlacement = autoPlacement$1;\n\n/**\n * Optimizes the visibility of the floating element by shifting it in order to\n * keep it in view when it will overflow the clipping boundary.\n * @see https://floating-ui.com/docs/shift\n */\nconst shift = shift$1;\n\n/**\n * Optimizes the visibility of the floating element by flipping the `placement`\n * in order to keep it in view when the preferred placement(s) will overflow the\n * clipping boundary. Alternative to `autoPlacement`.\n * @see https://floating-ui.com/docs/flip\n */\nconst flip = flip$1;\n\n/**\n * Provides data that allows you to change the size of the floating element \n * for instance, prevent it from overflowing the clipping boundary or match the\n * width of the reference element.\n * @see https://floating-ui.com/docs/size\n */\nconst size = size$1;\n\n/**\n * Provides data to hide the floating element in applicable situations, such as\n * when it is not in the same clipping context as the reference element.\n * @see https://floating-ui.com/docs/hide\n */\nconst hide = hide$1;\n\n/**\n * Provides data to position an inner element of the floating element so that it\n * appears centered to the reference element.\n * @see https://floating-ui.com/docs/arrow\n */\nconst arrow = arrow$1;\n\n/**\n * Provides improved positioning for inline reference elements that can span\n * over multiple lines, such as hyperlinks or range selections.\n * @see https://floating-ui.com/docs/inline\n */\nconst inline = inline$1;\n\n/**\n * Built-in `limiter` that will stop `shift()` at a certain point.\n */\nconst limitShift = limitShift$1;\n\n/**\n * Computes the `x` and `y` coordinates that will place the floating element\n * next to a given reference element.\n */\nconst computePosition = (reference, floating, options) => {\n  // This caches the expensive `getClippingElementAncestors` function so that\n  // multiple lifecycle resets re-use the same result. It only lives for a\n  // single call. If other functions become expensive, we can add them as well.\n  const cache = new Map();\n  const mergedOptions = {\n    platform,\n    ...options\n  };\n  const platformWithCache = {\n    ...mergedOptions.platform,\n    _c: cache\n  };\n  return computePosition$1(reference, floating, {\n    ...mergedOptions,\n    platform: platformWithCache\n  });\n};\n\nexport { arrow, autoPlacement, autoUpdate, computePosition, detectOverflow, flip, hide, inline, limitShift, offset, platform, shift, size };\n","// Tooltip.tsx  (patched), Fragment\nimport { h, ComponentChildren, Fragment, Component } from 'preact';\nimport { useEffect, useRef, useState } from 'preact/hooks';\nimport {\n  computePosition,\n  offset,\n  flip,\n  shift,\n  arrow as arrowMw,\n  autoUpdate,\n  Placement,\n} from '@floating-ui/dom';\n\ninterface TooltipProps {\n  children: ComponentChildren;\n  content: ComponentChildren;\n  position?: Placement;\n  className?: string;\n  delay?: number;\n  style?: 'light' | 'dark';\n  trigger?: 'hover' | 'click' | 'none';\n}\n\ntype PreactComponent = { base: HTMLElement } & Component;\n\nclass RefWrapper extends Component<{ children: ComponentChildren; ref: any }> {\n  render() {\n    return this.props.children;\n  }\n}\n\nexport function Tooltip({\n  children,\n  content,\n  position = 'top',\n  className = '',\n  delay = 200,\n  style = 'dark',\n  trigger = 'hover',\n}: TooltipProps) {\n  const reference = useRef<PreactComponent>(null);\n  const floating = useRef<HTMLDivElement>(null);\n  const arrow = useRef<HTMLDivElement>(null);\n  const [visible, setVisible] = useState(false);\n  const st = useRef<NodeJS.Timeout | null>(null);\n\n  /*  position  */\n  useEffect(() => {\n    if (!reference.current?.base || !floating.current) return;\n\n    return autoUpdate(reference.current.base, floating.current, () => {\n      computePosition(reference.current!.base, floating.current!, {\n        placement: position,\n        middleware: [\n          offset(8),\n          flip(),\n          shift({ padding: 8 }),\n          arrowMw({ element: arrow.current!, padding: 6 }),\n        ],\n      }).then(({ x, y, placement, middlewareData }) => {\n        Object.assign(floating.current!.style, { left: `${x}px`, top: `${y}px` });\n\n        const { x: ax, y: ay } = middlewareData.arrow ?? {};\n        const side = placement.split('-')[0] as 'top' | 'bottom' | 'left' | 'right';\n        const staticSide = { top: 'bottom', bottom: 'top', left: 'right', right: 'left' }[side];\n\n        /* --- **critical change**: clear the axis we don't use --- */\n        Object.assign(arrow.current!.style, {\n          left: ax != null ? `${ax}px` : '',\n          top: ay != null ? `${ay}px` : '',\n          right: '',\n          bottom: '',\n          [staticSide!]: '-4px',\n        });\n      });\n    });\n  }, [position, visible]);\n\n  /*  trigger wiring  */\n  useEffect(() => {\n    const refEl = reference.current?.base;\n    const floatEl = floating.current;\n    if (!refEl || !floatEl) return;\n\n    /* helpers */\n    const clear = () => {\n      if (st.current) clearTimeout(st.current);\n    };\n    const show = () => {\n      clear();\n      st.current = setTimeout(() => setVisible(true), delay);\n    };\n    const hide = () => {\n      clear();\n      setVisible(false);\n    };\n    const toggle = () => setVisible((v) => !v);\n\n    /* attach based on *current* trigger prop */\n    if (trigger === 'hover') {\n      refEl.addEventListener('mouseenter', show);\n      refEl.addEventListener('mouseleave', hide);\n      floatEl.addEventListener('mouseenter', show);\n      floatEl.addEventListener('mouseleave', hide);\n      refEl.addEventListener('pointerdown', hide);\n    } else if (trigger === 'click') {\n      refEl.addEventListener('click', toggle);\n    }\n    /* \"none\"  nothing attached */\n\n    if (trigger === 'none') {\n      /* cancel any pending timers */\n      if (st.current) clearTimeout(st.current);\n      /* instantly hide bubble */\n      setVisible(false);\n    }\n\n    /* detach when `trigger` changes or component unmounts */\n    return () => {\n      clear();\n      if (trigger === 'hover') {\n        refEl.removeEventListener('mouseenter', show);\n        refEl.removeEventListener('mouseleave', hide);\n        floatEl.removeEventListener('mouseenter', show);\n        floatEl.removeEventListener('mouseleave', hide);\n        refEl.removeEventListener('pointerdown', hide);\n      } else if (trigger === 'click') {\n        refEl.removeEventListener('click', toggle);\n      }\n    };\n  }, [trigger, delay]);\n\n  /*  render  */\n  return (\n    <Fragment>\n      <div\n        ref={floating}\n        role=\"tooltip\"\n        className={`z-100 pointer-events-none absolute select-none whitespace-nowrap rounded-lg px-3 py-2 text-sm shadow-md transition-opacity duration-150 ${\n          style === 'dark'\n            ? 'bg-gray-900 text-white'\n            : 'border border-gray-200 bg-white text-gray-900'\n        } ${visible ? 'opacity-100' : 'opacity-0'} ${className} `}\n        style={{ visibility: visible ? 'visible' : 'hidden' }}\n      >\n        {content}\n        {/* the arrow inherits background so it never mismatches */}\n        <div\n          ref={arrow}\n          className={`absolute h-2 w-2 rotate-45 bg-inherit ${style === 'light' ? 'border border-gray-200' : ''} `}\n        />\n      </div>\n      <RefWrapper ref={reference}>{children}</RefWrapper>\n    </Fragment>\n  );\n}\n","import{Component as n,createElement as t,options as e,toChildArray as r,Fragment as u,render as o,hydrate as i,createContext as l,createRef as c,cloneElement as f}from\"preact\";export{Component,Fragment,createContext,createElement,createRef}from\"preact\";import{useState as a,useLayoutEffect as s,useEffect as h,useCallback as v,useContext as d,useDebugValue as m,useId as p,useImperativeHandle as y,useMemo as _,useReducer as b,useRef as S}from\"preact/hooks\";export*from\"preact/hooks\";function g(n,t){for(var e in t)n[e]=t[e];return n}function E(n,t){for(var e in n)if(\"__source\"!==e&&!(e in t))return!0;for(var r in t)if(\"__source\"!==r&&n[r]!==t[r])return!0;return!1}function C(n,t){var e=t(),r=a({t:{__:e,u:t}}),u=r[0].t,o=r[1];return s(function(){u.__=e,u.u=t,x(u)&&o({t:u})},[n,e,t]),h(function(){return x(u)&&o({t:u}),n(function(){x(u)&&o({t:u})})},[n]),e}function x(n){var t,e,r=n.u,u=n.__;try{var o=r();return!((t=u)===(e=o)&&(0!==t||1/t==1/e)||t!=t&&e!=e)}catch(n){return!0}}function R(n){n()}function w(n){return n}function k(){return[!1,R]}var I=s;function N(n,t){this.props=n,this.context=t}function M(n,e){function r(n){var t=this.props.ref,r=t==n.ref;return!r&&t&&(t.call?t(null):t.current=null),e?!e(this.props,n)||!r:E(this.props,n)}function u(e){return this.shouldComponentUpdate=r,t(n,e)}return u.displayName=\"Memo(\"+(n.displayName||n.name)+\")\",u.prototype.isReactComponent=!0,u.__f=!0,u}(N.prototype=new n).isPureReactComponent=!0,N.prototype.shouldComponentUpdate=function(n,t){return E(this.props,n)||E(this.state,t)};var T=e.__b;e.__b=function(n){n.type&&n.type.__f&&n.ref&&(n.props.ref=n.ref,n.ref=null),T&&T(n)};var A=\"undefined\"!=typeof Symbol&&Symbol.for&&Symbol.for(\"react.forward_ref\")||3911;function D(n){function t(t){var e=g({},t);return delete e.ref,n(e,t.ref||null)}return t.$$typeof=A,t.render=t,t.prototype.isReactComponent=t.__f=!0,t.displayName=\"ForwardRef(\"+(n.displayName||n.name)+\")\",t}var L=function(n,t){return null==n?null:r(r(n).map(t))},O={map:L,forEach:L,count:function(n){return n?r(n).length:0},only:function(n){var t=r(n);if(1!==t.length)throw\"Children.only\";return t[0]},toArray:r},F=e.__e;e.__e=function(n,t,e,r){if(n.then)for(var u,o=t;o=o.__;)if((u=o.__c)&&u.__c)return null==t.__e&&(t.__e=e.__e,t.__k=e.__k),u.__c(n,t);F(n,t,e,r)};var U=e.unmount;function V(n,t,e){return n&&(n.__c&&n.__c.__H&&(n.__c.__H.__.forEach(function(n){\"function\"==typeof n.__c&&n.__c()}),n.__c.__H=null),null!=(n=g({},n)).__c&&(n.__c.__P===e&&(n.__c.__P=t),n.__c.__e=!0,n.__c=null),n.__k=n.__k&&n.__k.map(function(n){return V(n,t,e)})),n}function W(n,t,e){return n&&e&&(n.__v=null,n.__k=n.__k&&n.__k.map(function(n){return W(n,t,e)}),n.__c&&n.__c.__P===t&&(n.__e&&e.appendChild(n.__e),n.__c.__e=!0,n.__c.__P=e)),n}function P(){this.__u=0,this.o=null,this.__b=null}function j(n){var t=n.__.__c;return t&&t.__a&&t.__a(n)}function z(n){var e,r,u;function o(o){if(e||(e=n()).then(function(n){r=n.default||n},function(n){u=n}),u)throw u;if(!r)throw e;return t(r,o)}return o.displayName=\"Lazy\",o.__f=!0,o}function B(){this.i=null,this.l=null}e.unmount=function(n){var t=n.__c;t&&t.__R&&t.__R(),t&&32&n.__u&&(n.type=null),U&&U(n)},(P.prototype=new n).__c=function(n,t){var e=t.__c,r=this;null==r.o&&(r.o=[]),r.o.push(e);var u=j(r.__v),o=!1,i=function(){o||(o=!0,e.__R=null,u?u(l):l())};e.__R=i;var l=function(){if(!--r.__u){if(r.state.__a){var n=r.state.__a;r.__v.__k[0]=W(n,n.__c.__P,n.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.o.pop();)t.forceUpdate()}};r.__u++||32&t.__u||r.setState({__a:r.__b=r.__v.__k[0]}),n.then(i,i)},P.prototype.componentWillUnmount=function(){this.o=[]},P.prototype.render=function(n,e){if(this.__b){if(this.__v.__k){var r=document.createElement(\"div\"),o=this.__v.__k[0].__c;this.__v.__k[0]=V(this.__b,r,o.__O=o.__P)}this.__b=null}var i=e.__a&&t(u,null,n.fallback);return i&&(i.__u&=-33),[t(u,null,e.__a?null:n.children),i]};var H=function(n,t,e){if(++e[1]===e[0]&&n.l.delete(t),n.props.revealOrder&&(\"t\"!==n.props.revealOrder[0]||!n.l.size))for(e=n.i;e;){for(;e.length>3;)e.pop()();if(e[1]<e[0])break;n.i=e=e[2]}};function Z(n){return this.getChildContext=function(){return n.context},n.children}function Y(n){var e=this,r=n.h;if(e.componentWillUnmount=function(){o(null,e.v),e.v=null,e.h=null},e.h&&e.h!==r&&e.componentWillUnmount(),!e.v){for(var u=e.__v;null!==u&&!u.__m&&null!==u.__;)u=u.__;e.h=r,e.v={nodeType:1,parentNode:r,childNodes:[],__k:{__m:u.__m},contains:function(){return!0},insertBefore:function(n,t){this.childNodes.push(n),e.h.insertBefore(n,t)},removeChild:function(n){this.childNodes.splice(this.childNodes.indexOf(n)>>>1,1),e.h.removeChild(n)}}}o(t(Z,{context:e.context},n.__v),e.v)}function $(n,e){var r=t(Y,{__v:n,h:e});return r.containerInfo=e,r}(B.prototype=new n).__a=function(n){var t=this,e=j(t.__v),r=t.l.get(n);return r[0]++,function(u){var o=function(){t.props.revealOrder?(r.push(u),H(t,n,r)):u()};e?e(o):o()}},B.prototype.render=function(n){this.i=null,this.l=new Map;var t=r(n.children);n.revealOrder&&\"b\"===n.revealOrder[0]&&t.reverse();for(var e=t.length;e--;)this.l.set(t[e],this.i=[1,0,this.i]);return n.children},B.prototype.componentDidUpdate=B.prototype.componentDidMount=function(){var n=this;this.l.forEach(function(t,e){H(n,e,t)})};var q=\"undefined\"!=typeof Symbol&&Symbol.for&&Symbol.for(\"react.element\")||60103,G=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,J=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,K=/[A-Z0-9]/g,Q=\"undefined\"!=typeof document,X=function(n){return(\"undefined\"!=typeof Symbol&&\"symbol\"==typeof Symbol()?/fil|che|rad/:/fil|che|ra/).test(n)};function nn(n,t,e){return null==t.__k&&(t.textContent=\"\"),o(n,t),\"function\"==typeof e&&e(),n?n.__c:null}function tn(n,t,e){return i(n,t),\"function\"==typeof e&&e(),n?n.__c:null}n.prototype.isReactComponent={},[\"componentWillMount\",\"componentWillReceiveProps\",\"componentWillUpdate\"].forEach(function(t){Object.defineProperty(n.prototype,t,{configurable:!0,get:function(){return this[\"UNSAFE_\"+t]},set:function(n){Object.defineProperty(this,t,{configurable:!0,writable:!0,value:n})}})});var en=e.event;function rn(){}function un(){return this.cancelBubble}function on(){return this.defaultPrevented}e.event=function(n){return en&&(n=en(n)),n.persist=rn,n.isPropagationStopped=un,n.isDefaultPrevented=on,n.nativeEvent=n};var ln,cn={enumerable:!1,configurable:!0,get:function(){return this.class}},fn=e.vnode;e.vnode=function(n){\"string\"==typeof n.type&&function(n){var t=n.props,e=n.type,u={},o=-1===e.indexOf(\"-\");for(var i in t){var l=t[i];if(!(\"value\"===i&&\"defaultValue\"in t&&null==l||Q&&\"children\"===i&&\"noscript\"===e||\"class\"===i||\"className\"===i)){var c=i.toLowerCase();\"defaultValue\"===i&&\"value\"in t&&null==t.value?i=\"value\":\"download\"===i&&!0===l?l=\"\":\"translate\"===c&&\"no\"===l?l=!1:\"o\"===c[0]&&\"n\"===c[1]?\"ondoubleclick\"===c?i=\"ondblclick\":\"onchange\"!==c||\"input\"!==e&&\"textarea\"!==e||X(t.type)?\"onfocus\"===c?i=\"onfocusin\":\"onblur\"===c?i=\"onfocusout\":J.test(i)&&(i=c):c=i=\"oninput\":o&&G.test(i)?i=i.replace(K,\"-$&\").toLowerCase():null===l&&(l=void 0),\"oninput\"===c&&u[i=c]&&(i=\"oninputCapture\"),u[i]=l}}\"select\"==e&&u.multiple&&Array.isArray(u.value)&&(u.value=r(t.children).forEach(function(n){n.props.selected=-1!=u.value.indexOf(n.props.value)})),\"select\"==e&&null!=u.defaultValue&&(u.value=r(t.children).forEach(function(n){n.props.selected=u.multiple?-1!=u.defaultValue.indexOf(n.props.value):u.defaultValue==n.props.value})),t.class&&!t.className?(u.class=t.class,Object.defineProperty(u,\"className\",cn)):(t.className&&!t.class||t.class&&t.className)&&(u.class=u.className=t.className),n.props=u}(n),n.$$typeof=q,fn&&fn(n)};var an=e.__r;e.__r=function(n){an&&an(n),ln=n.__c};var sn=e.diffed;e.diffed=function(n){sn&&sn(n);var t=n.props,e=n.__e;null!=e&&\"textarea\"===n.type&&\"value\"in t&&t.value!==e.value&&(e.value=null==t.value?\"\":t.value),ln=null};var hn={ReactCurrentDispatcher:{current:{readContext:function(n){return ln.__n[n.__c].props.value},useCallback:v,useContext:d,useDebugValue:m,useDeferredValue:w,useEffect:h,useId:p,useImperativeHandle:y,useInsertionEffect:I,useLayoutEffect:s,useMemo:_,useReducer:b,useRef:S,useState:a,useSyncExternalStore:C,useTransition:k}}},vn=\"18.3.1\";function dn(n){return t.bind(null,n)}function mn(n){return!!n&&n.$$typeof===q}function pn(n){return mn(n)&&n.type===u}function yn(n){return!!n&&!!n.displayName&&(\"string\"==typeof n.displayName||n.displayName instanceof String)&&n.displayName.startsWith(\"Memo(\")}function _n(n){return mn(n)?f.apply(null,arguments):n}function bn(n){return!!n.__k&&(o(null,n),!0)}function Sn(n){return n&&(n.base||1===n.nodeType&&n)||null}var gn=function(n,t){return n(t)},En=function(n,t){return n(t)},Cn=u,xn=mn,Rn={useState:a,useId:p,useReducer:b,useEffect:h,useLayoutEffect:s,useInsertionEffect:I,useTransition:k,useDeferredValue:w,useSyncExternalStore:C,startTransition:R,useRef:S,useImperativeHandle:y,useMemo:_,useCallback:v,useContext:d,useDebugValue:m,version:\"18.3.1\",Children:O,render:nn,hydrate:tn,unmountComponentAtNode:bn,createPortal:$,createElement:t,createContext:l,createFactory:dn,cloneElement:_n,createRef:c,Fragment:u,isValidElement:mn,isElement:xn,isFragment:pn,isMemo:yn,findDOMNode:Sn,Component:n,PureComponent:N,memo:M,forwardRef:D,flushSync:En,unstable_batchedUpdates:gn,StrictMode:Cn,Suspense:P,SuspenseList:B,lazy:z,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:hn};export{O as Children,N as PureComponent,Cn as StrictMode,P as Suspense,B as SuspenseList,hn as __SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_n as cloneElement,dn as createFactory,$ as createPortal,Rn as default,Sn as findDOMNode,En as flushSync,D as forwardRef,tn as hydrate,xn as isElement,pn as isFragment,yn as isMemo,mn as isValidElement,z as lazy,M as memo,nn as render,R as startTransition,bn as unmountComponentAtNode,gn as unstable_batchedUpdates,w as useDeferredValue,I as useInsertionEffect,C as useSyncExternalStore,k as useTransition,vn as version};\n//# sourceMappingURL=compat.module.js.map\n","import { h, ComponentChildren } from 'preact';\nimport { useEffect, useRef, useState } from 'preact/hooks';\nimport { computePosition, offset, flip, shift, autoUpdate, Placement } from '@floating-ui/dom';\n\nexport interface DropdownProps {\n  /** Controlled visibility`true` shows, `false` hides */\n  open: boolean;\n  /** Reference element that anchors the menu (button, icon, ) */\n  trigger?: HTMLElement;\n  /** Menu items / JSXcontent */\n  children: ComponentChildren;\n  /** Preferred placement (FloatingUI keywords). Default`\"bottom-start\"` */\n  placement?: string;\n  /** Horizontal offset (skidding) */\n  offsetSkidding?: number;\n  /** Vertical offset (distance) */\n  offsetDistance?: number;\n  /** Optional fadeout delay when hiding (ms) */\n  delay?: number;\n  /** Callbacks */\n  onShow?: () => void;\n  onHide?: () => void; // should set `open=false` in parent\n  className?: string;\n}\n\nfunction resolvePlacement(p: string | undefined): Placement {\n  const map: Record<string, Placement> = {\n    top: 'top-start',\n    bottom: 'bottom-start',\n    left: 'left-start',\n    right: 'right-start',\n  };\n  return (p && map[p]) || (p as Placement) || 'bottom-start';\n}\n\nexport function Dropdown({\n  open,\n  trigger,\n  children,\n  placement = 'bottom-start',\n  offsetSkidding = -2,\n  offsetDistance = 5,\n  delay = 0,\n  onShow,\n  onHide,\n  className,\n}: DropdownProps) {\n  const menuRef = useRef<HTMLDivElement>(null);\n  const [position, setPosition] = useState({ x: 0, y: 0 });\n  const resolvedPlacement = resolvePlacement(placement);\n\n  /*  Position & lifecycle  */\n  useEffect(() => {\n    const reference = trigger;\n    const floating = menuRef.current;\n    if (!floating) return;\n\n    if (open) {\n      floating.style.display = 'block';\n      onShow?.();\n    } else {\n      if (delay) {\n        setTimeout(() => (floating.style.display = 'none'), delay);\n      } else {\n        floating.style.display = 'none';\n      }\n      onHide?.();\n    }\n\n    if (!reference) return;\n    if (!open) return;\n\n    const cleanup = autoUpdate(reference, floating, () => {\n      computePosition(reference, floating, {\n        placement: resolvedPlacement,\n        strategy: 'absolute',\n        middleware: [\n          offset({ mainAxis: offsetDistance, crossAxis: offsetSkidding }),\n          flip(),\n          shift({ padding: 8 }),\n        ],\n      }).then(({ x, y }) => {\n        setPosition({ x, y });\n      });\n    });\n\n    return () => cleanup();\n  }, [open, trigger, placement, offsetSkidding, offsetDistance, delay]);\n\n  /*  Global clickoutside detector  */\n  useEffect(() => {\n    if (!open) return; // only while menu is visible\n    const floating = menuRef.current;\n    if (!floating) return;\n\n    const handlePointer = (ev: PointerEvent) => {\n      const path = ev.composedPath?.() ?? [ev.target as Node];\n\n      // click inside trigger OR inside menu  ignore\n      if ((trigger && path.includes(trigger)) || path.includes(floating)) {\n        return;\n      }\n\n      onHide?.(); // tell parent to close\n    };\n\n    window.addEventListener('pointerdown', handlePointer, true); // capture phase\n    return () => window.removeEventListener('pointerdown', handlePointer, true);\n  }, [open, trigger, onHide]);\n\n  /*  Render  */\n  return (\n    <div\n      ref={menuRef}\n      style={{\n        ...(trigger && {\n          display: 'none',\n          left: `${position.x}px`,\n          top: `${position.y}px`,\n        }),\n      }}\n      className={`absolute z-50 min-w-[8rem] divide-y divide-gray-100 rounded-lg border border-[#cfd4da] bg-white shadow-sm transition-opacity duration-150 focus:outline-none ${open ? 'opacity-100' : 'opacity-0'} ${!trigger && 'bottom-0 left-0 right-0'} ${className} `}\n    >\n      <div className=\"flex flex-col py-2\">{children}</div>\n    </div>\n  );\n}\n","// ../core/dist/preact/index.js\nimport { createContext as b } from \"preact\";\nimport { jsx as w2 } from \"preact/jsx-runtime\";\nimport { useState as a, useRef as m, useEffect as f2, useContext as S } from \"preact/hooks\";\n\n// ../models/dist/index.js\nvar PdfSoftHyphenMarker = \"\\xAD\";\nvar PdfZeroWidthSpace = \"\\u200B\";\nvar PdfWordJoiner = \"\\u2060\";\nvar PdfBomOrZwnbsp = \"\\uFEFF\";\nvar PdfNonCharacterFFFE = \"\\uFFFE\";\nvar PdfNonCharacterFFFF = \"\\uFFFF\";\nvar PdfUnwantedTextMarkers = Object.freeze([\n  PdfSoftHyphenMarker,\n  PdfZeroWidthSpace,\n  PdfWordJoiner,\n  PdfBomOrZwnbsp,\n  PdfNonCharacterFFFE,\n  PdfNonCharacterFFFF\n]);\nvar PdfUnwantedTextRegex = new RegExp(`[${PdfUnwantedTextMarkers.join(\"\")}]`, \"g\");\nvar MixedBlendMode = Symbol(\"mixed\");\nvar BLEND_MODE_INFOS = Object.freeze([\n  { id: 0, label: \"Normal\", css: \"normal\" },\n  { id: 1, label: \"Multiply\", css: \"multiply\" },\n  { id: 2, label: \"Screen\", css: \"screen\" },\n  { id: 3, label: \"Overlay\", css: \"overlay\" },\n  { id: 4, label: \"Darken\", css: \"darken\" },\n  { id: 5, label: \"Lighten\", css: \"lighten\" },\n  { id: 6, label: \"Color Dodge\", css: \"color-dodge\" },\n  { id: 7, label: \"Color Burn\", css: \"color-burn\" },\n  { id: 8, label: \"Hard Light\", css: \"hard-light\" },\n  { id: 9, label: \"Soft Light\", css: \"soft-light\" },\n  { id: 10, label: \"Difference\", css: \"difference\" },\n  { id: 11, label: \"Exclusion\", css: \"exclusion\" },\n  { id: 12, label: \"Hue\", css: \"hue\" },\n  { id: 13, label: \"Saturation\", css: \"saturation\" },\n  { id: 14, label: \"Color\", css: \"color\" },\n  { id: 15, label: \"Luminosity\", css: \"luminosity\" }\n]);\nvar enumToInfo = BLEND_MODE_INFOS.reduce(\n  (m4, info) => {\n    m4[info.id] = info;\n    return m4;\n  },\n  {}\n);\nvar cssToEnum = BLEND_MODE_INFOS.reduce((m4, info) => {\n  m4[info.css] = info.id;\n  return m4;\n}, {});\nvar blendModeSelectOptions = BLEND_MODE_INFOS.map((info) => ({\n  value: info.id,\n  label: info.label\n}));\nvar PdfAnnotationFlagName = Object.freeze({\n  [\n    1\n    /* INVISIBLE */\n  ]: \"invisible\",\n  [\n    2\n    /* HIDDEN */\n  ]: \"hidden\",\n  [\n    4\n    /* PRINT */\n  ]: \"print\",\n  [\n    8\n    /* NO_ZOOM */\n  ]: \"noZoom\",\n  [\n    16\n    /* NO_ROTATE */\n  ]: \"noRotate\",\n  [\n    32\n    /* NO_VIEW */\n  ]: \"noView\",\n  [\n    64\n    /* READ_ONLY */\n  ]: \"readOnly\",\n  [\n    128\n    /* LOCKED */\n  ]: \"locked\",\n  [\n    256\n    /* TOGGLE_NOVIEW */\n  ]: \"toggleNoView\"\n});\nvar PdfAnnotationFlagValue = Object.entries(\n  PdfAnnotationFlagName\n).reduce(\n  (acc, [bit, name]) => {\n    acc[name] = Number(bit);\n    return acc;\n  },\n  {}\n);\n\n// ../core/dist/index.js\nvar Z = class {\n  constructor(t, e) {\n    if (this.id = t, this.registry = e, this.debouncedActions = {}, this.unsubscribeFromState = null, this.unsubscribeFromCoreStore = null, t !== this.constructor.id)\n      throw new Error(\n        `Plugin ID mismatch: ${t} !== ${this.constructor.id}`\n      );\n    this.coreStore = this.registry.getStore(), this.pluginStore = this.coreStore.getPluginStore(this.id), this.unsubscribeFromState = this.pluginStore.subscribeToState((i2, r, n) => {\n      this.onStoreUpdated(n, r);\n    }), this.unsubscribeFromCoreStore = this.coreStore.subscribe((i2, r, n) => {\n      this.onCoreStoreUpdated(n, r);\n    }), this.readyPromise = new Promise((i2) => {\n      this.readyResolve = i2;\n    }), this.readyResolve();\n  }\n  provides() {\n    if (!this._capability) {\n      const t = this.buildCapability();\n      this._capability = Object.freeze(t);\n    }\n    return this._capability;\n  }\n  /**\n   *  Get a copy of the current state\n   */\n  get state() {\n    return this.pluginStore.getState();\n  }\n  /**\n   *  Get a copy of the current core state\n   */\n  get coreState() {\n    return this.coreStore.getState();\n  }\n  /**\n   * @deprecated  use `this.state` Get a copy of the current state\n   */\n  getState() {\n    return this.pluginStore.getState();\n  }\n  /**\n   * @deprecated  use `this.coreState` Get a copy of the current core state\n   */\n  getCoreState() {\n    return this.coreStore.getState();\n  }\n  /**\n   * Core Dispatch\n   */\n  dispatchCoreAction(t) {\n    return this.coreStore.dispatchToCore(t);\n  }\n  /**\n   * Dispatch an action to all plugins\n   */\n  dispatchToAllPlugins(t) {\n    return this.coreStore.dispatch(t);\n  }\n  /**\n   * Dispatch an action\n   */\n  dispatch(t) {\n    return this.pluginStore.dispatch(t);\n  }\n  /**\n   * Dispatch an action with debouncing to prevent rapid repeated calls\n   * @param action The action to dispatch\n   * @param debounceTime Time in ms to debounce (default: 100ms)\n   * @returns boolean indicating whether the action was dispatched or debounced\n   */\n  debouncedDispatch(t, e = 100) {\n    const i2 = Date.now(), r = this.debouncedActions[t.type] || 0;\n    return i2 - r >= e ? (this.debouncedActions[t.type] = i2, this.dispatch(t), true) : false;\n  }\n  /**\n   * Subscribe to state changes\n   */\n  subscribe(t) {\n    return this.pluginStore.subscribeToState(t);\n  }\n  /**\n   * Subscribe to core store changes\n   */\n  subscribeToCoreStore(t) {\n    return this.coreStore.subscribe(t);\n  }\n  /**\n   * Called when the plugin store state is updated\n   * @param oldState Previous state\n   * @param newState New state\n   */\n  onStoreUpdated(t, e) {\n  }\n  /**\n   * Called when the core store state is updated\n   * @param oldState Previous state\n   * @param newState New state\n   */\n  onCoreStoreUpdated(t, e) {\n  }\n  /**\n   * Cleanup method to be called when plugin is being destroyed\n   */\n  destroy() {\n    this.unsubscribeFromState && (this.unsubscribeFromState(), this.unsubscribeFromState = null), this.unsubscribeFromCoreStore && (this.unsubscribeFromCoreStore(), this.unsubscribeFromCoreStore = null);\n  }\n  /**\n   * Returns a promise that resolves when the plugin is ready\n   */\n  ready() {\n    return this.readyPromise;\n  }\n  /**\n   * Mark the plugin as ready\n   */\n  markReady() {\n    this.readyResolve();\n  }\n  /**\n   * Reset the ready state (useful for plugins that need to reinitialize)\n   */\n  resetReady() {\n    this.readyPromise = new Promise((t) => {\n      this.readyResolve = t;\n    });\n  }\n};\nvar N = class {\n  constructor(t, e) {\n    this.handler = t, this.options = e, this.lastRun = 0, this.handle = (i2) => {\n      this.options.mode === \"debounce\" ? this.debounce(i2) : this.throttle(i2);\n    };\n  }\n  debounce(t) {\n    this.timeoutId && window.clearTimeout(this.timeoutId), this.timeoutId = window.setTimeout(() => {\n      this.handler(t), this.timeoutId = void 0;\n    }, this.options.wait);\n  }\n  throttle(t) {\n    if (this.options.mode === \"debounce\") return;\n    const e = Date.now(), i2 = this.options.throttleMode || \"leading-trailing\";\n    e - this.lastRun >= this.options.wait && (i2 === \"leading-trailing\" && this.handler(t), this.lastRun = e), this.timeoutId && window.clearTimeout(this.timeoutId), this.timeoutId = window.setTimeout(\n      () => {\n        this.handler(t), this.lastRun = Date.now(), this.timeoutId = void 0;\n      },\n      this.options.wait - (e - this.lastRun)\n    );\n  }\n  destroy() {\n    this.timeoutId && window.clearTimeout(this.timeoutId);\n  }\n};\nfunction f(s, t, e) {\n  if (s === t)\n    return true;\n  if (s == null || t == null)\n    return s === t;\n  const i2 = typeof s;\n  if (i2 !== typeof t) return false;\n  if (i2 === \"object\") {\n    e || (e = /* @__PURE__ */ new Set());\n    const n = F(s, t);\n    if (e.has(n))\n      return true;\n    e.add(n);\n    const o = Array.isArray(s), a2 = Array.isArray(t);\n    return o && a2 ? q(s, t, e) : !o && !a2 ? I(s, t, e) : false;\n  }\n  return false;\n}\nfunction F(s, t) {\n  return `${v(s)}__${v(t)}`;\n}\nvar k = 0;\nvar w = /* @__PURE__ */ new WeakMap();\nfunction v(s) {\n  return w.has(s) || w.set(s, ++k), w.get(s);\n}\nfunction q(s, t, e) {\n  if (s.length !== t.length) return false;\n  const i2 = new Array(t.length).fill(false);\n  t: for (let r = 0; r < s.length; r++) {\n    const n = s[r];\n    for (let o = 0; o < t.length; o++)\n      if (!i2[o] && f(n, t[o], e)) {\n        i2[o] = true;\n        continue t;\n      }\n    return false;\n  }\n  return true;\n}\nfunction I(s, t, e) {\n  const i2 = Object.keys(s).sort(), r = Object.keys(t).sort();\n  if (i2.length !== r.length) return false;\n  for (let n = 0; n < i2.length; n++)\n    if (i2[n] !== r[n]) return false;\n  for (const n of i2) {\n    const o = s[n], a2 = t[n];\n    if (!f(o, a2, e))\n      return false;\n  }\n  return true;\n}\nfunction et() {\n  const s = /* @__PURE__ */ new Set();\n  return {\n    emit: (e = void 0) => s.forEach((i2) => i2(e)),\n    on: (e) => (s.add(e), () => s.delete(e)),\n    off: (e) => s.delete(e),\n    clear: () => s.clear()\n  };\n}\nfunction it(s, t = f) {\n  const e = /* @__PURE__ */ new Set(), i2 = /* @__PURE__ */ new Map();\n  let r = s;\n  const n = (a2) => e.forEach((l3) => l3(a2)), o = (a2, l3) => {\n    let h4 = a2, g3 = () => {\n    };\n    if (l3) {\n      const c2 = new N(a2, l3);\n      h4 = c2.handle, g3 = () => c2.destroy(), i2.set(a2, { wrapped: h4, destroy: g3 });\n    }\n    return r !== void 0 && h4(r), e.add(h4), () => {\n      e.delete(h4), g3(), i2.delete(a2);\n    };\n  };\n  return {\n    /* emitter behaviour ---------------------------------------- */\n    get value() {\n      return r;\n    },\n    emit(a2 = void 0) {\n      (r === void 0 || !t(r, a2)) && (r = a2, n(a2));\n    },\n    on: o,\n    off(a2) {\n      const l3 = i2.get(a2);\n      l3 ? (e.delete(l3.wrapped), l3.destroy(), i2.delete(a2)) : e.delete(a2);\n    },\n    clear() {\n      e.clear(), i2.forEach((a2) => a2.destroy()), i2.clear();\n    },\n    /* derived hook --------------------------------------------- */\n    select(a2, l3 = f) {\n      return (h4, g3) => {\n        let c2;\n        if (r !== void 0) {\n          const p3 = a2(r);\n          c2 = p3, h4(p3);\n        }\n        return o(\n          (p3) => {\n            const y2 = a2(p3);\n            (c2 === void 0 || !l3(c2, y2)) && (c2 = y2, h4(y2));\n          },\n          g3\n        );\n      };\n    }\n  };\n}\n\n// ../core/dist/preact/index.js\nvar P = b({\n  registry: null,\n  isInitializing: true,\n  pluginsReady: false\n});\nfunction g() {\n  const t = S(P);\n  if (t === void 0)\n    throw new Error(\"useCapability must be used within a PDFContext.Provider\");\n  const { registry: r, isInitializing: e } = t;\n  if (e)\n    return t;\n  if (r === null)\n    throw new Error(\"PDF registry failed to initialize properly\");\n  return t;\n}\nfunction h(t) {\n  const { registry: r } = g();\n  if (r === null)\n    return {\n      plugin: null,\n      isLoading: true,\n      ready: new Promise(() => {\n      })\n    };\n  const e = r.getPlugin(t);\n  if (!e)\n    throw new Error(`Plugin ${t} not found`);\n  return {\n    plugin: e,\n    isLoading: false,\n    ready: e.ready()\n  };\n}\nfunction L(t) {\n  const { plugin: r, isLoading: e, ready: i2 } = h(t);\n  if (!r)\n    return {\n      provides: null,\n      isLoading: e,\n      ready: i2\n    };\n  if (!r.provides)\n    throw new Error(`Plugin ${t} does not provide a capability`);\n  return {\n    provides: r.provides(),\n    isLoading: e,\n    ready: i2\n  };\n}\n\n// dist/index.js\nvar SET_ZOOM_LEVEL = \"SET_ZOOM_LEVEL\";\nvar SET_INITIAL_ZOOM_LEVEL = \"SET_INITIAL_ZOOM_LEVEL\";\nfunction setZoomLevel(zoomLevel, currentZoomLevel) {\n  return {\n    type: SET_ZOOM_LEVEL,\n    payload: { zoomLevel, currentZoomLevel }\n  };\n}\nfunction setInitialZoomLevel(zoomLevel) {\n  return {\n    type: SET_INITIAL_ZOOM_LEVEL,\n    payload: { zoomLevel }\n  };\n}\nvar initialState = {\n  zoomLevel: \"automatic\",\n  currentZoomLevel: 1\n};\nfunction swap(size) {\n  const { width, height } = size;\n  return {\n    width: height,\n    height: width\n  };\n}\nfunction transformSize2(size, rotation, scaleFactor) {\n  size = rotation % 2 === 0 ? size : swap(size);\n  return {\n    width: size.width * scaleFactor,\n    height: size.height * scaleFactor\n  };\n}\nfunction rotateRect(containerSize, rect, rotation) {\n  let x = rect.origin.x;\n  let y2 = rect.origin.y;\n  let size = rect.size;\n  switch (rotation) {\n    case 0:\n      break;\n    case 1:\n      x = containerSize.height - rect.origin.y - rect.size.height;\n      y2 = rect.origin.x;\n      size = swap(rect.size);\n      break;\n    case 2:\n      x = containerSize.width - rect.origin.x - rect.size.width;\n      y2 = containerSize.height - rect.origin.y - rect.size.height;\n      break;\n    case 3:\n      x = rect.origin.y;\n      y2 = containerSize.width - rect.origin.x - rect.size.width;\n      size = swap(rect.size);\n      break;\n  }\n  return {\n    origin: {\n      x,\n      y: y2\n    },\n    size: {\n      width: size.width,\n      height: size.height\n    }\n  };\n}\nvar PdfSoftHyphenMarker2 = \"\\xAD\";\nvar PdfZeroWidthSpace2 = \"\\u200B\";\nvar PdfWordJoiner2 = \"\\u2060\";\nvar PdfBomOrZwnbsp2 = \"\\uFEFF\";\nvar PdfNonCharacterFFFE2 = \"\\uFFFE\";\nvar PdfNonCharacterFFFF2 = \"\\uFFFF\";\nvar PdfUnwantedTextMarkers2 = Object.freeze([\n  PdfSoftHyphenMarker2,\n  PdfZeroWidthSpace2,\n  PdfWordJoiner2,\n  PdfBomOrZwnbsp2,\n  PdfNonCharacterFFFE2,\n  PdfNonCharacterFFFF2\n]);\nvar PdfUnwantedTextRegex2 = new RegExp(`[${PdfUnwantedTextMarkers2.join(\"\")}]`, \"g\");\nvar MixedBlendMode2 = Symbol(\"mixed\");\nvar BLEND_MODE_INFOS2 = Object.freeze([\n  { id: 0, label: \"Normal\", css: \"normal\" },\n  { id: 1, label: \"Multiply\", css: \"multiply\" },\n  { id: 2, label: \"Screen\", css: \"screen\" },\n  { id: 3, label: \"Overlay\", css: \"overlay\" },\n  { id: 4, label: \"Darken\", css: \"darken\" },\n  { id: 5, label: \"Lighten\", css: \"lighten\" },\n  { id: 6, label: \"Color Dodge\", css: \"color-dodge\" },\n  { id: 7, label: \"Color Burn\", css: \"color-burn\" },\n  { id: 8, label: \"Hard Light\", css: \"hard-light\" },\n  { id: 9, label: \"Soft Light\", css: \"soft-light\" },\n  { id: 10, label: \"Difference\", css: \"difference\" },\n  { id: 11, label: \"Exclusion\", css: \"exclusion\" },\n  { id: 12, label: \"Hue\", css: \"hue\" },\n  { id: 13, label: \"Saturation\", css: \"saturation\" },\n  { id: 14, label: \"Color\", css: \"color\" },\n  { id: 15, label: \"Luminosity\", css: \"luminosity\" }\n]);\nvar enumToInfo2 = BLEND_MODE_INFOS2.reduce(\n  (m22, info) => {\n    m22[info.id] = info;\n    return m22;\n  },\n  {}\n);\nvar cssToEnum2 = BLEND_MODE_INFOS2.reduce((m22, info) => {\n  m22[info.css] = info.id;\n  return m22;\n}, {});\nvar blendModeSelectOptions2 = BLEND_MODE_INFOS2.map((info) => ({\n  value: info.id,\n  label: info.label\n}));\nvar PdfAnnotationFlagName2 = Object.freeze({\n  [\n    1\n    /* INVISIBLE */\n  ]: \"invisible\",\n  [\n    2\n    /* HIDDEN */\n  ]: \"hidden\",\n  [\n    4\n    /* PRINT */\n  ]: \"print\",\n  [\n    8\n    /* NO_ZOOM */\n  ]: \"noZoom\",\n  [\n    16\n    /* NO_ROTATE */\n  ]: \"noRotate\",\n  [\n    32\n    /* NO_VIEW */\n  ]: \"noView\",\n  [\n    64\n    /* READ_ONLY */\n  ]: \"readOnly\",\n  [\n    128\n    /* LOCKED */\n  ]: \"locked\",\n  [\n    256\n    /* TOGGLE_NOVIEW */\n  ]: \"toggleNoView\"\n});\nvar PdfAnnotationFlagValue2 = Object.entries(\n  PdfAnnotationFlagName2\n).reduce(\n  (acc, [bit, name]) => {\n    acc[name] = Number(bit);\n    return acc;\n  },\n  {}\n);\nvar m2 = \"SET_DOCUMENT\";\nvar E = \"SET_SCALE\";\nvar P2 = \"SET_ROTATION\";\nvar R = \"SET_PAGES\";\nvar Y = (s) => ({ type: E, payload: s });\nvar Q = (s) => s.pages.map(\n  (t) => t.map((e) => ({\n    ...e,\n    rotatedSize: transformSize2(e.size, s.rotation, 1)\n  }))\n);\nvar Z2 = class {\n  constructor(t, e) {\n    if (this.id = t, this.registry = e, this.debouncedActions = {}, this.unsubscribeFromState = null, this.unsubscribeFromCoreStore = null, t !== this.constructor.id)\n      throw new Error(\n        `Plugin ID mismatch: ${t} !== ${this.constructor.id}`\n      );\n    this.coreStore = this.registry.getStore(), this.pluginStore = this.coreStore.getPluginStore(this.id), this.unsubscribeFromState = this.pluginStore.subscribeToState((i2, r, n) => {\n      this.onStoreUpdated(n, r);\n    }), this.unsubscribeFromCoreStore = this.coreStore.subscribe((i2, r, n) => {\n      this.onCoreStoreUpdated(n, r);\n    }), this.readyPromise = new Promise((i2) => {\n      this.readyResolve = i2;\n    }), this.readyResolve();\n  }\n  provides() {\n    if (!this._capability) {\n      const t = this.buildCapability();\n      this._capability = Object.freeze(t);\n    }\n    return this._capability;\n  }\n  /**\n   *  Get a copy of the current state\n   */\n  get state() {\n    return this.pluginStore.getState();\n  }\n  /**\n   *  Get a copy of the current core state\n   */\n  get coreState() {\n    return this.coreStore.getState();\n  }\n  /**\n   * @deprecated  use `this.state` Get a copy of the current state\n   */\n  getState() {\n    return this.pluginStore.getState();\n  }\n  /**\n   * @deprecated  use `this.coreState` Get a copy of the current core state\n   */\n  getCoreState() {\n    return this.coreStore.getState();\n  }\n  /**\n   * Core Dispatch\n   */\n  dispatchCoreAction(t) {\n    return this.coreStore.dispatchToCore(t);\n  }\n  /**\n   * Dispatch an action to all plugins\n   */\n  dispatchToAllPlugins(t) {\n    return this.coreStore.dispatch(t);\n  }\n  /**\n   * Dispatch an action\n   */\n  dispatch(t) {\n    return this.pluginStore.dispatch(t);\n  }\n  /**\n   * Dispatch an action with debouncing to prevent rapid repeated calls\n   * @param action The action to dispatch\n   * @param debounceTime Time in ms to debounce (default: 100ms)\n   * @returns boolean indicating whether the action was dispatched or debounced\n   */\n  debouncedDispatch(t, e = 100) {\n    const i2 = Date.now(), r = this.debouncedActions[t.type] || 0;\n    return i2 - r >= e ? (this.debouncedActions[t.type] = i2, this.dispatch(t), true) : false;\n  }\n  /**\n   * Subscribe to state changes\n   */\n  subscribe(t) {\n    return this.pluginStore.subscribeToState(t);\n  }\n  /**\n   * Subscribe to core store changes\n   */\n  subscribeToCoreStore(t) {\n    return this.coreStore.subscribe(t);\n  }\n  /**\n   * Called when the plugin store state is updated\n   * @param oldState Previous state\n   * @param newState New state\n   */\n  onStoreUpdated(t, e) {\n  }\n  /**\n   * Called when the core store state is updated\n   * @param oldState Previous state\n   * @param newState New state\n   */\n  onCoreStoreUpdated(t, e) {\n  }\n  /**\n   * Cleanup method to be called when plugin is being destroyed\n   */\n  destroy() {\n    this.unsubscribeFromState && (this.unsubscribeFromState(), this.unsubscribeFromState = null), this.unsubscribeFromCoreStore && (this.unsubscribeFromCoreStore(), this.unsubscribeFromCoreStore = null);\n  }\n  /**\n   * Returns a promise that resolves when the plugin is ready\n   */\n  ready() {\n    return this.readyPromise;\n  }\n  /**\n   * Mark the plugin as ready\n   */\n  markReady() {\n    this.readyResolve();\n  }\n  /**\n   * Reset the ready state (useful for plugins that need to reinitialize)\n   */\n  resetReady() {\n    this.readyPromise = new Promise((t) => {\n      this.readyResolve = t;\n    });\n  }\n};\nvar N2 = class {\n  constructor(t, e) {\n    this.handler = t, this.options = e, this.lastRun = 0, this.handle = (i2) => {\n      this.options.mode === \"debounce\" ? this.debounce(i2) : this.throttle(i2);\n    };\n  }\n  debounce(t) {\n    this.timeoutId && window.clearTimeout(this.timeoutId), this.timeoutId = window.setTimeout(() => {\n      this.handler(t), this.timeoutId = void 0;\n    }, this.options.wait);\n  }\n  throttle(t) {\n    if (this.options.mode === \"debounce\") return;\n    const e = Date.now(), i2 = this.options.throttleMode || \"leading-trailing\";\n    e - this.lastRun >= this.options.wait && (i2 === \"leading-trailing\" && this.handler(t), this.lastRun = e), this.timeoutId && window.clearTimeout(this.timeoutId), this.timeoutId = window.setTimeout(\n      () => {\n        this.handler(t), this.lastRun = Date.now(), this.timeoutId = void 0;\n      },\n      this.options.wait - (e - this.lastRun)\n    );\n  }\n  destroy() {\n    this.timeoutId && window.clearTimeout(this.timeoutId);\n  }\n};\nfunction tt(s, t, e) {\n  return s < t ? t : s > e ? e : s;\n}\nfunction f3(s, t, e) {\n  if (s === t)\n    return true;\n  if (s == null || t == null)\n    return s === t;\n  const i2 = typeof s;\n  if (i2 !== typeof t) return false;\n  if (i2 === \"object\") {\n    e || (e = /* @__PURE__ */ new Set());\n    const n = F2(s, t);\n    if (e.has(n))\n      return true;\n    e.add(n);\n    const o = Array.isArray(s), a2 = Array.isArray(t);\n    return o && a2 ? q2(s, t, e) : !o && !a2 ? I2(s, t, e) : false;\n  }\n  return false;\n}\nfunction F2(s, t) {\n  return `${v2(s)}__${v2(t)}`;\n}\nvar k2 = 0;\nvar w3 = /* @__PURE__ */ new WeakMap();\nfunction v2(s) {\n  return w3.has(s) || w3.set(s, ++k2), w3.get(s);\n}\nfunction q2(s, t, e) {\n  if (s.length !== t.length) return false;\n  const i2 = new Array(t.length).fill(false);\n  t: for (let r = 0; r < s.length; r++) {\n    const n = s[r];\n    for (let o = 0; o < t.length; o++)\n      if (!i2[o] && f3(n, t[o], e)) {\n        i2[o] = true;\n        continue t;\n      }\n    return false;\n  }\n  return true;\n}\nfunction I2(s, t, e) {\n  const i2 = Object.keys(s).sort(), r = Object.keys(t).sort();\n  if (i2.length !== r.length) return false;\n  for (let n = 0; n < i2.length; n++)\n    if (i2[n] !== r[n]) return false;\n  for (const n of i2) {\n    const o = s[n], a2 = t[n];\n    if (!f3(o, a2, e))\n      return false;\n  }\n  return true;\n}\nfunction et2() {\n  const s = /* @__PURE__ */ new Set();\n  return {\n    emit: (e = void 0) => s.forEach((i2) => i2(e)),\n    on: (e) => (s.add(e), () => s.delete(e)),\n    off: (e) => s.delete(e),\n    clear: () => s.clear()\n  };\n}\nfunction it2(s, t = f3) {\n  const e = /* @__PURE__ */ new Set(), i2 = /* @__PURE__ */ new Map();\n  let r = s;\n  const n = (a2) => e.forEach((l3) => l3(a2)), o = (a2, l3) => {\n    let h4 = a2, g3 = () => {\n    };\n    if (l3) {\n      const c2 = new N2(a2, l3);\n      h4 = c2.handle, g3 = () => c2.destroy(), i2.set(a2, { wrapped: h4, destroy: g3 });\n    }\n    return r !== void 0 && h4(r), e.add(h4), () => {\n      e.delete(h4), g3(), i2.delete(a2);\n    };\n  };\n  return {\n    /* emitter behaviour ---------------------------------------- */\n    get value() {\n      return r;\n    },\n    emit(a2 = void 0) {\n      (r === void 0 || !t(r, a2)) && (r = a2, n(a2));\n    },\n    on: o,\n    off(a2) {\n      const l3 = i2.get(a2);\n      l3 ? (e.delete(l3.wrapped), l3.destroy(), i2.delete(a2)) : e.delete(a2);\n    },\n    clear() {\n      e.clear(), i2.forEach((a2) => a2.destroy()), i2.clear();\n    },\n    /* derived hook --------------------------------------------- */\n    select(a2, l3 = f3) {\n      return (h4, g3) => {\n        let c2;\n        if (r !== void 0) {\n          const p3 = a2(r);\n          c2 = p3, h4(p3);\n        }\n        return o(\n          (p3) => {\n            const y2 = a2(p3);\n            (c2 === void 0 || !l3(c2, y2)) && (c2 = y2, h4(y2));\n          },\n          g3\n        );\n      };\n    }\n  };\n}\nvar ZoomPlugin = class extends Z2 {\n  /* ------------------------------------------------------------------ */\n  constructor(id, registry, cfg) {\n    super(id, registry);\n    this.zoom$ = et2();\n    this.state$ = it2();\n    this.viewportPlugin = registry.getPlugin(\"viewport\");\n    this.viewport = this.viewportPlugin.provides();\n    this.scroll = registry.getPlugin(\"scroll\").provides();\n    const interactionManager = registry.getPlugin(\"interaction-manager\");\n    this.interactionManager = interactionManager?.provides() ?? null;\n    this.minZoom = cfg.minZoom ?? 0.25;\n    this.maxZoom = cfg.maxZoom ?? 10;\n    this.zoomStep = cfg.zoomStep ?? 0.1;\n    this.presets = cfg.presets ?? [];\n    this.zoomRanges = this.normalizeRanges(cfg.zoomRanges ?? []);\n    this.dispatch(setInitialZoomLevel(cfg.defaultZoomLevel));\n    this.viewport.onViewportResize(() => this.recalcAuto(\n      1\n      /* Top */\n    ), {\n      mode: \"debounce\",\n      wait: 150\n    });\n    this.coreStore.onAction(P2, () => this.recalcAuto(\n      1\n      /* Top */\n    ));\n    this.coreStore.onAction(R, () => this.recalcAuto(\n      1\n      /* Top */\n    ));\n    this.coreStore.onAction(m2, () => this.recalcAuto(\n      1\n      /* Top */\n    ));\n    this.interactionManager?.registerMode({\n      id: \"marqueeZoom\",\n      scope: \"page\",\n      exclusive: true,\n      cursor: \"zoom-in\"\n    });\n    this.resetReady();\n  }\n  /* ------------------------------------------------------------------ */\n  /* capability                                                          */\n  /* ------------------------------------------------------------------ */\n  buildCapability() {\n    return {\n      onZoomChange: this.zoom$.on,\n      onStateChange: this.state$.on,\n      zoomIn: () => {\n        const cur = this.state.currentZoomLevel;\n        return this.handleRequest({ level: cur, delta: this.stepFor(cur) });\n      },\n      zoomOut: () => {\n        const cur = this.state.currentZoomLevel;\n        return this.handleRequest({ level: cur, delta: -this.stepFor(cur) });\n      },\n      zoomToArea: (pageIndex, rect) => this.handleZoomToArea(pageIndex, rect),\n      requestZoom: (level, c2) => this.handleRequest({ level, center: c2 }),\n      requestZoomBy: (d, c2) => {\n        const cur = this.state.currentZoomLevel;\n        const target = this.toZoom(cur + d);\n        return this.handleRequest({ level: target, center: c2 });\n      },\n      enableMarqueeZoom: () => {\n        this.interactionManager?.activate(\"marqueeZoom\");\n      },\n      disableMarqueeZoom: () => {\n        this.interactionManager?.activate(\"default\");\n      },\n      toggleMarqueeZoom: () => {\n        if (this.interactionManager?.getActiveMode() === \"marqueeZoom\") {\n          this.interactionManager?.activate(\"default\");\n        } else {\n          this.interactionManager?.activate(\"marqueeZoom\");\n        }\n      },\n      isMarqueeZoomActive: () => this.interactionManager?.getActiveMode() === \"marqueeZoom\",\n      getState: () => this.state,\n      getPresets: () => this.presets\n    };\n  }\n  /* ------------------------------------------------------------------ */\n  /* plugin lifecycle                                                   */\n  /* ------------------------------------------------------------------ */\n  async initialize() {\n  }\n  async destroy() {\n    this.zoom$.clear();\n  }\n  /**\n   * Sort ranges once, make sure they are sane\n   */\n  normalizeRanges(ranges) {\n    return [...ranges].filter((r) => r.step > 0 && r.max > r.min).sort((a2, b2) => a2.min - b2.min);\n  }\n  /** pick the step that applies to a given numeric zoom */\n  stepFor(zoom) {\n    const r = this.zoomRanges.find((r2) => zoom >= r2.min && zoom < r2.max);\n    return r ? r.step : this.zoomStep;\n  }\n  /** clamp + round helper reused later */\n  toZoom(v22) {\n    return parseFloat(tt(v22, this.minZoom, this.maxZoom).toFixed(2));\n  }\n  /* ------------------------------------------------------------------ */\n  /* main entry  handles **every** zoom request                          */\n  /* ------------------------------------------------------------------ */\n  handleRequest({\n    level,\n    delta = 0,\n    center,\n    focus = 0,\n    align = \"keep\"\n  }) {\n    const metrics = this.viewport.getMetrics();\n    const oldZoom = this.state.currentZoomLevel;\n    if (metrics.clientWidth === 0 || metrics.clientHeight === 0) {\n      return;\n    }\n    const base = typeof level === \"number\" ? level : this.computeZoomForMode(level, metrics);\n    if (base === false) {\n      return;\n    }\n    const exactZoom = tt(base + delta, this.minZoom, this.maxZoom);\n    const newZoom = Math.floor(exactZoom * 100) / 100;\n    const focusPoint = center ?? {\n      vx: metrics.clientWidth / 2,\n      vy: focus === 1 ? 0 : metrics.clientHeight / 2\n    };\n    const { desiredScrollLeft, desiredScrollTop } = this.computeScrollForZoomChange(\n      metrics,\n      oldZoom,\n      newZoom,\n      focusPoint,\n      align\n    );\n    if (!isNaN(desiredScrollLeft) && !isNaN(desiredScrollTop)) {\n      this.viewportPlugin.setViewportScrollMetrics({\n        scrollLeft: desiredScrollLeft,\n        scrollTop: desiredScrollTop\n      });\n    }\n    this.dispatch(setZoomLevel(typeof level === \"number\" ? newZoom : level, newZoom));\n    this.dispatchCoreAction(Y(newZoom));\n    this.markReady();\n    this.viewport.scrollTo({\n      x: desiredScrollLeft,\n      y: desiredScrollTop,\n      behavior: \"instant\"\n    });\n    const evt = {\n      oldZoom,\n      newZoom,\n      level,\n      center: focusPoint,\n      desiredScrollLeft,\n      desiredScrollTop,\n      viewport: metrics\n    };\n    this.zoom$.emit(evt);\n  }\n  /* ------------------------------------------------------------------ */\n  /* helpers                                                             */\n  /* ------------------------------------------------------------------ */\n  /** numeric zoom for Automatic / FitPage / FitWidth */\n  computeZoomForMode(mode, vp) {\n    const spreads = Q(this.coreState.core);\n    if (!spreads.length) return false;\n    const pgGap = this.scroll.getPageGap();\n    const vpGap = this.viewport.getViewportGap();\n    if (vp.clientWidth === 0 || vp.clientHeight === 0) {\n      return false;\n    }\n    const availableWidth = vp.clientWidth - 2 * vpGap;\n    const availableHeight = vp.clientHeight - 2 * vpGap;\n    if (availableWidth <= 0 || availableHeight <= 0) {\n      return false;\n    }\n    let maxContentW = 0, maxContentH = 0;\n    spreads.forEach((spread) => {\n      const contentW = spread.reduce((s, p3, i2) => s + p3.rotatedSize.width + (i2 ? pgGap : 0), 0);\n      const contentH = Math.max(...spread.map((p3) => p3.rotatedSize.height));\n      maxContentW = Math.max(maxContentW, contentW);\n      maxContentH = Math.max(maxContentH, contentH);\n    });\n    switch (mode) {\n      case \"fit-width\":\n        return availableWidth / maxContentW;\n      case \"fit-page\":\n        return Math.min(availableWidth / maxContentW, availableHeight / maxContentH);\n      case \"automatic\":\n        return Math.min(availableWidth / maxContentW, 1);\n      /* istanbul ignore next */\n      default:\n        return 1;\n    }\n  }\n  /** where to scroll so that *focus* stays stable after scaling          */\n  computeScrollForZoomChange(vp, oldZoom, newZoom, focus, align = \"keep\") {\n    const layout = this.scroll.getLayout();\n    const vpGap = this.viewport.getViewportGap();\n    const contentW = layout.totalContentSize.width;\n    const contentH = layout.totalContentSize.height;\n    const availableWidth = vp.clientWidth - 2 * vpGap;\n    const availableHeight = vp.clientHeight - 2 * vpGap;\n    const off = (availableSpace, cw, zoom) => cw * zoom < availableSpace ? (availableSpace - cw * zoom) / 2 : 0;\n    const offXold = off(availableWidth, contentW, oldZoom);\n    const offYold = off(availableHeight, contentH, oldZoom);\n    const offXnew = off(availableWidth, contentW, newZoom);\n    const offYnew = off(availableHeight, contentH, newZoom);\n    const cx = (vp.scrollLeft + focus.vx - vpGap - offXold) / oldZoom;\n    const cy = (vp.scrollTop + focus.vy - vpGap - offYold) / oldZoom;\n    const baseLeft = cx * newZoom + vpGap + offXnew;\n    const baseTop = cy * newZoom + vpGap + offYnew;\n    const desiredScrollLeft = align === \"center\" ? baseLeft - vp.clientWidth / 2 : baseLeft - focus.vx;\n    const desiredScrollTop = align === \"center\" ? baseTop - vp.clientHeight / 2 : baseTop - focus.vy;\n    return {\n      desiredScrollLeft: Math.max(0, desiredScrollLeft),\n      desiredScrollTop: Math.max(0, desiredScrollTop)\n    };\n  }\n  handleZoomToArea(pageIndex, rect) {\n    const rotation = this.coreState.core.rotation;\n    const vp = this.viewport.getMetrics();\n    const vpGap = this.viewport.getViewportGap();\n    const oldZ = this.state.currentZoomLevel;\n    const availableW = vp.clientWidth - 2 * vpGap;\n    const availableH = vp.clientHeight - 2 * vpGap;\n    const layout = this.scroll.getLayout();\n    const vItem = layout.virtualItems.find(\n      (it22) => it22.pageLayouts.some((p3) => p3.pageIndex === pageIndex)\n    );\n    if (!vItem) return;\n    const pageRel = vItem.pageLayouts.find((p3) => p3.pageIndex === pageIndex);\n    const rotatedRect = rotateRect(\n      {\n        width: pageRel.width,\n        height: pageRel.height\n      },\n      rect,\n      rotation\n    );\n    const targetZoom = this.toZoom(\n      Math.min(availableW / rotatedRect.size.width, availableH / rotatedRect.size.height)\n    );\n    const pageAbsX = vItem.x + pageRel.x;\n    const pageAbsY = vItem.y + pageRel.y;\n    const cxContent = pageAbsX + rotatedRect.origin.x + rotatedRect.size.width / 2;\n    const cyContent = pageAbsY + rotatedRect.origin.y + rotatedRect.size.height / 2;\n    const off = (avail, cw, z) => cw * z < avail ? (avail - cw * z) / 2 : 0;\n    const offXold = off(availableW, layout.totalContentSize.width, oldZ);\n    const offYold = off(availableH, layout.totalContentSize.height, oldZ);\n    const centerVX = vpGap + offXold + cxContent * oldZ - vp.scrollLeft;\n    const centerVY = vpGap + offYold + cyContent * oldZ - vp.scrollTop;\n    this.handleRequest({\n      level: targetZoom,\n      center: { vx: centerVX, vy: centerVY },\n      align: \"center\"\n    });\n  }\n  /** recalculates Automatic / Fit* when viewport or pages change */\n  recalcAuto(focus) {\n    const s = this.state;\n    if (s.zoomLevel === \"automatic\" || s.zoomLevel === \"fit-page\" || s.zoomLevel === \"fit-width\")\n      this.handleRequest({ level: s.zoomLevel, focus });\n  }\n  onStoreUpdated(_prevState, newState) {\n    this.state$.emit(newState);\n  }\n};\nZoomPlugin.id = \"zoom\";\n\n// src/preact/hooks/use-zoom.ts\nimport { useEffect, useState } from \"preact/hooks\";\nvar useZoomCapability = () => L(ZoomPlugin.id);\nvar useZoomPlugin = () => h(ZoomPlugin.id);\nvar useZoom = () => {\n  const { provides } = useZoomCapability();\n  const [state, setState] = useState(initialState);\n  useEffect(() => {\n    return provides?.onStateChange((action) => {\n      setState(action);\n    });\n  }, [provides]);\n  return {\n    state,\n    provides\n  };\n};\n\n// src/preact/hooks/use-pinch-zoom.ts\nimport { useEffect as useEffect2, useRef } from \"preact/hooks\";\nfunction usePinch() {\n  const { provides: viewportProvides } = L(\"viewport\");\n  const { provides: zoomProvides } = useZoomCapability();\n  const elementRef = useRef(null);\n  useEffect2(() => {\n    const element = elementRef.current;\n    if (!element || !viewportProvides || !zoomProvides) {\n      return;\n    }\n    if (typeof window === \"undefined\") {\n      return;\n    }\n    let hammer;\n    let initialZoom = 0;\n    let lastCenter = { x: 0, y: 0 };\n    const getState = () => zoomProvides.getState();\n    const updateTransform = (scale) => {\n      element.style.transform = `scale(${scale})`;\n    };\n    const resetTransform = () => {\n      element.style.transform = \"none\";\n      element.style.transformOrigin = \"0 0\";\n    };\n    const pinchStart = (e) => {\n      initialZoom = getState().currentZoomLevel;\n      const contRect = viewportProvides.getBoundingRect();\n      lastCenter = {\n        x: e.center.x - contRect.origin.x,\n        y: e.center.y - contRect.origin.y\n      };\n      const innerRect = element.getBoundingClientRect();\n      element.style.transformOrigin = `${e.center.x - innerRect.left}px ${e.center.y - innerRect.top}px`;\n      if (e.srcEvent?.cancelable) {\n        e.srcEvent.preventDefault();\n        e.srcEvent.stopPropagation();\n      }\n    };\n    const pinchMove = (e) => {\n      updateTransform(e.scale);\n      if (e.srcEvent?.cancelable) {\n        e.srcEvent.preventDefault();\n        e.srcEvent.stopPropagation();\n      }\n    };\n    const pinchEnd = (e) => {\n      const delta = (e.scale - 1) * initialZoom;\n      zoomProvides.requestZoomBy(delta, { vx: lastCenter.x, vy: lastCenter.y });\n      resetTransform();\n      initialZoom = 0;\n    };\n    const setupHammer = async () => {\n      try {\n        const Hammer = (await import(\"hammerjs\")).default;\n        const inputClass = (() => {\n          const MOBILE_REGEX = /mobile|tablet|ip(ad|hone|od)|android/i;\n          const SUPPORT_TOUCH = \"ontouchstart\" in window || navigator.maxTouchPoints > 0;\n          const SUPPORT_ONLY_TOUCH = SUPPORT_TOUCH && MOBILE_REGEX.test(navigator.userAgent);\n          if (SUPPORT_ONLY_TOUCH) return Hammer.TouchInput;\n          if (!SUPPORT_TOUCH) return Hammer.MouseInput;\n          return Hammer.TouchMouseInput;\n        })();\n        hammer = new Hammer(element, {\n          touchAction: \"pan-x pan-y\",\n          // allow scroll in every direction\n          inputClass\n        });\n        hammer.get(\"pinch\").set({ enable: true, pointers: 2, threshold: 0.1 });\n        hammer.on(\"pinchstart\", pinchStart);\n        hammer.on(\"pinchmove\", pinchMove);\n        hammer.on(\"pinchend\", pinchEnd);\n      } catch (error) {\n        console.warn(\"Failed to load HammerJS:\", error);\n      }\n    };\n    setupHammer();\n    return () => {\n      hammer?.destroy();\n      resetTransform();\n    };\n  }, [viewportProvides, zoomProvides]);\n  return { elementRef };\n}\n\n// src/preact/components/pinch-wrapper.tsx\nimport { jsx } from \"preact/jsx-runtime\";\nfunction PinchWrapper({ children, style, ...props }) {\n  const { elementRef } = usePinch();\n  return /* @__PURE__ */ jsx(\n    \"div\",\n    {\n      ref: elementRef,\n      ...props,\n      style: {\n        ...style,\n        display: \"block\",\n        width: \"fit-content\",\n        overflow: \"visible\",\n        boxSizing: \"border-box\",\n        margin: \"0px auto\"\n      },\n      children\n    }\n  );\n}\n\n// src/preact/components/marquee-zoom.tsx\nimport { useEffect as useEffect3, useMemo, useRef as useRef2, useState as useState2 } from \"preact/hooks\";\n\n// ../plugin-interaction-manager/dist/preact/index.js\nimport { jsx as P3, jsxs as h3 } from \"preact/jsx-runtime\";\nimport { useState as I3, useEffect as c, useRef as p2, useCallback as E2 } from \"preact/hooks\";\n\n// ../plugin-interaction-manager/dist/index.js\nvar g2 = \"INTERACTION/ACTIVATE_MODE\";\nvar p = \"INTERACTION/PAUSE\";\nvar f4 = \"INTERACTION/RESUME\";\nvar C = \"INTERACTION/SET_CURSOR\";\nvar y = (n) => ({\n  type: g2,\n  payload: { mode: n }\n});\nvar w4 = (n) => ({\n  type: C,\n  payload: { cursor: n }\n});\nvar M = () => ({\n  type: p\n});\nvar A = () => ({\n  type: f4\n});\nfunction S2(n) {\n  const t = [\n    \"onPointerDown\",\n    \"onPointerUp\",\n    \"onPointerMove\",\n    \"onPointerEnter\",\n    \"onPointerLeave\",\n    \"onPointerCancel\"\n  ], e = {};\n  for (const i2 of t)\n    e[i2] = (s, o, a2) => {\n      var r;\n      for (const c2 of n) (r = c2[i2]) == null || r.call(c2, s, o, a2);\n    };\n  return e;\n}\nvar l = class l2 extends Z {\n  constructor(t, e) {\n    super(t, e), this.modes = /* @__PURE__ */ new Map(), this.cursorClaims = /* @__PURE__ */ new Map(), this.buckets = /* @__PURE__ */ new Map(), this.alwaysGlobal = /* @__PURE__ */ new Set(), this.alwaysPage = /* @__PURE__ */ new Map(), this.onModeChange$ = et(), this.onHandlerChange$ = et(), this.onCursorChange$ = et(), this.onStateChange$ = it(), this.registerMode({\n      id: \"default\",\n      scope: \"page\",\n      exclusive: false,\n      cursor: \"auto\"\n    });\n  }\n  async initialize(t) {\n  }\n  buildCapability() {\n    return {\n      activate: (t) => this.activate(t),\n      onModeChange: this.onModeChange$.on,\n      onCursorChange: this.onCursorChange$.on,\n      onHandlerChange: this.onHandlerChange$.on,\n      onStateChange: this.onStateChange$.on,\n      getActiveMode: () => this.state.activeMode,\n      getActiveInteractionMode: () => this.getActiveInteractionMode(),\n      finish: () => this.activate(\"default\"),\n      registerMode: (t) => this.registerMode(t),\n      registerHandlers: (t) => this.registerHandlers(t),\n      registerAlways: (t) => this.registerAlways(t),\n      setCursor: (t, e, i2 = 0) => this.setCursor(t, e, i2),\n      removeCursor: (t) => this.removeCursor(t),\n      getCurrentCursor: () => this.state.cursor,\n      getHandlersForScope: (t) => this.getHandlersForScope(t),\n      activeModeIsExclusive: () => this.activeModeIsExclusive(),\n      pause: () => this.dispatch(M()),\n      resume: () => this.dispatch(A()),\n      isPaused: () => this.state.paused\n    };\n  }\n  activate(t) {\n    if (!this.modes.has(t))\n      throw new Error(`[interaction] unknown mode '${t}'`);\n    if (t === this.state.activeMode) return;\n    const e = this.state.activeMode;\n    this.cursorClaims.clear(), this.notifyHandlersInactive(e), this.dispatch(y(t)), this.emitCursor(), this.notifyHandlersActive(t), this.onModeChange$.emit({ ...this.state, activeMode: t });\n  }\n  notifyHandlersActive(t) {\n    this.alwaysGlobal.forEach((s) => {\n      var o;\n      (o = s.onHandlerActiveStart) == null || o.call(s, t);\n    }), this.alwaysPage.forEach((s) => {\n      s.forEach((o) => {\n        var a2;\n        (a2 = o.onHandlerActiveStart) == null || a2.call(o, t);\n      });\n    });\n    const e = this.modes.get(t);\n    if (!e) return;\n    const i2 = this.buckets.get(t);\n    i2 && (e.scope === \"global\" && i2.global.forEach((s) => {\n      var o;\n      (o = s.onHandlerActiveStart) == null || o.call(s, t);\n    }), e.scope === \"page\" && i2.page.forEach((s, o) => {\n      s.forEach((a2) => {\n        var r;\n        (r = a2.onHandlerActiveStart) == null || r.call(a2, t);\n      });\n    }));\n  }\n  notifyHandlersInactive(t) {\n    this.alwaysGlobal.forEach((s) => {\n      var o;\n      (o = s.onHandlerActiveEnd) == null || o.call(s, t);\n    }), this.alwaysPage.forEach((s) => {\n      s.forEach((o) => {\n        var a2;\n        (a2 = o.onHandlerActiveEnd) == null || a2.call(o, t);\n      });\n    });\n    const e = this.modes.get(t);\n    if (!e) return;\n    const i2 = this.buckets.get(t);\n    i2 && (e.scope === \"global\" && i2.global.forEach((s) => {\n      var o;\n      (o = s.onHandlerActiveEnd) == null || o.call(s, t);\n    }), e.scope === \"page\" && i2.page.forEach((s, o) => {\n      s.forEach((a2) => {\n        var r;\n        (r = a2.onHandlerActiveEnd) == null || r.call(a2, t);\n      });\n    }));\n  }\n  registerMode(t) {\n    this.modes.set(t.id, t), this.buckets.has(t.id) || this.buckets.set(t.id, { global: /* @__PURE__ */ new Set(), page: /* @__PURE__ */ new Map() });\n  }\n  /** ---------- pointer-handler handling ------------ */\n  registerHandlers({ modeId: t, handlers: e, pageIndex: i2 }) {\n    const s = Array.isArray(t) ? t : [t], o = [];\n    for (const a2 of s) {\n      const r = this.buckets.get(a2);\n      if (!r) throw new Error(`unknown mode '${a2}'`);\n      if (i2 == null)\n        r.global.add(e);\n      else {\n        const c2 = r.page.get(i2) ?? /* @__PURE__ */ new Set();\n        c2.add(e), r.page.set(i2, c2);\n      }\n      o.push(() => {\n        if (i2 == null)\n          r.global.delete(e);\n        else {\n          const c2 = r.page.get(i2);\n          c2 && (c2.delete(e), c2.size === 0 && r.page.delete(i2));\n        }\n      });\n    }\n    return this.onHandlerChange$.emit({ ...this.state }), () => {\n      o.forEach((a2) => a2()), this.onHandlerChange$.emit({ ...this.state });\n    };\n  }\n  registerAlways({ scope: t, handlers: e }) {\n    if (t.type === \"global\")\n      return this.alwaysGlobal.add(e), this.onHandlerChange$.emit({ ...this.state }), () => this.alwaysGlobal.delete(e);\n    const i2 = this.alwaysPage.get(t.pageIndex) ?? /* @__PURE__ */ new Set();\n    return i2.add(e), this.alwaysPage.set(t.pageIndex, i2), this.onHandlerChange$.emit({ ...this.state }), () => {\n      i2.delete(e), this.onHandlerChange$.emit({ ...this.state });\n    };\n  }\n  /** Returns the *merged* handler set that should be active for the given\n   *  provider (`global` wrapper or a single page wrapper).\n   *   `alwaysGlobal` / `alwaysPage` are **always** active.\n   *   Handlers that belong to the current mode are added on top **iff**\n   *    the modes own scope matches the providers scope.            */\n  getHandlersForScope(t) {\n    if (!this.state) return null;\n    const e = this.modes.get(this.state.activeMode);\n    if (!e) return null;\n    const i2 = this.buckets.get(e.id);\n    if (!i2) return null;\n    const s = (r, c2) => r.size || c2.size ? S2([...r, ...c2]) : null;\n    if (t.type === \"global\") {\n      const r = e.scope === \"global\" ? i2.global : /* @__PURE__ */ new Set();\n      return s(this.alwaysGlobal, r);\n    }\n    const o = this.alwaysPage.get(t.pageIndex) ?? /* @__PURE__ */ new Set(), a2 = e.scope === \"page\" ? i2.page.get(t.pageIndex) ?? /* @__PURE__ */ new Set() : /* @__PURE__ */ new Set();\n    return s(o, a2);\n  }\n  /** ---------- cursor handling --------------------- */\n  setCursor(t, e, i2 = 0) {\n    this.cursorClaims.set(t, { cursor: e, priority: i2 }), this.emitCursor();\n  }\n  removeCursor(t) {\n    this.cursorClaims.delete(t), this.emitCursor();\n  }\n  emitCursor() {\n    var e;\n    const t = [...this.cursorClaims.values()].sort((i2, s) => s.priority - i2.priority)[0] ?? {\n      cursor: ((e = this.modes.get(this.state.activeMode)) == null ? void 0 : e.cursor) ?? \"auto\"\n    };\n    t.cursor !== this.state.cursor && (this.dispatch(w4(t.cursor)), this.onCursorChange$.emit(t.cursor));\n  }\n  onStoreUpdated(t, e) {\n    this.onStateChange$.emit(e);\n  }\n  activeModeIsExclusive() {\n    const t = this.modes.get(this.state.activeMode);\n    return !!(t != null && t.exclusive);\n  }\n  getActiveInteractionMode() {\n    return this.modes.get(this.state.activeMode) ?? null;\n  }\n  // keep emitter clean\n  async destroy() {\n    this.onModeChange$.clear(), this.onCursorChange$.clear(), await super.destroy();\n  }\n};\nl.id = \"interaction-manager\";\nvar h2 = l;\n\n// ../plugin-interaction-manager/dist/preact/index.js\nvar i = () => L(h2.id);\nfunction F3({ modeId: e, pageIndex: n }) {\n  const { provides: r } = i();\n  return {\n    register: (t, s) => {\n      const u = (s == null ? void 0 : s.modeId) ?? e, o = (s == null ? void 0 : s.pageIndex) ?? n;\n      return u ? r == null ? void 0 : r.registerHandlers({\n        modeId: u,\n        handlers: t,\n        pageIndex: o\n      }) : r == null ? void 0 : r.registerAlways({\n        scope: o !== void 0 ? { type: \"page\", pageIndex: o } : { type: \"global\" },\n        handlers: t\n      });\n    }\n  };\n}\n\n// src/preact/components/marquee-zoom.tsx\nimport { jsx as jsx2 } from \"preact/jsx-runtime\";\nvar MarqueeZoom = ({\n  pageIndex,\n  scale,\n  pageWidth,\n  pageHeight,\n  className,\n  stroke = \"rgba(33,150,243,0.8)\",\n  fill = \"rgba(33,150,243,0.15)\"\n}) => {\n  const { provides: zoom } = useZoomCapability();\n  const { register } = F3({ modeId: \"marqueeZoom\", pageIndex });\n  const clamp = (v3, min, max) => Math.max(min, Math.min(max, v3));\n  const startRef = useRef2(null);\n  const [rect, setRect] = useState2(null);\n  const pageWidthPDF = pageWidth / scale;\n  const pageHeightPDF = pageHeight / scale;\n  const handlers = useMemo(\n    () => ({\n      onPointerDown: (pos, evt) => {\n        startRef.current = pos;\n        setRect({ origin: { x: pos.x, y: pos.y }, size: { width: 0, height: 0 } });\n        evt.target?.setPointerCapture?.(evt.pointerId);\n      },\n      onPointerMove: (pos) => {\n        if (!startRef.current) return;\n        const curX = clamp(pos.x, 0, pageWidthPDF);\n        const curY = clamp(pos.y, 0, pageHeightPDF);\n        const { x: sx, y: sy } = startRef.current;\n        const left = Math.min(sx, curX);\n        const top = Math.min(sy, curY);\n        const width = Math.abs(curX - sx);\n        const height = Math.abs(curY - sy);\n        setRect({ origin: { x: left, y: top }, size: { width, height } });\n      },\n      onPointerUp: (_, evt) => {\n        if (rect && zoom) {\n          const dragPx = Math.max(rect.size.width, rect.size.height) * scale;\n          if (dragPx > 5) {\n            zoom.zoomToArea(pageIndex, rect);\n          } else {\n            zoom.zoomIn();\n          }\n        }\n        startRef.current = null;\n        setRect(null);\n        evt.target?.releasePointerCapture?.(evt.pointerId);\n      },\n      onPointerCancel: (_, evt) => {\n        startRef.current = null;\n        setRect(null);\n        evt.target?.releasePointerCapture?.(evt.pointerId);\n      }\n    }),\n    [pageWidthPDF, pageWidthPDF, zoom, scale, rect, pageIndex]\n  );\n  useEffect3(() => {\n    if (!register) return;\n    return register(handlers);\n  }, [register, handlers]);\n  if (!rect) return null;\n  return /* @__PURE__ */ jsx2(\n    \"div\",\n    {\n      style: {\n        position: \"absolute\",\n        pointerEvents: \"none\",\n        // ignore hits  underlying page still gets events\n        left: rect.origin.x * scale,\n        top: rect.origin.y * scale,\n        width: rect.size.width * scale,\n        height: rect.size.height * scale,\n        border: `1px solid ${stroke}`,\n        background: fill,\n        boxSizing: \"border-box\"\n      },\n      className\n    }\n  );\n};\nexport {\n  MarqueeZoom,\n  PinchWrapper,\n  usePinch,\n  useZoom,\n  useZoomCapability,\n  useZoomPlugin\n};\n//# sourceMappingURL=index.js.map","import { h, VNode, JSX, ComponentChildren } from 'preact';\nimport { IconIdentifier, IconRenderOptions } from '@embedpdf/plugin-ui';\nimport { useIcon } from '@embedpdf/plugin-ui/preact';\n\ntype IconProps = JSX.ButtonHTMLAttributes<HTMLSpanElement> &\n  IconRenderOptions & {\n    icon: IconIdentifier;\n  };\n\n/**\n * Icon component for React\n * Renders an icon from the registry or a raw SVG string in an SSR-compatible way\n */\nexport function Icon({ icon, title, ...props }: IconProps): VNode | null {\n  const iconManager = useIcon();\n  let svgContent: string | undefined;\n\n  // Check if it's a data URI\n  if (iconManager.isSvgDataUri(icon)) {\n    svgContent = iconManager.dataUriToSvgString(icon);\n  } else {\n    svgContent = iconManager.getSvgString(icon);\n  }\n\n  if (!svgContent) {\n    console.warn(`Icon not found: ${icon}`);\n    return null;\n  }\n\n  // Build the component with dangerouslySetInnerHTML to avoid DOM usage\n  const iconElement = (\n    <span\n      {...props}\n      dangerouslySetInnerHTML={{\n        __html: svgContent,\n      }}\n    />\n  );\n\n  return title ? (\n    <span title={title} {...props}>\n      {iconElement}\n    </span>\n  ) : (\n    iconElement\n  );\n}\n","import { useEffect, useState } from 'preact/hooks'; // or react/hooks\n\nexport function useDebounce<T>(value: T, delay = 300): T {\n  const [debounced, setDebounced] = useState(value);\n\n  useEffect(() => {\n    const id = window.setTimeout(() => setDebounced(value), delay);\n    return () => clearTimeout(id); // cancel if value changes early\n  }, [value, delay]);\n\n  return debounced;\n}\n","import { h } from 'preact';\n\ninterface CheckboxProps {\n  label: string;\n  checked: boolean;\n  onChange: (v: boolean) => void;\n}\n\nexport const Checkbox = ({ label, checked, onChange }: CheckboxProps) => (\n  <label className=\"inline-flex cursor-pointer select-none items-center gap-2 text-xs font-medium text-gray-700\">\n    {/* 1 the real checkbox (still visible so we keep keyboard a11y) */}\n    <input\n      type=\"checkbox\"\n      checked={checked}\n      onChange={(e) => onChange((e.target as HTMLInputElement).checked)}\n      className=\"peer h-4 w-4 shrink-0 appearance-none rounded-[3px] border border-gray-300 bg-white transition-all checked:border-blue-600 checked:bg-blue-600\"\n    />\n\n    {/* 2 overlayed check icon that fades in only when checked */}\n    <svg\n      viewBox=\"0 0 24 24\"\n      className=\"/* fine-tune centering */ pointer-events-none absolute h-3.5 w-3.5 translate-x-[1px] translate-y-[1px] text-white opacity-0 peer-checked:opacity-100\"\n      fill=\"none\"\n      stroke=\"currentColor\"\n      strokeWidth={3}\n      strokeLinecap=\"round\"\n      strokeLinejoin=\"round\"\n    >\n      <polyline points=\"20 6 9 17 4 12\" />\n    </svg>\n\n    {label}\n  </label>\n);\n","import { BasePlugin as G, createBehaviorEmitter as I, createEmitter as m, SET_DOCUMENT as D } from \"@embedpdf/core\";\nimport { boundingRect as z, PdfTaskHelper as u, PdfErrorCode as M, ignore as E } from \"@embedpdf/models\";\nconst L = \"selection\", B = {\n  id: L,\n  name: \"Selection Plugin\",\n  version: \"1.0.0\",\n  provides: [\"selection\"],\n  requires: [\"interaction-manager\"],\n  optional: [],\n  defaultConfig: {\n    enabled: !0\n  }\n}, _ = \"CACHE_PAGE_GEOMETRY\", O = \"SET_SELECTION\", w = \"START_SELECTION\", N = \"END_SELECTION\", A = \"CLEAR_SELECTION\", P = \"SET_RECTS\", v = \"SET_SLICES\", F = \"RESET\", k = (e, t) => ({\n  type: _,\n  payload: { page: e, geo: t }\n}), j = (e) => ({\n  type: O,\n  payload: e\n}), V = () => ({ type: w }), W = () => ({ type: N }), Y = () => ({ type: A }), U = (e) => ({\n  type: P,\n  payload: e\n}), q = (e) => ({ type: v, payload: e }), X = () => ({ type: F });\nfunction $(e, t) {\n  return e.rects[t] ?? [];\n}\nfunction C(e, t) {\n  return z($(e, t));\n}\nfunction Z(e) {\n  const t = [], n = e.rects;\n  for (const i in n) {\n    const s = Number(i), o = z(n[s]);\n    o && t.push({ page: s, rect: o });\n  }\n  return t;\n}\nfunction J(e, t) {\n  const n = e.rects[t] || [];\n  if (n.length === 0) return null;\n  const i = C(e, t);\n  return i ? { pageIndex: t, rect: i, segmentRects: n } : null;\n}\nfunction K(e) {\n  const t = [], n = Object.keys(e.rects).map(Number);\n  for (const i of n) {\n    const s = e.rects[i] || [];\n    if (s.length === 0) continue;\n    const o = C(e, i);\n    o && t.push({\n      pageIndex: i,\n      rect: o,\n      segmentRects: s\n    });\n  }\n  return t;\n}\nfunction at(e, t) {\n  for (const n of e.runs) {\n    if (!(t.y >= n.rect.y && t.y <= n.rect.y + n.rect.height && t.x >= n.rect.x && t.x <= n.rect.x + n.rect.width)) continue;\n    const s = n.glyphs.findIndex(\n      (o) => t.x >= o.x && t.x <= o.x + o.width && t.y >= o.y && t.y <= o.y + o.height\n    );\n    if (s !== -1)\n      return n.charStart + s;\n  }\n  return -1;\n}\nfunction Q(e, t, n) {\n  if (!e || !t || n < e.start.page || n > e.end.page) return null;\n  const i = n === e.start.page ? e.start.index : 0, s = t.runs[t.runs.length - 1], o = s.charStart + s.glyphs.length - 1, c = n === e.end.page ? e.end.index : o;\n  return { from: i, to: c };\n}\nfunction tt(e, t, n, i = !0) {\n  const s = [];\n  for (const o of e.runs) {\n    const c = o.charStart, r = c + o.glyphs.length - 1;\n    if (r < t || c > n) continue;\n    const d = Math.max(t, c) - c, f = Math.min(n, r) - c;\n    let a = 1 / 0, l = -1 / 0, g = 1 / 0, S = -1 / 0, p = 0;\n    for (let y = d; y <= f; y++) {\n      const h = o.glyphs[y];\n      h.flags !== 2 && (a = Math.min(a, h.x), l = Math.max(l, h.x + h.width), g = Math.min(g, h.y), S = Math.max(S, h.y + h.height), p++);\n    }\n    a !== 1 / 0 && p > 0 && s.push({\n      rect: {\n        origin: { x: a, y: g },\n        size: { width: l - a, height: S - g }\n      },\n      charCount: p\n    });\n  }\n  return i ? st(s) : s.map((o) => o.rect);\n}\nfunction H(e, t) {\n  const n = Math.min(e.origin.x, t.origin.x), i = Math.min(e.origin.y, t.origin.y), s = Math.max(e.origin.x + e.size.width, t.origin.x + t.size.width), o = Math.max(e.origin.y + e.size.height, t.origin.y + t.size.height);\n  return {\n    origin: { x: n, y: i },\n    size: { width: s - n, height: o - i }\n  };\n}\nfunction et(e, t) {\n  const n = Math.max(e.origin.x, t.origin.x), i = Math.max(e.origin.y, t.origin.y), s = Math.min(e.origin.x + e.size.width, t.origin.x + t.size.width), o = Math.min(e.origin.y + e.size.height, t.origin.y + t.size.height), c = Math.max(0, s - n), r = Math.max(0, o - i);\n  return {\n    origin: { x: n, y: i },\n    size: { width: c, height: r }\n  };\n}\nfunction x(e) {\n  return e.size.width <= 0 || e.size.height <= 0;\n}\nfunction nt(e, t) {\n  if (x(e) || x(t)) return 0;\n  const n = H(e, t);\n  return n.size.height === e.size.height || n.size.height === t.size.height ? 1 : et(e, t).size.height / n.size.height;\n}\nfunction it(e, t) {\n  const i = e.rect, s = t.rect;\n  if (nt(i, s) < 0.8)\n    return !1;\n  const o = 1, c = o * i.size.width / e.charCount, r = o * s.size.width / t.charCount, d = i.origin.x - c, f = i.origin.x + i.size.width + c, a = s.origin.x - r, l = s.origin.x + s.size.width + r;\n  return d < l && f > a;\n}\nfunction st(e) {\n  const t = [];\n  let n = null, i = null;\n  for (const s of e)\n    n && i ? it(n, s) ? i = H(i, s.rect) : (t.push(i), i = s.rect) : i = s.rect, n = s;\n  return i && !x(i) && t.push(i), t;\n}\nconst b = class b extends G {\n  constructor(t, n, i) {\n    super(t, n), this.engine = i, this.enabledModes = /* @__PURE__ */ new Set([\"default\"]), this.selecting = !1, this.selChange$ = I(), this.textRetrieved$ = I(), this.copyToClipboard$ = m(), this.beginSelection$ = m(), this.endSelection$ = m(), this.coreStore.onAction(D, (s) => {\n      this.dispatch(X());\n    });\n  }\n  /*  life-cycle  */\n  async initialize() {\n  }\n  async destroy() {\n    this.selChange$.clear();\n  }\n  /*  capability exposed to UI / other plugins  */\n  buildCapability() {\n    return {\n      getGeometry: (t) => this.getOrLoadGeometry(t),\n      getFormattedSelection: () => K(this.state),\n      getFormattedSelectionForPage: (t) => J(this.state, t),\n      getHighlightRectsForPage: (t) => $(this.state, t),\n      getHighlightRects: () => this.state.rects,\n      getBoundingRectForPage: (t) => C(this.state, t),\n      getBoundingRects: () => Z(this.state),\n      begin: (t, n) => this.beginSelection(t, n),\n      update: (t, n) => this.updateSelection(t, n),\n      end: () => this.endSelection(),\n      clear: () => this.clearSelection(),\n      onCopyToClipboard: this.copyToClipboard$.on,\n      onSelectionChange: this.selChange$.on,\n      onTextRetrieved: this.textRetrieved$.on,\n      onBeginSelection: this.beginSelection$.on,\n      onEndSelection: this.endSelection$.on,\n      getSelectedText: () => this.getSelectedText(),\n      copyToClipboard: () => this.copyToClipboard(),\n      enableForMode: (t) => this.enabledModes.add(t),\n      isEnabledForMode: (t) => this.enabledModes.has(t),\n      getState: () => this.state\n    };\n  }\n  /*  geometry cache  */\n  getOrLoadGeometry(t) {\n    const n = this.state.geometry[t];\n    if (n) return u.resolve(n);\n    if (!this.coreState.core.document)\n      return u.reject({ code: M.NotFound, message: \"Doc Not Found\" });\n    const i = this.coreState.core.document.pages.find((o) => o.index === t), s = this.engine.getPageGeometry(this.coreState.core.document, i);\n    return s.wait((o) => {\n      this.dispatch(k(t, o));\n    }, E), s;\n  }\n  /*  selection state updates  */\n  beginSelection(t, n) {\n    this.selecting = !0, this.anchor = { page: t, index: n }, this.dispatch(V()), this.beginSelection$.emit({ page: t, index: n });\n  }\n  endSelection() {\n    this.selecting = !1, this.anchor = void 0, this.dispatch(W()), this.endSelection$.emit();\n  }\n  clearSelection() {\n    this.selecting = !1, this.anchor = void 0, this.dispatch(Y()), this.selChange$.emit(null);\n  }\n  updateSelection(t, n) {\n    if (!this.selecting || !this.anchor) return;\n    const i = this.anchor, s = t > i.page || t === i.page && n >= i.index, r = { start: s ? i : { page: t, index: n }, end: s ? { page: t, index: n } : i };\n    this.dispatch(j(r)), this.updateRectsAndSlices(r), this.selChange$.emit(r);\n  }\n  updateRectsAndSlices(t) {\n    const n = {}, i = {};\n    for (let s = t.start.page; s <= t.end.page; s++) {\n      const o = this.state.geometry[s], c = Q(t, o, s);\n      c && (n[s] = tt(o, c.from, c.to), i[s] = { start: c.from, count: c.to - c.from + 1 });\n    }\n    this.dispatch(U(n)), this.dispatch(q(i));\n  }\n  getSelectedText() {\n    if (!this.coreState.core.document || !this.state.selection)\n      return u.reject({\n        code: M.NotFound,\n        message: \"Doc Not Found or No Selection\"\n      });\n    const t = this.state.selection, n = [];\n    for (let s = t.start.page; s <= t.end.page; s++) {\n      const o = this.state.slices[s];\n      o && n.push({ pageIndex: s, charIndex: o.start, charCount: o.count });\n    }\n    if (n.length === 0) return u.resolve([]);\n    const i = this.engine.getTextSlices(this.coreState.core.document, n);\n    return i.wait((s) => {\n      this.textRetrieved$.emit(s);\n    }, E), i;\n  }\n  copyToClipboard() {\n    this.getSelectedText().wait((n) => {\n      this.copyToClipboard$.emit(n.join(`\n`));\n    }, E);\n  }\n};\nb.id = \"selection\";\nlet R = b;\nconst T = {\n  geometry: {},\n  rects: {},\n  slices: {},\n  selection: null,\n  active: !1,\n  selecting: !1\n}, ot = (e = T, t) => {\n  switch (t.type) {\n    case _: {\n      const { page: n, geo: i } = t.payload;\n      return { ...e, geometry: { ...e.geometry, [n]: i } };\n    }\n    case O:\n      return { ...e, selection: t.payload, active: !0 };\n    case w:\n      return { ...e, selecting: !0, selection: null, rects: {} };\n    case N:\n      return { ...e, selecting: !1 };\n    case A:\n      return { ...e, selecting: !1, selection: null, rects: {}, active: !1 };\n    case P:\n      return { ...e, rects: t.payload };\n    case v:\n      return { ...e, slices: t.payload };\n    case F:\n      return T;\n    default:\n      return e;\n  }\n}, ht = {\n  manifest: B,\n  create: (e, t) => new R(L, e, t),\n  reducer: ot,\n  initialState: T\n};\nexport {\n  L as SELECTION_PLUGIN_ID,\n  R as SelectionPlugin,\n  ht as SelectionPluginPackage,\n  nt as getVerticalOverlap,\n  at as glyphAt,\n  B as manifest,\n  st as mergeAdjacentRects,\n  et as rectIntersect,\n  x as rectIsEmpty,\n  H as rectUnion,\n  tt as rectsWithinSlice,\n  it as shouldMergeHorizontalRects,\n  Q as sliceBounds\n};\n//# sourceMappingURL=index.js.map\n","function P(e, s, t, d) {\n  let r = e.getHandlersForScope(s);\n  const b = e.onModeChange(() => {\n    if (s.type === \"global\") {\n      const o = e.getActiveInteractionMode();\n      t.style.cursor = (o == null ? void 0 : o.scope) === \"global\" ? o.cursor ?? \"auto\" : \"auto\";\n    }\n    r = e.getHandlersForScope(s);\n  }), f = e.onHandlerChange(() => {\n    r = e.getHandlersForScope(s);\n  }), c = e.getActiveInteractionMode(), g = e.getCurrentCursor();\n  s.type === \"global\" ? t.style.cursor = (c == null ? void 0 : c.scope) === \"global\" ? g : \"auto\" : t.style.cursor = g;\n  const y = e.onCursorChange((o) => {\n    var n;\n    s.type === \"global\" && !(((n = e.getActiveInteractionMode()) == null ? void 0 : n.scope) === \"global\") || (t.style.cursor = o);\n  }), l = {\n    onPointerDown: \"pointerdown\",\n    onPointerUp: \"pointerup\",\n    onPointerMove: \"pointermove\",\n    onPointerEnter: \"pointerenter\",\n    onPointerLeave: \"pointerleave\",\n    onPointerCancel: \"pointercancel\"\n  }, u = {}, M = (o, n) => {\n    if (d) return d(o, n);\n    const i = n.getBoundingClientRect();\n    return { x: o.clientX - i.left, y: o.clientY - i.top };\n  };\n  return Object.keys(l).forEach((o) => {\n    u[o] = (n) => {\n      var a;\n      if (e.isPaused()) return;\n      const i = n, C = e.getActiveMode();\n      (a = r == null ? void 0 : r[o]) == null || a.call(r, M(i, t), i, C);\n    }, t.addEventListener(l[o], u[o]);\n  }), () => {\n    Object.keys(l).forEach(\n      (o) => t.removeEventListener(l[o], u[o])\n    ), b(), y(), f();\n  };\n}\nexport {\n  P as c\n};\n//# sourceMappingURL=utils-plgMhFiX.js.map\n","import { BasePlugin as v, createEmitter as u, createBehaviorEmitter as E } from \"@embedpdf/core\";\nconst g = \"INTERACTION/ACTIVATE_MODE\", p = \"INTERACTION/PAUSE\", f = \"INTERACTION/RESUME\", C = \"INTERACTION/SET_CURSOR\", y = (n) => ({\n  type: g,\n  payload: { mode: n }\n}), w = (n) => ({\n  type: C,\n  payload: { cursor: n }\n}), M = () => ({\n  type: p\n}), A = () => ({\n  type: f\n});\nfunction S(n) {\n  const t = [\n    \"onPointerDown\",\n    \"onPointerUp\",\n    \"onPointerMove\",\n    \"onPointerEnter\",\n    \"onPointerLeave\",\n    \"onPointerCancel\"\n  ], e = {};\n  for (const i of t)\n    e[i] = (s, o, a) => {\n      var r;\n      for (const c of n) (r = c[i]) == null || r.call(c, s, o, a);\n    };\n  return e;\n}\nconst l = class l extends v {\n  constructor(t, e) {\n    super(t, e), this.modes = /* @__PURE__ */ new Map(), this.cursorClaims = /* @__PURE__ */ new Map(), this.buckets = /* @__PURE__ */ new Map(), this.alwaysGlobal = /* @__PURE__ */ new Set(), this.alwaysPage = /* @__PURE__ */ new Map(), this.onModeChange$ = u(), this.onHandlerChange$ = u(), this.onCursorChange$ = u(), this.onStateChange$ = E(), this.registerMode({\n      id: \"default\",\n      scope: \"page\",\n      exclusive: !1,\n      cursor: \"auto\"\n    });\n  }\n  async initialize(t) {\n  }\n  buildCapability() {\n    return {\n      activate: (t) => this.activate(t),\n      onModeChange: this.onModeChange$.on,\n      onCursorChange: this.onCursorChange$.on,\n      onHandlerChange: this.onHandlerChange$.on,\n      onStateChange: this.onStateChange$.on,\n      getActiveMode: () => this.state.activeMode,\n      getActiveInteractionMode: () => this.getActiveInteractionMode(),\n      finish: () => this.activate(\"default\"),\n      registerMode: (t) => this.registerMode(t),\n      registerHandlers: (t) => this.registerHandlers(t),\n      registerAlways: (t) => this.registerAlways(t),\n      setCursor: (t, e, i = 0) => this.setCursor(t, e, i),\n      removeCursor: (t) => this.removeCursor(t),\n      getCurrentCursor: () => this.state.cursor,\n      getHandlersForScope: (t) => this.getHandlersForScope(t),\n      activeModeIsExclusive: () => this.activeModeIsExclusive(),\n      pause: () => this.dispatch(M()),\n      resume: () => this.dispatch(A()),\n      isPaused: () => this.state.paused\n    };\n  }\n  activate(t) {\n    if (!this.modes.has(t))\n      throw new Error(`[interaction] unknown mode '${t}'`);\n    if (t === this.state.activeMode) return;\n    const e = this.state.activeMode;\n    this.cursorClaims.clear(), this.notifyHandlersInactive(e), this.dispatch(y(t)), this.emitCursor(), this.notifyHandlersActive(t), this.onModeChange$.emit({ ...this.state, activeMode: t });\n  }\n  notifyHandlersActive(t) {\n    this.alwaysGlobal.forEach((s) => {\n      var o;\n      (o = s.onHandlerActiveStart) == null || o.call(s, t);\n    }), this.alwaysPage.forEach((s) => {\n      s.forEach((o) => {\n        var a;\n        (a = o.onHandlerActiveStart) == null || a.call(o, t);\n      });\n    });\n    const e = this.modes.get(t);\n    if (!e) return;\n    const i = this.buckets.get(t);\n    i && (e.scope === \"global\" && i.global.forEach((s) => {\n      var o;\n      (o = s.onHandlerActiveStart) == null || o.call(s, t);\n    }), e.scope === \"page\" && i.page.forEach((s, o) => {\n      s.forEach((a) => {\n        var r;\n        (r = a.onHandlerActiveStart) == null || r.call(a, t);\n      });\n    }));\n  }\n  notifyHandlersInactive(t) {\n    this.alwaysGlobal.forEach((s) => {\n      var o;\n      (o = s.onHandlerActiveEnd) == null || o.call(s, t);\n    }), this.alwaysPage.forEach((s) => {\n      s.forEach((o) => {\n        var a;\n        (a = o.onHandlerActiveEnd) == null || a.call(o, t);\n      });\n    });\n    const e = this.modes.get(t);\n    if (!e) return;\n    const i = this.buckets.get(t);\n    i && (e.scope === \"global\" && i.global.forEach((s) => {\n      var o;\n      (o = s.onHandlerActiveEnd) == null || o.call(s, t);\n    }), e.scope === \"page\" && i.page.forEach((s, o) => {\n      s.forEach((a) => {\n        var r;\n        (r = a.onHandlerActiveEnd) == null || r.call(a, t);\n      });\n    }));\n  }\n  registerMode(t) {\n    this.modes.set(t.id, t), this.buckets.has(t.id) || this.buckets.set(t.id, { global: /* @__PURE__ */ new Set(), page: /* @__PURE__ */ new Map() });\n  }\n  /** ---------- pointer-handler handling ------------ */\n  registerHandlers({ modeId: t, handlers: e, pageIndex: i }) {\n    const s = Array.isArray(t) ? t : [t], o = [];\n    for (const a of s) {\n      const r = this.buckets.get(a);\n      if (!r) throw new Error(`unknown mode '${a}'`);\n      if (i == null)\n        r.global.add(e);\n      else {\n        const c = r.page.get(i) ?? /* @__PURE__ */ new Set();\n        c.add(e), r.page.set(i, c);\n      }\n      o.push(() => {\n        if (i == null)\n          r.global.delete(e);\n        else {\n          const c = r.page.get(i);\n          c && (c.delete(e), c.size === 0 && r.page.delete(i));\n        }\n      });\n    }\n    return this.onHandlerChange$.emit({ ...this.state }), () => {\n      o.forEach((a) => a()), this.onHandlerChange$.emit({ ...this.state });\n    };\n  }\n  registerAlways({ scope: t, handlers: e }) {\n    if (t.type === \"global\")\n      return this.alwaysGlobal.add(e), this.onHandlerChange$.emit({ ...this.state }), () => this.alwaysGlobal.delete(e);\n    const i = this.alwaysPage.get(t.pageIndex) ?? /* @__PURE__ */ new Set();\n    return i.add(e), this.alwaysPage.set(t.pageIndex, i), this.onHandlerChange$.emit({ ...this.state }), () => {\n      i.delete(e), this.onHandlerChange$.emit({ ...this.state });\n    };\n  }\n  /** Returns the *merged* handler set that should be active for the given\n   *  provider (`global` wrapper or a single page wrapper).\n   *   `alwaysGlobal` / `alwaysPage` are **always** active.\n   *   Handlers that belong to the current mode are added on top **iff**\n   *    the modes own scope matches the providers scope.            */\n  getHandlersForScope(t) {\n    if (!this.state) return null;\n    const e = this.modes.get(this.state.activeMode);\n    if (!e) return null;\n    const i = this.buckets.get(e.id);\n    if (!i) return null;\n    const s = (r, c) => r.size || c.size ? S([...r, ...c]) : null;\n    if (t.type === \"global\") {\n      const r = e.scope === \"global\" ? i.global : /* @__PURE__ */ new Set();\n      return s(this.alwaysGlobal, r);\n    }\n    const o = this.alwaysPage.get(t.pageIndex) ?? /* @__PURE__ */ new Set(), a = e.scope === \"page\" ? i.page.get(t.pageIndex) ?? /* @__PURE__ */ new Set() : /* @__PURE__ */ new Set();\n    return s(o, a);\n  }\n  /** ---------- cursor handling --------------------- */\n  setCursor(t, e, i = 0) {\n    this.cursorClaims.set(t, { cursor: e, priority: i }), this.emitCursor();\n  }\n  removeCursor(t) {\n    this.cursorClaims.delete(t), this.emitCursor();\n  }\n  emitCursor() {\n    var e;\n    const t = [...this.cursorClaims.values()].sort((i, s) => s.priority - i.priority)[0] ?? {\n      cursor: ((e = this.modes.get(this.state.activeMode)) == null ? void 0 : e.cursor) ?? \"auto\"\n    };\n    t.cursor !== this.state.cursor && (this.dispatch(w(t.cursor)), this.onCursorChange$.emit(t.cursor));\n  }\n  onStoreUpdated(t, e) {\n    this.onStateChange$.emit(e);\n  }\n  activeModeIsExclusive() {\n    const t = this.modes.get(this.state.activeMode);\n    return !!(t != null && t.exclusive);\n  }\n  getActiveInteractionMode() {\n    return this.modes.get(this.state.activeMode) ?? null;\n  }\n  // keep emitter clean\n  async destroy() {\n    this.onModeChange$.clear(), this.onCursorChange$.clear(), await super.destroy();\n  }\n};\nl.id = \"interaction-manager\";\nlet h = l;\nconst d = \"interaction-manager\", b = {\n  id: d,\n  name: \"Interaction Manager Plugin\",\n  version: \"1.0.0\",\n  provides: [\"interaction-manager\"],\n  requires: [],\n  optional: [],\n  defaultConfig: {\n    enabled: !0\n  }\n}, m = {\n  activeMode: \"default\",\n  cursor: \"auto\",\n  paused: !1\n}, H = (n, t) => {\n  switch (t.type) {\n    case g:\n      return {\n        ...n,\n        activeMode: t.payload.mode\n      };\n    case C:\n      return {\n        ...n,\n        cursor: t.payload.cursor\n      };\n    case p:\n      return {\n        ...n,\n        paused: !0\n      };\n    case f:\n      return {\n        ...n,\n        paused: !1\n      };\n    default:\n      return n;\n  }\n}, T = {\n  manifest: b,\n  create: (n) => new h(d, n),\n  reducer: H,\n  initialState: m\n};\nexport {\n  d as INTERACTION_MANAGER_PLUGIN_ID,\n  h as InteractionManagerPlugin,\n  T as InteractionManagerPluginPackage,\n  m as initialState,\n  b as manifest,\n  H as reducer\n};\n//# sourceMappingURL=index.js.map\n","import { jsx as P, jsxs as h } from \"preact/jsx-runtime\";\nimport { useState as I, useEffect as c, useRef as p, useCallback as E } from \"preact/hooks\";\nimport { c as v } from \"../utils-plgMhFiX.js\";\nimport { usePlugin as S, useCapability as w } from \"@embedpdf/core/preact\";\nimport { InteractionManagerPlugin as x, initialState as A } from \"@embedpdf/plugin-interaction-manager\";\nimport { restorePosition as j } from \"@embedpdf/models\";\nconst Y = () => S(x.id), i = () => w(x.id);\nfunction q() {\n  const { provides: e } = i(), [n, r] = I(A);\n  return c(() => {\n    if (e)\n      return e.onStateChange((t) => {\n        r(t);\n      });\n  }, [e]), {\n    provides: e,\n    state: n\n  };\n}\nfunction D() {\n  const { provides: e } = i();\n  return {\n    setCursor: (n, r, t = 0) => {\n      e == null || e.setCursor(n, r, t);\n    },\n    removeCursor: (n) => {\n      e == null || e.removeCursor(n);\n    }\n  };\n}\nfunction F({ modeId: e, pageIndex: n }) {\n  const { provides: r } = i();\n  return {\n    register: (t, s) => {\n      const u = (s == null ? void 0 : s.modeId) ?? e, o = (s == null ? void 0 : s.pageIndex) ?? n;\n      return u ? r == null ? void 0 : r.registerHandlers({\n        modeId: u,\n        handlers: t,\n        pageIndex: o\n      }) : r == null ? void 0 : r.registerAlways({\n        scope: o !== void 0 ? { type: \"page\", pageIndex: o } : { type: \"global\" },\n        handlers: t\n      });\n    }\n  };\n}\nfunction R() {\n  const { provides: e } = i(), [n, r] = I(() => {\n    const t = e == null ? void 0 : e.getActiveInteractionMode();\n    return (t == null ? void 0 : t.scope) === \"page\" && !!t.exclusive;\n  });\n  return c(() => {\n    if (e)\n      return e.onModeChange(() => {\n        const t = e.getActiveInteractionMode();\n        r((t == null ? void 0 : t.scope) === \"page\" && !!(t != null && t.exclusive));\n      });\n  }, [e]), n;\n}\nconst J = ({\n  children: e,\n  style: n,\n  ...r\n}) => {\n  const t = p(null), { provides: s } = i();\n  return c(() => {\n    if (!(!s || !t.current))\n      return v(s, { type: \"global\" }, t.current);\n  }, [s]), /* @__PURE__ */ P(\n    \"div\",\n    {\n      ref: t,\n      style: {\n        width: \"100%\",\n        height: \"100%\",\n        ...n\n      },\n      ...r,\n      children: e\n    }\n  );\n}, K = ({\n  pageIndex: e,\n  children: n,\n  pageWidth: r,\n  pageHeight: t,\n  rotation: s,\n  scale: u,\n  convertEventToPoint: o,\n  style: m,\n  ...y\n}) => {\n  const a = p(null), { provides: l } = i(), C = R(), g = E(\n    (f, b) => {\n      const d = b.getBoundingClientRect(), M = {\n        x: f.clientX - d.left,\n        y: f.clientY - d.top\n      };\n      return j(\n        { width: r, height: t },\n        M,\n        s,\n        u\n      );\n    },\n    [r, t, s, u]\n  );\n  return c(() => {\n    if (!(!l || !a.current))\n      return v(\n        l,\n        { type: \"page\", pageIndex: e },\n        a.current,\n        o || g\n      );\n  }, [l, e, o, g]), /* @__PURE__ */ h(\n    \"div\",\n    {\n      ref: a,\n      style: {\n        ...m\n      },\n      ...y,\n      children: [\n        n,\n        C && /* @__PURE__ */ P(\"div\", { style: { position: \"absolute\", top: 0, left: 0, right: 0, bottom: 0, zIndex: 10 } })\n      ]\n    }\n  );\n};\nexport {\n  J as GlobalPointerProvider,\n  K as PagePointerProvider,\n  D as useCursor,\n  q as useInteractionManager,\n  i as useInteractionManagerCapability,\n  Y as useInteractionManagerPlugin,\n  R as useIsPageExclusive,\n  F as usePointerHandlers\n};\n//# sourceMappingURL=index.js.map\n","import { useCapability as k, usePlugin as z } from \"@embedpdf/core/preact\";\nimport { SelectionPlugin as P, glyphAt as y } from \"@embedpdf/plugin-selection\";\nimport { jsx as C } from \"preact/jsx-runtime\";\nimport { useState as b, useRef as A, useEffect as l, useCallback as _, useMemo as B } from \"preact/hooks\";\nimport { ignore as v, PdfErrorCode as G } from \"@embedpdf/models\";\nimport { useInteractionManagerCapability as H, usePointerHandlers as T, useCursor as j } from \"@embedpdf/plugin-interaction-manager/preact\";\nconst M = () => k(P.id), K = () => z(P.id);\nfunction N({ pageIndex: o, scale: r, background: w = \"rgba(33,150,243)\" }) {\n  const { provides: e } = M(), { provides: c } = H(), { register: d } = T({ pageIndex: o }), [E, f] = b([]), [n, g] = b(null), { setCursor: R, removeCursor: F } = j(), a = A(null);\n  l(() => {\n    if (e)\n      return e.onSelectionChange(() => {\n        (c == null ? void 0 : c.getActiveMode()) === \"default\" ? (f(e.getHighlightRectsForPage(o)), g(e.getBoundingRectForPage(o))) : (f([]), g(null));\n      });\n  }, [e, o]);\n  const h = _((t) => {\n    const i = a.current;\n    return i ? y(i, t) : -1;\n  }, []);\n  l(() => {\n    if (!e) return;\n    const t = e.getGeometry(o);\n    return t.wait((i) => a.current = i, v), () => {\n      t.abort({\n        code: G.Cancelled,\n        message: \"Cancelled\"\n      }), a.current = null;\n    };\n  }, [e, o]);\n  const m = B(\n    () => ({\n      onPointerDown: (t, i, s) => {\n        if (!e || !e.isEnabledForMode(s)) return;\n        e.clear(), e.getGeometry(o).wait((S) => {\n          const p = y(S, t);\n          p !== -1 && e.begin(o, p);\n        }, v);\n      },\n      onPointerMove: (t, i, s) => {\n        if (!e || !e.isEnabledForMode(s)) return;\n        const u = h(t);\n        u !== -1 ? R(\"selection-text\", \"text\", 10) : F(\"selection-text\"), u !== -1 && e.update(o, u);\n      },\n      onPointerUp: (t, i, s) => {\n        e && e.isEnabledForMode(s) && e.end();\n      },\n      onHandlerActiveEnd(t) {\n        e && e.isEnabledForMode(t) && e.clear();\n      }\n    }),\n    [e, o, h]\n  );\n  return l(() => {\n    if (d)\n      return d(m);\n  }, [d, m]), n ? /* @__PURE__ */ C(\n    \"div\",\n    {\n      style: {\n        position: \"absolute\",\n        left: n.origin.x * r,\n        top: n.origin.y * r,\n        width: n.size.width * r,\n        height: n.size.height * r,\n        mixBlendMode: \"multiply\",\n        isolation: \"isolate\"\n      },\n      children: E.map((t, i) => /* @__PURE__ */ C(\n        \"div\",\n        {\n          style: {\n            position: \"absolute\",\n            left: (t.origin.x - n.origin.x) * r,\n            top: (t.origin.y - n.origin.y) * r,\n            width: t.size.width * r,\n            height: t.size.height * r,\n            background: w,\n            pointerEvents: \"none\"\n          }\n        },\n        i\n      ))\n    }\n  ) : null;\n}\nfunction O() {\n  const { provides: o } = M();\n  return l(() => {\n    if (o)\n      return o.onCopyToClipboard((r) => {\n        navigator.clipboard.writeText(r);\n      });\n  }, [o]), null;\n}\nexport {\n  O as CopyToClipboard,\n  N as SelectionLayer,\n  M as useSelectionCapability,\n  K as useSelectionPlugin\n};\n//# sourceMappingURL=index.js.map\n","import { Rect } from '@embedpdf/models';\nimport { ScrollCapability } from '@embedpdf/plugin-scroll';\nimport { ViewportCapability, ViewportMetrics } from '@embedpdf/plugin-viewport';\n\nexport type MenuCoords = { left: number; top: number } | null;\n\nfunction edgeVisible(\n  vr: Rect,\n  vp: ViewportMetrics,\n  menuHeight: number,\n  margin: number,\n  vpGap: number,\n  isTop: boolean,\n) {\n  if (isTop) {\n    // For top position, check if there's enough space above the rect including margin\n    return vr.origin.y + vpGap >= menuHeight + margin;\n  } else {\n    // For bottom position, check if there's enough space below the rect including margin\n    return (\n      vr.origin.y + vpGap + vr.size.height + menuHeight + margin <= vp.scrollTop + vp.clientHeight\n    );\n  }\n}\n\n/**\n * Decide where to place the menu for a *multi-page* selection.\n *\n * boundingRects  one rect per page\n * scrollCap      converts page-space  viewport-space\n * vpCap          live viewport metrics\n * margin         gap between rect and menu\n */\nexport function menuPositionForSelection(\n  boundingRects: { page: number; rect: Rect }[],\n  scrollCap: ScrollCapability,\n  vpCap: ViewportCapability,\n  margin = 8,\n  menuHeight = 40,\n): MenuCoords {\n  if (!boundingRects.length) return null;\n\n  const vp = vpCap.getMetrics();\n  const vpGap = vpCap.getViewportGap();\n\n  // Get the relevant rect(s) for positioning\n  const rects =\n    boundingRects.length === 1\n      ? { first: boundingRects[0], last: boundingRects[0] }\n      : { first: boundingRects[0], last: boundingRects[boundingRects.length - 1] };\n\n  const firstVR = scrollCap.getRectPositionForPage(rects.first.page, rects.first.rect);\n  const lastVR = scrollCap.getRectPositionForPage(rects.last.page, rects.last.rect);\n\n  if (!firstVR || !lastVR) return null;\n\n  const bottomSpaceAvailable = edgeVisible(lastVR, vp, menuHeight, margin, vpGap, false);\n  const topSpaceAvailable = edgeVisible(firstVR, vp, menuHeight, margin, vpGap, true);\n\n  if (bottomSpaceAvailable) {\n    return {\n      left: lastVR.origin.x + lastVR.size.width / 2,\n      top: lastVR.origin.y + lastVR.size.height + margin,\n    };\n  }\n  if (topSpaceAvailable) {\n    return {\n      left: firstVR.origin.x + firstVR.size.width / 2,\n      top: firstVR.origin.y - margin - menuHeight,\n    };\n  }\n  return null;\n}\n","/** @jsxImportSource preact */\nimport { h, ComponentChildren } from 'preact';\nimport { useEffect, useRef } from 'preact/hooks';\nimport { Icon } from './icon';\nimport { Button } from './button';\n\nexport interface DialogProps {\n  /** Controlled visibility  `true` shows, `false` hides */\n  open: boolean;\n  /** Dialog title */\n  title?: string;\n  /** Dialog content */\n  children: ComponentChildren;\n  /** Callback when dialog should close */\n  onClose?: () => void;\n  /** Optional className for the dialog content */\n  className?: string;\n  /** Whether to show close button */\n  showCloseButton?: boolean;\n  /** Maximum width of the dialog */\n  maxWidth?: string;\n}\n\nexport function Dialog({\n  open,\n  title,\n  children,\n  onClose,\n  className,\n  showCloseButton = true,\n  maxWidth = '32rem',\n}: DialogProps) {\n  const overlayRef = useRef<HTMLDivElement>(null);\n\n  // Handle escape key\n  useEffect(() => {\n    if (!open) return;\n\n    const handleEscape = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') {\n        onClose?.();\n      }\n    };\n\n    document.addEventListener('keydown', handleEscape);\n    return () => document.removeEventListener('keydown', handleEscape);\n  }, [open, onClose]);\n\n  // Handle backdrop click\n  const handleBackdropClick = (e: MouseEvent) => {\n    if (e.target === overlayRef.current) {\n      onClose?.();\n    }\n  };\n\n  // Prevent body scroll when dialog is open\n  useEffect(() => {\n    if (open) {\n      document.body.style.overflow = 'hidden';\n    } else {\n      document.body.style.overflow = '';\n    }\n\n    return () => {\n      document.body.style.overflow = '';\n    };\n  }, [open]);\n\n  if (!open) return null;\n\n  return (\n    <div\n      ref={overlayRef}\n      className=\"fixed inset-0 z-50 bg-black/50 md:flex md:items-center md:justify-center\"\n      onClick={handleBackdropClick}\n    >\n      <div\n        className={`relative flex h-full w-full flex-col bg-white md:h-auto md:w-[28rem] md:max-w-[90vw] md:rounded-lg md:border md:border-gray-200 md:shadow-lg ${className}`}\n        onClick={(e) => e.stopPropagation()}\n      >\n        {/* Header */}\n        {(title || showCloseButton) && (\n          <div className=\"flex flex-shrink-0 items-center justify-between border-b border-gray-200 px-6 py-4\">\n            {title && <h2 className=\"text-lg font-semibold text-gray-900\">{title}</h2>}\n            {showCloseButton && (\n              <Button onClick={onClose} className=\"p-1 hover:bg-gray-100\">\n                <Icon icon=\"x\" className=\"h-5 w-5\" />\n              </Button>\n            )}\n          </div>\n        )}\n\n        {/* Content */}\n        <div className=\"flex-1 overflow-y-auto px-6 py-4 md:max-h-[80vh] md:flex-none\">\n          {children}\n        </div>\n      </div>\n    </div>\n  );\n}\n","// ../core/dist/preact/index.js\nimport { createContext as b } from \"preact\";\nimport { jsx as w } from \"preact/jsx-runtime\";\nimport { useState as a, useRef as m, useEffect as f, useContext as S } from \"preact/hooks\";\n\n// ../models/dist/index.js\nvar PdfSoftHyphenMarker = \"\\xAD\";\nvar PdfZeroWidthSpace = \"\\u200B\";\nvar PdfWordJoiner = \"\\u2060\";\nvar PdfBomOrZwnbsp = \"\\uFEFF\";\nvar PdfNonCharacterFFFE = \"\\uFFFE\";\nvar PdfNonCharacterFFFF = \"\\uFFFF\";\nvar PdfUnwantedTextMarkers = Object.freeze([\n  PdfSoftHyphenMarker,\n  PdfZeroWidthSpace,\n  PdfWordJoiner,\n  PdfBomOrZwnbsp,\n  PdfNonCharacterFFFE,\n  PdfNonCharacterFFFF\n]);\nvar PdfUnwantedTextRegex = new RegExp(`[${PdfUnwantedTextMarkers.join(\"\")}]`, \"g\");\nvar MixedBlendMode = Symbol(\"mixed\");\nvar BLEND_MODE_INFOS = Object.freeze([\n  { id: 0, label: \"Normal\", css: \"normal\" },\n  { id: 1, label: \"Multiply\", css: \"multiply\" },\n  { id: 2, label: \"Screen\", css: \"screen\" },\n  { id: 3, label: \"Overlay\", css: \"overlay\" },\n  { id: 4, label: \"Darken\", css: \"darken\" },\n  { id: 5, label: \"Lighten\", css: \"lighten\" },\n  { id: 6, label: \"Color Dodge\", css: \"color-dodge\" },\n  { id: 7, label: \"Color Burn\", css: \"color-burn\" },\n  { id: 8, label: \"Hard Light\", css: \"hard-light\" },\n  { id: 9, label: \"Soft Light\", css: \"soft-light\" },\n  { id: 10, label: \"Difference\", css: \"difference\" },\n  { id: 11, label: \"Exclusion\", css: \"exclusion\" },\n  { id: 12, label: \"Hue\", css: \"hue\" },\n  { id: 13, label: \"Saturation\", css: \"saturation\" },\n  { id: 14, label: \"Color\", css: \"color\" },\n  { id: 15, label: \"Luminosity\", css: \"luminosity\" }\n]);\nvar enumToInfo = BLEND_MODE_INFOS.reduce(\n  (m2, info) => {\n    m2[info.id] = info;\n    return m2;\n  },\n  {}\n);\nvar cssToEnum = BLEND_MODE_INFOS.reduce((m2, info) => {\n  m2[info.css] = info.id;\n  return m2;\n}, {});\nvar blendModeSelectOptions = BLEND_MODE_INFOS.map((info) => ({\n  value: info.id,\n  label: info.label\n}));\nvar PdfAnnotationFlagName = Object.freeze({\n  [\n    1\n    /* INVISIBLE */\n  ]: \"invisible\",\n  [\n    2\n    /* HIDDEN */\n  ]: \"hidden\",\n  [\n    4\n    /* PRINT */\n  ]: \"print\",\n  [\n    8\n    /* NO_ZOOM */\n  ]: \"noZoom\",\n  [\n    16\n    /* NO_ROTATE */\n  ]: \"noRotate\",\n  [\n    32\n    /* NO_VIEW */\n  ]: \"noView\",\n  [\n    64\n    /* READ_ONLY */\n  ]: \"readOnly\",\n  [\n    128\n    /* LOCKED */\n  ]: \"locked\",\n  [\n    256\n    /* TOGGLE_NOVIEW */\n  ]: \"toggleNoView\"\n});\nvar PdfAnnotationFlagValue = Object.entries(\n  PdfAnnotationFlagName\n).reduce(\n  (acc, [bit, name]) => {\n    acc[name] = Number(bit);\n    return acc;\n  },\n  {}\n);\n\n// ../core/dist/preact/index.js\nvar P = b({\n  registry: null,\n  isInitializing: true,\n  pluginsReady: false\n});\nfunction g() {\n  const t = S(P);\n  if (t === void 0)\n    throw new Error(\"useCapability must be used within a PDFContext.Provider\");\n  const { registry: r, isInitializing: e } = t;\n  if (e)\n    return t;\n  if (r === null)\n    throw new Error(\"PDF registry failed to initialize properly\");\n  return t;\n}\nfunction h(t) {\n  const { registry: r } = g();\n  if (r === null)\n    return {\n      plugin: null,\n      isLoading: true,\n      ready: new Promise(() => {\n      })\n    };\n  const e = r.getPlugin(t);\n  if (!e)\n    throw new Error(`Plugin ${t} not found`);\n  return {\n    plugin: e,\n    isLoading: false,\n    ready: e.ready()\n  };\n}\nfunction L(t) {\n  const { plugin: r, isLoading: e, ready: i } = h(t);\n  if (!r)\n    return {\n      provides: null,\n      isLoading: e,\n      ready: i\n    };\n  if (!r.provides)\n    throw new Error(`Plugin ${t} does not provide a capability`);\n  return {\n    provides: r.provides(),\n    isLoading: e,\n    ready: i\n  };\n}\n\n// dist/index.js\nvar Rotation2 = /* @__PURE__ */ ((Rotation22) => {\n  Rotation22[Rotation22[\"Degree0\"] = 0] = \"Degree0\";\n  Rotation22[Rotation22[\"Degree90\"] = 1] = \"Degree90\";\n  Rotation22[Rotation22[\"Degree180\"] = 2] = \"Degree180\";\n  Rotation22[Rotation22[\"Degree270\"] = 3] = \"Degree270\";\n  return Rotation22;\n})(Rotation2 || {});\nvar PdfSoftHyphenMarker2 = \"\\xAD\";\nvar PdfZeroWidthSpace2 = \"\\u200B\";\nvar PdfWordJoiner2 = \"\\u2060\";\nvar PdfBomOrZwnbsp2 = \"\\uFEFF\";\nvar PdfNonCharacterFFFE2 = \"\\uFFFE\";\nvar PdfNonCharacterFFFF2 = \"\\uFFFF\";\nvar PdfUnwantedTextMarkers2 = Object.freeze([\n  PdfSoftHyphenMarker2,\n  PdfZeroWidthSpace2,\n  PdfWordJoiner2,\n  PdfBomOrZwnbsp2,\n  PdfNonCharacterFFFE2,\n  PdfNonCharacterFFFF2\n]);\nvar PdfUnwantedTextRegex2 = new RegExp(`[${PdfUnwantedTextMarkers2.join(\"\")}]`, \"g\");\nvar MixedBlendMode2 = Symbol(\"mixed\");\nvar BLEND_MODE_INFOS2 = Object.freeze([\n  { id: 0, label: \"Normal\", css: \"normal\" },\n  { id: 1, label: \"Multiply\", css: \"multiply\" },\n  { id: 2, label: \"Screen\", css: \"screen\" },\n  { id: 3, label: \"Overlay\", css: \"overlay\" },\n  { id: 4, label: \"Darken\", css: \"darken\" },\n  { id: 5, label: \"Lighten\", css: \"lighten\" },\n  { id: 6, label: \"Color Dodge\", css: \"color-dodge\" },\n  { id: 7, label: \"Color Burn\", css: \"color-burn\" },\n  { id: 8, label: \"Hard Light\", css: \"hard-light\" },\n  { id: 9, label: \"Soft Light\", css: \"soft-light\" },\n  { id: 10, label: \"Difference\", css: \"difference\" },\n  { id: 11, label: \"Exclusion\", css: \"exclusion\" },\n  { id: 12, label: \"Hue\", css: \"hue\" },\n  { id: 13, label: \"Saturation\", css: \"saturation\" },\n  { id: 14, label: \"Color\", css: \"color\" },\n  { id: 15, label: \"Luminosity\", css: \"luminosity\" }\n]);\nvar enumToInfo2 = BLEND_MODE_INFOS2.reduce(\n  (m2, info) => {\n    m2[info.id] = info;\n    return m2;\n  },\n  {}\n);\nvar cssToEnum2 = BLEND_MODE_INFOS2.reduce((m2, info) => {\n  m2[info.css] = info.id;\n  return m2;\n}, {});\nvar blendModeSelectOptions2 = BLEND_MODE_INFOS2.map((info) => ({\n  value: info.id,\n  label: info.label\n}));\nvar PdfAnnotationFlagName2 = Object.freeze({\n  [\n    1\n    /* INVISIBLE */\n  ]: \"invisible\",\n  [\n    2\n    /* HIDDEN */\n  ]: \"hidden\",\n  [\n    4\n    /* PRINT */\n  ]: \"print\",\n  [\n    8\n    /* NO_ZOOM */\n  ]: \"noZoom\",\n  [\n    16\n    /* NO_ROTATE */\n  ]: \"noRotate\",\n  [\n    32\n    /* NO_VIEW */\n  ]: \"noView\",\n  [\n    64\n    /* READ_ONLY */\n  ]: \"readOnly\",\n  [\n    128\n    /* LOCKED */\n  ]: \"locked\",\n  [\n    256\n    /* TOGGLE_NOVIEW */\n  ]: \"toggleNoView\"\n});\nvar PdfAnnotationFlagValue2 = Object.entries(\n  PdfAnnotationFlagName2\n).reduce(\n  (acc, [bit, name]) => {\n    acc[name] = Number(bit);\n    return acc;\n  },\n  {}\n);\nvar Z = class {\n  constructor(t, e) {\n    if (this.id = t, this.registry = e, this.debouncedActions = {}, this.unsubscribeFromState = null, this.unsubscribeFromCoreStore = null, t !== this.constructor.id)\n      throw new Error(\n        `Plugin ID mismatch: ${t} !== ${this.constructor.id}`\n      );\n    this.coreStore = this.registry.getStore(), this.pluginStore = this.coreStore.getPluginStore(this.id), this.unsubscribeFromState = this.pluginStore.subscribeToState((i, r, n) => {\n      this.onStoreUpdated(n, r);\n    }), this.unsubscribeFromCoreStore = this.coreStore.subscribe((i, r, n) => {\n      this.onCoreStoreUpdated(n, r);\n    }), this.readyPromise = new Promise((i) => {\n      this.readyResolve = i;\n    }), this.readyResolve();\n  }\n  provides() {\n    if (!this._capability) {\n      const t = this.buildCapability();\n      this._capability = Object.freeze(t);\n    }\n    return this._capability;\n  }\n  /**\n   *  Get a copy of the current state\n   */\n  get state() {\n    return this.pluginStore.getState();\n  }\n  /**\n   *  Get a copy of the current core state\n   */\n  get coreState() {\n    return this.coreStore.getState();\n  }\n  /**\n   * @deprecated  use `this.state` Get a copy of the current state\n   */\n  getState() {\n    return this.pluginStore.getState();\n  }\n  /**\n   * @deprecated  use `this.coreState` Get a copy of the current core state\n   */\n  getCoreState() {\n    return this.coreStore.getState();\n  }\n  /**\n   * Core Dispatch\n   */\n  dispatchCoreAction(t) {\n    return this.coreStore.dispatchToCore(t);\n  }\n  /**\n   * Dispatch an action to all plugins\n   */\n  dispatchToAllPlugins(t) {\n    return this.coreStore.dispatch(t);\n  }\n  /**\n   * Dispatch an action\n   */\n  dispatch(t) {\n    return this.pluginStore.dispatch(t);\n  }\n  /**\n   * Dispatch an action with debouncing to prevent rapid repeated calls\n   * @param action The action to dispatch\n   * @param debounceTime Time in ms to debounce (default: 100ms)\n   * @returns boolean indicating whether the action was dispatched or debounced\n   */\n  debouncedDispatch(t, e = 100) {\n    const i = Date.now(), r = this.debouncedActions[t.type] || 0;\n    return i - r >= e ? (this.debouncedActions[t.type] = i, this.dispatch(t), true) : false;\n  }\n  /**\n   * Subscribe to state changes\n   */\n  subscribe(t) {\n    return this.pluginStore.subscribeToState(t);\n  }\n  /**\n   * Subscribe to core store changes\n   */\n  subscribeToCoreStore(t) {\n    return this.coreStore.subscribe(t);\n  }\n  /**\n   * Called when the plugin store state is updated\n   * @param oldState Previous state\n   * @param newState New state\n   */\n  onStoreUpdated(t, e) {\n  }\n  /**\n   * Called when the core store state is updated\n   * @param oldState Previous state\n   * @param newState New state\n   */\n  onCoreStoreUpdated(t, e) {\n  }\n  /**\n   * Cleanup method to be called when plugin is being destroyed\n   */\n  destroy() {\n    this.unsubscribeFromState && (this.unsubscribeFromState(), this.unsubscribeFromState = null), this.unsubscribeFromCoreStore && (this.unsubscribeFromCoreStore(), this.unsubscribeFromCoreStore = null);\n  }\n  /**\n   * Returns a promise that resolves when the plugin is ready\n   */\n  ready() {\n    return this.readyPromise;\n  }\n  /**\n   * Mark the plugin as ready\n   */\n  markReady() {\n    this.readyResolve();\n  }\n  /**\n   * Reset the ready state (useful for plugins that need to reinitialize)\n   */\n  resetReady() {\n    this.readyPromise = new Promise((t) => {\n      this.readyResolve = t;\n    });\n  }\n};\nvar g2 = class g22 extends Z {\n  constructor(e, n, r) {\n    super(e, n), this.engine = r;\n  }\n  async initialize(e) {\n  }\n  buildCapability() {\n    return {\n      renderPage: this.renderPage.bind(this),\n      renderPageRect: this.renderPageRect.bind(this)\n    };\n  }\n  renderPage({\n    pageIndex: e,\n    scaleFactor: n = 1,\n    dpr: r = 1,\n    rotation: a2 = Rotation2.Degree0,\n    options: s = { withAnnotations: false },\n    imageType: d = \"image/webp\"\n  }) {\n    const o = this.coreState.core;\n    if (!o.document)\n      throw new Error(\"document does not open\");\n    const t = o.document.pages.find((i) => i.index === e);\n    if (!t)\n      throw new Error(\"page does not exist\");\n    return this.engine.renderPage(\n      o.document,\n      t,\n      n,\n      a2,\n      r,\n      s,\n      d\n    );\n  }\n  renderPageRect({\n    pageIndex: e,\n    scaleFactor: n = 1,\n    dpr: r = 1,\n    rect: a2,\n    rotation: s = Rotation2.Degree0,\n    options: d = { withAnnotations: false },\n    imageType: o = \"image/webp\"\n  }) {\n    const t = this.coreState.core;\n    if (!t.document)\n      throw new Error(\"document does not open\");\n    const i = t.document.pages.find((m2) => m2.index === e);\n    if (!i)\n      throw new Error(\"page does not exist\");\n    return this.engine.renderPageRect(\n      t.document,\n      i,\n      n,\n      s,\n      r,\n      a2,\n      d,\n      o\n    );\n  }\n};\ng2.id = \"render\";\nvar c = g2;\nvar PrintPlugin = class extends Z {\n  constructor(id, registry, config) {\n    super(id, registry);\n    this.config = config;\n    this.renderCapability = this.registry.getPlugin(c.id)?.provides();\n  }\n  async initialize(_config) {\n  }\n  buildCapability() {\n    return {\n      preparePrint: this.preparePrint.bind(this),\n      parsePageRange: this.parsePageRange.bind(this)\n    };\n  }\n  async preparePrint(options, onProgress, onPageReady) {\n    const coreState = this.coreState.core;\n    if (!coreState.document) {\n      throw new Error(\"No document loaded\");\n    }\n    const pagesToPrint = this.getPagesToPrint(options, coreState.document.pages.length);\n    const totalPages = pagesToPrint.length;\n    const batchSize = this.config?.batchSize || 3;\n    onProgress?.({\n      current: 0,\n      total: totalPages,\n      status: \"preparing\",\n      message: `Preparing to render ${totalPages} page${totalPages !== 1 ? \"s\" : \"\"}...`\n    });\n    const scaleFactor = this.getScaleFactor(options.quality);\n    const dpr = 1;\n    for (let batchStart = 0; batchStart < pagesToPrint.length; batchStart += batchSize) {\n      const batchEnd = Math.min(batchStart + batchSize, pagesToPrint.length);\n      const batch = pagesToPrint.slice(batchStart, batchEnd);\n      const batchPromises = batch.map(async (pageIndex, batchIndex) => {\n        const overallIndex = batchStart + batchIndex;\n        onProgress?.({\n          current: overallIndex,\n          total: totalPages,\n          status: \"rendering\",\n          message: `Rendering page ${pageIndex + 1}...`\n        });\n        const blob = await this.renderPage(pageIndex, scaleFactor, dpr, options.includeAnnotations);\n        onPageReady?.({\n          pageIndex,\n          blob\n        });\n        return;\n      });\n      await Promise.all(batchPromises);\n    }\n    onProgress?.({\n      current: totalPages,\n      total: totalPages,\n      status: \"complete\",\n      message: \"All pages rendered successfully\"\n    });\n  }\n  async renderPage(pageIndex, scaleFactor, dpr, withAnnotations) {\n    return new Promise((resolve, reject) => {\n      const renderTask = this.renderCapability.renderPage({\n        pageIndex,\n        scaleFactor,\n        dpr,\n        rotation: Rotation2.Degree0,\n        options: {\n          withAnnotations\n        }\n      });\n      renderTask.wait(\n        (blob) => resolve(blob),\n        (error) => reject(\n          new Error(\n            `Failed to render page ${pageIndex + 1}: ${error.reason.message || \"Unknown error\"}`\n          )\n        )\n      );\n    });\n  }\n  getScaleFactor(quality) {\n    switch (quality) {\n      case \"high\":\n        return 1.5;\n      // Higher resolution for better print quality\n      case \"normal\":\n      default:\n        return 1;\n    }\n  }\n  getPagesToPrint(options, totalPages) {\n    const { pageRange } = options;\n    switch (pageRange.type) {\n      case \"current\":\n        return pageRange.currentPage !== void 0 ? [pageRange.currentPage] : [0];\n      case \"all\":\n        return Array.from({ length: totalPages }, (_, i) => i);\n      case \"custom\":\n        if (!pageRange.pages) return [0];\n        return pageRange.pages.filter((page) => page >= 0 && page < totalPages).sort((a2, b2) => a2 - b2);\n      default:\n        return [0];\n    }\n  }\n  parsePageRange(rangeString) {\n    try {\n      const totalPages = this.coreState.core.document?.pages.length || 0;\n      const pages = [];\n      const parts = rangeString.split(\",\").map((s) => s.trim());\n      for (const part of parts) {\n        if (part.includes(\"-\")) {\n          const [start, end] = part.split(\"-\").map((s) => parseInt(s.trim()));\n          if (isNaN(start) || isNaN(end)) {\n            return { pages: [], isValid: false, error: `Invalid range: ${part}` };\n          }\n          if (start > end) {\n            return { pages: [], isValid: false, error: `Invalid range: ${part} (start > end)` };\n          }\n          for (let i = start; i <= end; i++) {\n            if (i >= 1 && i <= totalPages) {\n              pages.push(i - 1);\n            }\n          }\n        } else {\n          const pageNum = parseInt(part);\n          if (isNaN(pageNum)) {\n            return { pages: [], isValid: false, error: `Invalid page number: ${part}` };\n          }\n          if (pageNum >= 1 && pageNum <= totalPages) {\n            pages.push(pageNum - 1);\n          }\n        }\n      }\n      const uniquePages = [...new Set(pages)].sort((a2, b2) => a2 - b2);\n      return {\n        pages: uniquePages,\n        isValid: true\n      };\n    } catch (error) {\n      return {\n        pages: [],\n        isValid: false,\n        error: `Parsing error: ${error instanceof Error ? error.message : \"Unknown error\"}`\n      };\n    }\n  }\n};\nPrintPlugin.id = \"print\";\n\n// src/preact/hooks/use-print.ts\nvar usePrintPlugin = () => h(PrintPlugin.id);\nvar usePrintCapability = () => L(PrintPlugin.id);\n\n// src/preact/components/print.tsx\nimport { createContext, render } from \"preact\";\nimport { useContext, useRef, useEffect, useState } from \"preact/hooks\";\nimport { jsx, jsxs } from \"preact/jsx-runtime\";\nvar PrintContext = createContext(null);\nvar PrintPage = ({ pageResult }) => {\n  const [imageUrl, setImageUrl] = useState(\"\");\n  useEffect(() => {\n    const url = URL.createObjectURL(pageResult.blob);\n    setImageUrl(url);\n    return () => {\n      URL.revokeObjectURL(url);\n    };\n  }, [pageResult.blob]);\n  const handleLoad = () => {\n    if (imageUrl) {\n      URL.revokeObjectURL(imageUrl);\n    }\n  };\n  return /* @__PURE__ */ jsx(\n    \"div\",\n    {\n      style: {\n        pageBreakAfter: \"always\",\n        width: \"210mm\",\n        minHeight: \"297mm\",\n        margin: \"0 auto\",\n        background: \"white\",\n        position: \"relative\"\n      },\n      children: /* @__PURE__ */ jsx(\n        \"img\",\n        {\n          src: imageUrl,\n          onLoad: handleLoad,\n          alt: `Page ${pageResult.pageIndex + 1}`,\n          style: {\n            width: \"100%\",\n            height: \"auto\",\n            display: \"block\",\n            objectFit: \"contain\"\n          }\n        }\n      )\n    }\n  );\n};\nvar PrintLayout = ({ pages }) => {\n  return /* @__PURE__ */ jsxs(\n    \"div\",\n    {\n      style: {\n        fontFamily: \"Arial, sans-serif\",\n        fontSize: \"12px\",\n        lineHeight: \"1.4\",\n        color: \"#000\",\n        backgroundColor: \"#fff\"\n      },\n      children: [\n        /* @__PURE__ */ jsx(\"style\", { children: `\n        @media print {\n          body { margin: 0; padding: 0; }\n        }\n      ` }),\n        pages.map((pageResult) => /* @__PURE__ */ jsx(\"div\", { children: /* @__PURE__ */ jsx(PrintPage, { pageResult }) }, pageResult.pageIndex))\n      ]\n    }\n  );\n};\nfunction PrintProvider({ children }) {\n  const { provides: printCapability } = usePrintCapability();\n  const iframeRef = useRef(null);\n  const [progress, setProgress] = useState(null);\n  const [isReady, setIsReady] = useState(false);\n  const [isPrinting, setIsPrinting] = useState(false);\n  const [pages, setPages] = useState([]);\n  const executePrint = async (options) => {\n    if (!printCapability) {\n      throw new Error(\"Print capability not available\");\n    }\n    if (!iframeRef.current?.contentWindow) {\n      throw new Error(\"Print iframe not ready\");\n    }\n    setIsPrinting(true);\n    setProgress(null);\n    setPages([]);\n    setIsReady(false);\n    try {\n      const collectedPages = [];\n      await printCapability.preparePrint(\n        options,\n        // Progress callback\n        (progressUpdate) => {\n          setProgress(progressUpdate);\n        },\n        // Page ready callback\n        (pageResult) => {\n          collectedPages.push(pageResult);\n          setPages([...collectedPages]);\n        }\n      );\n      await new Promise((resolve) => setTimeout(resolve, 500));\n      const printWindow = iframeRef.current.contentWindow;\n      printWindow.focus();\n      printWindow.print();\n      setProgress({\n        current: progress?.total || 0,\n        total: progress?.total || 0,\n        status: \"complete\",\n        message: \"Print dialog opened\"\n      });\n    } catch (error) {\n      setProgress({\n        current: 0,\n        total: 0,\n        status: \"error\",\n        message: `Print failed: ${error instanceof Error ? error.message : \"Unknown error\"}`\n      });\n      throw error;\n    } finally {\n      setIsPrinting(false);\n    }\n  };\n  useEffect(() => {\n    const iframe = iframeRef.current;\n    const mountNode = iframe?.contentWindow?.document?.body;\n    if (mountNode && pages.length > 0) {\n      render(/* @__PURE__ */ jsx(PrintLayout, { pages }), mountNode);\n      setIsReady(true);\n      return () => {\n        if (mountNode) {\n          render(null, mountNode);\n        }\n      };\n    }\n  }, [pages]);\n  const contextValue = {\n    parsePageRange: printCapability?.parsePageRange || (() => ({ pages: [], isValid: false })),\n    executePrint,\n    progress,\n    isReady,\n    isPrinting\n  };\n  return /* @__PURE__ */ jsxs(PrintContext.Provider, { value: contextValue, children: [\n    children,\n    /* @__PURE__ */ jsx(\n      \"iframe\",\n      {\n        ref: iframeRef,\n        style: {\n          display: \"none\",\n          width: \"210mm\",\n          height: \"297mm\"\n        },\n        title: \"Print Preview\"\n      }\n    )\n  ] });\n}\nfunction usePrintContext() {\n  const context = useContext(PrintContext);\n  if (!context) {\n    throw new Error(\"usePrintContext must be used within a PrintProvider\");\n  }\n  return context;\n}\n\n// src/preact/hooks/use-print-action.ts\nvar usePrintAction = () => {\n  const { executePrint, progress, isReady, isPrinting, parsePageRange } = usePrintContext();\n  return {\n    executePrint,\n    progress,\n    isReady,\n    isPrinting,\n    parsePageRange\n  };\n};\nexport {\n  PrintProvider,\n  usePrintAction,\n  usePrintCapability,\n  usePrintContext,\n  usePrintPlugin\n};\n//# sourceMappingURL=index.js.map","// src/lib/manifest.ts\nvar PRINT_PLUGIN_ID = \"print\";\nvar manifest = {\n  id: PRINT_PLUGIN_ID,\n  name: \"Print Plugin\",\n  version: \"1.0.0\",\n  provides: [\"print\"],\n  requires: [\"render\"],\n  optional: [],\n  defaultConfig: {\n    enabled: true\n  }\n};\n\n// ../models/dist/index.js\nvar Rotation = /* @__PURE__ */ ((Rotation2) => {\n  Rotation2[Rotation2[\"Degree0\"] = 0] = \"Degree0\";\n  Rotation2[Rotation2[\"Degree90\"] = 1] = \"Degree90\";\n  Rotation2[Rotation2[\"Degree180\"] = 2] = \"Degree180\";\n  Rotation2[Rotation2[\"Degree270\"] = 3] = \"Degree270\";\n  return Rotation2;\n})(Rotation || {});\nvar PdfSoftHyphenMarker = \"\\xAD\";\nvar PdfZeroWidthSpace = \"\\u200B\";\nvar PdfWordJoiner = \"\\u2060\";\nvar PdfBomOrZwnbsp = \"\\uFEFF\";\nvar PdfNonCharacterFFFE = \"\\uFFFE\";\nvar PdfNonCharacterFFFF = \"\\uFFFF\";\nvar PdfUnwantedTextMarkers = Object.freeze([\n  PdfSoftHyphenMarker,\n  PdfZeroWidthSpace,\n  PdfWordJoiner,\n  PdfBomOrZwnbsp,\n  PdfNonCharacterFFFE,\n  PdfNonCharacterFFFF\n]);\nvar PdfUnwantedTextRegex = new RegExp(`[${PdfUnwantedTextMarkers.join(\"\")}]`, \"g\");\nvar MixedBlendMode = Symbol(\"mixed\");\nvar BLEND_MODE_INFOS = Object.freeze([\n  { id: 0, label: \"Normal\", css: \"normal\" },\n  { id: 1, label: \"Multiply\", css: \"multiply\" },\n  { id: 2, label: \"Screen\", css: \"screen\" },\n  { id: 3, label: \"Overlay\", css: \"overlay\" },\n  { id: 4, label: \"Darken\", css: \"darken\" },\n  { id: 5, label: \"Lighten\", css: \"lighten\" },\n  { id: 6, label: \"Color Dodge\", css: \"color-dodge\" },\n  { id: 7, label: \"Color Burn\", css: \"color-burn\" },\n  { id: 8, label: \"Hard Light\", css: \"hard-light\" },\n  { id: 9, label: \"Soft Light\", css: \"soft-light\" },\n  { id: 10, label: \"Difference\", css: \"difference\" },\n  { id: 11, label: \"Exclusion\", css: \"exclusion\" },\n  { id: 12, label: \"Hue\", css: \"hue\" },\n  { id: 13, label: \"Saturation\", css: \"saturation\" },\n  { id: 14, label: \"Color\", css: \"color\" },\n  { id: 15, label: \"Luminosity\", css: \"luminosity\" }\n]);\nvar enumToInfo = BLEND_MODE_INFOS.reduce(\n  (m, info) => {\n    m[info.id] = info;\n    return m;\n  },\n  {}\n);\nvar cssToEnum = BLEND_MODE_INFOS.reduce((m, info) => {\n  m[info.css] = info.id;\n  return m;\n}, {});\nvar blendModeSelectOptions = BLEND_MODE_INFOS.map((info) => ({\n  value: info.id,\n  label: info.label\n}));\nvar PdfAnnotationFlagName = Object.freeze({\n  [\n    1\n    /* INVISIBLE */\n  ]: \"invisible\",\n  [\n    2\n    /* HIDDEN */\n  ]: \"hidden\",\n  [\n    4\n    /* PRINT */\n  ]: \"print\",\n  [\n    8\n    /* NO_ZOOM */\n  ]: \"noZoom\",\n  [\n    16\n    /* NO_ROTATE */\n  ]: \"noRotate\",\n  [\n    32\n    /* NO_VIEW */\n  ]: \"noView\",\n  [\n    64\n    /* READ_ONLY */\n  ]: \"readOnly\",\n  [\n    128\n    /* LOCKED */\n  ]: \"locked\",\n  [\n    256\n    /* TOGGLE_NOVIEW */\n  ]: \"toggleNoView\"\n});\nvar PdfAnnotationFlagValue = Object.entries(\n  PdfAnnotationFlagName\n).reduce(\n  (acc, [bit, name]) => {\n    acc[name] = Number(bit);\n    return acc;\n  },\n  {}\n);\n\n// ../core/dist/index.js\nvar Z = class {\n  constructor(t, e) {\n    if (this.id = t, this.registry = e, this.debouncedActions = {}, this.unsubscribeFromState = null, this.unsubscribeFromCoreStore = null, t !== this.constructor.id)\n      throw new Error(\n        `Plugin ID mismatch: ${t} !== ${this.constructor.id}`\n      );\n    this.coreStore = this.registry.getStore(), this.pluginStore = this.coreStore.getPluginStore(this.id), this.unsubscribeFromState = this.pluginStore.subscribeToState((i, r, n) => {\n      this.onStoreUpdated(n, r);\n    }), this.unsubscribeFromCoreStore = this.coreStore.subscribe((i, r, n) => {\n      this.onCoreStoreUpdated(n, r);\n    }), this.readyPromise = new Promise((i) => {\n      this.readyResolve = i;\n    }), this.readyResolve();\n  }\n  provides() {\n    if (!this._capability) {\n      const t = this.buildCapability();\n      this._capability = Object.freeze(t);\n    }\n    return this._capability;\n  }\n  /**\n   *  Get a copy of the current state\n   */\n  get state() {\n    return this.pluginStore.getState();\n  }\n  /**\n   *  Get a copy of the current core state\n   */\n  get coreState() {\n    return this.coreStore.getState();\n  }\n  /**\n   * @deprecated  use `this.state` Get a copy of the current state\n   */\n  getState() {\n    return this.pluginStore.getState();\n  }\n  /**\n   * @deprecated  use `this.coreState` Get a copy of the current core state\n   */\n  getCoreState() {\n    return this.coreStore.getState();\n  }\n  /**\n   * Core Dispatch\n   */\n  dispatchCoreAction(t) {\n    return this.coreStore.dispatchToCore(t);\n  }\n  /**\n   * Dispatch an action to all plugins\n   */\n  dispatchToAllPlugins(t) {\n    return this.coreStore.dispatch(t);\n  }\n  /**\n   * Dispatch an action\n   */\n  dispatch(t) {\n    return this.pluginStore.dispatch(t);\n  }\n  /**\n   * Dispatch an action with debouncing to prevent rapid repeated calls\n   * @param action The action to dispatch\n   * @param debounceTime Time in ms to debounce (default: 100ms)\n   * @returns boolean indicating whether the action was dispatched or debounced\n   */\n  debouncedDispatch(t, e = 100) {\n    const i = Date.now(), r = this.debouncedActions[t.type] || 0;\n    return i - r >= e ? (this.debouncedActions[t.type] = i, this.dispatch(t), true) : false;\n  }\n  /**\n   * Subscribe to state changes\n   */\n  subscribe(t) {\n    return this.pluginStore.subscribeToState(t);\n  }\n  /**\n   * Subscribe to core store changes\n   */\n  subscribeToCoreStore(t) {\n    return this.coreStore.subscribe(t);\n  }\n  /**\n   * Called when the plugin store state is updated\n   * @param oldState Previous state\n   * @param newState New state\n   */\n  onStoreUpdated(t, e) {\n  }\n  /**\n   * Called when the core store state is updated\n   * @param oldState Previous state\n   * @param newState New state\n   */\n  onCoreStoreUpdated(t, e) {\n  }\n  /**\n   * Cleanup method to be called when plugin is being destroyed\n   */\n  destroy() {\n    this.unsubscribeFromState && (this.unsubscribeFromState(), this.unsubscribeFromState = null), this.unsubscribeFromCoreStore && (this.unsubscribeFromCoreStore(), this.unsubscribeFromCoreStore = null);\n  }\n  /**\n   * Returns a promise that resolves when the plugin is ready\n   */\n  ready() {\n    return this.readyPromise;\n  }\n  /**\n   * Mark the plugin as ready\n   */\n  markReady() {\n    this.readyResolve();\n  }\n  /**\n   * Reset the ready state (useful for plugins that need to reinitialize)\n   */\n  resetReady() {\n    this.readyPromise = new Promise((t) => {\n      this.readyResolve = t;\n    });\n  }\n};\n\n// ../plugin-render/dist/index.js\nvar g = class g2 extends Z {\n  constructor(e, n, r) {\n    super(e, n), this.engine = r;\n  }\n  async initialize(e) {\n  }\n  buildCapability() {\n    return {\n      renderPage: this.renderPage.bind(this),\n      renderPageRect: this.renderPageRect.bind(this)\n    };\n  }\n  renderPage({\n    pageIndex: e,\n    scaleFactor: n = 1,\n    dpr: r = 1,\n    rotation: a = Rotation.Degree0,\n    options: s = { withAnnotations: false },\n    imageType: d = \"image/webp\"\n  }) {\n    const o = this.coreState.core;\n    if (!o.document)\n      throw new Error(\"document does not open\");\n    const t = o.document.pages.find((i) => i.index === e);\n    if (!t)\n      throw new Error(\"page does not exist\");\n    return this.engine.renderPage(\n      o.document,\n      t,\n      n,\n      a,\n      r,\n      s,\n      d\n    );\n  }\n  renderPageRect({\n    pageIndex: e,\n    scaleFactor: n = 1,\n    dpr: r = 1,\n    rect: a,\n    rotation: s = Rotation.Degree0,\n    options: d = { withAnnotations: false },\n    imageType: o = \"image/webp\"\n  }) {\n    const t = this.coreState.core;\n    if (!t.document)\n      throw new Error(\"document does not open\");\n    const i = t.document.pages.find((m) => m.index === e);\n    if (!i)\n      throw new Error(\"page does not exist\");\n    return this.engine.renderPageRect(\n      t.document,\n      i,\n      n,\n      s,\n      r,\n      a,\n      d,\n      o\n    );\n  }\n};\ng.id = \"render\";\nvar c = g;\n\n// src/lib/types.ts\nvar PrintQuality = /* @__PURE__ */ ((PrintQuality2) => {\n  PrintQuality2[\"Normal\"] = \"normal\";\n  PrintQuality2[\"High\"] = \"high\";\n  return PrintQuality2;\n})(PrintQuality || {});\nvar PageRangeType = /* @__PURE__ */ ((PageRangeType2) => {\n  PageRangeType2[\"Current\"] = \"current\";\n  PageRangeType2[\"All\"] = \"all\";\n  PageRangeType2[\"Custom\"] = \"custom\";\n  return PageRangeType2;\n})(PageRangeType || {});\n\n// src/lib/print-plugin.ts\nvar PrintPlugin = class extends Z {\n  constructor(id, registry, config) {\n    super(id, registry);\n    this.config = config;\n    this.renderCapability = this.registry.getPlugin(c.id)?.provides();\n  }\n  async initialize(_config) {\n  }\n  buildCapability() {\n    return {\n      preparePrint: this.preparePrint.bind(this),\n      parsePageRange: this.parsePageRange.bind(this)\n    };\n  }\n  async preparePrint(options, onProgress, onPageReady) {\n    const coreState = this.coreState.core;\n    if (!coreState.document) {\n      throw new Error(\"No document loaded\");\n    }\n    const pagesToPrint = this.getPagesToPrint(options, coreState.document.pages.length);\n    const totalPages = pagesToPrint.length;\n    const batchSize = this.config?.batchSize || 3;\n    onProgress?.({\n      current: 0,\n      total: totalPages,\n      status: \"preparing\",\n      message: `Preparing to render ${totalPages} page${totalPages !== 1 ? \"s\" : \"\"}...`\n    });\n    const scaleFactor = this.getScaleFactor(options.quality);\n    const dpr = 1;\n    for (let batchStart = 0; batchStart < pagesToPrint.length; batchStart += batchSize) {\n      const batchEnd = Math.min(batchStart + batchSize, pagesToPrint.length);\n      const batch = pagesToPrint.slice(batchStart, batchEnd);\n      const batchPromises = batch.map(async (pageIndex, batchIndex) => {\n        const overallIndex = batchStart + batchIndex;\n        onProgress?.({\n          current: overallIndex,\n          total: totalPages,\n          status: \"rendering\",\n          message: `Rendering page ${pageIndex + 1}...`\n        });\n        const blob = await this.renderPage(pageIndex, scaleFactor, dpr, options.includeAnnotations);\n        onPageReady?.({\n          pageIndex,\n          blob\n        });\n        return;\n      });\n      await Promise.all(batchPromises);\n    }\n    onProgress?.({\n      current: totalPages,\n      total: totalPages,\n      status: \"complete\",\n      message: \"All pages rendered successfully\"\n    });\n  }\n  async renderPage(pageIndex, scaleFactor, dpr, withAnnotations) {\n    return new Promise((resolve, reject) => {\n      const renderTask = this.renderCapability.renderPage({\n        pageIndex,\n        scaleFactor,\n        dpr,\n        rotation: Rotation.Degree0,\n        options: {\n          withAnnotations\n        }\n      });\n      renderTask.wait(\n        (blob) => resolve(blob),\n        (error) => reject(\n          new Error(\n            `Failed to render page ${pageIndex + 1}: ${error.reason.message || \"Unknown error\"}`\n          )\n        )\n      );\n    });\n  }\n  getScaleFactor(quality) {\n    switch (quality) {\n      case \"high\" /* High */:\n        return 1.5;\n      // Higher resolution for better print quality\n      case \"normal\" /* Normal */:\n      default:\n        return 1;\n    }\n  }\n  getPagesToPrint(options, totalPages) {\n    const { pageRange } = options;\n    switch (pageRange.type) {\n      case \"current\" /* Current */:\n        return pageRange.currentPage !== void 0 ? [pageRange.currentPage] : [0];\n      case \"all\" /* All */:\n        return Array.from({ length: totalPages }, (_, i) => i);\n      case \"custom\" /* Custom */:\n        if (!pageRange.pages) return [0];\n        return pageRange.pages.filter((page) => page >= 0 && page < totalPages).sort((a, b) => a - b);\n      default:\n        return [0];\n    }\n  }\n  parsePageRange(rangeString) {\n    try {\n      const totalPages = this.coreState.core.document?.pages.length || 0;\n      const pages = [];\n      const parts = rangeString.split(\",\").map((s) => s.trim());\n      for (const part of parts) {\n        if (part.includes(\"-\")) {\n          const [start, end] = part.split(\"-\").map((s) => parseInt(s.trim()));\n          if (isNaN(start) || isNaN(end)) {\n            return { pages: [], isValid: false, error: `Invalid range: ${part}` };\n          }\n          if (start > end) {\n            return { pages: [], isValid: false, error: `Invalid range: ${part} (start > end)` };\n          }\n          for (let i = start; i <= end; i++) {\n            if (i >= 1 && i <= totalPages) {\n              pages.push(i - 1);\n            }\n          }\n        } else {\n          const pageNum = parseInt(part);\n          if (isNaN(pageNum)) {\n            return { pages: [], isValid: false, error: `Invalid page number: ${part}` };\n          }\n          if (pageNum >= 1 && pageNum <= totalPages) {\n            pages.push(pageNum - 1);\n          }\n        }\n      }\n      const uniquePages = [...new Set(pages)].sort((a, b) => a - b);\n      return {\n        pages: uniquePages,\n        isValid: true\n      };\n    } catch (error) {\n      return {\n        pages: [],\n        isValid: false,\n        error: `Parsing error: ${error instanceof Error ? error.message : \"Unknown error\"}`\n      };\n    }\n  }\n};\nPrintPlugin.id = \"print\";\n\n// src/lib/index.ts\nvar PrintPluginPackage = {\n  manifest,\n  create: (registry, _engine, config) => new PrintPlugin(PRINT_PLUGIN_ID, registry, config),\n  reducer: () => {\n  },\n  initialState: {}\n};\nexport {\n  PRINT_PLUGIN_ID,\n  PageRangeType,\n  PrintPlugin,\n  PrintPluginPackage,\n  PrintQuality,\n  manifest\n};\n//# sourceMappingURL=index.js.map","// ../core/dist/preact/index.js\nimport { createContext as b } from \"preact\";\nimport { jsx as w2 } from \"preact/jsx-runtime\";\nimport { useState as a, useRef as m2, useEffect as f2, useContext as S } from \"preact/hooks\";\n\n// ../models/dist/index.js\nfunction restoreOffset(offset, rotation, scaleFactor) {\n  let offsetX = offset.x;\n  let offsetY = offset.y;\n  switch (rotation) {\n    case 0:\n      offsetX = offset.x / scaleFactor;\n      offsetY = offset.y / scaleFactor;\n      break;\n    case 1:\n      offsetX = offset.y / scaleFactor;\n      offsetY = -offset.x / scaleFactor;\n      break;\n    case 2:\n      offsetX = -offset.x / scaleFactor;\n      offsetY = -offset.y / scaleFactor;\n      break;\n    case 3:\n      offsetX = -offset.y / scaleFactor;\n      offsetY = offset.x / scaleFactor;\n      break;\n  }\n  return {\n    x: offsetX,\n    y: offsetY\n  };\n}\nfunction boundingRect(rects) {\n  if (rects.length === 0) return null;\n  let minX = rects[0].origin.x, minY = rects[0].origin.y, maxX = rects[0].origin.x + rects[0].size.width, maxY = rects[0].origin.y + rects[0].size.height;\n  for (const r of rects) {\n    minX = Math.min(minX, r.origin.x);\n    minY = Math.min(minY, r.origin.y);\n    maxX = Math.max(maxX, r.origin.x + r.size.width);\n    maxY = Math.max(maxY, r.origin.y + r.size.height);\n  }\n  return {\n    origin: {\n      x: minX,\n      y: minY\n    },\n    size: {\n      width: maxX - minX,\n      height: maxY - minY\n    }\n  };\n}\nvar TaskAbortedError = class extends Error {\n  constructor(reason) {\n    super(`Task aborted: ${JSON.stringify(reason)}`);\n    this.name = \"TaskAbortedError\";\n  }\n};\nvar TaskRejectedError = class extends Error {\n  constructor(reason) {\n    super(`Task rejected: ${JSON.stringify(reason)}`);\n    this.name = \"TaskRejectedError\";\n  }\n};\nvar Task = class _Task {\n  constructor() {\n    this.state = {\n      stage: 0\n      /* Pending */\n    };\n    this.resolvedCallbacks = [];\n    this.rejectedCallbacks = [];\n    this._promise = null;\n  }\n  /**\n   * Convert task to promise\n   * @returns promise that will be resolved when task is settled\n   */\n  toPromise() {\n    if (!this._promise) {\n      this._promise = new Promise((resolve, reject) => {\n        this.wait(\n          (result) => resolve(result),\n          (error) => {\n            if (error.type === \"abort\") {\n              reject(new TaskAbortedError(error.reason));\n            } else {\n              reject(new TaskRejectedError(error.reason));\n            }\n          }\n        );\n      });\n    }\n    return this._promise;\n  }\n  /**\n   * wait for task to be settled\n   * @param resolvedCallback - callback for resolved value\n   * @param rejectedCallback - callback for rejected value\n   */\n  wait(resolvedCallback, rejectedCallback) {\n    switch (this.state.stage) {\n      case 0:\n        this.resolvedCallbacks.push(resolvedCallback);\n        this.rejectedCallbacks.push(rejectedCallback);\n        break;\n      case 1:\n        resolvedCallback(this.state.result);\n        break;\n      case 2:\n        rejectedCallback({\n          type: \"reject\",\n          reason: this.state.reason\n        });\n        break;\n      case 3:\n        rejectedCallback({\n          type: \"abort\",\n          reason: this.state.reason\n        });\n        break;\n    }\n  }\n  /**\n   * resolve task with specific result\n   * @param result - result value\n   */\n  resolve(result) {\n    if (this.state.stage === 0) {\n      this.state = {\n        stage: 1,\n        result\n      };\n      for (const resolvedCallback of this.resolvedCallbacks) {\n        try {\n          resolvedCallback(result);\n        } catch (e) {\n        }\n      }\n      this.resolvedCallbacks = [];\n      this.rejectedCallbacks = [];\n    }\n  }\n  /**\n   * reject task with specific reason\n   * @param reason - abort reason\n   *\n   */\n  reject(reason) {\n    if (this.state.stage === 0) {\n      this.state = {\n        stage: 2,\n        reason\n      };\n      for (const rejectedCallback of this.rejectedCallbacks) {\n        try {\n          rejectedCallback({\n            type: \"reject\",\n            reason\n          });\n        } catch (e) {\n        }\n      }\n      this.resolvedCallbacks = [];\n      this.rejectedCallbacks = [];\n    }\n  }\n  /**\n   * abort task with specific reason\n   * @param reason - abort reason\n   */\n  abort(reason) {\n    if (this.state.stage === 0) {\n      this.state = {\n        stage: 3,\n        reason\n      };\n      for (const rejectedCallback of this.rejectedCallbacks) {\n        try {\n          rejectedCallback({\n            type: \"abort\",\n            reason\n          });\n        } catch (e) {\n        }\n      }\n      this.resolvedCallbacks = [];\n      this.rejectedCallbacks = [];\n    }\n  }\n  /**\n   * fail task with a TaskError from another task\n   * This is a convenience method for error propagation between tasks\n   * @param error - TaskError from another task\n   */\n  fail(error) {\n    if (error.type === \"abort\") {\n      this.abort(error.reason);\n    } else {\n      this.reject(error.reason);\n    }\n  }\n  /**\n   * Static method to wait for all tasks to resolve\n   * Returns a new task that resolves with an array of all results\n   * Rejects immediately if any task fails\n   *\n   * @param tasks - array of tasks to wait for\n   * @returns new task that resolves when all input tasks resolve\n   * @public\n   */\n  static all(tasks) {\n    const combinedTask = new _Task();\n    if (tasks.length === 0) {\n      combinedTask.resolve([]);\n      return combinedTask;\n    }\n    const results = new Array(tasks.length);\n    let resolvedCount = 0;\n    let isSettled = false;\n    tasks.forEach((task, index) => {\n      task.wait(\n        (result) => {\n          if (isSettled) return;\n          results[index] = result;\n          resolvedCount++;\n          if (resolvedCount === tasks.length) {\n            isSettled = true;\n            combinedTask.resolve(results);\n          }\n        },\n        (error) => {\n          if (isSettled) return;\n          isSettled = true;\n          if (error.type === \"abort\") {\n            combinedTask.abort(error.reason);\n          } else {\n            combinedTask.reject(error.reason);\n          }\n        }\n      );\n    });\n    return combinedTask;\n  }\n  /**\n   * Static method to wait for all tasks to settle (resolve, reject, or abort)\n   * Always resolves with an array of settlement results\n   *\n   * @param tasks - array of tasks to wait for\n   * @returns new task that resolves when all input tasks settle\n   * @public\n   */\n  static allSettled(tasks) {\n    const combinedTask = new _Task();\n    if (tasks.length === 0) {\n      combinedTask.resolve([]);\n      return combinedTask;\n    }\n    const results = new Array(tasks.length);\n    let settledCount = 0;\n    tasks.forEach((task, index) => {\n      task.wait(\n        (result) => {\n          results[index] = { status: \"resolved\", value: result };\n          settledCount++;\n          if (settledCount === tasks.length) {\n            combinedTask.resolve(results);\n          }\n        },\n        (error) => {\n          results[index] = {\n            status: error.type === \"abort\" ? \"aborted\" : \"rejected\",\n            reason: error.reason\n          };\n          settledCount++;\n          if (settledCount === tasks.length) {\n            combinedTask.resolve(results);\n          }\n        }\n      );\n    });\n    return combinedTask;\n  }\n  /**\n   * Static method that resolves/rejects with the first task that settles\n   *\n   * @param tasks - array of tasks to race\n   * @returns new task that settles with the first input task that settles\n   * @public\n   */\n  static race(tasks) {\n    const combinedTask = new _Task();\n    if (tasks.length === 0) {\n      combinedTask.reject(\"No tasks provided\");\n      return combinedTask;\n    }\n    let isSettled = false;\n    tasks.forEach((task) => {\n      task.wait(\n        (result) => {\n          if (isSettled) return;\n          isSettled = true;\n          combinedTask.resolve(result);\n        },\n        (error) => {\n          if (isSettled) return;\n          isSettled = true;\n          if (error.type === \"abort\") {\n            combinedTask.abort(error.reason);\n          } else {\n            combinedTask.reject(error.reason);\n          }\n        }\n      );\n    });\n    return combinedTask;\n  }\n  /**\n   * Utility to track progress of multiple tasks\n   *\n   * @param tasks - array of tasks to track\n   * @param onProgress - callback called when any task completes\n   * @returns new task that resolves when all input tasks resolve\n   * @public\n   */\n  static withProgress(tasks, onProgress) {\n    const combinedTask = _Task.all(tasks);\n    if (onProgress) {\n      let completedCount = 0;\n      tasks.forEach((task) => {\n        task.wait(\n          () => {\n            completedCount++;\n            onProgress(completedCount, tasks.length);\n          },\n          () => {\n            completedCount++;\n            onProgress(completedCount, tasks.length);\n          }\n        );\n      });\n    }\n    return combinedTask;\n  }\n};\nvar PdfSoftHyphenMarker = \"\\xAD\";\nvar PdfZeroWidthSpace = \"\\u200B\";\nvar PdfWordJoiner = \"\\u2060\";\nvar PdfBomOrZwnbsp = \"\\uFEFF\";\nvar PdfNonCharacterFFFE = \"\\uFFFE\";\nvar PdfNonCharacterFFFF = \"\\uFFFF\";\nvar PdfUnwantedTextMarkers = Object.freeze([\n  PdfSoftHyphenMarker,\n  PdfZeroWidthSpace,\n  PdfWordJoiner,\n  PdfBomOrZwnbsp,\n  PdfNonCharacterFFFE,\n  PdfNonCharacterFFFF\n]);\nvar PdfUnwantedTextRegex = new RegExp(`[${PdfUnwantedTextMarkers.join(\"\")}]`, \"g\");\nvar PdfBlendMode = /* @__PURE__ */ ((PdfBlendMode22) => {\n  PdfBlendMode22[PdfBlendMode22[\"Normal\"] = 0] = \"Normal\";\n  PdfBlendMode22[PdfBlendMode22[\"Multiply\"] = 1] = \"Multiply\";\n  PdfBlendMode22[PdfBlendMode22[\"Screen\"] = 2] = \"Screen\";\n  PdfBlendMode22[PdfBlendMode22[\"Overlay\"] = 3] = \"Overlay\";\n  PdfBlendMode22[PdfBlendMode22[\"Darken\"] = 4] = \"Darken\";\n  PdfBlendMode22[PdfBlendMode22[\"Lighten\"] = 5] = \"Lighten\";\n  PdfBlendMode22[PdfBlendMode22[\"ColorDodge\"] = 6] = \"ColorDodge\";\n  PdfBlendMode22[PdfBlendMode22[\"ColorBurn\"] = 7] = \"ColorBurn\";\n  PdfBlendMode22[PdfBlendMode22[\"HardLight\"] = 8] = \"HardLight\";\n  PdfBlendMode22[PdfBlendMode22[\"SoftLight\"] = 9] = \"SoftLight\";\n  PdfBlendMode22[PdfBlendMode22[\"Difference\"] = 10] = \"Difference\";\n  PdfBlendMode22[PdfBlendMode22[\"Exclusion\"] = 11] = \"Exclusion\";\n  PdfBlendMode22[PdfBlendMode22[\"Hue\"] = 12] = \"Hue\";\n  PdfBlendMode22[PdfBlendMode22[\"Saturation\"] = 13] = \"Saturation\";\n  PdfBlendMode22[PdfBlendMode22[\"Color\"] = 14] = \"Color\";\n  PdfBlendMode22[PdfBlendMode22[\"Luminosity\"] = 15] = \"Luminosity\";\n  return PdfBlendMode22;\n})(PdfBlendMode || {});\nvar MixedBlendMode = Symbol(\"mixed\");\nvar BLEND_MODE_INFOS = Object.freeze([\n  { id: 0, label: \"Normal\", css: \"normal\" },\n  { id: 1, label: \"Multiply\", css: \"multiply\" },\n  { id: 2, label: \"Screen\", css: \"screen\" },\n  { id: 3, label: \"Overlay\", css: \"overlay\" },\n  { id: 4, label: \"Darken\", css: \"darken\" },\n  { id: 5, label: \"Lighten\", css: \"lighten\" },\n  { id: 6, label: \"Color Dodge\", css: \"color-dodge\" },\n  { id: 7, label: \"Color Burn\", css: \"color-burn\" },\n  { id: 8, label: \"Hard Light\", css: \"hard-light\" },\n  { id: 9, label: \"Soft Light\", css: \"soft-light\" },\n  { id: 10, label: \"Difference\", css: \"difference\" },\n  { id: 11, label: \"Exclusion\", css: \"exclusion\" },\n  { id: 12, label: \"Hue\", css: \"hue\" },\n  { id: 13, label: \"Saturation\", css: \"saturation\" },\n  { id: 14, label: \"Color\", css: \"color\" },\n  { id: 15, label: \"Luminosity\", css: \"luminosity\" }\n]);\nvar enumToInfo = BLEND_MODE_INFOS.reduce(\n  (m5, info) => {\n    m5[info.id] = info;\n    return m5;\n  },\n  {}\n);\nvar cssToEnum = BLEND_MODE_INFOS.reduce((m5, info) => {\n  m5[info.css] = info.id;\n  return m5;\n}, {});\nfunction getBlendModeInfo(mode) {\n  return enumToInfo[mode] ?? enumToInfo[\n    0\n    /* Normal */\n  ];\n}\nfunction blendModeToCss(mode) {\n  return getBlendModeInfo(mode).css;\n}\nvar blendModeSelectOptions = BLEND_MODE_INFOS.map((info) => ({\n  value: info.id,\n  label: info.label\n}));\nvar PdfAnnotationSubtype = /* @__PURE__ */ ((PdfAnnotationSubtype22) => {\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"UNKNOWN\"] = 0] = \"UNKNOWN\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"TEXT\"] = 1] = \"TEXT\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"LINK\"] = 2] = \"LINK\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"FREETEXT\"] = 3] = \"FREETEXT\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"LINE\"] = 4] = \"LINE\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"SQUARE\"] = 5] = \"SQUARE\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"CIRCLE\"] = 6] = \"CIRCLE\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"POLYGON\"] = 7] = \"POLYGON\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"POLYLINE\"] = 8] = \"POLYLINE\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"HIGHLIGHT\"] = 9] = \"HIGHLIGHT\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"UNDERLINE\"] = 10] = \"UNDERLINE\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"SQUIGGLY\"] = 11] = \"SQUIGGLY\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"STRIKEOUT\"] = 12] = \"STRIKEOUT\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"STAMP\"] = 13] = \"STAMP\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"CARET\"] = 14] = \"CARET\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"INK\"] = 15] = \"INK\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"POPUP\"] = 16] = \"POPUP\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"FILEATTACHMENT\"] = 17] = \"FILEATTACHMENT\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"SOUND\"] = 18] = \"SOUND\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"MOVIE\"] = 19] = \"MOVIE\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"WIDGET\"] = 20] = \"WIDGET\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"SCREEN\"] = 21] = \"SCREEN\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"PRINTERMARK\"] = 22] = \"PRINTERMARK\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"TRAPNET\"] = 23] = \"TRAPNET\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"WATERMARK\"] = 24] = \"WATERMARK\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"THREED\"] = 25] = \"THREED\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"RICHMEDIA\"] = 26] = \"RICHMEDIA\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"XFAWIDGET\"] = 27] = \"XFAWIDGET\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"REDACT\"] = 28] = \"REDACT\";\n  return PdfAnnotationSubtype22;\n})(PdfAnnotationSubtype || {});\nvar PdfAnnotationFlagName = Object.freeze({\n  [\n    1\n    /* INVISIBLE */\n  ]: \"invisible\",\n  [\n    2\n    /* HIDDEN */\n  ]: \"hidden\",\n  [\n    4\n    /* PRINT */\n  ]: \"print\",\n  [\n    8\n    /* NO_ZOOM */\n  ]: \"noZoom\",\n  [\n    16\n    /* NO_ROTATE */\n  ]: \"noRotate\",\n  [\n    32\n    /* NO_VIEW */\n  ]: \"noView\",\n  [\n    64\n    /* READ_ONLY */\n  ]: \"readOnly\",\n  [\n    128\n    /* LOCKED */\n  ]: \"locked\",\n  [\n    256\n    /* TOGGLE_NOVIEW */\n  ]: \"toggleNoView\"\n});\nvar PdfAnnotationFlagValue = Object.entries(\n  PdfAnnotationFlagName\n).reduce(\n  (acc, [bit, name]) => {\n    acc[name] = Number(bit);\n    return acc;\n  },\n  {}\n);\nvar PdfErrorCode = /* @__PURE__ */ ((PdfErrorCode22) => {\n  PdfErrorCode22[PdfErrorCode22[\"Ok\"] = 0] = \"Ok\";\n  PdfErrorCode22[PdfErrorCode22[\"Unknown\"] = 1] = \"Unknown\";\n  PdfErrorCode22[PdfErrorCode22[\"NotFound\"] = 2] = \"NotFound\";\n  PdfErrorCode22[PdfErrorCode22[\"WrongFormat\"] = 3] = \"WrongFormat\";\n  PdfErrorCode22[PdfErrorCode22[\"Password\"] = 4] = \"Password\";\n  PdfErrorCode22[PdfErrorCode22[\"Security\"] = 5] = \"Security\";\n  PdfErrorCode22[PdfErrorCode22[\"PageError\"] = 6] = \"PageError\";\n  PdfErrorCode22[PdfErrorCode22[\"XFALoad\"] = 7] = \"XFALoad\";\n  PdfErrorCode22[PdfErrorCode22[\"XFALayout\"] = 8] = \"XFALayout\";\n  PdfErrorCode22[PdfErrorCode22[\"Cancelled\"] = 9] = \"Cancelled\";\n  PdfErrorCode22[PdfErrorCode22[\"Initialization\"] = 10] = \"Initialization\";\n  PdfErrorCode22[PdfErrorCode22[\"NotReady\"] = 11] = \"NotReady\";\n  PdfErrorCode22[PdfErrorCode22[\"NotSupport\"] = 12] = \"NotSupport\";\n  PdfErrorCode22[PdfErrorCode22[\"LoadDoc\"] = 13] = \"LoadDoc\";\n  PdfErrorCode22[PdfErrorCode22[\"DocNotOpen\"] = 14] = \"DocNotOpen\";\n  PdfErrorCode22[PdfErrorCode22[\"CantCloseDoc\"] = 15] = \"CantCloseDoc\";\n  PdfErrorCode22[PdfErrorCode22[\"CantCreateNewDoc\"] = 16] = \"CantCreateNewDoc\";\n  PdfErrorCode22[PdfErrorCode22[\"CantImportPages\"] = 17] = \"CantImportPages\";\n  PdfErrorCode22[PdfErrorCode22[\"CantCreateAnnot\"] = 18] = \"CantCreateAnnot\";\n  PdfErrorCode22[PdfErrorCode22[\"CantSetAnnotRect\"] = 19] = \"CantSetAnnotRect\";\n  PdfErrorCode22[PdfErrorCode22[\"CantSetAnnotContent\"] = 20] = \"CantSetAnnotContent\";\n  PdfErrorCode22[PdfErrorCode22[\"CantRemoveInkList\"] = 21] = \"CantRemoveInkList\";\n  PdfErrorCode22[PdfErrorCode22[\"CantAddInkStoke\"] = 22] = \"CantAddInkStoke\";\n  PdfErrorCode22[PdfErrorCode22[\"CantReadAttachmentSize\"] = 23] = \"CantReadAttachmentSize\";\n  PdfErrorCode22[PdfErrorCode22[\"CantReadAttachmentContent\"] = 24] = \"CantReadAttachmentContent\";\n  PdfErrorCode22[PdfErrorCode22[\"CantFocusAnnot\"] = 25] = \"CantFocusAnnot\";\n  PdfErrorCode22[PdfErrorCode22[\"CantSelectText\"] = 26] = \"CantSelectText\";\n  PdfErrorCode22[PdfErrorCode22[\"CantSelectOption\"] = 27] = \"CantSelectOption\";\n  PdfErrorCode22[PdfErrorCode22[\"CantCheckField\"] = 28] = \"CantCheckField\";\n  return PdfErrorCode22;\n})(PdfErrorCode || {});\nvar PdfTaskHelper = class {\n  /**\n   * Create a task\n   * @returns new task\n   */\n  static create() {\n    return new Task();\n  }\n  /**\n   * Create a task that has been resolved with value\n   * @param result - resolved value\n   * @returns resolved task\n   */\n  static resolve(result) {\n    const task = new Task();\n    task.resolve(result);\n    return task;\n  }\n  /**\n   * Create a task that has been rejected with error\n   * @param reason - rejected error\n   * @returns rejected task\n   */\n  static reject(reason) {\n    const task = new Task();\n    task.reject(reason);\n    return task;\n  }\n  /**\n   * Create a task that has been aborted with error\n   * @param reason - aborted error\n   * @returns aborted task\n   */\n  static abort(reason) {\n    const task = new Task();\n    task.reject(reason);\n    return task;\n  }\n};\nfunction ignore() {\n}\n\n// ../core/dist/index.js\nvar m = \"SET_DOCUMENT\";\nvar Z = class {\n  constructor(t, e) {\n    if (this.id = t, this.registry = e, this.debouncedActions = {}, this.unsubscribeFromState = null, this.unsubscribeFromCoreStore = null, t !== this.constructor.id)\n      throw new Error(\n        `Plugin ID mismatch: ${t} !== ${this.constructor.id}`\n      );\n    this.coreStore = this.registry.getStore(), this.pluginStore = this.coreStore.getPluginStore(this.id), this.unsubscribeFromState = this.pluginStore.subscribeToState((i2, r, n) => {\n      this.onStoreUpdated(n, r);\n    }), this.unsubscribeFromCoreStore = this.coreStore.subscribe((i2, r, n) => {\n      this.onCoreStoreUpdated(n, r);\n    }), this.readyPromise = new Promise((i2) => {\n      this.readyResolve = i2;\n    }), this.readyResolve();\n  }\n  provides() {\n    if (!this._capability) {\n      const t = this.buildCapability();\n      this._capability = Object.freeze(t);\n    }\n    return this._capability;\n  }\n  /**\n   *  Get a copy of the current state\n   */\n  get state() {\n    return this.pluginStore.getState();\n  }\n  /**\n   *  Get a copy of the current core state\n   */\n  get coreState() {\n    return this.coreStore.getState();\n  }\n  /**\n   * @deprecated  use `this.state` Get a copy of the current state\n   */\n  getState() {\n    return this.pluginStore.getState();\n  }\n  /**\n   * @deprecated  use `this.coreState` Get a copy of the current core state\n   */\n  getCoreState() {\n    return this.coreStore.getState();\n  }\n  /**\n   * Core Dispatch\n   */\n  dispatchCoreAction(t) {\n    return this.coreStore.dispatchToCore(t);\n  }\n  /**\n   * Dispatch an action to all plugins\n   */\n  dispatchToAllPlugins(t) {\n    return this.coreStore.dispatch(t);\n  }\n  /**\n   * Dispatch an action\n   */\n  dispatch(t) {\n    return this.pluginStore.dispatch(t);\n  }\n  /**\n   * Dispatch an action with debouncing to prevent rapid repeated calls\n   * @param action The action to dispatch\n   * @param debounceTime Time in ms to debounce (default: 100ms)\n   * @returns boolean indicating whether the action was dispatched or debounced\n   */\n  debouncedDispatch(t, e = 100) {\n    const i2 = Date.now(), r = this.debouncedActions[t.type] || 0;\n    return i2 - r >= e ? (this.debouncedActions[t.type] = i2, this.dispatch(t), true) : false;\n  }\n  /**\n   * Subscribe to state changes\n   */\n  subscribe(t) {\n    return this.pluginStore.subscribeToState(t);\n  }\n  /**\n   * Subscribe to core store changes\n   */\n  subscribeToCoreStore(t) {\n    return this.coreStore.subscribe(t);\n  }\n  /**\n   * Called when the plugin store state is updated\n   * @param oldState Previous state\n   * @param newState New state\n   */\n  onStoreUpdated(t, e) {\n  }\n  /**\n   * Called when the core store state is updated\n   * @param oldState Previous state\n   * @param newState New state\n   */\n  onCoreStoreUpdated(t, e) {\n  }\n  /**\n   * Cleanup method to be called when plugin is being destroyed\n   */\n  destroy() {\n    this.unsubscribeFromState && (this.unsubscribeFromState(), this.unsubscribeFromState = null), this.unsubscribeFromCoreStore && (this.unsubscribeFromCoreStore(), this.unsubscribeFromCoreStore = null);\n  }\n  /**\n   * Returns a promise that resolves when the plugin is ready\n   */\n  ready() {\n    return this.readyPromise;\n  }\n  /**\n   * Mark the plugin as ready\n   */\n  markReady() {\n    this.readyResolve();\n  }\n  /**\n   * Reset the ready state (useful for plugins that need to reinitialize)\n   */\n  resetReady() {\n    this.readyPromise = new Promise((t) => {\n      this.readyResolve = t;\n    });\n  }\n};\nvar N = class {\n  constructor(t, e) {\n    this.handler = t, this.options = e, this.lastRun = 0, this.handle = (i2) => {\n      this.options.mode === \"debounce\" ? this.debounce(i2) : this.throttle(i2);\n    };\n  }\n  debounce(t) {\n    this.timeoutId && window.clearTimeout(this.timeoutId), this.timeoutId = window.setTimeout(() => {\n      this.handler(t), this.timeoutId = void 0;\n    }, this.options.wait);\n  }\n  throttle(t) {\n    if (this.options.mode === \"debounce\") return;\n    const e = Date.now(), i2 = this.options.throttleMode || \"leading-trailing\";\n    e - this.lastRun >= this.options.wait && (i2 === \"leading-trailing\" && this.handler(t), this.lastRun = e), this.timeoutId && window.clearTimeout(this.timeoutId), this.timeoutId = window.setTimeout(\n      () => {\n        this.handler(t), this.lastRun = Date.now(), this.timeoutId = void 0;\n      },\n      this.options.wait - (e - this.lastRun)\n    );\n  }\n  destroy() {\n    this.timeoutId && window.clearTimeout(this.timeoutId);\n  }\n};\nfunction f(s, t, e) {\n  if (s === t)\n    return true;\n  if (s == null || t == null)\n    return s === t;\n  const i2 = typeof s;\n  if (i2 !== typeof t) return false;\n  if (i2 === \"object\") {\n    e || (e = /* @__PURE__ */ new Set());\n    const n = F(s, t);\n    if (e.has(n))\n      return true;\n    e.add(n);\n    const o = Array.isArray(s), a2 = Array.isArray(t);\n    return o && a2 ? q(s, t, e) : !o && !a2 ? I(s, t, e) : false;\n  }\n  return false;\n}\nfunction F(s, t) {\n  return `${v(s)}__${v(t)}`;\n}\nvar k = 0;\nvar w = /* @__PURE__ */ new WeakMap();\nfunction v(s) {\n  return w.has(s) || w.set(s, ++k), w.get(s);\n}\nfunction q(s, t, e) {\n  if (s.length !== t.length) return false;\n  const i2 = new Array(t.length).fill(false);\n  t: for (let r = 0; r < s.length; r++) {\n    const n = s[r];\n    for (let o = 0; o < t.length; o++)\n      if (!i2[o] && f(n, t[o], e)) {\n        i2[o] = true;\n        continue t;\n      }\n    return false;\n  }\n  return true;\n}\nfunction I(s, t, e) {\n  const i2 = Object.keys(s).sort(), r = Object.keys(t).sort();\n  if (i2.length !== r.length) return false;\n  for (let n = 0; n < i2.length; n++)\n    if (i2[n] !== r[n]) return false;\n  for (const n of i2) {\n    const o = s[n], a2 = t[n];\n    if (!f(o, a2, e))\n      return false;\n  }\n  return true;\n}\nfunction et() {\n  const s = /* @__PURE__ */ new Set();\n  return {\n    emit: (e = void 0) => s.forEach((i2) => i2(e)),\n    on: (e) => (s.add(e), () => s.delete(e)),\n    off: (e) => s.delete(e),\n    clear: () => s.clear()\n  };\n}\nfunction it(s, t = f) {\n  const e = /* @__PURE__ */ new Set(), i2 = /* @__PURE__ */ new Map();\n  let r = s;\n  const n = (a2) => e.forEach((l4) => l4(a2)), o = (a2, l4) => {\n    let h4 = a2, g3 = () => {\n    };\n    if (l4) {\n      const c2 = new N(a2, l4);\n      h4 = c2.handle, g3 = () => c2.destroy(), i2.set(a2, { wrapped: h4, destroy: g3 });\n    }\n    return r !== void 0 && h4(r), e.add(h4), () => {\n      e.delete(h4), g3(), i2.delete(a2);\n    };\n  };\n  return {\n    /* emitter behaviour ---------------------------------------- */\n    get value() {\n      return r;\n    },\n    emit(a2 = void 0) {\n      (r === void 0 || !t(r, a2)) && (r = a2, n(a2));\n    },\n    on: o,\n    off(a2) {\n      const l4 = i2.get(a2);\n      l4 ? (e.delete(l4.wrapped), l4.destroy(), i2.delete(a2)) : e.delete(a2);\n    },\n    clear() {\n      e.clear(), i2.forEach((a2) => a2.destroy()), i2.clear();\n    },\n    /* derived hook --------------------------------------------- */\n    select(a2, l4 = f) {\n      return (h4, g3) => {\n        let c2;\n        if (r !== void 0) {\n          const p3 = a2(r);\n          c2 = p3, h4(p3);\n        }\n        return o(\n          (p3) => {\n            const y2 = a2(p3);\n            (c2 === void 0 || !l4(c2, y2)) && (c2 = y2, h4(y2));\n          },\n          g3\n        );\n      };\n    }\n  };\n}\n\n// ../core/dist/preact/index.js\nvar P = b({\n  registry: null,\n  isInitializing: true,\n  pluginsReady: false\n});\nfunction g() {\n  const t = S(P);\n  if (t === void 0)\n    throw new Error(\"useCapability must be used within a PDFContext.Provider\");\n  const { registry: r, isInitializing: e } = t;\n  if (e)\n    return t;\n  if (r === null)\n    throw new Error(\"PDF registry failed to initialize properly\");\n  return t;\n}\nfunction h(t) {\n  const { registry: r } = g();\n  if (r === null)\n    return {\n      plugin: null,\n      isLoading: true,\n      ready: new Promise(() => {\n      })\n    };\n  const e = r.getPlugin(t);\n  if (!e)\n    throw new Error(`Plugin ${t} not found`);\n  return {\n    plugin: e,\n    isLoading: false,\n    ready: e.ready()\n  };\n}\nfunction L(t) {\n  const { plugin: r, isLoading: e, ready: i2 } = h(t);\n  if (!r)\n    return {\n      provides: null,\n      isLoading: e,\n      ready: i2\n    };\n  if (!r.provides)\n    throw new Error(`Plugin ${t} does not provide a capability`);\n  return {\n    provides: r.provides(),\n    isLoading: e,\n    ready: i2\n  };\n}\n\n// dist/index.js\nvar Rotation2 = /* @__PURE__ */ ((Rotation22) => {\n  Rotation22[Rotation22[\"Degree0\"] = 0] = \"Degree0\";\n  Rotation22[Rotation22[\"Degree90\"] = 1] = \"Degree90\";\n  Rotation22[Rotation22[\"Degree180\"] = 2] = \"Degree180\";\n  Rotation22[Rotation22[\"Degree270\"] = 3] = \"Degree270\";\n  return Rotation22;\n})(Rotation2 || {});\nvar TaskAbortedError2 = class extends Error {\n  constructor(reason) {\n    super(`Task aborted: ${JSON.stringify(reason)}`);\n    this.name = \"TaskAbortedError\";\n  }\n};\nvar TaskRejectedError2 = class extends Error {\n  constructor(reason) {\n    super(`Task rejected: ${JSON.stringify(reason)}`);\n    this.name = \"TaskRejectedError\";\n  }\n};\nvar Task2 = class _Task2 {\n  constructor() {\n    this.state = {\n      stage: 0\n      /* Pending */\n    };\n    this.resolvedCallbacks = [];\n    this.rejectedCallbacks = [];\n    this._promise = null;\n  }\n  /**\n   * Convert task to promise\n   * @returns promise that will be resolved when task is settled\n   */\n  toPromise() {\n    if (!this._promise) {\n      this._promise = new Promise((resolve, reject) => {\n        this.wait(\n          (result) => resolve(result),\n          (error) => {\n            if (error.type === \"abort\") {\n              reject(new TaskAbortedError2(error.reason));\n            } else {\n              reject(new TaskRejectedError2(error.reason));\n            }\n          }\n        );\n      });\n    }\n    return this._promise;\n  }\n  /**\n   * wait for task to be settled\n   * @param resolvedCallback - callback for resolved value\n   * @param rejectedCallback - callback for rejected value\n   */\n  wait(resolvedCallback, rejectedCallback) {\n    switch (this.state.stage) {\n      case 0:\n        this.resolvedCallbacks.push(resolvedCallback);\n        this.rejectedCallbacks.push(rejectedCallback);\n        break;\n      case 1:\n        resolvedCallback(this.state.result);\n        break;\n      case 2:\n        rejectedCallback({\n          type: \"reject\",\n          reason: this.state.reason\n        });\n        break;\n      case 3:\n        rejectedCallback({\n          type: \"abort\",\n          reason: this.state.reason\n        });\n        break;\n    }\n  }\n  /**\n   * resolve task with specific result\n   * @param result - result value\n   */\n  resolve(result) {\n    if (this.state.stage === 0) {\n      this.state = {\n        stage: 1,\n        result\n      };\n      for (const resolvedCallback of this.resolvedCallbacks) {\n        try {\n          resolvedCallback(result);\n        } catch (e) {\n        }\n      }\n      this.resolvedCallbacks = [];\n      this.rejectedCallbacks = [];\n    }\n  }\n  /**\n   * reject task with specific reason\n   * @param reason - abort reason\n   *\n   */\n  reject(reason) {\n    if (this.state.stage === 0) {\n      this.state = {\n        stage: 2,\n        reason\n      };\n      for (const rejectedCallback of this.rejectedCallbacks) {\n        try {\n          rejectedCallback({\n            type: \"reject\",\n            reason\n          });\n        } catch (e) {\n        }\n      }\n      this.resolvedCallbacks = [];\n      this.rejectedCallbacks = [];\n    }\n  }\n  /**\n   * abort task with specific reason\n   * @param reason - abort reason\n   */\n  abort(reason) {\n    if (this.state.stage === 0) {\n      this.state = {\n        stage: 3,\n        reason\n      };\n      for (const rejectedCallback of this.rejectedCallbacks) {\n        try {\n          rejectedCallback({\n            type: \"abort\",\n            reason\n          });\n        } catch (e) {\n        }\n      }\n      this.resolvedCallbacks = [];\n      this.rejectedCallbacks = [];\n    }\n  }\n  /**\n   * fail task with a TaskError from another task\n   * This is a convenience method for error propagation between tasks\n   * @param error - TaskError from another task\n   */\n  fail(error) {\n    if (error.type === \"abort\") {\n      this.abort(error.reason);\n    } else {\n      this.reject(error.reason);\n    }\n  }\n  /**\n   * Static method to wait for all tasks to resolve\n   * Returns a new task that resolves with an array of all results\n   * Rejects immediately if any task fails\n   *\n   * @param tasks - array of tasks to wait for\n   * @returns new task that resolves when all input tasks resolve\n   * @public\n   */\n  static all(tasks) {\n    const combinedTask = new _Task2();\n    if (tasks.length === 0) {\n      combinedTask.resolve([]);\n      return combinedTask;\n    }\n    const results = new Array(tasks.length);\n    let resolvedCount = 0;\n    let isSettled = false;\n    tasks.forEach((task, index) => {\n      task.wait(\n        (result) => {\n          if (isSettled) return;\n          results[index] = result;\n          resolvedCount++;\n          if (resolvedCount === tasks.length) {\n            isSettled = true;\n            combinedTask.resolve(results);\n          }\n        },\n        (error) => {\n          if (isSettled) return;\n          isSettled = true;\n          if (error.type === \"abort\") {\n            combinedTask.abort(error.reason);\n          } else {\n            combinedTask.reject(error.reason);\n          }\n        }\n      );\n    });\n    return combinedTask;\n  }\n  /**\n   * Static method to wait for all tasks to settle (resolve, reject, or abort)\n   * Always resolves with an array of settlement results\n   *\n   * @param tasks - array of tasks to wait for\n   * @returns new task that resolves when all input tasks settle\n   * @public\n   */\n  static allSettled(tasks) {\n    const combinedTask = new _Task2();\n    if (tasks.length === 0) {\n      combinedTask.resolve([]);\n      return combinedTask;\n    }\n    const results = new Array(tasks.length);\n    let settledCount = 0;\n    tasks.forEach((task, index) => {\n      task.wait(\n        (result) => {\n          results[index] = { status: \"resolved\", value: result };\n          settledCount++;\n          if (settledCount === tasks.length) {\n            combinedTask.resolve(results);\n          }\n        },\n        (error) => {\n          results[index] = {\n            status: error.type === \"abort\" ? \"aborted\" : \"rejected\",\n            reason: error.reason\n          };\n          settledCount++;\n          if (settledCount === tasks.length) {\n            combinedTask.resolve(results);\n          }\n        }\n      );\n    });\n    return combinedTask;\n  }\n  /**\n   * Static method that resolves/rejects with the first task that settles\n   *\n   * @param tasks - array of tasks to race\n   * @returns new task that settles with the first input task that settles\n   * @public\n   */\n  static race(tasks) {\n    const combinedTask = new _Task2();\n    if (tasks.length === 0) {\n      combinedTask.reject(\"No tasks provided\");\n      return combinedTask;\n    }\n    let isSettled = false;\n    tasks.forEach((task) => {\n      task.wait(\n        (result) => {\n          if (isSettled) return;\n          isSettled = true;\n          combinedTask.resolve(result);\n        },\n        (error) => {\n          if (isSettled) return;\n          isSettled = true;\n          if (error.type === \"abort\") {\n            combinedTask.abort(error.reason);\n          } else {\n            combinedTask.reject(error.reason);\n          }\n        }\n      );\n    });\n    return combinedTask;\n  }\n  /**\n   * Utility to track progress of multiple tasks\n   *\n   * @param tasks - array of tasks to track\n   * @param onProgress - callback called when any task completes\n   * @returns new task that resolves when all input tasks resolve\n   * @public\n   */\n  static withProgress(tasks, onProgress) {\n    const combinedTask = _Task2.all(tasks);\n    if (onProgress) {\n      let completedCount = 0;\n      tasks.forEach((task) => {\n        task.wait(\n          () => {\n            completedCount++;\n            onProgress(completedCount, tasks.length);\n          },\n          () => {\n            completedCount++;\n            onProgress(completedCount, tasks.length);\n          }\n        );\n      });\n    }\n    return combinedTask;\n  }\n};\nvar PdfSoftHyphenMarker2 = \"\\xAD\";\nvar PdfZeroWidthSpace2 = \"\\u200B\";\nvar PdfWordJoiner2 = \"\\u2060\";\nvar PdfBomOrZwnbsp2 = \"\\uFEFF\";\nvar PdfNonCharacterFFFE2 = \"\\uFFFE\";\nvar PdfNonCharacterFFFF2 = \"\\uFFFF\";\nvar PdfUnwantedTextMarkers2 = Object.freeze([\n  PdfSoftHyphenMarker2,\n  PdfZeroWidthSpace2,\n  PdfWordJoiner2,\n  PdfBomOrZwnbsp2,\n  PdfNonCharacterFFFE2,\n  PdfNonCharacterFFFF2\n]);\nvar PdfUnwantedTextRegex2 = new RegExp(`[${PdfUnwantedTextMarkers2.join(\"\")}]`, \"g\");\nvar PdfBlendMode2 = /* @__PURE__ */ ((PdfBlendMode22) => {\n  PdfBlendMode22[PdfBlendMode22[\"Normal\"] = 0] = \"Normal\";\n  PdfBlendMode22[PdfBlendMode22[\"Multiply\"] = 1] = \"Multiply\";\n  PdfBlendMode22[PdfBlendMode22[\"Screen\"] = 2] = \"Screen\";\n  PdfBlendMode22[PdfBlendMode22[\"Overlay\"] = 3] = \"Overlay\";\n  PdfBlendMode22[PdfBlendMode22[\"Darken\"] = 4] = \"Darken\";\n  PdfBlendMode22[PdfBlendMode22[\"Lighten\"] = 5] = \"Lighten\";\n  PdfBlendMode22[PdfBlendMode22[\"ColorDodge\"] = 6] = \"ColorDodge\";\n  PdfBlendMode22[PdfBlendMode22[\"ColorBurn\"] = 7] = \"ColorBurn\";\n  PdfBlendMode22[PdfBlendMode22[\"HardLight\"] = 8] = \"HardLight\";\n  PdfBlendMode22[PdfBlendMode22[\"SoftLight\"] = 9] = \"SoftLight\";\n  PdfBlendMode22[PdfBlendMode22[\"Difference\"] = 10] = \"Difference\";\n  PdfBlendMode22[PdfBlendMode22[\"Exclusion\"] = 11] = \"Exclusion\";\n  PdfBlendMode22[PdfBlendMode22[\"Hue\"] = 12] = \"Hue\";\n  PdfBlendMode22[PdfBlendMode22[\"Saturation\"] = 13] = \"Saturation\";\n  PdfBlendMode22[PdfBlendMode22[\"Color\"] = 14] = \"Color\";\n  PdfBlendMode22[PdfBlendMode22[\"Luminosity\"] = 15] = \"Luminosity\";\n  return PdfBlendMode22;\n})(PdfBlendMode2 || {});\nvar MixedBlendMode2 = Symbol(\"mixed\");\nvar BLEND_MODE_INFOS2 = Object.freeze([\n  { id: 0, label: \"Normal\", css: \"normal\" },\n  { id: 1, label: \"Multiply\", css: \"multiply\" },\n  { id: 2, label: \"Screen\", css: \"screen\" },\n  { id: 3, label: \"Overlay\", css: \"overlay\" },\n  { id: 4, label: \"Darken\", css: \"darken\" },\n  { id: 5, label: \"Lighten\", css: \"lighten\" },\n  { id: 6, label: \"Color Dodge\", css: \"color-dodge\" },\n  { id: 7, label: \"Color Burn\", css: \"color-burn\" },\n  { id: 8, label: \"Hard Light\", css: \"hard-light\" },\n  { id: 9, label: \"Soft Light\", css: \"soft-light\" },\n  { id: 10, label: \"Difference\", css: \"difference\" },\n  { id: 11, label: \"Exclusion\", css: \"exclusion\" },\n  { id: 12, label: \"Hue\", css: \"hue\" },\n  { id: 13, label: \"Saturation\", css: \"saturation\" },\n  { id: 14, label: \"Color\", css: \"color\" },\n  { id: 15, label: \"Luminosity\", css: \"luminosity\" }\n]);\nvar enumToInfo2 = BLEND_MODE_INFOS2.reduce(\n  (m22, info) => {\n    m22[info.id] = info;\n    return m22;\n  },\n  {}\n);\nvar cssToEnum2 = BLEND_MODE_INFOS2.reduce((m22, info) => {\n  m22[info.css] = info.id;\n  return m22;\n}, {});\nvar blendModeSelectOptions2 = BLEND_MODE_INFOS2.map((info) => ({\n  value: info.id,\n  label: info.label\n}));\nvar PdfAnnotationSubtype2 = /* @__PURE__ */ ((PdfAnnotationSubtype22) => {\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"UNKNOWN\"] = 0] = \"UNKNOWN\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"TEXT\"] = 1] = \"TEXT\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"LINK\"] = 2] = \"LINK\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"FREETEXT\"] = 3] = \"FREETEXT\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"LINE\"] = 4] = \"LINE\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"SQUARE\"] = 5] = \"SQUARE\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"CIRCLE\"] = 6] = \"CIRCLE\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"POLYGON\"] = 7] = \"POLYGON\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"POLYLINE\"] = 8] = \"POLYLINE\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"HIGHLIGHT\"] = 9] = \"HIGHLIGHT\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"UNDERLINE\"] = 10] = \"UNDERLINE\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"SQUIGGLY\"] = 11] = \"SQUIGGLY\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"STRIKEOUT\"] = 12] = \"STRIKEOUT\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"STAMP\"] = 13] = \"STAMP\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"CARET\"] = 14] = \"CARET\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"INK\"] = 15] = \"INK\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"POPUP\"] = 16] = \"POPUP\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"FILEATTACHMENT\"] = 17] = \"FILEATTACHMENT\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"SOUND\"] = 18] = \"SOUND\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"MOVIE\"] = 19] = \"MOVIE\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"WIDGET\"] = 20] = \"WIDGET\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"SCREEN\"] = 21] = \"SCREEN\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"PRINTERMARK\"] = 22] = \"PRINTERMARK\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"TRAPNET\"] = 23] = \"TRAPNET\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"WATERMARK\"] = 24] = \"WATERMARK\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"THREED\"] = 25] = \"THREED\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"RICHMEDIA\"] = 26] = \"RICHMEDIA\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"XFAWIDGET\"] = 27] = \"XFAWIDGET\";\n  PdfAnnotationSubtype22[PdfAnnotationSubtype22[\"REDACT\"] = 28] = \"REDACT\";\n  return PdfAnnotationSubtype22;\n})(PdfAnnotationSubtype2 || {});\nvar AppearanceMode = /* @__PURE__ */ ((AppearanceMode2) => {\n  AppearanceMode2[AppearanceMode2[\"Normal\"] = 0] = \"Normal\";\n  AppearanceMode2[AppearanceMode2[\"Rollover\"] = 1] = \"Rollover\";\n  AppearanceMode2[AppearanceMode2[\"Down\"] = 2] = \"Down\";\n  return AppearanceMode2;\n})(AppearanceMode || {});\nvar PdfAnnotationFlagName2 = Object.freeze({\n  [\n    1\n    /* INVISIBLE */\n  ]: \"invisible\",\n  [\n    2\n    /* HIDDEN */\n  ]: \"hidden\",\n  [\n    4\n    /* PRINT */\n  ]: \"print\",\n  [\n    8\n    /* NO_ZOOM */\n  ]: \"noZoom\",\n  [\n    16\n    /* NO_ROTATE */\n  ]: \"noRotate\",\n  [\n    32\n    /* NO_VIEW */\n  ]: \"noView\",\n  [\n    64\n    /* READ_ONLY */\n  ]: \"readOnly\",\n  [\n    128\n    /* LOCKED */\n  ]: \"locked\",\n  [\n    256\n    /* TOGGLE_NOVIEW */\n  ]: \"toggleNoView\"\n});\nvar PdfAnnotationFlagValue2 = Object.entries(\n  PdfAnnotationFlagName2\n).reduce(\n  (acc, [bit, name]) => {\n    acc[name] = Number(bit);\n    return acc;\n  },\n  {}\n);\nvar PdfErrorCode2 = /* @__PURE__ */ ((PdfErrorCode22) => {\n  PdfErrorCode22[PdfErrorCode22[\"Ok\"] = 0] = \"Ok\";\n  PdfErrorCode22[PdfErrorCode22[\"Unknown\"] = 1] = \"Unknown\";\n  PdfErrorCode22[PdfErrorCode22[\"NotFound\"] = 2] = \"NotFound\";\n  PdfErrorCode22[PdfErrorCode22[\"WrongFormat\"] = 3] = \"WrongFormat\";\n  PdfErrorCode22[PdfErrorCode22[\"Password\"] = 4] = \"Password\";\n  PdfErrorCode22[PdfErrorCode22[\"Security\"] = 5] = \"Security\";\n  PdfErrorCode22[PdfErrorCode22[\"PageError\"] = 6] = \"PageError\";\n  PdfErrorCode22[PdfErrorCode22[\"XFALoad\"] = 7] = \"XFALoad\";\n  PdfErrorCode22[PdfErrorCode22[\"XFALayout\"] = 8] = \"XFALayout\";\n  PdfErrorCode22[PdfErrorCode22[\"Cancelled\"] = 9] = \"Cancelled\";\n  PdfErrorCode22[PdfErrorCode22[\"Initialization\"] = 10] = \"Initialization\";\n  PdfErrorCode22[PdfErrorCode22[\"NotReady\"] = 11] = \"NotReady\";\n  PdfErrorCode22[PdfErrorCode22[\"NotSupport\"] = 12] = \"NotSupport\";\n  PdfErrorCode22[PdfErrorCode22[\"LoadDoc\"] = 13] = \"LoadDoc\";\n  PdfErrorCode22[PdfErrorCode22[\"DocNotOpen\"] = 14] = \"DocNotOpen\";\n  PdfErrorCode22[PdfErrorCode22[\"CantCloseDoc\"] = 15] = \"CantCloseDoc\";\n  PdfErrorCode22[PdfErrorCode22[\"CantCreateNewDoc\"] = 16] = \"CantCreateNewDoc\";\n  PdfErrorCode22[PdfErrorCode22[\"CantImportPages\"] = 17] = \"CantImportPages\";\n  PdfErrorCode22[PdfErrorCode22[\"CantCreateAnnot\"] = 18] = \"CantCreateAnnot\";\n  PdfErrorCode22[PdfErrorCode22[\"CantSetAnnotRect\"] = 19] = \"CantSetAnnotRect\";\n  PdfErrorCode22[PdfErrorCode22[\"CantSetAnnotContent\"] = 20] = \"CantSetAnnotContent\";\n  PdfErrorCode22[PdfErrorCode22[\"CantRemoveInkList\"] = 21] = \"CantRemoveInkList\";\n  PdfErrorCode22[PdfErrorCode22[\"CantAddInkStoke\"] = 22] = \"CantAddInkStoke\";\n  PdfErrorCode22[PdfErrorCode22[\"CantReadAttachmentSize\"] = 23] = \"CantReadAttachmentSize\";\n  PdfErrorCode22[PdfErrorCode22[\"CantReadAttachmentContent\"] = 24] = \"CantReadAttachmentContent\";\n  PdfErrorCode22[PdfErrorCode22[\"CantFocusAnnot\"] = 25] = \"CantFocusAnnot\";\n  PdfErrorCode22[PdfErrorCode22[\"CantSelectText\"] = 26] = \"CantSelectText\";\n  PdfErrorCode22[PdfErrorCode22[\"CantSelectOption\"] = 27] = \"CantSelectOption\";\n  PdfErrorCode22[PdfErrorCode22[\"CantCheckField\"] = 28] = \"CantCheckField\";\n  return PdfErrorCode22;\n})(PdfErrorCode2 || {});\nvar PdfTaskHelper2 = class {\n  /**\n   * Create a task\n   * @returns new task\n   */\n  static create() {\n    return new Task2();\n  }\n  /**\n   * Create a task that has been resolved with value\n   * @param result - resolved value\n   * @returns resolved task\n   */\n  static resolve(result) {\n    const task = new Task2();\n    task.resolve(result);\n    return task;\n  }\n  /**\n   * Create a task that has been rejected with error\n   * @param reason - rejected error\n   * @returns rejected task\n   */\n  static reject(reason) {\n    const task = new Task2();\n    task.reject(reason);\n    return task;\n  }\n  /**\n   * Create a task that has been aborted with error\n   * @param reason - aborted error\n   * @returns aborted task\n   */\n  static abort(reason) {\n    const task = new Task2();\n    task.reject(reason);\n    return task;\n  }\n};\nfunction ignore2() {\n}\nvar m3 = \"SET_DOCUMENT\";\nvar Z2 = class {\n  constructor(t, e) {\n    if (this.id = t, this.registry = e, this.debouncedActions = {}, this.unsubscribeFromState = null, this.unsubscribeFromCoreStore = null, t !== this.constructor.id)\n      throw new Error(\n        `Plugin ID mismatch: ${t} !== ${this.constructor.id}`\n      );\n    this.coreStore = this.registry.getStore(), this.pluginStore = this.coreStore.getPluginStore(this.id), this.unsubscribeFromState = this.pluginStore.subscribeToState((i2, r, n) => {\n      this.onStoreUpdated(n, r);\n    }), this.unsubscribeFromCoreStore = this.coreStore.subscribe((i2, r, n) => {\n      this.onCoreStoreUpdated(n, r);\n    }), this.readyPromise = new Promise((i2) => {\n      this.readyResolve = i2;\n    }), this.readyResolve();\n  }\n  provides() {\n    if (!this._capability) {\n      const t = this.buildCapability();\n      this._capability = Object.freeze(t);\n    }\n    return this._capability;\n  }\n  /**\n   *  Get a copy of the current state\n   */\n  get state() {\n    return this.pluginStore.getState();\n  }\n  /**\n   *  Get a copy of the current core state\n   */\n  get coreState() {\n    return this.coreStore.getState();\n  }\n  /**\n   * @deprecated  use `this.state` Get a copy of the current state\n   */\n  getState() {\n    return this.pluginStore.getState();\n  }\n  /**\n   * @deprecated  use `this.coreState` Get a copy of the current core state\n   */\n  getCoreState() {\n    return this.coreStore.getState();\n  }\n  /**\n   * Core Dispatch\n   */\n  dispatchCoreAction(t) {\n    return this.coreStore.dispatchToCore(t);\n  }\n  /**\n   * Dispatch an action to all plugins\n   */\n  dispatchToAllPlugins(t) {\n    return this.coreStore.dispatch(t);\n  }\n  /**\n   * Dispatch an action\n   */\n  dispatch(t) {\n    return this.pluginStore.dispatch(t);\n  }\n  /**\n   * Dispatch an action with debouncing to prevent rapid repeated calls\n   * @param action The action to dispatch\n   * @param debounceTime Time in ms to debounce (default: 100ms)\n   * @returns boolean indicating whether the action was dispatched or debounced\n   */\n  debouncedDispatch(t, e = 100) {\n    const i2 = Date.now(), r = this.debouncedActions[t.type] || 0;\n    return i2 - r >= e ? (this.debouncedActions[t.type] = i2, this.dispatch(t), true) : false;\n  }\n  /**\n   * Subscribe to state changes\n   */\n  subscribe(t) {\n    return this.pluginStore.subscribeToState(t);\n  }\n  /**\n   * Subscribe to core store changes\n   */\n  subscribeToCoreStore(t) {\n    return this.coreStore.subscribe(t);\n  }\n  /**\n   * Called when the plugin store state is updated\n   * @param oldState Previous state\n   * @param newState New state\n   */\n  onStoreUpdated(t, e) {\n  }\n  /**\n   * Called when the core store state is updated\n   * @param oldState Previous state\n   * @param newState New state\n   */\n  onCoreStoreUpdated(t, e) {\n  }\n  /**\n   * Cleanup method to be called when plugin is being destroyed\n   */\n  destroy() {\n    this.unsubscribeFromState && (this.unsubscribeFromState(), this.unsubscribeFromState = null), this.unsubscribeFromCoreStore && (this.unsubscribeFromCoreStore(), this.unsubscribeFromCoreStore = null);\n  }\n  /**\n   * Returns a promise that resolves when the plugin is ready\n   */\n  ready() {\n    return this.readyPromise;\n  }\n  /**\n   * Mark the plugin as ready\n   */\n  markReady() {\n    this.readyResolve();\n  }\n  /**\n   * Reset the ready state (useful for plugins that need to reinitialize)\n   */\n  resetReady() {\n    this.readyPromise = new Promise((t) => {\n      this.readyResolve = t;\n    });\n  }\n};\nvar N2 = class {\n  constructor(t, e) {\n    this.handler = t, this.options = e, this.lastRun = 0, this.handle = (i2) => {\n      this.options.mode === \"debounce\" ? this.debounce(i2) : this.throttle(i2);\n    };\n  }\n  debounce(t) {\n    this.timeoutId && window.clearTimeout(this.timeoutId), this.timeoutId = window.setTimeout(() => {\n      this.handler(t), this.timeoutId = void 0;\n    }, this.options.wait);\n  }\n  throttle(t) {\n    if (this.options.mode === \"debounce\") return;\n    const e = Date.now(), i2 = this.options.throttleMode || \"leading-trailing\";\n    e - this.lastRun >= this.options.wait && (i2 === \"leading-trailing\" && this.handler(t), this.lastRun = e), this.timeoutId && window.clearTimeout(this.timeoutId), this.timeoutId = window.setTimeout(\n      () => {\n        this.handler(t), this.lastRun = Date.now(), this.timeoutId = void 0;\n      },\n      this.options.wait - (e - this.lastRun)\n    );\n  }\n  destroy() {\n    this.timeoutId && window.clearTimeout(this.timeoutId);\n  }\n};\nfunction f3(s, t, e) {\n  if (s === t)\n    return true;\n  if (s == null || t == null)\n    return s === t;\n  const i2 = typeof s;\n  if (i2 !== typeof t) return false;\n  if (i2 === \"object\") {\n    e || (e = /* @__PURE__ */ new Set());\n    const n = F2(s, t);\n    if (e.has(n))\n      return true;\n    e.add(n);\n    const o = Array.isArray(s), a2 = Array.isArray(t);\n    return o && a2 ? q2(s, t, e) : !o && !a2 ? I2(s, t, e) : false;\n  }\n  return false;\n}\nfunction F2(s, t) {\n  return `${v2(s)}__${v2(t)}`;\n}\nvar k2 = 0;\nvar w3 = /* @__PURE__ */ new WeakMap();\nfunction v2(s) {\n  return w3.has(s) || w3.set(s, ++k2), w3.get(s);\n}\nfunction q2(s, t, e) {\n  if (s.length !== t.length) return false;\n  const i2 = new Array(t.length).fill(false);\n  t: for (let r = 0; r < s.length; r++) {\n    const n = s[r];\n    for (let o = 0; o < t.length; o++)\n      if (!i2[o] && f3(n, t[o], e)) {\n        i2[o] = true;\n        continue t;\n      }\n    return false;\n  }\n  return true;\n}\nfunction I2(s, t, e) {\n  const i2 = Object.keys(s).sort(), r = Object.keys(t).sort();\n  if (i2.length !== r.length) return false;\n  for (let n = 0; n < i2.length; n++)\n    if (i2[n] !== r[n]) return false;\n  for (const n of i2) {\n    const o = s[n], a2 = t[n];\n    if (!f3(o, a2, e))\n      return false;\n  }\n  return true;\n}\nfunction it2(s, t = f3) {\n  const e = /* @__PURE__ */ new Set(), i2 = /* @__PURE__ */ new Map();\n  let r = s;\n  const n = (a2) => e.forEach((l4) => l4(a2)), o = (a2, l4) => {\n    let h4 = a2, g3 = () => {\n    };\n    if (l4) {\n      const c2 = new N2(a2, l4);\n      h4 = c2.handle, g3 = () => c2.destroy(), i2.set(a2, { wrapped: h4, destroy: g3 });\n    }\n    return r !== void 0 && h4(r), e.add(h4), () => {\n      e.delete(h4), g3(), i2.delete(a2);\n    };\n  };\n  return {\n    /* emitter behaviour ---------------------------------------- */\n    get value() {\n      return r;\n    },\n    emit(a2 = void 0) {\n      (r === void 0 || !t(r, a2)) && (r = a2, n(a2));\n    },\n    on: o,\n    off(a2) {\n      const l4 = i2.get(a2);\n      l4 ? (e.delete(l4.wrapped), l4.destroy(), i2.delete(a2)) : e.delete(a2);\n    },\n    clear() {\n      e.clear(), i2.forEach((a2) => a2.destroy()), i2.clear();\n    },\n    /* derived hook --------------------------------------------- */\n    select(a2, l4 = f3) {\n      return (h4, g3) => {\n        let c2;\n        if (r !== void 0) {\n          const p3 = a2(r);\n          c2 = p3, h4(p3);\n        }\n        return o(\n          (p3) => {\n            const y2 = a2(p3);\n            (c2 === void 0 || !l4(c2, y2)) && (c2 = y2, h4(y2));\n          },\n          g3\n        );\n      };\n    }\n  };\n}\nvar SET_ANNOTATIONS = \"ANNOTATION/SET_ANNOTATIONS\";\nvar REINDEX_PAGE_ANNOTATIONS = \"ANNOTATION/REINDEX_PAGE\";\nvar SELECT_ANNOTATION = \"ANNOTATION/SELECT_ANNOTATION\";\nvar DESELECT_ANNOTATION = \"ANNOTATION/DESELECT_ANNOTATION\";\nvar UPDATE_TOOL_DEFAULTS = \"ANNOTATION/UPDATE_TOOL_DEFAULTS\";\nvar ADD_COLOR_PRESET = \"ANNOTATION/ADD_COLOR_PRESET\";\nvar CREATE_ANNOTATION = \"ANNOTATION/CREATE_ANNOTATION\";\nvar PATCH_ANNOTATION = \"ANNOTATION/PATCH_ANNOTATION\";\nvar DELETE_ANNOTATION = \"ANNOTATION/DELETE_ANNOTATION\";\nvar COMMIT_PENDING_CHANGES = \"ANNOTATION/COMMIT\";\nvar STORE_PDF_ID = \"ANNOTATION/STORE_PDF_ID\";\nvar PURGE_ANNOTATION = \"ANNOTATION/PURGE_ANNOTATION\";\nvar SET_ACTIVE_VARIANT = \"ANNOTATION/SET_ACTIVE_VARIANT\";\nvar setAnnotations = (p3) => ({\n  type: SET_ANNOTATIONS,\n  payload: p3\n});\nvar reindexPageAnnotations = (pageIndex) => ({\n  type: REINDEX_PAGE_ANNOTATIONS,\n  payload: { pageIndex }\n});\nvar selectAnnotation = (pageIndex, localId) => ({\n  type: SELECT_ANNOTATION,\n  payload: { pageIndex, localId }\n});\nvar deselectAnnotation = () => ({ type: DESELECT_ANNOTATION });\nvar updateToolDefaults = (variantKey, patch) => ({ type: UPDATE_TOOL_DEFAULTS, payload: { variantKey, patch } });\nvar addColorPreset = (c2) => ({\n  type: ADD_COLOR_PRESET,\n  payload: c2\n});\nvar createAnnotation = (pageIndex, localId, annotation) => ({\n  type: CREATE_ANNOTATION,\n  payload: { pageIndex, localId, annotation }\n});\nvar patchAnnotation = (pageIndex, localId, patch) => ({\n  type: PATCH_ANNOTATION,\n  payload: { pageIndex, localId, patch }\n});\nvar deleteAnnotation = (pageIndex, localId) => ({\n  type: DELETE_ANNOTATION,\n  payload: { pageIndex, localId }\n});\nvar commitPendingChanges = () => ({ type: COMMIT_PENDING_CHANGES });\nvar storePdfId = (uid, pdfId) => ({\n  type: STORE_PDF_ID,\n  payload: { uid, pdfId }\n});\nvar purgeAnnotation = (uid) => ({\n  type: PURGE_ANNOTATION,\n  payload: { uid }\n});\nvar setActiveVariant = (k22) => ({\n  type: SET_ACTIVE_VARIANT,\n  payload: k22\n});\nvar makeUid = (pageIndex, localId) => `p${pageIndex}#${localId}`;\nvar parseUid = (uid) => {\n  const [pg, rest] = uid.slice(1).split(\"#\");\n  return { pageIndex: Number(pg), localId: Number(rest) };\n};\nvar getAnnotationsByPageIndex = (s, page) => (s.pages[page] ?? []).map((uid) => s.byUid[uid]);\nvar getSelectedAnnotation = (s) => s.selectedUid ? s.byUid[s.selectedUid] : null;\nvar getSelectedAnnotationByPageIndex = (s, pageIndex) => {\n  if (!s.selectedUid) return null;\n  const pageUids = s.pages[pageIndex] ?? [];\n  if (pageUids.includes(s.selectedUid)) {\n    return s.byUid[s.selectedUid];\n  }\n  return null;\n};\nvar makeVariantKey = (subtype, intent) => intent ? `${subtype}#${intent}` : `${subtype}`;\nvar AnnotationPlugin = class extends Z2 {\n  constructor(id, registry, engine, config) {\n    super(id, registry);\n    this.ANNOTATION_HISTORY_TOPIC = \"annotations\";\n    this.state$ = it2();\n    this.modeByVariant = /* @__PURE__ */ new Map();\n    this.variantByMode = /* @__PURE__ */ new Map();\n    this.activeVariantChange$ = it2();\n    this.activeTool$ = it2({\n      variantKey: null,\n      defaults: null\n    });\n    this.engine = engine;\n    this.config = config;\n    const selection = registry.getPlugin(\"selection\");\n    this.selection = selection?.provides() ?? null;\n    const history = registry.getPlugin(\"history\");\n    this.history = history?.provides() ?? null;\n    const interactionManager = registry.getPlugin(\"interaction-manager\");\n    this.interactionManager = interactionManager?.provides() ?? null;\n    this.coreStore.onAction(m3, (_action, state) => {\n      const doc = state.core.document;\n      if (doc) {\n        this.getAllAnnotations(doc);\n      }\n    });\n  }\n  async initialize() {\n    for (const [variantKey, defaults] of Object.entries(this.state.toolDefaults)) {\n      this.registerTool(variantKey, defaults);\n    }\n    this.history?.onHistoryChange((topic) => {\n      if (topic === this.ANNOTATION_HISTORY_TOPIC && this.config.autoCommit !== false) {\n        this.commit();\n      }\n    });\n    this.interactionManager?.onModeChange((s) => {\n      const newVariant = this.variantByMode.get(s.activeMode) ?? null;\n      console.log(newVariant, this.state.activeVariant);\n      if (newVariant !== this.state.activeVariant) {\n        this.dispatch(setActiveVariant(newVariant));\n        this.activeVariantChange$.emit(newVariant);\n      }\n    });\n    this.selection?.onEndSelection(() => {\n      if (!this.state.activeVariant) return;\n      if (!(this.state.activeVariant === makeVariantKey(PdfAnnotationSubtype2.HIGHLIGHT) || this.state.activeVariant === makeVariantKey(PdfAnnotationSubtype2.UNDERLINE) || this.state.activeVariant === makeVariantKey(PdfAnnotationSubtype2.STRIKEOUT) || this.state.activeVariant === makeVariantKey(PdfAnnotationSubtype2.SQUIGGLY))) {\n        return;\n      }\n      const formattedSelection = this.selection?.getFormattedSelection();\n      if (!formattedSelection) return;\n      for (const selection of formattedSelection) {\n        const rect = selection.rect;\n        const segmentRects = selection.segmentRects;\n        const type = this.state.activeVariant;\n        const subtype = this.state.toolDefaults[type].subtype;\n        const color = this.state.toolDefaults[type].color;\n        const opacity = this.state.toolDefaults[type].opacity;\n        const blendMode = this.state.toolDefaults[type].blendMode ?? PdfBlendMode2.Normal;\n        this.createAnnotation(selection.pageIndex, {\n          type: subtype,\n          rect,\n          segmentRects,\n          color,\n          opacity,\n          blendMode,\n          pageIndex: selection.pageIndex,\n          id: Date.now() + Math.random()\n        });\n      }\n      this.selection?.clear();\n    });\n  }\n  registerTool(variantKey, defaults) {\n    const modeId = defaults.interaction.mode;\n    const interactionMode = {\n      id: modeId,\n      scope: \"page\",\n      exclusive: defaults.interaction.exclusive,\n      cursor: defaults.interaction.cursor\n    };\n    this.interactionManager?.registerMode(interactionMode);\n    if (defaults.textSelection) {\n      this.selection?.enableForMode(modeId);\n    }\n    this.modeByVariant.set(variantKey, modeId);\n    this.variantByMode.set(modeId, variantKey);\n  }\n  buildCapability() {\n    return {\n      getPageAnnotations: (options) => {\n        return this.getPageAnnotations(options);\n      },\n      getSelectedAnnotation: () => {\n        return getSelectedAnnotation(this.state);\n      },\n      selectAnnotation: (pageIndex, annotationId) => {\n        this.selectAnnotation(pageIndex, annotationId);\n      },\n      deselectAnnotation: () => {\n        this.dispatch(deselectAnnotation());\n      },\n      getActiveVariant: () => {\n        return this.state.activeVariant;\n      },\n      setActiveVariant: (variantKey) => {\n        if (variantKey === this.state.activeVariant) return;\n        if (variantKey) {\n          const mode = this.modeByVariant.get(variantKey);\n          if (!mode) throw new Error(`Mode missing for variant ${variantKey}`);\n          this.interactionManager?.activate(mode);\n        } else {\n          this.interactionManager?.activate(\"default\");\n        }\n      },\n      getToolDefaults: (variantKey) => {\n        const defaults = this.state.toolDefaults[variantKey];\n        if (!defaults) {\n          throw new Error(`No defaults found for variant: ${variantKey}`);\n        }\n        return defaults;\n      },\n      getToolDefaultsBySubtypeAndIntent: (subtype, intent) => {\n        const variantKey = makeVariantKey(subtype, intent);\n        const defaults = this.state.toolDefaults[variantKey];\n        if (!defaults) {\n          throw new Error(`No defaults found for variant: ${variantKey}`);\n        }\n        return defaults;\n      },\n      getToolDefaultsBySubtype: (subtype) => {\n        const defaults = this.state.toolDefaults[subtype];\n        if (!defaults) {\n          throw new Error(`No defaults found for subtype: ${subtype}`);\n        }\n        return defaults;\n      },\n      setToolDefaults: (variantKey, patch) => {\n        this.dispatch(updateToolDefaults(variantKey, patch));\n      },\n      getColorPresets: () => [...this.state.colorPresets],\n      addColorPreset: (color) => this.dispatch(addColorPreset(color)),\n      createAnnotation: (pageIndex, annotation) => this.createAnnotation(pageIndex, annotation),\n      updateAnnotation: (pageIndex, localId, patch) => this.updateAnnotation(pageIndex, localId, patch),\n      deleteAnnotation: (pageIndex, localId) => this.deleteAnnotation(pageIndex, localId),\n      renderAnnotation: (options) => this.renderAnnotation(options),\n      onStateChange: this.state$.on,\n      onActiveVariantChange: this.activeVariantChange$.on,\n      onActiveToolChange: this.activeTool$.on,\n      commit: () => this.commit()\n    };\n  }\n  createActiveTool(mode, toolDefaults) {\n    if (mode === null) {\n      return { variantKey: null, defaults: null };\n    }\n    return { variantKey: mode, defaults: toolDefaults[mode] };\n  }\n  emitActiveTool(state) {\n    const activeTool = this.createActiveTool(state.activeVariant, state.toolDefaults);\n    this.activeTool$.emit(activeTool);\n  }\n  onStoreUpdated(prev, next) {\n    this.state$.emit(next);\n    if (prev.activeVariant !== next.activeVariant || prev.toolDefaults[prev.activeVariant ?? PdfAnnotationSubtype2.HIGHLIGHT] !== next.toolDefaults[next.activeVariant ?? PdfAnnotationSubtype2.HIGHLIGHT]) {\n      this.emitActiveTool(next);\n    }\n  }\n  getAllAnnotations(doc) {\n    const task = this.engine.getAllAnnotations(doc);\n    task.wait((annotations) => this.dispatch(setAnnotations(annotations)), ignore2);\n  }\n  getPageAnnotations(options) {\n    const { pageIndex } = options;\n    const doc = this.coreState.core.document;\n    if (!doc) {\n      return PdfTaskHelper2.reject({ code: PdfErrorCode2.NotFound, message: \"Document not found\" });\n    }\n    const page = doc.pages.find((p3) => p3.index === pageIndex);\n    if (!page) {\n      return PdfTaskHelper2.reject({ code: PdfErrorCode2.NotFound, message: \"Page not found\" });\n    }\n    return this.engine.getPageAnnotations(doc, page);\n  }\n  renderAnnotation({\n    pageIndex,\n    annotation,\n    scaleFactor = 1,\n    rotation = Rotation2.Degree0,\n    dpr = 1,\n    mode = AppearanceMode.Normal,\n    imageType = \"image/webp\"\n  }) {\n    const coreState = this.coreState.core;\n    if (!coreState.document) {\n      throw new Error(\"document does not open\");\n    }\n    const page = coreState.document.pages.find((page2) => page2.index === pageIndex);\n    if (!page) {\n      throw new Error(\"page does not exist\");\n    }\n    return this.engine.renderAnnotation(\n      coreState.document,\n      page,\n      annotation,\n      scaleFactor,\n      rotation,\n      dpr,\n      mode,\n      imageType\n    );\n  }\n  selectAnnotation(pageIndex, annotationId) {\n    this.dispatch(selectAnnotation(pageIndex, annotationId));\n  }\n  createAnnotation(pageIndex, annotation) {\n    const localId = annotation.id;\n    const execute = () => this.dispatch(createAnnotation(pageIndex, localId, annotation));\n    if (!this.history) {\n      execute();\n      if (this.config.autoCommit) this.commit();\n      return;\n    }\n    const command = {\n      execute,\n      undo: () => {\n        this.dispatch(deselectAnnotation());\n        this.dispatch(deleteAnnotation(pageIndex, localId));\n      }\n    };\n    this.history.register(command, this.ANNOTATION_HISTORY_TOPIC);\n  }\n  updateAnnotation(pageIndex, localId, patch) {\n    if (!this.history) {\n      this.dispatch(patchAnnotation(pageIndex, localId, patch));\n      if (this.config.autoCommit !== false) {\n        this.commit();\n      }\n      return;\n    }\n    const originalObject = this.state.byUid[makeUid(pageIndex, localId)].object;\n    const originalPatch = Object.fromEntries(\n      Object.keys(patch).map((key) => [key, originalObject[key]])\n    );\n    const command = {\n      execute: () => this.dispatch(patchAnnotation(pageIndex, localId, patch)),\n      undo: () => this.dispatch(patchAnnotation(pageIndex, localId, originalPatch))\n    };\n    this.history.register(command, this.ANNOTATION_HISTORY_TOPIC);\n  }\n  deleteAnnotation(pageIndex, localId) {\n    if (!this.history) {\n      this.dispatch(deselectAnnotation());\n      this.dispatch(deleteAnnotation(pageIndex, localId));\n      if (this.config.autoCommit !== false) {\n        this.commit();\n      }\n      return;\n    }\n    const originalAnnotation = this.state.byUid[makeUid(pageIndex, localId)].object;\n    const command = {\n      execute: () => {\n        this.dispatch(deselectAnnotation());\n        this.dispatch(deleteAnnotation(pageIndex, localId));\n      },\n      undo: () => this.dispatch(createAnnotation(pageIndex, localId, originalAnnotation))\n    };\n    this.history.register(command, this.ANNOTATION_HISTORY_TOPIC);\n  }\n  commit() {\n    const task = new Task2();\n    if (!this.state.hasPendingChanges) return PdfTaskHelper2.resolve(true);\n    const doc = this.coreState.core.document;\n    if (!doc)\n      return PdfTaskHelper2.reject({ code: PdfErrorCode2.NotFound, message: \"Document not found\" });\n    const creations = [];\n    const updates = [];\n    const deletionsByPage = /* @__PURE__ */ new Map();\n    const affectedPages = /* @__PURE__ */ new Set();\n    for (const [uid, ta] of Object.entries(this.state.byUid)) {\n      if (ta.commitState === \"synced\") continue;\n      const { pageIndex } = parseUid(uid);\n      const page = doc.pages.find((p3) => p3.index === pageIndex);\n      if (!page) continue;\n      affectedPages.add(pageIndex);\n      switch (ta.commitState) {\n        case \"new\":\n          const task2 = this.engine.createPageAnnotation(doc, page, ta.object);\n          task2.wait((annoId) => this.dispatch(storePdfId(uid, annoId)), ignore2);\n          creations.push(task2);\n          break;\n        case \"dirty\":\n          updates.push(\n            this.engine.updatePageAnnotation(doc, page, { ...ta.object, id: ta.pdfId })\n          );\n          break;\n        case \"deleted\":\n          if (!deletionsByPage.has(pageIndex)) {\n            deletionsByPage.set(pageIndex, []);\n          }\n          deletionsByPage.get(pageIndex).push({ ta, uid });\n          break;\n      }\n    }\n    const deletionTasks = [];\n    for (const [pageIndex, deletions] of deletionsByPage.entries()) {\n      const page = doc.pages.find((p3) => p3.index === pageIndex);\n      deletions.sort((a2, b5) => (b5.ta.pdfId ?? -1) - (a2.ta.pdfId ?? -1));\n      for (const { ta, uid } of deletions) {\n        if (ta.pdfId !== void 0) {\n          const task2 = new Task2();\n          const removeTask = this.engine.removePageAnnotation(doc, page, {\n            ...ta.object,\n            id: ta.pdfId\n          });\n          removeTask.wait(() => {\n            this.dispatch(purgeAnnotation(uid));\n            task2.resolve(true);\n          }, task2.fail);\n          deletionTasks.push(task2);\n        } else {\n          this.dispatch(purgeAnnotation(uid));\n        }\n      }\n    }\n    const allWriteTasks = [...creations, ...updates, ...deletionTasks];\n    Task2.allSettled(allWriteTasks).wait(() => {\n      for (const pageIndex of affectedPages) {\n        this.dispatch(reindexPageAnnotations(pageIndex));\n      }\n      this.dispatch(commitPendingChanges());\n      task.resolve(true);\n    }, task.fail);\n    return task;\n  }\n};\nAnnotationPlugin.id = \"annotation\";\n\n// src/preact/hooks/use-annotation.ts\nvar useAnnotationPlugin = () => h(AnnotationPlugin.id);\nvar useAnnotationCapability = () => L(AnnotationPlugin.id);\n\n// ../plugin-interaction-manager/dist/preact/index.js\nimport { jsx as P2, jsxs as h3 } from \"preact/jsx-runtime\";\nimport { useState as I3, useEffect as c, useRef as p2, useCallback as E } from \"preact/hooks\";\n\n// ../plugin-interaction-manager/dist/index.js\nvar g2 = \"INTERACTION/ACTIVATE_MODE\";\nvar p = \"INTERACTION/PAUSE\";\nvar f4 = \"INTERACTION/RESUME\";\nvar C = \"INTERACTION/SET_CURSOR\";\nvar y = (n) => ({\n  type: g2,\n  payload: { mode: n }\n});\nvar w4 = (n) => ({\n  type: C,\n  payload: { cursor: n }\n});\nvar M = () => ({\n  type: p\n});\nvar A = () => ({\n  type: f4\n});\nfunction S2(n) {\n  const t = [\n    \"onPointerDown\",\n    \"onPointerUp\",\n    \"onPointerMove\",\n    \"onPointerEnter\",\n    \"onPointerLeave\",\n    \"onPointerCancel\"\n  ], e = {};\n  for (const i2 of t)\n    e[i2] = (s, o, a2) => {\n      var r;\n      for (const c2 of n) (r = c2[i2]) == null || r.call(c2, s, o, a2);\n    };\n  return e;\n}\nvar l = class l2 extends Z {\n  constructor(t, e) {\n    super(t, e), this.modes = /* @__PURE__ */ new Map(), this.cursorClaims = /* @__PURE__ */ new Map(), this.buckets = /* @__PURE__ */ new Map(), this.alwaysGlobal = /* @__PURE__ */ new Set(), this.alwaysPage = /* @__PURE__ */ new Map(), this.onModeChange$ = et(), this.onHandlerChange$ = et(), this.onCursorChange$ = et(), this.onStateChange$ = it(), this.registerMode({\n      id: \"default\",\n      scope: \"page\",\n      exclusive: false,\n      cursor: \"auto\"\n    });\n  }\n  async initialize(t) {\n  }\n  buildCapability() {\n    return {\n      activate: (t) => this.activate(t),\n      onModeChange: this.onModeChange$.on,\n      onCursorChange: this.onCursorChange$.on,\n      onHandlerChange: this.onHandlerChange$.on,\n      onStateChange: this.onStateChange$.on,\n      getActiveMode: () => this.state.activeMode,\n      getActiveInteractionMode: () => this.getActiveInteractionMode(),\n      finish: () => this.activate(\"default\"),\n      registerMode: (t) => this.registerMode(t),\n      registerHandlers: (t) => this.registerHandlers(t),\n      registerAlways: (t) => this.registerAlways(t),\n      setCursor: (t, e, i2 = 0) => this.setCursor(t, e, i2),\n      removeCursor: (t) => this.removeCursor(t),\n      getCurrentCursor: () => this.state.cursor,\n      getHandlersForScope: (t) => this.getHandlersForScope(t),\n      activeModeIsExclusive: () => this.activeModeIsExclusive(),\n      pause: () => this.dispatch(M()),\n      resume: () => this.dispatch(A()),\n      isPaused: () => this.state.paused\n    };\n  }\n  activate(t) {\n    if (!this.modes.has(t))\n      throw new Error(`[interaction] unknown mode '${t}'`);\n    if (t === this.state.activeMode) return;\n    const e = this.state.activeMode;\n    this.cursorClaims.clear(), this.notifyHandlersInactive(e), this.dispatch(y(t)), this.emitCursor(), this.notifyHandlersActive(t), this.onModeChange$.emit({ ...this.state, activeMode: t });\n  }\n  notifyHandlersActive(t) {\n    this.alwaysGlobal.forEach((s) => {\n      var o;\n      (o = s.onHandlerActiveStart) == null || o.call(s, t);\n    }), this.alwaysPage.forEach((s) => {\n      s.forEach((o) => {\n        var a2;\n        (a2 = o.onHandlerActiveStart) == null || a2.call(o, t);\n      });\n    });\n    const e = this.modes.get(t);\n    if (!e) return;\n    const i2 = this.buckets.get(t);\n    i2 && (e.scope === \"global\" && i2.global.forEach((s) => {\n      var o;\n      (o = s.onHandlerActiveStart) == null || o.call(s, t);\n    }), e.scope === \"page\" && i2.page.forEach((s, o) => {\n      s.forEach((a2) => {\n        var r;\n        (r = a2.onHandlerActiveStart) == null || r.call(a2, t);\n      });\n    }));\n  }\n  notifyHandlersInactive(t) {\n    this.alwaysGlobal.forEach((s) => {\n      var o;\n      (o = s.onHandlerActiveEnd) == null || o.call(s, t);\n    }), this.alwaysPage.forEach((s) => {\n      s.forEach((o) => {\n        var a2;\n        (a2 = o.onHandlerActiveEnd) == null || a2.call(o, t);\n      });\n    });\n    const e = this.modes.get(t);\n    if (!e) return;\n    const i2 = this.buckets.get(t);\n    i2 && (e.scope === \"global\" && i2.global.forEach((s) => {\n      var o;\n      (o = s.onHandlerActiveEnd) == null || o.call(s, t);\n    }), e.scope === \"page\" && i2.page.forEach((s, o) => {\n      s.forEach((a2) => {\n        var r;\n        (r = a2.onHandlerActiveEnd) == null || r.call(a2, t);\n      });\n    }));\n  }\n  registerMode(t) {\n    this.modes.set(t.id, t), this.buckets.has(t.id) || this.buckets.set(t.id, { global: /* @__PURE__ */ new Set(), page: /* @__PURE__ */ new Map() });\n  }\n  /** ---------- pointer-handler handling ------------ */\n  registerHandlers({ modeId: t, handlers: e, pageIndex: i2 }) {\n    const s = Array.isArray(t) ? t : [t], o = [];\n    for (const a2 of s) {\n      const r = this.buckets.get(a2);\n      if (!r) throw new Error(`unknown mode '${a2}'`);\n      if (i2 == null)\n        r.global.add(e);\n      else {\n        const c2 = r.page.get(i2) ?? /* @__PURE__ */ new Set();\n        c2.add(e), r.page.set(i2, c2);\n      }\n      o.push(() => {\n        if (i2 == null)\n          r.global.delete(e);\n        else {\n          const c2 = r.page.get(i2);\n          c2 && (c2.delete(e), c2.size === 0 && r.page.delete(i2));\n        }\n      });\n    }\n    return this.onHandlerChange$.emit({ ...this.state }), () => {\n      o.forEach((a2) => a2()), this.onHandlerChange$.emit({ ...this.state });\n    };\n  }\n  registerAlways({ scope: t, handlers: e }) {\n    if (t.type === \"global\")\n      return this.alwaysGlobal.add(e), this.onHandlerChange$.emit({ ...this.state }), () => this.alwaysGlobal.delete(e);\n    const i2 = this.alwaysPage.get(t.pageIndex) ?? /* @__PURE__ */ new Set();\n    return i2.add(e), this.alwaysPage.set(t.pageIndex, i2), this.onHandlerChange$.emit({ ...this.state }), () => {\n      i2.delete(e), this.onHandlerChange$.emit({ ...this.state });\n    };\n  }\n  /** Returns the *merged* handler set that should be active for the given\n   *  provider (`global` wrapper or a single page wrapper).\n   *   `alwaysGlobal` / `alwaysPage` are **always** active.\n   *   Handlers that belong to the current mode are added on top **iff**\n   *    the modes own scope matches the providers scope.            */\n  getHandlersForScope(t) {\n    if (!this.state) return null;\n    const e = this.modes.get(this.state.activeMode);\n    if (!e) return null;\n    const i2 = this.buckets.get(e.id);\n    if (!i2) return null;\n    const s = (r, c2) => r.size || c2.size ? S2([...r, ...c2]) : null;\n    if (t.type === \"global\") {\n      const r = e.scope === \"global\" ? i2.global : /* @__PURE__ */ new Set();\n      return s(this.alwaysGlobal, r);\n    }\n    const o = this.alwaysPage.get(t.pageIndex) ?? /* @__PURE__ */ new Set(), a2 = e.scope === \"page\" ? i2.page.get(t.pageIndex) ?? /* @__PURE__ */ new Set() : /* @__PURE__ */ new Set();\n    return s(o, a2);\n  }\n  /** ---------- cursor handling --------------------- */\n  setCursor(t, e, i2 = 0) {\n    this.cursorClaims.set(t, { cursor: e, priority: i2 }), this.emitCursor();\n  }\n  removeCursor(t) {\n    this.cursorClaims.delete(t), this.emitCursor();\n  }\n  emitCursor() {\n    var e;\n    const t = [...this.cursorClaims.values()].sort((i2, s) => s.priority - i2.priority)[0] ?? {\n      cursor: ((e = this.modes.get(this.state.activeMode)) == null ? void 0 : e.cursor) ?? \"auto\"\n    };\n    t.cursor !== this.state.cursor && (this.dispatch(w4(t.cursor)), this.onCursorChange$.emit(t.cursor));\n  }\n  onStoreUpdated(t, e) {\n    this.onStateChange$.emit(e);\n  }\n  activeModeIsExclusive() {\n    const t = this.modes.get(this.state.activeMode);\n    return !!(t != null && t.exclusive);\n  }\n  getActiveInteractionMode() {\n    return this.modes.get(this.state.activeMode) ?? null;\n  }\n  // keep emitter clean\n  async destroy() {\n    this.onModeChange$.clear(), this.onCursorChange$.clear(), await super.destroy();\n  }\n};\nl.id = \"interaction-manager\";\nvar h2 = l;\n\n// ../plugin-interaction-manager/dist/preact/index.js\nvar i = () => L(h2.id);\nfunction F3({ modeId: e, pageIndex: n }) {\n  const { provides: r } = i();\n  return {\n    register: (t, s) => {\n      const u = (s == null ? void 0 : s.modeId) ?? e, o = (s == null ? void 0 : s.pageIndex) ?? n;\n      return u ? r == null ? void 0 : r.registerHandlers({\n        modeId: u,\n        handlers: t,\n        pageIndex: o\n      }) : r == null ? void 0 : r.registerAlways({\n        scope: o !== void 0 ? { type: \"page\", pageIndex: o } : { type: \"global\" },\n        handlers: t\n      });\n    }\n  };\n}\n\n// src/preact/components/annotations.tsx\nimport { useMemo as useMemo2, useState as useState2, useEffect as useEffect2, useCallback } from \"preact/hooks\";\n\n// src/preact/components/annotation-container.tsx\nimport { useEffect, useRef, useState } from \"preact/hooks\";\nimport { Fragment, jsx, jsxs } from \"preact/jsx-runtime\";\nfunction AnnotationContainer({\n  scale,\n  pageIndex,\n  rotation,\n  trackedAnnotation,\n  children,\n  style,\n  outlineOffset = 1,\n  isSelected = false,\n  isDraggable = true,\n  isResizable = true,\n  computeResizePatch,\n  ...props\n}) {\n  const { provides: annotationProvides } = useAnnotationCapability();\n  const ref = useRef(null);\n  const [dragState, setDragState] = useState(\"idle\");\n  const [resizeDirection, setResizeDirection] = useState(null);\n  const [startPos, setStartPos] = useState(null);\n  const [startRect, setStartRect] = useState(null);\n  const [currentRect, setCurrentRect] = useState(trackedAnnotation.object.rect);\n  const [previewObject, setPreviewObject] = useState(null);\n  useEffect(() => {\n    setCurrentRect(trackedAnnotation.object.rect);\n    setPreviewObject(null);\n  }, [trackedAnnotation]);\n  const handlePointerDown = (e) => {\n    if (!isSelected) return;\n    e.stopPropagation();\n    e.preventDefault();\n    const target = e.target;\n    if (isResizable && target.classList.contains(\"resize-handle\")) {\n      setDragState(\"resizing\");\n      setResizeDirection(target.dataset.direction);\n    } else if (isDraggable) {\n      setDragState(\"dragging\");\n    } else {\n      return;\n    }\n    setStartPos({ x: e.clientX, y: e.clientY });\n    setStartRect(currentRect);\n    ref.current?.setPointerCapture(e.pointerId);\n  };\n  const handlePointerMove = (e) => {\n    if (dragState === \"idle\" || !startPos || !startRect) return;\n    const dispDelta = { x: e.clientX - startPos.x, y: e.clientY - startPos.y };\n    const { x: dx, y: dy } = restoreOffset(dispDelta, rotation, scale);\n    let newOriginX = startRect.origin.x;\n    let newOriginY = startRect.origin.y;\n    let newWidth = startRect.size.width;\n    let newHeight = startRect.size.height;\n    if (dragState === \"dragging\") {\n      newOriginX += dx;\n      newOriginY += dy;\n    } else if (dragState === \"resizing\" && resizeDirection) {\n      if (resizeDirection.includes(\"right\")) {\n        newWidth += dx;\n      } else if (resizeDirection.includes(\"left\")) {\n        newOriginX += dx;\n        newWidth -= dx;\n      }\n      if (resizeDirection.includes(\"bottom\")) {\n        newHeight += dy;\n      } else if (resizeDirection.includes(\"top\")) {\n        newOriginY += dy;\n        newHeight -= dy;\n      }\n      if (newWidth < 1 || newHeight < 1) return;\n    }\n    const tentativeRect = {\n      origin: { x: newOriginX, y: newOriginY },\n      size: { width: newWidth, height: newHeight }\n    };\n    let previewPatch = { rect: tentativeRect };\n    if (computeResizePatch) {\n      const dir = dragState === \"resizing\" ? resizeDirection : \"bottom-right\";\n      if (dir) {\n        previewPatch = computeResizePatch(trackedAnnotation.object, tentativeRect, dir);\n      }\n    }\n    setCurrentRect(previewPatch.rect || tentativeRect);\n    setPreviewObject(previewPatch);\n  };\n  const handlePointerUp = (e) => {\n    if (dragState === \"idle\") return;\n    const usedDirection = resizeDirection || \"bottom-right\";\n    setDragState(\"idle\");\n    setResizeDirection(null);\n    ref.current?.releasePointerCapture(e.pointerId);\n    if (annotationProvides && trackedAnnotation) {\n      let patch = { rect: currentRect };\n      if (computeResizePatch && usedDirection) {\n        patch = computeResizePatch(trackedAnnotation.object, currentRect, usedDirection);\n      }\n      annotationProvides.updateAnnotation(pageIndex, trackedAnnotation.localId, patch);\n    }\n    setStartPos(null);\n    setStartRect(null);\n    setPreviewObject(null);\n  };\n  const currentObject = previewObject ? { ...trackedAnnotation.object, ...previewObject } : trackedAnnotation.object;\n  return /* @__PURE__ */ jsxs(\n    \"div\",\n    {\n      ref,\n      onPointerDown: handlePointerDown,\n      onPointerMove: handlePointerMove,\n      onPointerUp: handlePointerUp,\n      style: {\n        position: \"absolute\",\n        outline: isSelected ? \"1px solid #007ACC\" : \"none\",\n        outlineOffset: isSelected ? `${outlineOffset}px` : \"0px\",\n        left: `${currentRect.origin.x * scale}px`,\n        top: `${currentRect.origin.y * scale}px`,\n        width: `${currentRect.size.width * scale}px`,\n        height: `${currentRect.size.height * scale}px`,\n        pointerEvents: isSelected ? \"auto\" : \"none\",\n        cursor: isSelected && isDraggable ? \"move\" : \"default\",\n        ...style\n      },\n      ...props,\n      children: [\n        typeof children === \"function\" ? children(currentObject) : children,\n        isSelected && isResizable && /* @__PURE__ */ jsxs(Fragment, { children: [\n          /* @__PURE__ */ jsx(\n            \"div\",\n            {\n              className: \"resize-handle\",\n              \"data-direction\": \"top-left\",\n              style: {\n                position: \"absolute\",\n                top: -7 - outlineOffset,\n                left: -7 - outlineOffset,\n                width: 13,\n                height: 13,\n                background: \"blue\",\n                borderRadius: \"50%\",\n                cursor: rotation % 2 ? \"nesw-resize\" : \"nwse-resize\"\n              }\n            }\n          ),\n          /* @__PURE__ */ jsx(\n            \"div\",\n            {\n              className: \"resize-handle\",\n              \"data-direction\": \"top-right\",\n              style: {\n                position: \"absolute\",\n                top: -7 - outlineOffset,\n                right: -7 - outlineOffset,\n                width: 13,\n                height: 13,\n                background: \"blue\",\n                borderRadius: \"50%\",\n                cursor: rotation % 2 ? \"nwse-resize\" : \"nesw-resize\"\n              }\n            }\n          ),\n          /* @__PURE__ */ jsx(\n            \"div\",\n            {\n              className: \"resize-handle\",\n              \"data-direction\": \"bottom-left\",\n              style: {\n                position: \"absolute\",\n                bottom: -7 - outlineOffset,\n                left: -7 - outlineOffset,\n                width: 13,\n                height: 13,\n                background: \"blue\",\n                borderRadius: \"50%\",\n                cursor: rotation % 2 ? \"nwse-resize\" : \"nesw-resize\"\n              }\n            }\n          ),\n          /* @__PURE__ */ jsx(\n            \"div\",\n            {\n              className: \"resize-handle\",\n              \"data-direction\": \"bottom-right\",\n              style: {\n                position: \"absolute\",\n                bottom: -7 - outlineOffset,\n                right: -7 - outlineOffset,\n                width: 13,\n                height: 13,\n                background: \"blue\",\n                borderRadius: \"50%\",\n                cursor: rotation % 2 ? \"nesw-resize\" : \"nwse-resize\"\n              }\n            }\n          )\n        ] })\n      ]\n    }\n  );\n}\n\n// src/preact/components/text-markup/highlight.tsx\nimport { Fragment as Fragment2, jsx as jsx2 } from \"preact/jsx-runtime\";\nfunction Highlight({\n  color = \"#FFFF00\",\n  opacity = 0.5,\n  rects,\n  rect,\n  scale,\n  onClick,\n  style,\n  ...props\n}) {\n  return /* @__PURE__ */ jsx2(Fragment2, { children: rects.map((b5, i2) => /* @__PURE__ */ jsx2(\n    \"div\",\n    {\n      onMouseDown: onClick,\n      style: {\n        position: \"absolute\",\n        left: (rect ? b5.origin.x - rect.origin.x : b5.origin.x) * scale,\n        top: (rect ? b5.origin.y - rect.origin.y : b5.origin.y) * scale,\n        width: b5.size.width * scale,\n        height: b5.size.height * scale,\n        background: color,\n        opacity,\n        pointerEvents: onClick ? \"auto\" : \"none\",\n        cursor: onClick ? \"pointer\" : \"default\",\n        zIndex: onClick ? 1 : null,\n        ...style\n      },\n      ...props\n    },\n    i2\n  )) });\n}\n\n// src/preact/components/text-markup/underline.tsx\nimport { Fragment as Fragment3, jsx as jsx3 } from \"preact/jsx-runtime\";\nfunction Underline({\n  color = \"#FFFF00\",\n  opacity = 0.5,\n  rects,\n  rect,\n  scale,\n  onClick,\n  style,\n  ...props\n}) {\n  const thickness = 2 * scale;\n  return /* @__PURE__ */ jsx3(Fragment3, { children: rects.map((r, i2) => /* @__PURE__ */ jsx3(\n    \"div\",\n    {\n      onMouseDown: onClick,\n      style: {\n        position: \"absolute\",\n        left: (rect ? r.origin.x - rect.origin.x : r.origin.x) * scale,\n        top: (rect ? r.origin.y - rect.origin.y : r.origin.y) * scale,\n        width: r.size.width * scale,\n        height: r.size.height * scale,\n        background: \"transparent\",\n        pointerEvents: onClick ? \"auto\" : \"none\",\n        cursor: onClick ? \"pointer\" : \"default\",\n        zIndex: onClick ? 1 : 0,\n        ...style\n      },\n      ...props,\n      children: /* @__PURE__ */ jsx3(\n        \"div\",\n        {\n          style: {\n            position: \"absolute\",\n            left: 0,\n            bottom: 0,\n            width: \"100%\",\n            height: thickness,\n            background: color,\n            opacity,\n            pointerEvents: \"none\"\n          }\n        }\n      )\n    },\n    i2\n  )) });\n}\n\n// src/preact/components/text-markup/strikeout.tsx\nimport { Fragment as Fragment4, jsx as jsx4 } from \"preact/jsx-runtime\";\nfunction Strikeout({\n  color = \"#FFFF00\",\n  opacity = 0.5,\n  rects,\n  rect,\n  scale,\n  onClick,\n  style,\n  ...props\n}) {\n  const thickness = 2 * scale;\n  return /* @__PURE__ */ jsx4(Fragment4, { children: rects.map((r, i2) => /* @__PURE__ */ jsx4(\n    \"div\",\n    {\n      onMouseDown: onClick,\n      style: {\n        position: \"absolute\",\n        left: (rect ? r.origin.x - rect.origin.x : r.origin.x) * scale,\n        top: (rect ? r.origin.y - rect.origin.y : r.origin.y) * scale,\n        width: r.size.width * scale,\n        height: r.size.height * scale,\n        background: \"transparent\",\n        pointerEvents: onClick ? \"auto\" : \"none\",\n        cursor: onClick ? \"pointer\" : \"default\",\n        zIndex: onClick ? 1 : 0,\n        ...style\n      },\n      ...props,\n      children: /* @__PURE__ */ jsx4(\n        \"div\",\n        {\n          style: {\n            position: \"absolute\",\n            left: 0,\n            top: \"50%\",\n            width: \"100%\",\n            height: thickness,\n            background: color,\n            opacity,\n            transform: \"translateY(-50%)\",\n            pointerEvents: \"none\"\n          }\n        }\n      )\n    },\n    i2\n  )) });\n}\n\n// src/preact/components/text-markup/squiggly.tsx\nimport { Fragment as Fragment5, jsx as jsx5 } from \"preact/jsx-runtime\";\nfunction Squiggly({\n  color = \"#FFFF00\",\n  opacity = 0.5,\n  rects,\n  rect,\n  scale,\n  onClick,\n  style,\n  ...props\n}) {\n  const amplitude = 2 * scale;\n  const period = 6 * scale;\n  const svg = `<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"${period}\" height=\"${amplitude * 2}\" viewBox=\"0 0 ${period} ${amplitude * 2}\">\n      <path d=\"M0 ${amplitude} Q ${period / 4} 0 ${period / 2} ${amplitude} T ${period} ${amplitude}\"\n            fill=\"none\" stroke=\"${color}\" stroke-width=\"${amplitude}\" stroke-linecap=\"round\"/>\n    </svg>`;\n  const svgDataUri = `url(\"data:image/svg+xml;utf8,${encodeURIComponent(svg)}\")`;\n  return /* @__PURE__ */ jsx5(Fragment5, { children: rects.map((r, i2) => /* @__PURE__ */ jsx5(\n    \"div\",\n    {\n      onMouseDown: onClick,\n      style: {\n        position: \"absolute\",\n        left: (rect ? r.origin.x - rect.origin.x : r.origin.x) * scale,\n        top: (rect ? r.origin.y - rect.origin.y : r.origin.y) * scale,\n        width: r.size.width * scale,\n        height: r.size.height * scale,\n        background: \"transparent\",\n        pointerEvents: onClick ? \"auto\" : \"none\",\n        cursor: onClick ? \"pointer\" : \"default\",\n        zIndex: onClick ? 1 : 0,\n        ...style\n      },\n      ...props,\n      children: /* @__PURE__ */ jsx5(\n        \"div\",\n        {\n          style: {\n            position: \"absolute\",\n            left: 0,\n            bottom: 0,\n            width: \"100%\",\n            height: amplitude * 2,\n            backgroundImage: svgDataUri,\n            backgroundRepeat: \"repeat-x\",\n            backgroundSize: `${period}px ${amplitude * 2}px`,\n            opacity,\n            pointerEvents: \"none\"\n          }\n        }\n      )\n    },\n    i2\n  )) });\n}\n\n// src/preact/components/annotations/ink.tsx\nimport { useMemo } from \"preact/hooks\";\nimport { jsx as jsx6 } from \"preact/jsx-runtime\";\nfunction Ink({\n  color = \"#000000\",\n  opacity = 1,\n  strokeWidth,\n  inkList,\n  rect,\n  scale,\n  onClick\n}) {\n  const paths = useMemo(() => {\n    return inkList.map(({ points }) => {\n      let d = \"\";\n      points.forEach(({ x: x2, y: y2 }, i2) => {\n        const lx = x2 - rect.origin.x;\n        const ly = y2 - rect.origin.y;\n        d += (i2 === 0 ? \"M\" : \"L\") + lx + \" \" + ly + \" \";\n      });\n      return d.trim();\n    });\n  }, [inkList, rect]);\n  const width = rect.size.width * scale;\n  const height = rect.size.height * scale;\n  return /* @__PURE__ */ jsx6(\n    \"svg\",\n    {\n      style: {\n        position: \"absolute\",\n        width,\n        height,\n        pointerEvents: \"none\",\n        zIndex: 2\n      },\n      width,\n      height,\n      viewBox: `0 0 ${rect.size.width} ${rect.size.height}`,\n      children: paths.map((d, i2) => /* @__PURE__ */ jsx6(\n        \"path\",\n        {\n          d,\n          fill: \"none\",\n          stroke: color,\n          strokeWidth,\n          strokeLinecap: \"round\",\n          strokeLinejoin: \"round\",\n          opacity,\n          pointerEvents: \"visibleStroke\",\n          onMouseDown: onClick,\n          style: {\n            cursor: \"pointer\"\n          }\n        },\n        i2\n      ))\n    }\n  );\n}\n\n// ../plugin-selection/dist/index.js\nvar _ = \"CACHE_PAGE_GEOMETRY\";\nvar O = \"SET_SELECTION\";\nvar w5 = \"START_SELECTION\";\nvar N3 = \"END_SELECTION\";\nvar A2 = \"CLEAR_SELECTION\";\nvar P4 = \"SET_RECTS\";\nvar v3 = \"SET_SLICES\";\nvar F4 = \"RESET\";\nvar k3 = (e, t) => ({\n  type: _,\n  payload: { page: e, geo: t }\n});\nvar j = (e) => ({\n  type: O,\n  payload: e\n});\nvar V2 = () => ({ type: w5 });\nvar W = () => ({ type: N3 });\nvar Y = () => ({ type: A2 });\nvar U = (e) => ({\n  type: P4,\n  payload: e\n});\nvar q3 = (e) => ({ type: v3, payload: e });\nvar X = () => ({ type: F4 });\nfunction $(e, t) {\n  return e.rects[t] ?? [];\n}\nfunction C2(e, t) {\n  return boundingRect($(e, t));\n}\nfunction Z3(e) {\n  const t = [], n = e.rects;\n  for (const i2 in n) {\n    const s = Number(i2), o = boundingRect(n[s]);\n    o && t.push({ page: s, rect: o });\n  }\n  return t;\n}\nfunction J(e, t) {\n  const n = e.rects[t] || [];\n  if (n.length === 0) return null;\n  const i2 = C2(e, t);\n  return i2 ? { pageIndex: t, rect: i2, segmentRects: n } : null;\n}\nfunction K(e) {\n  const t = [], n = Object.keys(e.rects).map(Number);\n  for (const i2 of n) {\n    const s = e.rects[i2] || [];\n    if (s.length === 0) continue;\n    const o = C2(e, i2);\n    o && t.push({\n      pageIndex: i2,\n      rect: o,\n      segmentRects: s\n    });\n  }\n  return t;\n}\nfunction Q(e, t, n) {\n  if (!e || !t || n < e.start.page || n > e.end.page) return null;\n  const i2 = n === e.start.page ? e.start.index : 0, s = t.runs[t.runs.length - 1], o = s.charStart + s.glyphs.length - 1, c2 = n === e.end.page ? e.end.index : o;\n  return { from: i2, to: c2 };\n}\nfunction tt(e, t, n, i2 = true) {\n  const s = [];\n  for (const o of e.runs) {\n    const c2 = o.charStart, r = c2 + o.glyphs.length - 1;\n    if (r < t || c2 > n) continue;\n    const d = Math.max(t, c2) - c2, f5 = Math.min(n, r) - c2;\n    let a2 = 1 / 0, l4 = -1 / 0, g3 = 1 / 0, S3 = -1 / 0, p3 = 0;\n    for (let y2 = d; y2 <= f5; y2++) {\n      const h4 = o.glyphs[y2];\n      h4.flags !== 2 && (a2 = Math.min(a2, h4.x), l4 = Math.max(l4, h4.x + h4.width), g3 = Math.min(g3, h4.y), S3 = Math.max(S3, h4.y + h4.height), p3++);\n    }\n    a2 !== 1 / 0 && p3 > 0 && s.push({\n      rect: {\n        origin: { x: a2, y: g3 },\n        size: { width: l4 - a2, height: S3 - g3 }\n      },\n      charCount: p3\n    });\n  }\n  return i2 ? st(s) : s.map((o) => o.rect);\n}\nfunction H(e, t) {\n  const n = Math.min(e.origin.x, t.origin.x), i2 = Math.min(e.origin.y, t.origin.y), s = Math.max(e.origin.x + e.size.width, t.origin.x + t.size.width), o = Math.max(e.origin.y + e.size.height, t.origin.y + t.size.height);\n  return {\n    origin: { x: n, y: i2 },\n    size: { width: s - n, height: o - i2 }\n  };\n}\nfunction et2(e, t) {\n  const n = Math.max(e.origin.x, t.origin.x), i2 = Math.max(e.origin.y, t.origin.y), s = Math.min(e.origin.x + e.size.width, t.origin.x + t.size.width), o = Math.min(e.origin.y + e.size.height, t.origin.y + t.size.height), c2 = Math.max(0, s - n), r = Math.max(0, o - i2);\n  return {\n    origin: { x: n, y: i2 },\n    size: { width: c2, height: r }\n  };\n}\nfunction x(e) {\n  return e.size.width <= 0 || e.size.height <= 0;\n}\nfunction nt(e, t) {\n  if (x(e) || x(t)) return 0;\n  const n = H(e, t);\n  return n.size.height === e.size.height || n.size.height === t.size.height ? 1 : et2(e, t).size.height / n.size.height;\n}\nfunction it3(e, t) {\n  const i2 = e.rect, s = t.rect;\n  if (nt(i2, s) < 0.8)\n    return false;\n  const o = 1, c2 = o * i2.size.width / e.charCount, r = o * s.size.width / t.charCount, d = i2.origin.x - c2, f5 = i2.origin.x + i2.size.width + c2, a2 = s.origin.x - r, l4 = s.origin.x + s.size.width + r;\n  return d < l4 && f5 > a2;\n}\nfunction st(e) {\n  const t = [];\n  let n = null, i2 = null;\n  for (const s of e)\n    n && i2 ? it3(n, s) ? i2 = H(i2, s.rect) : (t.push(i2), i2 = s.rect) : i2 = s.rect, n = s;\n  return i2 && !x(i2) && t.push(i2), t;\n}\nvar b2 = class b3 extends Z {\n  constructor(t, n, i2) {\n    super(t, n), this.engine = i2, this.enabledModes = /* @__PURE__ */ new Set([\"default\"]), this.selecting = false, this.selChange$ = it(), this.textRetrieved$ = it(), this.copyToClipboard$ = et(), this.beginSelection$ = et(), this.endSelection$ = et(), this.coreStore.onAction(m, (s) => {\n      this.dispatch(X());\n    });\n  }\n  /*  life-cycle  */\n  async initialize() {\n  }\n  async destroy() {\n    this.selChange$.clear();\n  }\n  /*  capability exposed to UI / other plugins  */\n  buildCapability() {\n    return {\n      getGeometry: (t) => this.getOrLoadGeometry(t),\n      getFormattedSelection: () => K(this.state),\n      getFormattedSelectionForPage: (t) => J(this.state, t),\n      getHighlightRectsForPage: (t) => $(this.state, t),\n      getHighlightRects: () => this.state.rects,\n      getBoundingRectForPage: (t) => C2(this.state, t),\n      getBoundingRects: () => Z3(this.state),\n      begin: (t, n) => this.beginSelection(t, n),\n      update: (t, n) => this.updateSelection(t, n),\n      end: () => this.endSelection(),\n      clear: () => this.clearSelection(),\n      onCopyToClipboard: this.copyToClipboard$.on,\n      onSelectionChange: this.selChange$.on,\n      onTextRetrieved: this.textRetrieved$.on,\n      onBeginSelection: this.beginSelection$.on,\n      onEndSelection: this.endSelection$.on,\n      getSelectedText: () => this.getSelectedText(),\n      copyToClipboard: () => this.copyToClipboard(),\n      enableForMode: (t) => this.enabledModes.add(t),\n      isEnabledForMode: (t) => this.enabledModes.has(t),\n      getState: () => this.state\n    };\n  }\n  /*  geometry cache  */\n  getOrLoadGeometry(t) {\n    const n = this.state.geometry[t];\n    if (n) return PdfTaskHelper.resolve(n);\n    if (!this.coreState.core.document)\n      return PdfTaskHelper.reject({ code: PdfErrorCode.NotFound, message: \"Doc Not Found\" });\n    const i2 = this.coreState.core.document.pages.find((o) => o.index === t), s = this.engine.getPageGeometry(this.coreState.core.document, i2);\n    return s.wait((o) => {\n      this.dispatch(k3(t, o));\n    }, ignore), s;\n  }\n  /*  selection state updates  */\n  beginSelection(t, n) {\n    this.selecting = true, this.anchor = { page: t, index: n }, this.dispatch(V2()), this.beginSelection$.emit({ page: t, index: n });\n  }\n  endSelection() {\n    this.selecting = false, this.anchor = void 0, this.dispatch(W()), this.endSelection$.emit();\n  }\n  clearSelection() {\n    this.selecting = false, this.anchor = void 0, this.dispatch(Y()), this.selChange$.emit(null);\n  }\n  updateSelection(t, n) {\n    if (!this.selecting || !this.anchor) return;\n    const i2 = this.anchor, s = t > i2.page || t === i2.page && n >= i2.index, r = { start: s ? i2 : { page: t, index: n }, end: s ? { page: t, index: n } : i2 };\n    this.dispatch(j(r)), this.updateRectsAndSlices(r), this.selChange$.emit(r);\n  }\n  updateRectsAndSlices(t) {\n    const n = {}, i2 = {};\n    for (let s = t.start.page; s <= t.end.page; s++) {\n      const o = this.state.geometry[s], c2 = Q(t, o, s);\n      c2 && (n[s] = tt(o, c2.from, c2.to), i2[s] = { start: c2.from, count: c2.to - c2.from + 1 });\n    }\n    this.dispatch(U(n)), this.dispatch(q3(i2));\n  }\n  getSelectedText() {\n    if (!this.coreState.core.document || !this.state.selection)\n      return PdfTaskHelper.reject({\n        code: PdfErrorCode.NotFound,\n        message: \"Doc Not Found or No Selection\"\n      });\n    const t = this.state.selection, n = [];\n    for (let s = t.start.page; s <= t.end.page; s++) {\n      const o = this.state.slices[s];\n      o && n.push({ pageIndex: s, charIndex: o.start, charCount: o.count });\n    }\n    if (n.length === 0) return PdfTaskHelper.resolve([]);\n    const i2 = this.engine.getTextSlices(this.coreState.core.document, n);\n    return i2.wait((s) => {\n      this.textRetrieved$.emit(s);\n    }, ignore), i2;\n  }\n  copyToClipboard() {\n    this.getSelectedText().wait((n) => {\n      this.copyToClipboard$.emit(n.join(`\n`));\n    }, ignore);\n  }\n};\nb2.id = \"selection\";\nvar R = b2;\n\n// ../plugin-selection/dist/preact/index.js\nimport { jsx as C3 } from \"preact/jsx-runtime\";\nimport { useState as b4, useRef as A3, useEffect as l3, useCallback as _2, useMemo as B } from \"preact/hooks\";\nvar M2 = () => L(R.id);\n\n// src/shared/resize-ink.ts\nfunction resizeInkAnnotation(original, newRect, direction, uniform = false) {\n  if (original.type !== PdfAnnotationSubtype.INK) {\n    throw new Error(\"resizeInkAnnotation: original is not an ink annotation\");\n  }\n  const oldRect = original.rect;\n  let scaleX = newRect.size.width / oldRect.size.width;\n  let scaleY = newRect.size.height / oldRect.size.height;\n  const minSize = 10;\n  if (newRect.size.width < minSize || newRect.size.height < minSize) {\n    scaleX = Math.max(scaleX, minSize / oldRect.size.width);\n    scaleY = Math.max(scaleY, minSize / oldRect.size.height);\n    newRect = {\n      origin: newRect.origin,\n      size: {\n        width: oldRect.size.width * scaleX,\n        height: oldRect.size.height * scaleY\n      }\n    };\n  }\n  if (uniform) {\n    const minScale = Math.min(scaleX, scaleY);\n    scaleX = minScale;\n    scaleY = minScale;\n    newRect.size = {\n      width: oldRect.size.width * minScale,\n      height: oldRect.size.height * minScale\n    };\n  }\n  const newInkList = original.inkList.map((stroke) => ({\n    points: stroke.points.map((p3) => ({\n      x: newRect.origin.x + (p3.x - oldRect.origin.x) * scaleX,\n      y: newRect.origin.y + (p3.y - oldRect.origin.y) * scaleY\n    }))\n  }));\n  const avgScale = (scaleX + scaleY) / 2;\n  const newStrokeWidth = original.strokeWidth * avgScale;\n  return {\n    rect: newRect,\n    inkList: newInkList,\n    strokeWidth: newStrokeWidth\n  };\n}\n\n// src/preact/components/annotations.tsx\nimport { Fragment as Fragment6, jsx as jsx7 } from \"preact/jsx-runtime\";\nfunction Annotations(annotationsProps) {\n  const { pageIndex, scale } = annotationsProps;\n  const { provides: annotationProvides } = useAnnotationCapability();\n  const { provides: selectionProvides } = M2();\n  const [annotations, setAnnotations2] = useState2([]);\n  const { register } = F3({ pageIndex });\n  const [selectionState, setSelectionState] = useState2(null);\n  useEffect2(() => {\n    if (annotationProvides) {\n      annotationProvides.onStateChange((state) => {\n        setAnnotations2(getAnnotationsByPageIndex(state, pageIndex));\n        setSelectionState(getSelectedAnnotationByPageIndex(state, pageIndex));\n      });\n    }\n  }, [annotationProvides]);\n  const handlers = useMemo2(\n    () => ({\n      onPointerDown: (_3, pe) => {\n        if (pe.target === pe.currentTarget && annotationProvides) {\n          annotationProvides.deselectAnnotation();\n        }\n      }\n    }),\n    [annotationProvides]\n  );\n  const handleClick = useCallback(\n    (e, annotation) => {\n      e.stopPropagation();\n      if (annotationProvides && selectionProvides) {\n        annotationProvides.selectAnnotation(pageIndex, annotation.localId);\n        selectionProvides.clear();\n      }\n    },\n    [annotationProvides, selectionProvides, pageIndex]\n  );\n  useEffect2(() => {\n    return register(handlers);\n  }, [register, handlers]);\n  return /* @__PURE__ */ jsx7(Fragment6, { children: annotations.map((annotation) => {\n    const isSelected = selectionState?.localId === annotation.localId;\n    switch (annotation.object.type) {\n      case PdfAnnotationSubtype.UNDERLINE:\n        return /* @__PURE__ */ jsx7(\n          AnnotationContainer,\n          {\n            trackedAnnotation: annotation,\n            isSelected,\n            isDraggable: false,\n            isResizable: false,\n            style: {\n              mixBlendMode: blendModeToCss(annotation.object.blendMode ?? PdfBlendMode.Normal)\n            },\n            ...annotationsProps,\n            children: /* @__PURE__ */ jsx7(\n              Underline,\n              {\n                rect: annotation.object.rect,\n                color: annotation.object.color,\n                opacity: annotation.object.opacity,\n                rects: annotation.object.segmentRects,\n                scale,\n                onClick: (e) => handleClick(e, annotation)\n              }\n            )\n          },\n          annotation.localId\n        );\n      case PdfAnnotationSubtype.STRIKEOUT:\n        return /* @__PURE__ */ jsx7(\n          AnnotationContainer,\n          {\n            trackedAnnotation: annotation,\n            isSelected,\n            isDraggable: false,\n            isResizable: false,\n            style: {\n              mixBlendMode: blendModeToCss(annotation.object.blendMode ?? PdfBlendMode.Normal)\n            },\n            ...annotationsProps,\n            children: /* @__PURE__ */ jsx7(\n              Strikeout,\n              {\n                rect: annotation.object.rect,\n                color: annotation.object.color,\n                opacity: annotation.object.opacity,\n                rects: annotation.object.segmentRects,\n                scale,\n                onClick: (e) => handleClick(e, annotation)\n              }\n            )\n          },\n          annotation.localId\n        );\n      case PdfAnnotationSubtype.SQUIGGLY:\n        return /* @__PURE__ */ jsx7(\n          AnnotationContainer,\n          {\n            trackedAnnotation: annotation,\n            isSelected,\n            isDraggable: false,\n            isResizable: false,\n            style: {\n              mixBlendMode: blendModeToCss(annotation.object.blendMode ?? PdfBlendMode.Normal)\n            },\n            ...annotationsProps,\n            children: /* @__PURE__ */ jsx7(\n              Squiggly,\n              {\n                color: annotation.object.color,\n                opacity: annotation.object.opacity,\n                rects: annotation.object.segmentRects,\n                rect: annotation.object.rect,\n                scale,\n                onClick: (e) => handleClick(e, annotation)\n              }\n            )\n          },\n          annotation.localId\n        );\n      case PdfAnnotationSubtype.HIGHLIGHT:\n        return /* @__PURE__ */ jsx7(\n          AnnotationContainer,\n          {\n            trackedAnnotation: annotation,\n            isSelected,\n            isDraggable: false,\n            isResizable: false,\n            style: {\n              mixBlendMode: blendModeToCss(\n                annotation.object.blendMode ?? PdfBlendMode.Multiply\n              )\n            },\n            ...annotationsProps,\n            children: /* @__PURE__ */ jsx7(\n              Highlight,\n              {\n                color: annotation.object.color,\n                opacity: annotation.object.opacity,\n                rects: annotation.object.segmentRects,\n                scale,\n                rect: annotation.object.rect,\n                onClick: (e) => handleClick(e, annotation)\n              }\n            )\n          },\n          annotation.localId\n        );\n      case PdfAnnotationSubtype.INK:\n        return /* @__PURE__ */ jsx7(\n          AnnotationContainer,\n          {\n            isSelected,\n            trackedAnnotation: annotation,\n            outlineOffset: 6,\n            computeResizePatch: resizeInkAnnotation,\n            style: {\n              mixBlendMode: blendModeToCss(annotation.object.blendMode ?? PdfBlendMode.Normal)\n            },\n            ...annotationsProps,\n            children: (obj) => /* @__PURE__ */ jsx7(\n              Ink,\n              {\n                color: obj.color,\n                opacity: obj.opacity,\n                strokeWidth: obj.strokeWidth,\n                inkList: obj.inkList,\n                rect: obj.rect,\n                scale,\n                onClick: (e) => handleClick(e, annotation)\n              }\n            )\n          },\n          annotation.localId\n        );\n      default:\n        return null;\n    }\n  }) });\n}\n\n// src/preact/components/text-markup.tsx\nimport { useEffect as useEffect3, useState as useState3 } from \"preact/hooks\";\nimport { jsx as jsx8 } from \"preact/jsx-runtime\";\nfunction TextMarkup({ pageIndex, scale }) {\n  const { provides: selectionProvides } = M2();\n  const { provides: annotationProvides } = useAnnotationCapability();\n  const [rects, setRects] = useState3([]);\n  const [boundingRect2, setBoundingRect] = useState3(null);\n  const [activeTool, setActiveTool] = useState3({ variantKey: null, defaults: null });\n  useEffect3(() => {\n    if (!selectionProvides) return;\n    const off = selectionProvides.onSelectionChange(() => {\n      setRects(selectionProvides.getHighlightRectsForPage(pageIndex));\n      setBoundingRect(selectionProvides.getBoundingRectForPage(pageIndex));\n    });\n    return off;\n  }, [selectionProvides, pageIndex]);\n  useEffect3(() => {\n    if (!annotationProvides) return;\n    const off = annotationProvides.onActiveToolChange(setActiveTool);\n    return off;\n  }, [annotationProvides]);\n  if (!boundingRect2) return null;\n  switch (activeTool.variantKey) {\n    case makeVariantKey(PdfAnnotationSubtype.UNDERLINE):\n      return /* @__PURE__ */ jsx8(\n        \"div\",\n        {\n          style: {\n            mixBlendMode: blendModeToCss(activeTool.defaults?.blendMode ?? PdfBlendMode.Normal),\n            pointerEvents: \"none\",\n            position: \"absolute\",\n            inset: 0\n          },\n          children: /* @__PURE__ */ jsx8(\n            Underline,\n            {\n              color: activeTool.defaults?.color,\n              opacity: activeTool.defaults?.opacity,\n              rects,\n              scale\n            }\n          )\n        }\n      );\n    case makeVariantKey(PdfAnnotationSubtype.HIGHLIGHT):\n      return /* @__PURE__ */ jsx8(\n        \"div\",\n        {\n          style: {\n            mixBlendMode: blendModeToCss(activeTool.defaults?.blendMode ?? PdfBlendMode.Multiply),\n            pointerEvents: \"none\",\n            position: \"absolute\",\n            inset: 0\n          },\n          children: /* @__PURE__ */ jsx8(\n            Highlight,\n            {\n              color: activeTool.defaults?.color,\n              opacity: activeTool.defaults?.opacity,\n              rects,\n              scale\n            }\n          )\n        }\n      );\n    case makeVariantKey(PdfAnnotationSubtype.STRIKEOUT):\n      return /* @__PURE__ */ jsx8(\n        \"div\",\n        {\n          style: {\n            mixBlendMode: blendModeToCss(activeTool.defaults?.blendMode ?? PdfBlendMode.Normal),\n            pointerEvents: \"none\",\n            position: \"absolute\",\n            inset: 0\n          },\n          children: /* @__PURE__ */ jsx8(\n            Strikeout,\n            {\n              color: activeTool.defaults?.color,\n              opacity: activeTool.defaults?.opacity,\n              rects,\n              scale\n            }\n          )\n        }\n      );\n    case makeVariantKey(PdfAnnotationSubtype.SQUIGGLY):\n      return /* @__PURE__ */ jsx8(\n        \"div\",\n        {\n          style: {\n            mixBlendMode: blendModeToCss(activeTool.defaults?.blendMode ?? PdfBlendMode.Normal),\n            pointerEvents: \"none\",\n            position: \"absolute\",\n            inset: 0\n          },\n          children: /* @__PURE__ */ jsx8(\n            Squiggly,\n            {\n              color: activeTool.defaults?.color,\n              opacity: activeTool.defaults?.opacity,\n              rects,\n              scale\n            }\n          )\n        }\n      );\n    default:\n      return null;\n  }\n}\n\n// src/preact/components/annotations/ink-paint.tsx\nimport { useEffect as useEffect4, useMemo as useMemo3, useRef as useRef2, useState as useState4 } from \"preact/hooks\";\nimport { jsx as jsx9 } from \"preact/jsx-runtime\";\nvar MAX_STROKE_WIDTH = 30;\nvar InkPaint = ({ pageIndex, scale, pageWidth, pageHeight }) => {\n  const { provides: annotationProvides } = useAnnotationCapability();\n  const [activeTool, setActiveTool] = useState4({ variantKey: null, defaults: null });\n  useEffect4(() => {\n    if (!annotationProvides) return;\n    const off = annotationProvides.onActiveToolChange(setActiveTool);\n    return off;\n  }, [annotationProvides]);\n  if (!activeTool.defaults) return null;\n  if (activeTool.defaults.subtype !== PdfAnnotationSubtype.INK) return null;\n  const toolColor = activeTool.defaults?.color ?? \"#000000\";\n  const toolOpacity = activeTool.defaults?.opacity ?? 1;\n  const toolStrokeWidth = activeTool.defaults?.strokeWidth ?? 2;\n  const { register } = F3({ modeId: \"ink\", pageIndex });\n  const clamp = (v4, min, max) => Math.max(min, Math.min(max, v4));\n  const [currentStrokes, setCurrentStrokes] = useState4([]);\n  const [isDrawing, setIsDrawing] = useState4(false);\n  const timerRef = useRef2(null);\n  const pageWidthPDF = pageWidth / scale;\n  const pageHeightPDF = pageHeight / scale;\n  const handlers = useMemo3(\n    () => ({\n      onPointerDown: (pos, evt) => {\n        const curX = clamp(pos.x, 0, pageWidthPDF);\n        const curY = clamp(pos.y, 0, pageHeightPDF);\n        setIsDrawing(true);\n        if (timerRef.current) {\n          clearTimeout(timerRef.current);\n          timerRef.current = null;\n          setCurrentStrokes((prev) => [...prev, { points: [{ x: curX, y: curY }] }]);\n        } else {\n          setCurrentStrokes([{ points: [{ x: curX, y: curY }] }]);\n        }\n        evt.target?.setPointerCapture?.(evt.pointerId);\n      },\n      onPointerMove: (pos) => {\n        if (!isDrawing) return;\n        const curX = clamp(pos.x, 0, pageWidthPDF);\n        const curY = clamp(pos.y, 0, pageHeightPDF);\n        setCurrentStrokes((prev) => {\n          if (!prev.length) return prev;\n          const last = prev[prev.length - 1];\n          const newLast = { points: [...last.points, { x: curX, y: curY }] };\n          return [...prev.slice(0, -1), newLast];\n        });\n      },\n      onPointerUp: (_3, evt) => {\n        setIsDrawing(false);\n        evt.target?.releasePointerCapture?.(evt.pointerId);\n        if (timerRef.current) clearTimeout(timerRef.current);\n        timerRef.current = setTimeout(() => {\n          if (currentStrokes.length && annotationProvides) {\n            const allPoints2 = currentStrokes.flatMap((s) => s.points);\n            if (!allPoints2.length) return;\n            const minX2 = Math.min(...allPoints2.map((p3) => p3.x));\n            const minY2 = Math.min(...allPoints2.map((p3) => p3.y));\n            const maxX2 = Math.max(...allPoints2.map((p3) => p3.x));\n            const maxY2 = Math.max(...allPoints2.map((p3) => p3.y));\n            const halfStroke2 = MAX_STROKE_WIDTH / 2;\n            const rectMinX = minX2 - halfStroke2;\n            const rectMinY = minY2 - halfStroke2;\n            const rectMaxX = maxX2 + halfStroke2;\n            const rectMaxY = maxY2 + halfStroke2;\n            if (rectMaxX - rectMinX < 1 || rectMaxY - rectMinY < 1) return;\n            const rect = {\n              origin: { x: rectMinX, y: rectMinY },\n              size: { width: rectMaxX - rectMinX, height: rectMaxY - rectMinY }\n            };\n            const anno = {\n              type: PdfAnnotationSubtype.INK,\n              rect,\n              inkList: currentStrokes,\n              color: toolColor,\n              opacity: toolOpacity,\n              strokeWidth: toolStrokeWidth,\n              pageIndex,\n              id: Date.now() + Math.random()\n            };\n            annotationProvides.createAnnotation(pageIndex, anno);\n            annotationProvides.setActiveVariant(null);\n            annotationProvides.selectAnnotation(pageIndex, anno.id);\n          }\n          setCurrentStrokes([]);\n          timerRef.current = null;\n        }, 3e3);\n      },\n      onPointerCancel: (_3, evt) => {\n        setIsDrawing(false);\n        evt.target?.releasePointerCapture?.(evt.pointerId);\n        setCurrentStrokes([]);\n        if (timerRef.current) {\n          clearTimeout(timerRef.current);\n          timerRef.current = null;\n        }\n      }\n    }),\n    [\n      pageWidthPDF,\n      pageHeightPDF,\n      currentStrokes,\n      annotationProvides,\n      pageIndex,\n      toolColor,\n      toolOpacity,\n      toolStrokeWidth,\n      isDrawing\n    ]\n  );\n  useEffect4(() => {\n    if (!register) return;\n    return register(handlers);\n  }, [register, handlers]);\n  useEffect4(() => {\n    return () => {\n      if (timerRef.current) clearTimeout(timerRef.current);\n    };\n  }, []);\n  if (!currentStrokes.length) return null;\n  const allPoints = currentStrokes.flatMap((s) => s.points);\n  if (!allPoints.length) return null;\n  const minX = Math.min(...allPoints.map((p3) => p3.x));\n  const minY = Math.min(...allPoints.map((p3) => p3.y));\n  const maxX = Math.max(...allPoints.map((p3) => p3.x));\n  const maxY = Math.max(...allPoints.map((p3) => p3.y));\n  const halfStroke = MAX_STROKE_WIDTH / 2;\n  const svgMinX = minX - halfStroke;\n  const svgMinY = minY - halfStroke;\n  const svgMaxX = maxX + halfStroke;\n  const svgMaxY = maxY + halfStroke;\n  const dw = svgMaxX - svgMinX;\n  const dh = svgMaxY - svgMinY;\n  const paths = currentStrokes.map(({ points }) => {\n    let d = \"\";\n    points.forEach(({ x: x2, y: y2 }, i2) => {\n      const lx = x2 - svgMinX;\n      const ly = y2 - svgMinY;\n      d += (i2 === 0 ? \"M\" : \"L\") + lx + \" \" + ly + \" \";\n    });\n    return d.trim();\n  });\n  return /* @__PURE__ */ jsx9(\n    \"svg\",\n    {\n      style: {\n        position: \"absolute\",\n        left: svgMinX * scale,\n        top: svgMinY * scale,\n        width: dw * scale,\n        height: dh * scale,\n        pointerEvents: \"none\",\n        zIndex: 2\n      },\n      width: dw * scale,\n      height: dh * scale,\n      viewBox: `0 0 ${dw} ${dh}`,\n      children: paths.map((d, i2) => /* @__PURE__ */ jsx9(\n        \"path\",\n        {\n          d,\n          fill: \"none\",\n          stroke: toolColor,\n          strokeWidth: toolStrokeWidth,\n          strokeLinecap: \"round\",\n          strokeLinejoin: \"round\",\n          opacity: toolOpacity\n        },\n        i2\n      ))\n    }\n  );\n};\n\n// src/preact/components/annotation-layer.tsx\nimport { jsx as jsx10, jsxs as jsxs2 } from \"preact/jsx-runtime\";\nfunction AnnotationLayer({\n  pageIndex,\n  scale,\n  pageWidth,\n  pageHeight,\n  rotation,\n  style,\n  ...props\n}) {\n  return /* @__PURE__ */ jsxs2(\n    \"div\",\n    {\n      style: {\n        ...style\n      },\n      ...props,\n      children: [\n        /* @__PURE__ */ jsx10(Annotations, { pageIndex, scale, rotation }),\n        /* @__PURE__ */ jsx10(TextMarkup, { pageIndex, scale }),\n        /* @__PURE__ */ jsx10(InkPaint, { pageIndex, scale, pageWidth, pageHeight })\n      ]\n    }\n  );\n}\nexport {\n  AnnotationLayer,\n  useAnnotationCapability,\n  useAnnotationPlugin\n};\n//# sourceMappingURL=index.js.map","import {\n  Action,\n  CommandMenuProps,\n  ComponentRenderFunction,\n  DividerComponent,\n  FloatingComponentProps,\n  Group,\n  GroupedItemsProps,\n  HeaderProps,\n  IconButtonProps,\n  Menu,\n  MenuItem,\n  PanelProps,\n  ResolvedMenuItem,\n  SelectButtonProps,\n  TabButtonProps,\n} from '@embedpdf/plugin-ui';\nimport { h, Fragment } from 'preact';\nimport { Button } from './ui/button';\nimport { Tooltip } from './ui/tooltip';\nimport { useState, useRef, useEffect, useCallback } from 'preact/hooks';\nimport { useUICapability } from '@embedpdf/plugin-ui/preact';\nimport { Dropdown } from './ui/dropdown';\nimport { useZoomCapability } from '@embedpdf/plugin-zoom/preact';\nimport { useViewportCapability } from '@embedpdf/plugin-viewport/preact';\nimport { useScrollCapability } from '@embedpdf/plugin-scroll/preact';\nimport { Icon } from './ui/icon';\nimport { useSearchCapability } from '@embedpdf/plugin-search/preact';\nimport { ThumbImg, ThumbnailsPane } from '@embedpdf/plugin-thumbnail/preact';\nimport { useDebounce } from '@/hooks/use-debounce';\nimport {\n  ignore,\n  PdfAlphaColor,\n  PdfAnnotationSubtype,\n  PdfBookmarkObject,\n  PdfDocumentObject,\n  PdfErrorCode,\n  PdfZoomMode,\n  Rotation,\n  SearchAllPagesResult,\n  SearchResult,\n  WebAlphaColor,\n} from '@embedpdf/models';\nimport { MatchFlag } from '@embedpdf/models';\nimport { Checkbox } from './ui/checkbox';\nimport { useSelectionCapability } from '@embedpdf/plugin-selection/preact';\nimport { menuPositionForSelection } from './utils';\nimport { useSwipeGesture } from '@/hooks/use-swipe-gesture';\nimport { Dialog } from './ui/dialog';\nimport { usePrintAction } from '@embedpdf/plugin-print/preact';\nimport { PageRange, PageRangeType, PrintOptions, PrintQuality } from '@embedpdf/plugin-print';\nimport { useBookmarkCapability } from '@embedpdf/plugin-bookmark/preact';\nimport { useStoreState } from '@embedpdf/core/preact';\nimport { SelectedAnnotation, TrackedAnnotation } from '@embedpdf/plugin-annotation';\nimport { useAnnotationCapability } from '@embedpdf/plugin-annotation/preact';\n\nexport const iconButtonRenderer: ComponentRenderFunction<IconButtonProps> = (\n  { commandId, onClick, active, color, disabled = false, ...props },\n  children,\n  context,\n) => {\n  const { provides: ui } = useUICapability();\n  const command = commandId ? ui?.getMenuOrAction(commandId) : null;\n\n  const handleClick = useCallback(\n    (e: MouseEvent) => {\n      e.preventDefault();\n      e.stopPropagation();\n\n      if (onClick) {\n        onClick();\n        return;\n      }\n\n      if (!commandId || !ui || !command) return;\n\n      // Get the button element to use for positioning menus\n      const triggerElement = e.currentTarget as HTMLElement;\n\n      ui.executeCommand(commandId, {\n        source: 'click',\n        triggerElement,\n        position: context?.direction === 'horizontal' ? 'bottom' : 'right',\n      });\n    },\n    [command, commandId, ui, onClick],\n  );\n\n  return (\n    <Tooltip\n      position={context?.direction === 'horizontal' ? 'bottom' : 'right'}\n      content={props.label || command?.label || ''}\n      trigger={active ? 'none' : 'hover'}\n      delay={500}\n    >\n      <Button\n        active={active}\n        onClick={handleClick}\n        disabled={disabled}\n        className={` ${context?.variant === 'flyout' ? 'w-full rounded-none px-2' : ''} `}\n      >\n        {!command?.icon && props.img && (\n          <img src={props.img} alt={props.label} className=\"h-5 w-5\" />\n        )}\n        {command?.icon && <Icon icon={command.icon} className=\"h-5 w-5\" style={{ color }} />}\n      </Button>\n    </Tooltip>\n  );\n};\n\nexport const tabButtonRenderer: ComponentRenderFunction<TabButtonProps> = (\n  { commandId, onClick, active, ...props },\n  children,\n) => {\n  const { provides: ui } = useUICapability();\n  const command = commandId ? ui?.getMenuOrAction(commandId) : null;\n\n  const handleClick = useCallback(\n    (e: MouseEvent) => {\n      e.preventDefault();\n      e.stopPropagation();\n\n      if (onClick) {\n        onClick();\n        return;\n      }\n\n      if (!commandId || !ui || !command) return;\n\n      ui.executeCommand(commandId, {\n        source: 'click',\n      });\n    },\n    [command, commandId, ui, onClick],\n  );\n\n  return (\n    <Button\n      key={props.id}\n      className={`rounded-none px-2 py-1 text-sm hover:bg-transparent ${active ? 'border-b-2 border-b-blue-500 text-blue-500' : 'border-b-2 border-b-transparent hover:border-b-gray-500'} hover:ring-transparent`}\n      onClick={handleClick}\n    >\n      {props.label}\n    </Button>\n  );\n};\n\nexport const dividerRenderer: ComponentRenderFunction<DividerComponent> = (\n  props,\n  _: any,\n  context,\n) => {\n  const className =\n    context?.direction === 'horizontal'\n      ? 'h-6 w-[1px] bg-gray-300 self-center'\n      : 'h-[1px] w-6 bg-gray-300 self-center';\n\n  return <div className={className} />;\n};\n\nexport const groupedItemsRenderer: ComponentRenderFunction<GroupedItemsProps> = (\n  props,\n  children,\n  context,\n) => {\n  const style: h.JSX.CSSProperties = {\n    display: 'flex',\n    flexDirection: context?.direction === 'horizontal' ? 'row' : 'column',\n    justifyContent: props.justifyContent || 'start',\n    gap: `${props.gap || 0}px`,\n  };\n\n  return <div style={style}>{children()}</div>;\n};\n\nexport const headerRenderer: ComponentRenderFunction<HeaderProps> = (props, children) => {\n  const style: h.JSX.CSSProperties = {\n    // Get the correct border based on placement\n    ...(props.placement === 'top'\n      ? { borderBottom: '1px solid #cfd4da' }\n      : props.placement === 'bottom'\n        ? { borderTop: '1px solid #cfd4da' }\n        : props.placement === 'left'\n          ? { borderRight: '1px solid #cfd4da' }\n          : { borderLeft: '1px solid #cfd4da' }),\n    width: props.placement === 'top' || props.placement === 'bottom' ? '100%' : 'auto',\n    height: props.placement === 'left' || props.placement === 'right' ? '100%' : 'auto',\n    zIndex: 10,\n    justifyContent: 'space-between',\n    display: 'flex',\n    flexDirection: props.placement === 'top' || props.placement === 'bottom' ? 'row' : 'column',\n    // Conditional padding based on placement\n    ...(props.placement === 'top' || props.placement === 'bottom'\n      ? {\n          paddingTop: '8px',\n          paddingBottom: '8px',\n          paddingLeft: '16px',\n          paddingRight: '16px',\n        }\n      : {\n          paddingLeft: '8px',\n          paddingRight: '8px',\n          paddingTop: '16px',\n          paddingBottom: '16px',\n        }),\n    ...props.style,\n  };\n\n  if (props.visible !== undefined && !props.visible) return null;\n\n  return (\n    <div style={style} className=\"header\">\n      {children({\n        ...(props.visibleChild && {\n          filter: (childId) => childId === props.visibleChild,\n        }),\n      })}\n    </div>\n  );\n};\n\nexport interface LeftPanelMainProps {\n  visibleChild: string;\n  tabsCommandId: string;\n}\n\nexport const leftPanelMainRenderer: ComponentRenderFunction<LeftPanelMainProps> = (\n  props,\n  children,\n) => {\n  const { provides: ui } = useUICapability();\n  const tabsCommand = props.tabsCommandId ? ui?.getMenuOrAction(props.tabsCommandId) : null;\n  const tabChildren =\n    tabsCommand && tabsCommand.type === 'menu' ? ui?.getItemsByIds(tabsCommand.children) : null;\n\n  return (\n    <Fragment>\n      {tabsCommand && tabChildren && (\n        <div role=\"tablist\" className=\"mx-4 my-4 flex flex-shrink-0 overflow-hidden bg-white\">\n          {tabChildren\n            .filter((child) => child.type === 'action')\n            .map((child, idx, array) => {\n              const isActive = !!child.active;\n              const isFirst = idx === 0;\n              const isLast = idx === array.length - 1;\n\n              return (\n                <Tooltip key={child.id} content={child.label} trigger=\"hover\" position=\"bottom\">\n                  <button\n                    role=\"tab\"\n                    aria-selected={isActive}\n                    tabIndex={isActive ? 0 : -1}\n                    onClick={(e) =>\n                      ui?.executeCommand(child.id, {\n                        source: 'click',\n                        triggerElement: e.currentTarget as HTMLElement,\n                        position: 'bottom',\n                      })\n                    }\n                    className={`relative flex h-7 flex-1 cursor-pointer items-center justify-center border outline-none transition-colors ${isFirst ? 'rounded-l-md' : ''} ${isLast ? 'rounded-r-md' : ''} ${!isLast ? 'border-r-0' : ''} ${\n                      isActive\n                        ? 'border-blue-600 bg-blue-600 text-white'\n                        : 'border-gray-300 text-gray-600 hover:bg-gray-50'\n                    } `}\n                  >\n                    {child.icon && (\n                      <Icon icon={child.icon} className=\"pointer-events-none block h-5 w-5\" />\n                    )}\n                  </button>\n                </Tooltip>\n              );\n            })}\n        </div>\n      )}\n      {children({\n        ...(props.visibleChild && {\n          filter: (childId) => childId === props.visibleChild,\n        }),\n      })}\n    </Fragment>\n  );\n};\n\nexport const panelRenderer: ComponentRenderFunction<PanelProps & { tabsCommandId?: string }> = (\n  props,\n  children,\n) => {\n  const { elementRef, isFullscreen } = useSwipeGesture(props.open);\n  const { provides: ui } = useUICapability();\n  if (!props.open) return null;\n  const borderClass = props.location === 'left' ? 'md:border-r' : 'md:border-l';\n\n  const togglePanel = () => {\n    ui?.togglePanel({\n      id: props.id,\n      visibleChild: props.visibleChild || 'leftPanelMain',\n      open: !props.open,\n    });\n  };\n\n  return (\n    <div\n      className={`flex w-full flex-none shrink-0 flex-col border-t bg-white md:w-[275px] md:min-w-[275px] md:border-t-0 ${borderClass} absolute bottom-0 left-0 right-0 z-10 touch-pan-y border-[#cfd4da] transition-all duration-300 ease-in-out md:static md:h-full ${isFullscreen ? 'h-full' : 'h-1/2'}`}\n    >\n      {/* Drag handle for mobile */}\n      <div\n        className=\"flex h-6 w-full cursor-grab items-center justify-center active:cursor-grabbing md:hidden\"\n        ref={elementRef}\n      >\n        <div className=\"h-1 w-12 rounded-full bg-gray-300\"></div>\n      </div>\n\n      <div className=\"flex flex-row justify-end md:hidden\">\n        <Icon icon=\"x\" className=\"mr-5 h-5 w-5 cursor-pointer\" onClick={togglePanel} />\n      </div>\n\n      {/* Panel content */}\n      <div className=\"flex min-h-0 flex-1 flex-col\">\n        {children({\n          ...(props.visibleChild && {\n            filter: (childId) => childId === props.visibleChild,\n          }),\n        })}\n      </div>\n    </div>\n  );\n};\n\nfunction groupByPage(results: SearchResult[]) {\n  return results.reduce<Record<number, { hit: SearchResult; index: number }[]>>((map, r, i) => {\n    (map[r.pageIndex] ??= []).push({ hit: r, index: i });\n    return map;\n  }, {});\n}\n\n/** one hit line  click jumps to the first rect */\nfunction HitLine({\n  hit,\n  onClick,\n  active,\n}: {\n  hit: SearchResult;\n  onClick: (hit: SearchResult) => void;\n  active: boolean;\n}) {\n  const { before, match, after, truncatedLeft, truncatedRight } = hit.context;\n  const ref = useRef<HTMLButtonElement>(null);\n\n  useEffect(() => {\n    if (active && ref.current) {\n      ref.current.scrollIntoView({ behavior: 'smooth', block: 'nearest' });\n    }\n  }, [active]);\n\n  return (\n    <button\n      ref={ref}\n      onClick={() => onClick(hit)}\n      className={`shadow-xs w-full cursor-pointer rounded border border-[#cfd4da] p-3 text-left text-xs leading-tight text-gray-600 ${active ? 'border-blue-500 bg-blue-50' : 'hover:border-[#1a466b] hover:bg-gray-100'}`}\n    >\n      {truncatedLeft && ' '}\n      {before}\n      <span className=\"font-bold text-blue-500\">{match}</span>\n      {after}\n      {truncatedRight && ' '}\n    </button>\n  );\n}\n\ninterface SearchRendererProps {\n  flags: MatchFlag[];\n  results: SearchResult[];\n  total: number;\n  activeResultIndex: number;\n  active: boolean;\n  query: string;\n  loading: boolean;\n}\n\nexport const searchRenderer: ComponentRenderFunction<SearchRendererProps> = (props) => {\n  const inputRef = useRef<HTMLInputElement>(null);\n  const [inputValue, setInputValue] = useState(props.query || '');\n  const { provides: search } = useSearchCapability();\n  const { provides: scroll } = useScrollCapability();\n  const debouncedValue = useDebounce(inputValue, 400);\n\n  useEffect(() => {\n    // Focus the input element when the component mounts\n    if (inputRef.current) {\n      inputRef.current.focus();\n    }\n  }, [search]);\n\n  useEffect(() => {\n    if (debouncedValue === '') {\n      search?.stopSearch();\n    } else {\n      search?.searchAllPages(debouncedValue);\n    }\n  }, [debouncedValue, search]);\n\n  useEffect(() => {\n    if (props.activeResultIndex !== undefined && !props.loading) {\n      scrollToItem(props.activeResultIndex);\n    }\n  }, [props.activeResultIndex, props.loading, props.query, props.flags]);\n\n  const handleInputChange = (e: Event) => {\n    const target = e.target as HTMLInputElement;\n    setInputValue(target.value);\n  };\n\n  const handleFlagChange = (flag: MatchFlag, checked: boolean) => {\n    if (checked) {\n      search?.setFlags([...props.flags, flag]);\n    } else {\n      search?.setFlags(props.flags.filter((f) => f !== flag));\n    }\n  };\n\n  const scrollToItem = (index: number) => {\n    const item = props.results[index];\n    if (!item) return;\n\n    const minCoordinates = item.rects.reduce(\n      (min, rect) => ({\n        x: Math.min(min.x, rect.origin.x),\n        y: Math.min(min.y, rect.origin.y),\n      }),\n      { x: Infinity, y: Infinity },\n    );\n\n    scroll?.scrollToPage({\n      pageNumber: item.pageIndex + 1,\n      pageCoordinates: minCoordinates,\n      center: true,\n    });\n  };\n\n  const clearInput = () => {\n    setInputValue('');\n    // Focus the input after clearing\n    if (inputRef.current) {\n      inputRef.current.focus();\n    }\n  };\n\n  const grouped = groupByPage(props.results);\n\n  return (\n    <div className=\"flex h-full flex-col bg-white\">\n      <div className=\"p-4\">\n        <div className=\"relative\">\n          <div className=\"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-2\">\n            <svg\n              className=\"h-4 w-4 text-gray-500\"\n              xmlns=\"http://www.w3.org/2000/svg\"\n              viewBox=\"0 0 20 20\"\n              fill=\"currentColor\"\n            >\n              <path\n                fillRule=\"evenodd\"\n                d=\"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z\"\n                clipRule=\"evenodd\"\n              />\n            </svg>\n          </div>\n          <input\n            ref={inputRef}\n            type=\"text\"\n            placeholder=\"Search\"\n            autoFocus\n            value={inputValue}\n            onInput={handleInputChange}\n            className=\"w-full rounded-md border border-gray-300 py-1 pl-8 pr-9 text-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500\"\n          />\n          {inputValue && (\n            <div\n              className=\"absolute inset-y-0 right-0 flex cursor-pointer items-center pr-3\"\n              onClick={clearInput}\n            >\n              <svg\n                className=\"h-4 w-4 text-gray-500 hover:text-gray-700\"\n                xmlns=\"http://www.w3.org/2000/svg\"\n                viewBox=\"0 0 20 20\"\n                fill=\"currentColor\"\n              >\n                <path\n                  fillRule=\"evenodd\"\n                  d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\"\n                  clipRule=\"evenodd\"\n                />\n              </svg>\n            </div>\n          )}\n        </div>\n        <div className=\"mt-3 flex flex-row gap-4\">\n          <Checkbox\n            label=\"Case sensitive\"\n            checked={props.flags.includes(MatchFlag.MatchCase)}\n            onChange={(checked) => handleFlagChange(MatchFlag.MatchCase, checked)}\n          />\n          <Checkbox\n            label=\"Whole word\"\n            checked={props.flags.includes(MatchFlag.MatchWholeWord)}\n            onChange={(checked) => handleFlagChange(MatchFlag.MatchWholeWord, checked)}\n          />\n        </div>\n        <hr className=\"mb-2 mt-5 border-gray-200\" />\n        {props.active && !props.loading && (\n          <div className=\"flex h-[32px] flex-row items-center justify-between\">\n            <div className=\"text-xs text-gray-500\">{props.total} results found</div>\n            {props.total > 1 && (\n              <div className=\"flex flex-row\">\n                <Button\n                  onClick={() => {\n                    search?.previousResult();\n                  }}\n                >\n                  <Icon icon={'chevronLeft'} className=\"h-4 w-4\" />\n                </Button>\n                <Button\n                  onClick={() => {\n                    search?.nextResult();\n                  }}\n                >\n                  <Icon icon={'chevronRight'} className=\"h-4 w-4\" />\n                </Button>\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n      <div className=\"flex min-h-0 flex-1 flex-col gap-2 overflow-y-auto px-4\">\n        {props.loading && (\n          <div className=\"flex h-full flex-row items-center justify-center\">\n            <div className=\"text-xs text-gray-500\">Loading...</div>\n          </div>\n        )}\n        {!props.loading &&\n          Object.entries(grouped).map(([page, hits]) => (\n            <div key={page} className=\"mt-2 first:mt-0\">\n              <div className=\"bg-white/80 py-2 text-xs text-gray-500 backdrop-blur\">\n                Page {Number(page) + 1}\n              </div>\n\n              <div className=\"flex flex-col gap-2\">\n                {hits.map(({ hit, index }) => (\n                  <HitLine\n                    key={index}\n                    hit={hit}\n                    active={index === props.activeResultIndex}\n                    onClick={() => {\n                      search?.goToResult(index);\n                    }}\n                  />\n                ))}\n              </div>\n            </div>\n          ))}\n        <div />\n      </div>\n    </div>\n  );\n};\n\nexport interface ZoomRendererProps {\n  zoomLevel: number;\n  commandZoomIn: string;\n  commandZoomOut: string;\n  commandZoomMenu: string;\n  zoomMenuActive: boolean;\n}\n\nexport const zoomRenderer: ComponentRenderFunction<ZoomRendererProps> = (\n  props,\n  children,\n  context,\n) => {\n  const { provides: zoom } = useZoomCapability();\n  const { provides: ui } = useUICapability();\n\n  if (!ui) return null;\n\n  const commandZoomMenu = props.commandZoomMenu ? ui.getMenuOrAction(props.commandZoomMenu) : null;\n  const commandZoomIn = props.commandZoomIn ? ui.getMenuOrAction(props.commandZoomIn) : null;\n  const commandZoomOut = props.commandZoomOut ? ui.getMenuOrAction(props.commandZoomOut) : null;\n\n  const [zoomDropdownOpen, setZoomDropdownOpen] = useState(false);\n  const zoomDropdownRef = useRef<any>(null);\n  // Format zoom level as percentage and round to avoid floating point issues\n  const zoomPercentage = Math.round(props.zoomLevel * 100);\n\n  const handleClick = (e: MouseEvent, command: Menu<any> | Action<any> | null | undefined) => {\n    if (command) {\n      ui.executeCommand(command.id, {\n        source: 'click',\n        triggerElement: e.currentTarget as HTMLElement,\n        position: context?.direction === 'horizontal' ? 'bottom' : 'right',\n        flatten: true,\n      });\n    }\n  };\n\n  const handleZoomChange = (e: Event) => {\n    e.preventDefault();\n    const form = e.target as HTMLFormElement;\n    const formData = new FormData(form);\n    const zoomStr = formData.get('zoom') as string;\n\n    zoom?.requestZoom(parseFloat(zoomStr) / 100);\n  };\n\n  useEffect(() => {\n    if (zoomDropdownRef.current) {\n      console.log(zoomDropdownRef.current);\n    }\n  }, [zoomDropdownRef.current]);\n\n  return (\n    <div className=\"flex flex-row items-center rounded-md bg-[#f1f3f5]\">\n      <form onSubmit={handleZoomChange} className=\"block\">\n        <input\n          name=\"zoom\"\n          type=\"text\"\n          inputMode=\"numeric\"\n          pattern=\"\\d*\"\n          className=\"h-6 w-8 border-0 bg-transparent p-0 text-right text-sm\"\n          aria-label=\"Set zoom\"\n          autoFocus={false}\n          value={zoomPercentage}\n          onInput={(e) => {\n            // Only allow numbers\n            const target = e.target as HTMLInputElement;\n            target.value = target.value.replace(/[^0-9]/g, '');\n          }}\n        />\n        <span className=\"text-sm\">%</span>\n      </form>\n      <Tooltip\n        position={context?.direction === 'horizontal' ? 'bottom' : 'right'}\n        content={'Zoom Options'}\n        trigger={props.zoomMenuActive ? 'none' : 'hover'}\n      >\n        <Button\n          className={`p-1`}\n          onClick={(e) => handleClick(e, commandZoomMenu)}\n          active={props.zoomMenuActive}\n        >\n          <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            width=\"14\"\n            height=\"14\"\n            viewBox=\"0 0 24 24\"\n            fill=\"none\"\n            stroke=\"currentColor\"\n            strokeWidth=\"2\"\n            strokeLinecap=\"round\"\n            strokeLinejoin=\"round\"\n            class=\"icon icon-tabler icons-tabler-outline icon-tabler-chevron-down\"\n          >\n            <path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\" />\n            <path d=\"M6 9l6 6l6 -6\" />\n          </svg>\n        </Button>\n      </Tooltip>\n      <Tooltip\n        position={context?.direction === 'horizontal' ? 'bottom' : 'right'}\n        content={'Zoom Out'}\n        trigger={'hover'}\n      >\n        <Button className=\"p-1\" onClick={(e) => handleClick(e, commandZoomOut)}>\n          {commandZoomOut?.icon && <Icon icon={commandZoomOut.icon} className=\"h-5 w-5\" />}\n        </Button>\n      </Tooltip>\n      <Tooltip\n        position={context?.direction === 'horizontal' ? 'bottom' : 'right'}\n        content={'Zoom In'}\n        trigger={'hover'}\n      >\n        <Button className=\"p-1\" onClick={(e) => handleClick(e, commandZoomIn)}>\n          {commandZoomIn?.icon && <Icon icon={commandZoomIn.icon} className=\"h-5 w-5\" />}\n        </Button>\n      </Tooltip>\n    </div>\n  );\n};\n\ninterface AnnotationSelectionMenuProps extends FloatingComponentProps {\n  open: boolean;\n}\n\nexport const annotationSelectionMenuRenderer: ComponentRenderFunction<\n  AnnotationSelectionMenuProps\n> = (props, children) => {\n  const { provides: annotation } = useAnnotationCapability();\n  const { provides: scroll } = useScrollCapability();\n  const { provides: viewport } = useViewportCapability();\n\n  if (!props.open || !annotation || !scroll || !viewport) return null;\n\n  const selectedAnnotation = annotation.getSelectedAnnotation();\n  if (!selectedAnnotation) return null;\n\n  const bounding = [\n    { page: selectedAnnotation.object.pageIndex, rect: selectedAnnotation.object.rect },\n  ];\n  const coords = menuPositionForSelection(bounding, scroll, viewport, 10, 42);\n  if (!coords) return null; // nothing visible yet\n\n  return (\n    <div\n      style={{\n        left: `${coords.left}px`,\n        top: `${coords.top}px`,\n        transform: 'translate(-50%, 0%)',\n        zIndex: 2000,\n      }}\n      className=\"absolute rounded-md border border-[#cfd4da] bg-[#f8f9fa] p-1\"\n    >\n      {children()}\n    </div>\n  );\n};\n\ninterface TextSelectionMenuProps extends FloatingComponentProps {\n  open: boolean;\n  scale?: number;\n  rotation?: Rotation;\n}\n\nexport const textSelectionMenuRenderer: ComponentRenderFunction<TextSelectionMenuProps> = (\n  props,\n  children,\n) => {\n  const { provides: selection } = useSelectionCapability();\n  const { provides: scroll } = useScrollCapability();\n  const { provides: viewport } = useViewportCapability();\n\n  if (!props.open || !selection || !scroll || !viewport) return null;\n\n  const bounding = selection.getBoundingRects(); // one per page\n  const coords = menuPositionForSelection(bounding, scroll, viewport, 10, 42);\n  if (!coords) return null; // nothing visible yet\n\n  return (\n    <div\n      style={{\n        left: `${coords.left}px`,\n        top: `${coords.top}px`,\n        transform: 'translate(-50%, 0%)',\n        zIndex: 2000,\n      }}\n      className=\"absolute rounded-md border border-[#cfd4da] bg-[#f8f9fa] p-1\"\n    >\n      {children()}\n    </div>\n  );\n};\n\nexport const pageControlsContainerRenderer: ComponentRenderFunction<FloatingComponentProps> = (\n  props,\n  children,\n) => {\n  const { provides: viewport } = useViewportCapability();\n  const [isVisible, setIsVisible] = useState(false);\n  const [isHovering, setIsHovering] = useState(false);\n  const hideTimeoutRef = useRef<NodeJS.Timeout>();\n\n  const startHideTimer = useCallback(() => {\n    if (hideTimeoutRef.current) {\n      clearTimeout(hideTimeoutRef.current);\n    }\n    hideTimeoutRef.current = setTimeout(() => {\n      if (!isHovering) {\n        setIsVisible(false);\n      }\n    }, 4000);\n  }, [isHovering]);\n\n  useEffect(() => {\n    if (!viewport) return;\n\n    return viewport.onScrollChange((scrollMetrics) => {\n      if (scrollMetrics.scrollTop > 0 || scrollMetrics.scrollLeft > 0) {\n        setIsVisible(true);\n        startHideTimer();\n      }\n    });\n  }, [viewport, startHideTimer]);\n\n  useEffect(() => {\n    return () => {\n      if (hideTimeoutRef.current) {\n        clearTimeout(hideTimeoutRef.current);\n      }\n    };\n  }, []);\n\n  const handleMouseEnter = () => {\n    setIsHovering(true);\n    setIsVisible(true);\n  };\n\n  const handleMouseLeave = () => {\n    setIsHovering(false);\n    startHideTimer();\n  };\n\n  return (\n    <div\n      className=\"absolute bottom-4 left-1/2 -translate-x-1/2\"\n      onMouseEnter={handleMouseEnter}\n      onMouseLeave={handleMouseLeave}\n    >\n      <div\n        className={`rounded-md border border-[#cfd4da] bg-[#f8f9fa] p-1 transition-opacity duration-200 ${\n          isVisible ? 'opacity-100' : 'opacity-0'\n        }`}\n      >\n        {children()}\n      </div>\n    </div>\n  );\n};\n\nexport interface PageControlsProps {\n  currentPage: number;\n  pageCount: number;\n  nextPageCommandId: string;\n  previousPageCommandId: string;\n}\n\nexport const pageControlsRenderer: ComponentRenderFunction<PageControlsProps> = (props) => {\n  const { provides: scroll } = useScrollCapability();\n  const { provides: ui } = useUICapability();\n  const isFirstPage = props.currentPage === 1;\n  const isLastPage = props.currentPage === props.pageCount;\n\n  const commandNextPage = props.nextPageCommandId\n    ? ui?.getMenuOrAction(props.nextPageCommandId)\n    : null;\n  const commandPreviousPage = props.previousPageCommandId\n    ? ui?.getMenuOrAction(props.previousPageCommandId)\n    : null;\n\n  const handlePageChange = (e: Event) => {\n    e.preventDefault();\n    const form = e.target as HTMLFormElement;\n    const formData = new FormData(form);\n    const pageStr = formData.get('page') as string;\n    const page = parseInt(pageStr);\n\n    if (!isNaN(page) && page >= 1) {\n      scroll?.scrollToPage({\n        pageNumber: page,\n      });\n    }\n  };\n\n  const handleClick = (e: MouseEvent, command: Menu<any> | Action<any> | null | undefined) => {\n    if (command && ui) {\n      ui.executeCommand(command.id, {\n        source: 'click',\n        triggerElement: e.currentTarget as HTMLElement,\n      });\n    }\n  };\n\n  return (\n    <div className=\"flex flex-row items-center justify-between gap-3 rounded-md\">\n      <Tooltip position={'top'} content={'Previous Page'} trigger={isFirstPage ? 'none' : 'hover'}>\n        <Button\n          className={`p-1 ${isFirstPage ? 'cursor-not-allowed opacity-50 hover:ring-0' : ''}`}\n          onClick={(e) => handleClick(e, commandPreviousPage)}\n          disabled={isFirstPage}\n        >\n          {commandPreviousPage?.icon && (\n            <Icon icon={commandPreviousPage.icon} className=\"h-5 w-5\" />\n          )}\n        </Button>\n      </Tooltip>\n      <form className=\"flex flex-row items-center gap-3\" onSubmit={handlePageChange}>\n        <input\n          name=\"page\"\n          type=\"text\"\n          inputMode=\"numeric\"\n          pattern=\"\\d*\"\n          className=\"border-1 h-8 w-8 rounded-md border-gray-600 bg-white p-0 text-center text-sm\"\n          aria-label=\"Set page\"\n          value={props.currentPage}\n          onInput={(e) => {\n            // Only allow numbers\n            const target = e.target as HTMLInputElement;\n            target.value = target.value.replace(/[^0-9]/g, '');\n          }}\n        />\n        <span className=\"text-sm\">{props.pageCount}</span>\n      </form>\n      <Tooltip position={'top'} content={'Next Page'} trigger={isLastPage ? 'none' : 'hover'}>\n        <Button\n          className={`p-1 ${isLastPage ? 'cursor-not-allowed opacity-50 hover:ring-0' : ''}`}\n          onClick={(e) => handleClick(e, commandNextPage)}\n          disabled={isLastPage}\n        >\n          {commandNextPage?.icon && <Icon icon={commandNextPage.icon} className=\"h-5 w-5\" />}\n        </Button>\n      </Tooltip>\n    </div>\n  );\n};\n\nexport const commandMenuRenderer: ComponentRenderFunction<CommandMenuProps> = ({\n  activeCommand,\n  open,\n  position,\n  triggerElement,\n  flatten,\n}) => {\n  const { provides: ui } = useUICapability();\n  const [history, setHistory] = useState<string[]>([]);\n  const lastPushRef = useRef<string | null>(null);\n\n  useEffect(() => {\n    if (!open) setHistory([]);\n  }, [open]);\n\n  useEffect(() => {\n    if (!activeCommand) return;\n\n    if (lastPushRef.current === activeCommand) {\n      lastPushRef.current = null;\n      return;\n    }\n\n    setHistory([]);\n  }, [activeCommand]);\n\n  if (!ui) return null;\n\n  const items = activeCommand ? ui?.getChildItems(activeCommand, { flatten }) : null;\n\n  const currentMenu =\n    history.length > 0 && activeCommand ? ui.getMenuOrAction(activeCommand) : undefined;\n\n  const handleHide = () => {\n    ui.hideCommandMenu();\n  };\n\n  const handleCommandClick = (command: MenuItem) => {\n    if (command.type === 'action') {\n      ui.hideCommandMenu();\n      ui.executeCommand(command.id);\n    } else if (command.type === 'menu') {\n      pushMenu(command.id);\n    }\n  };\n\n  const pushMenu = (menuId: string) => {\n    if (activeCommand) setHistory((prev) => [...prev, activeCommand]);\n    lastPushRef.current = menuId;\n\n    ui.executeCommand(menuId, {\n      triggerElement: triggerElement,\n      position: position,\n    });\n  };\n\n  const goBack = () => {\n    if (history.length === 0) return;\n    const previous = history[history.length - 1];\n    setHistory((prev) => prev.slice(0, -1));\n    lastPushRef.current = previous;\n    ui.executeCommand(previous, {\n      triggerElement: triggerElement,\n      position: position,\n    });\n  };\n\n  const renderCommandItem = (command: ResolvedMenuItem, index: number) => {\n    if (command.type === 'group') {\n      const group = command as Group;\n      const groupChildren = ui.getItemsByIds(group.children);\n\n      return (\n        <Fragment key={command.id}>\n          <div className=\"px-4 py-3 text-xs font-medium uppercase text-gray-600\">{group.label}</div>\n          {groupChildren.map((child, childIndex) => (\n            <Fragment key={child.id}>{renderCommandItem(child, childIndex)}</Fragment>\n          ))}\n          <hr className=\"my-2 border-gray-200\" />\n        </Fragment>\n      );\n    }\n\n    const divider =\n      command.dividerBefore && index !== 0 ? <hr className=\"my-2 border-gray-200\" /> : null;\n\n    return (\n      <Fragment key={command.id}>\n        {divider}\n        <button\n          disabled={command.disabled ? true : false}\n          onClick={() => handleCommandClick(command)}\n          className={`flex cursor-pointer flex-row items-center justify-between gap-2 px-4 py-1 ${command.type === 'menu' ? 'menu-item' : ''} ${command.active && !command.disabled ? 'bg-blue-500 text-white' : 'text-gray-500 hover:bg-blue-900 hover:text-white'} ${command.disabled ? 'pointer-events-none cursor-not-allowed opacity-50' : ''} `}\n        >\n          <div className=\"flex flex-row items-center gap-2\">\n            <div className=\"flex h-6 w-6 items-center justify-center\">\n              {command.icon && <Icon icon={command.icon} className=\"h-6 w-6\" />}\n            </div>\n            <div className=\"text-sm\">{command.label}</div>\n          </div>\n          <div className=\"flex items-center\">\n            {command.shortcutLabel && <div className=\"mr-2 text-sm\">({command.shortcutLabel})</div>}\n            {command.type === 'menu' && <Icon icon=\"chevronRight\" className=\"h-6 w-6\" />}\n          </div>\n        </button>\n      </Fragment>\n    );\n  };\n\n  const menuContent = (\n    <Fragment>\n      {history.length > 0 && (\n        <div\n          onClick={goBack}\n          className=\"flex cursor-pointer flex-row items-center gap-2 px-4 py-1 pb-2 text-sm font-medium text-gray-500 hover:bg-gray-100\"\n        >\n          <Icon icon=\"chevronLeft\" className=\"h-6 w-6 text-gray-500\" /> {currentMenu?.label}\n        </div>\n      )}\n      {items?.map((item, index) => renderCommandItem(item, index))}\n    </Fragment>\n  );\n\n  if (!open) return null;\n\n  // Render as Dropdown if there's a triggerElement, otherwise as SwipeableDrawer\n  return (\n    <Dropdown\n      trigger={triggerElement}\n      open={open}\n      placement={position || 'bottom'}\n      className=\"@max-[600px]:!bottom-0 @max-[600px]:!top-auto @max-[600px]:!left-0 @max-[600px]:!right-0\"\n      onShow={() => {}}\n      onHide={handleHide}\n    >\n      {menuContent}\n    </Dropdown>\n  );\n};\n\nexport const commentRender: ComponentRenderFunction<any> = (props, children) => {\n  return <div>Comments</div>;\n};\n\nexport interface ThumbnailsRenderProps {\n  currentPage: number;\n}\n\nexport const thumbnailsRender: ComponentRenderFunction<ThumbnailsRenderProps> = (\n  props,\n  children,\n) => {\n  const { provides: scroll } = useScrollCapability();\n\n  return (\n    <ThumbnailsPane className=\"flex-1\" selectedPage={props.currentPage}>\n      {(m) => (\n        <div\n          key={m.pageIndex}\n          className=\"absolute flex w-full cursor-pointer flex-col items-center\"\n          style={{ height: m.wrapperHeight, top: m.top }}\n          onClick={() => {\n            scroll?.scrollToPage({\n              pageNumber: m.pageIndex + 1,\n            });\n          }}\n        >\n          {/* thumbnail box */}\n          <div\n            style={{ width: m.width, height: m.height }}\n            className={`outline outline-2 -outline-offset-2 ${props.currentPage === m.pageIndex + 1 ? 'outline-blue-500' : 'outline-gray-300'}`}\n          >\n            <ThumbImg meta={m} className=\"h-full w-full object-contain\" />\n          </div>\n\n          {/* label box with fixed height = labelHeight */}\n          <div\n            className=\"flex items-center justify-center text-xs text-gray-500\"\n            style={{ height: m.labelHeight }}\n          >\n            {m.pageIndex + 1}\n          </div>\n        </div>\n      )}\n    </ThumbnailsPane>\n  );\n};\n\ninterface OutlineRenderProps {\n  document: PdfDocumentObject;\n}\n\nexport const outlineRenderer: ComponentRenderFunction<OutlineRenderProps> = (props, children) => {\n  const { provides: bookmark } = useBookmarkCapability();\n  const { provides: scroll } = useScrollCapability();\n  const [bookmarks, setBookmarks] = useState<PdfBookmarkObject[]>([]);\n  const [expandedItems, setExpandedItems] = useState<Set<string>>(new Set());\n\n  useEffect(() => {\n    if (!bookmark) return;\n    const task = bookmark.getBookmarks();\n    task.wait(({ bookmarks }) => {\n      setBookmarks(bookmarks);\n      // Auto-expand first level items\n      const firstLevelIds = bookmarks.map((_, index) => `bookmark-${index}`);\n      setExpandedItems(new Set(firstLevelIds));\n    }, ignore);\n\n    return () => {\n      task.abort({\n        code: PdfErrorCode.Cancelled,\n        message: 'Bookmark task cancelled',\n      });\n    };\n  }, [bookmark, props.document]);\n\n  const handleBookmarkClick = (bookmark: PdfBookmarkObject) => {\n    if (!scroll || !bookmark.target || bookmark.target.type !== 'action') return;\n\n    const action = bookmark.target.action;\n    if (action.type === 1 && action.destination) {\n      // Type 1 is \"Go to destination\"\n\n      const destination = action.destination;\n\n      if (destination.zoom.mode === PdfZoomMode.XYZ) {\n        const page = props.document?.pages.find((p) => p.index === destination.pageIndex);\n        if (!page) return;\n\n        scroll.scrollToPage({\n          pageNumber: destination.pageIndex + 1, // Convert from 0-based to 1-based\n          pageCoordinates: destination.zoom.params\n            ? {\n                x: destination.zoom.params.x,\n                y: page.size.height - destination.zoom.params.y,\n              }\n            : undefined,\n          behavior: 'smooth',\n        });\n      } else if (destination.zoom.mode === PdfZoomMode.FitPage) {\n        scroll.scrollToPage({\n          pageNumber: destination.pageIndex + 1, // Convert from 0-based to 1-based\n          behavior: 'smooth',\n        });\n      }\n    }\n  };\n\n  const toggleExpanded = (itemId: string) => {\n    setExpandedItems((prev) => {\n      const newSet = new Set(prev);\n      if (newSet.has(itemId)) {\n        newSet.delete(itemId);\n      } else {\n        newSet.add(itemId);\n      }\n      return newSet;\n    });\n  };\n\n  const renderBookmarkItem = (bookmark: PdfBookmarkObject, index: number, level: number = 0) => {\n    const itemId = `bookmark-${index}`;\n    const hasChildren = bookmark.children && bookmark.children.length > 0;\n    const isExpanded = expandedItems.has(itemId);\n    const paddingLeft = level * 16 + 8; // 16px per level + 8px base padding\n\n    return (\n      <div key={itemId} className=\"outline-item\">\n        <div\n          className=\"flex cursor-pointer items-center py-1 pr-4 text-sm text-gray-700 hover:bg-gray-100\"\n          style={{ paddingLeft: `${paddingLeft}px` }}\n          onClick={() => handleBookmarkClick(bookmark)}\n        >\n          {hasChildren && (\n            <button\n              className=\"mr-1 flex h-4 w-4 items-center justify-center rounded hover:bg-gray-200\"\n              onClick={(e) => {\n                e.stopPropagation();\n                toggleExpanded(itemId);\n              }}\n            >\n              <Icon\n                icon={isExpanded ? 'chevronDown' : 'chevronRight'}\n                className=\"h-3 w-3 text-gray-500\"\n              />\n            </button>\n          )}\n          {!hasChildren && <div className=\"mr-1 w-4\" />}\n          <span className=\"flex-1 truncate\" title={bookmark.title}>\n            {bookmark.title}\n          </span>\n        </div>\n\n        {hasChildren && isExpanded && (\n          <div className=\"outline-children\">\n            {bookmark.children?.map((child, childIndex) =>\n              renderBookmarkItem(child, `${index}-${childIndex}` as any, level + 1),\n            )}\n          </div>\n        )}\n      </div>\n    );\n  };\n\n  if (bookmarks.length === 0) {\n    return (\n      <div className=\"flex h-full items-center justify-center p-6\">\n        <div className=\"text-center text-gray-500\">\n          <div className=\"text-sm\">No outline available</div>\n          <div className=\"mt-1 text-xs\">This document doesn't contain bookmarks</div>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex h-full flex-col bg-white\">\n      <div className=\"flex-1 overflow-y-auto\">\n        <div className=\"outline-tree\">\n          {bookmarks.map((bookmark, index) => renderBookmarkItem(bookmark, index))}\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport const attachmentsRenderer: ComponentRenderFunction<any> = (props, children) => {\n  return <div>Attachments</div>;\n};\n\nexport const selectButtonRenderer: ComponentRenderFunction<SelectButtonProps> = (\n  { activeCommandId, menuCommandId, active },\n  children,\n) => {\n  const { provides: ui } = useUICapability();\n  if (!ui) return null;\n\n  const activeCommand = ui.getMenuOrAction(activeCommandId);\n\n  const handleClick = useCallback(\n    (e: MouseEvent) => {\n      e.preventDefault();\n      e.stopPropagation();\n\n      if (!ui || !menuCommandId) return;\n\n      const triggerElement = e.currentTarget as HTMLElement;\n\n      ui.executeCommand(menuCommandId, {\n        source: 'click',\n        triggerElement: triggerElement,\n      });\n    },\n    [menuCommandId, ui],\n  );\n\n  return (\n    <div style={{ maxWidth: '100px', width: '100px' }}>\n      <Button\n        className={`col-start-1 row-start-1 !w-full appearance-none rounded-md bg-white py-1.5 pl-3 pr-2 text-[13px] text-gray-900 ${active ? 'text-blue-500 outline outline-2 -outline-offset-2 outline-blue-500' : 'outline outline-1 -outline-offset-1 outline-gray-300'} flex flex-row items-center justify-between gap-2 hover:ring-transparent`}\n        onClick={handleClick}\n      >\n        <span className=\"min-w-0 flex-1 truncate text-left\">{activeCommand?.label}</span>\n        <Icon icon=\"chevronDown\" className=\"h-4 w-4 text-gray-500\" />\n      </Button>\n    </div>\n  );\n};\n\nexport interface PrintModalProps {\n  open: boolean;\n}\n\nexport const printModalRenderer: ComponentRenderFunction<PrintModalProps> = (props, children) => {\n  const { provides: ui } = useUICapability();\n  const { provides: scroll } = useScrollCapability();\n  const { executePrint, parsePageRange, progress, isReady, isPrinting } = usePrintAction();\n  const [pageRangeType, setPageRangeType] = useState<PageRangeType>(PageRangeType.All);\n  const [customPages, setCustomPages] = useState('');\n  const [includeAnnotations, setIncludeAnnotations] = useState(true);\n  const [quality, setQuality] = useState<PrintQuality>(PrintQuality.Normal);\n  const [customPagesError, setCustomPagesError] = useState<string>('');\n\n  if (!ui) return null;\n\n  if (!props.open) return null;\n\n  // Get current page and total pages\n  const scrollMetrics = scroll?.getMetrics();\n  const currentPage = scrollMetrics?.currentPage || 1;\n  const totalPages = scrollMetrics?.pageVisibilityMetrics?.length || 0;\n\n  const handleClose = () => {\n    ui.updateComponentState({\n      componentType: 'floating',\n      componentId: 'printModal',\n      patch: {\n        open: false,\n      },\n    });\n  };\n\n  const handlePageRangeChange = (type: PageRangeType) => {\n    setPageRangeType(type);\n    setCustomPagesError('');\n  };\n\n  const handleCustomPagesChange = (e: Event) => {\n    const target = e.target as HTMLInputElement;\n    const value = target.value;\n    setCustomPages(value);\n\n    if (value.trim()) {\n      const parsed = parsePageRange(value);\n      if (!parsed.isValid) {\n        setCustomPagesError(parsed.error || 'Invalid page range');\n      } else {\n        setCustomPagesError('');\n      }\n    } else {\n      setCustomPagesError('');\n    }\n  };\n\n  const handlePrint = async () => {\n    let pageRange: PageRange;\n\n    switch (pageRangeType) {\n      case PageRangeType.Current:\n        pageRange = {\n          type: PageRangeType.Current,\n          currentPage: currentPage - 1, // Convert to 0-based index\n        };\n        break;\n      case PageRangeType.All:\n        pageRange = {\n          type: PageRangeType.All,\n        };\n        break;\n      case PageRangeType.Custom:\n        if (!customPages.trim()) {\n          setCustomPagesError('Please enter page numbers');\n          return;\n        }\n        const parsed = parsePageRange(customPages);\n        if (!parsed.isValid) {\n          setCustomPagesError(parsed.error || 'Invalid page range');\n          return;\n        }\n        pageRange = {\n          type: PageRangeType.Custom,\n          pages: parsed.pages,\n        };\n        break;\n      default:\n        return;\n    }\n\n    const printOptions: PrintOptions = {\n      pageRange,\n      includeAnnotations,\n      quality,\n    };\n\n    try {\n      await executePrint(printOptions);\n      // Close modal after successful print\n      handleClose();\n    } catch (error) {\n      console.error('Print failed:', error);\n    }\n  };\n\n  const isCustomPagesValid =\n    pageRangeType !== PageRangeType.Custom || (customPages.trim() && !customPagesError);\n\n  return (\n    <Dialog open={props.open} title=\"Print Settings\" onClose={handleClose} maxWidth=\"28rem\">\n      <div className=\"space-y-6\">\n        {/* Pages to print */}\n        <div>\n          <label className=\"mb-3 block text-sm font-medium text-gray-700\">Pages to print</label>\n          <div className=\"space-y-2\">\n            <label className=\"flex items-center\">\n              <input\n                type=\"radio\"\n                name=\"pageRange\"\n                value=\"all\"\n                checked={pageRangeType === PageRangeType.All}\n                onChange={() => handlePageRangeChange(PageRangeType.All)}\n                className=\"mr-2\"\n              />\n              <span className=\"text-sm\">All pages</span>\n            </label>\n            <label className=\"flex items-center\">\n              <input\n                type=\"radio\"\n                name=\"pageRange\"\n                value=\"current\"\n                checked={pageRangeType === PageRangeType.Current}\n                onChange={() => handlePageRangeChange(PageRangeType.Current)}\n                className=\"mr-2\"\n              />\n              <span className=\"text-sm\">Current page ({currentPage})</span>\n            </label>\n            <label className=\"flex items-start\">\n              <input\n                type=\"radio\"\n                name=\"pageRange\"\n                value=\"custom\"\n                checked={pageRangeType === PageRangeType.Custom}\n                onChange={() => handlePageRangeChange(PageRangeType.Custom)}\n                className=\"mr-2 mt-0.5\"\n              />\n              <div className=\"flex-1\">\n                <span className=\"mb-1 block text-sm\">Specify pages</span>\n                <input\n                  type=\"text\"\n                  placeholder=\"e.g., 1-3, 5, 8-10\"\n                  value={customPages}\n                  onInput={handleCustomPagesChange}\n                  disabled={pageRangeType !== PageRangeType.Custom}\n                  className={`w-full rounded-md border px-3 py-1 text-sm ${\n                    pageRangeType !== PageRangeType.Custom\n                      ? 'bg-gray-100 text-gray-500'\n                      : customPagesError\n                        ? 'border-red-500 focus:border-red-500 focus:ring-red-500'\n                        : 'border-gray-300 focus:border-blue-500 focus:ring-blue-500'\n                  } focus:outline-none focus:ring-1`}\n                />\n                {customPagesError && (\n                  <p className=\"mt-1 text-xs text-red-500\">{customPagesError}</p>\n                )}\n                {pageRangeType === PageRangeType.Custom &&\n                  !customPagesError &&\n                  customPages.trim() && (\n                    <p className=\"mt-1 text-xs text-gray-500\">Total pages: {totalPages}</p>\n                  )}\n              </div>\n            </label>\n          </div>\n        </div>\n\n        {/* Include annotations */}\n        <div>\n          <label className=\"flex items-center\">\n            <input\n              type=\"checkbox\"\n              checked={includeAnnotations}\n              onChange={(e) => setIncludeAnnotations((e.target as HTMLInputElement).checked)}\n              className=\"mr-2\"\n            />\n            <span className=\"text-sm font-medium text-gray-700\">Include annotations</span>\n          </label>\n        </div>\n\n        {/* Print Quality */}\n        <div>\n          <label className=\"mb-2 block text-sm font-medium text-gray-700\">Print Quality</label>\n          <div className=\"relative\">\n            <select\n              value={quality}\n              onChange={(e) => setQuality((e.target as HTMLSelectElement).value as PrintQuality)}\n              className=\"w-full appearance-none rounded-md border border-gray-300 bg-white px-3 py-2 pr-8 text-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500\"\n            >\n              <option value={PrintQuality.Normal}>Normal</option>\n              <option value={PrintQuality.High}>High</option>\n            </select>\n            <div className=\"pointer-events-none absolute inset-y-0 right-3 flex items-center\">\n              <svg\n                className=\"h-4 w-4 text-gray-400\"\n                fill=\"none\"\n                stroke=\"currentColor\"\n                viewBox=\"0 0 24 24\"\n              >\n                <path\n                  strokeLinecap=\"round\"\n                  strokeLinejoin=\"round\"\n                  strokeWidth={2}\n                  d=\"M19 9l-7 7-7-7\"\n                />\n              </svg>\n            </div>\n          </div>\n        </div>\n\n        {/* Progress indicator */}\n        {isPrinting && progress && (\n          <div className=\"rounded-md border border-blue-200 bg-blue-50 p-3\">\n            <div className=\"mb-2 flex items-center justify-between\">\n              <span className=\"text-sm font-medium text-blue-900\">\n                {progress.status === 'preparing' && 'Preparing...'}\n                {progress.status === 'rendering' && 'Rendering pages...'}\n                {progress.status === 'complete' && 'Complete!'}\n                {progress.status === 'error' && 'Error'}\n              </span>\n              <span className=\"text-sm text-blue-700\">\n                {progress.current}/{progress.total}\n              </span>\n            </div>\n            <div className=\"h-2 w-full rounded-full bg-blue-200\">\n              <div\n                className=\"h-2 rounded-full bg-blue-600 transition-all duration-300\"\n                style={{ width: `${(progress.current / progress.total) * 100}%` }}\n              />\n            </div>\n            {progress.message && <p className=\"mt-2 text-sm text-blue-700\">{progress.message}</p>}\n          </div>\n        )}\n\n        {/* Action buttons */}\n        <div className=\"flex justify-end space-x-3 border-t border-gray-200 pt-4\">\n          <Button\n            onClick={handleClose}\n            className=\"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm text-gray-700 hover:bg-gray-50\"\n            disabled={isPrinting}\n          >\n            Cancel\n          </Button>\n          <Button\n            onClick={handlePrint}\n            disabled={isPrinting || !isCustomPagesValid}\n            className=\"rounded-md border border-transparent bg-blue-600 px-4 py-2 text-sm text-white hover:!bg-blue-700 disabled:cursor-not-allowed disabled:opacity-50\"\n          >\n            {isPrinting ? 'Printing...' : 'Print'}\n          </Button>\n        </div>\n      </div>\n    </Dialog>\n  );\n};\n","import { useEffect, useRef, useState } from 'preact/hooks';\n\nexport const useSwipeGesture = (isOpen: boolean) => {\n  const [isFullscreen, setIsFullscreen] = useState(false);\n  const startY = useRef(0);\n  const currentY = useRef(0);\n  const elementRef = useRef<HTMLDivElement>(null);\n  const isDragging = useRef(false);\n\n  // Reset state when panel closes\n  useEffect(() => {\n    if (!isOpen) {\n      setIsFullscreen(false);\n      isDragging.current = false;\n    }\n  }, [isOpen]);\n\n  // Set up gesture handlers only when panel is open\n  useEffect(() => {\n    if (!isOpen) return;\n\n    const element = elementRef.current;\n    if (!element) {\n      return;\n    }\n\n    const handleStart = (e: TouchEvent | MouseEvent) => {\n      isDragging.current = true;\n      startY.current = 'touches' in e ? e.touches[0].clientY : e.clientY;\n      currentY.current = startY.current;\n    };\n\n    const handleMove = (e: TouchEvent | MouseEvent) => {\n      if (!isDragging.current) return;\n\n      currentY.current = 'touches' in e ? e.touches[0].clientY : e.clientY;\n      const deltaY = currentY.current - startY.current;\n\n      // Reduced threshold to 15 pixels for more responsive feel\n      if (deltaY < -2 && !isFullscreen) {\n        setIsFullscreen(true);\n        isDragging.current = false;\n      } else if (deltaY > 2 && isFullscreen) {\n        setIsFullscreen(false);\n        isDragging.current = false;\n      }\n    };\n\n    const handleEnd = () => {\n      isDragging.current = false;\n    };\n\n    // Touch events\n    element.addEventListener('touchstart', handleStart);\n    element.addEventListener('touchmove', handleMove);\n    element.addEventListener('touchend', handleEnd);\n    element.addEventListener('touchcancel', handleEnd);\n\n    // Mouse events\n    element.addEventListener('mousedown', handleStart);\n    element.addEventListener('mousemove', handleMove);\n    element.addEventListener('mouseup', handleEnd);\n    element.addEventListener('mouseleave', handleEnd);\n\n    return () => {\n      // Clean up touch events\n      element.removeEventListener('touchstart', handleStart);\n      element.removeEventListener('touchmove', handleMove);\n      element.removeEventListener('touchend', handleEnd);\n      element.removeEventListener('touchcancel', handleEnd);\n\n      // Clean up mouse events\n      element.removeEventListener('mousedown', handleStart);\n      element.removeEventListener('mousemove', handleMove);\n      element.removeEventListener('mouseup', handleEnd);\n      element.removeEventListener('mouseleave', handleEnd);\n    };\n  }, [isOpen, isFullscreen]); // Depend on isOpen instead of elementRef.current\n\n  return { elementRef, isFullscreen };\n};\n","// src/lib/manifest.ts\nvar ANNOTATION_PLUGIN_ID = \"annotation\";\nvar manifest = {\n  id: ANNOTATION_PLUGIN_ID,\n  name: \"Annotation Plugin\",\n  version: \"1.0.0\",\n  provides: [\"annotation\"],\n  requires: [\"interaction-manager\", \"selection\"],\n  optional: [\"history\"],\n  defaultConfig: {\n    enabled: true,\n    autoCommit: true\n  }\n};\n\n// ../models/dist/index.js\nvar Rotation = /* @__PURE__ */ ((Rotation2) => {\n  Rotation2[Rotation2[\"Degree0\"] = 0] = \"Degree0\";\n  Rotation2[Rotation2[\"Degree90\"] = 1] = \"Degree90\";\n  Rotation2[Rotation2[\"Degree180\"] = 2] = \"Degree180\";\n  Rotation2[Rotation2[\"Degree270\"] = 3] = \"Degree270\";\n  return Rotation2;\n})(Rotation || {});\nvar TaskAbortedError = class extends Error {\n  constructor(reason) {\n    super(`Task aborted: ${JSON.stringify(reason)}`);\n    this.name = \"TaskAbortedError\";\n  }\n};\nvar TaskRejectedError = class extends Error {\n  constructor(reason) {\n    super(`Task rejected: ${JSON.stringify(reason)}`);\n    this.name = \"TaskRejectedError\";\n  }\n};\nvar Task = class _Task {\n  constructor() {\n    this.state = {\n      stage: 0\n      /* Pending */\n    };\n    this.resolvedCallbacks = [];\n    this.rejectedCallbacks = [];\n    this._promise = null;\n  }\n  /**\n   * Convert task to promise\n   * @returns promise that will be resolved when task is settled\n   */\n  toPromise() {\n    if (!this._promise) {\n      this._promise = new Promise((resolve, reject) => {\n        this.wait(\n          (result) => resolve(result),\n          (error) => {\n            if (error.type === \"abort\") {\n              reject(new TaskAbortedError(error.reason));\n            } else {\n              reject(new TaskRejectedError(error.reason));\n            }\n          }\n        );\n      });\n    }\n    return this._promise;\n  }\n  /**\n   * wait for task to be settled\n   * @param resolvedCallback - callback for resolved value\n   * @param rejectedCallback - callback for rejected value\n   */\n  wait(resolvedCallback, rejectedCallback) {\n    switch (this.state.stage) {\n      case 0:\n        this.resolvedCallbacks.push(resolvedCallback);\n        this.rejectedCallbacks.push(rejectedCallback);\n        break;\n      case 1:\n        resolvedCallback(this.state.result);\n        break;\n      case 2:\n        rejectedCallback({\n          type: \"reject\",\n          reason: this.state.reason\n        });\n        break;\n      case 3:\n        rejectedCallback({\n          type: \"abort\",\n          reason: this.state.reason\n        });\n        break;\n    }\n  }\n  /**\n   * resolve task with specific result\n   * @param result - result value\n   */\n  resolve(result) {\n    if (this.state.stage === 0) {\n      this.state = {\n        stage: 1,\n        result\n      };\n      for (const resolvedCallback of this.resolvedCallbacks) {\n        try {\n          resolvedCallback(result);\n        } catch (e) {\n        }\n      }\n      this.resolvedCallbacks = [];\n      this.rejectedCallbacks = [];\n    }\n  }\n  /**\n   * reject task with specific reason\n   * @param reason - abort reason\n   *\n   */\n  reject(reason) {\n    if (this.state.stage === 0) {\n      this.state = {\n        stage: 2,\n        reason\n      };\n      for (const rejectedCallback of this.rejectedCallbacks) {\n        try {\n          rejectedCallback({\n            type: \"reject\",\n            reason\n          });\n        } catch (e) {\n        }\n      }\n      this.resolvedCallbacks = [];\n      this.rejectedCallbacks = [];\n    }\n  }\n  /**\n   * abort task with specific reason\n   * @param reason - abort reason\n   */\n  abort(reason) {\n    if (this.state.stage === 0) {\n      this.state = {\n        stage: 3,\n        reason\n      };\n      for (const rejectedCallback of this.rejectedCallbacks) {\n        try {\n          rejectedCallback({\n            type: \"abort\",\n            reason\n          });\n        } catch (e) {\n        }\n      }\n      this.resolvedCallbacks = [];\n      this.rejectedCallbacks = [];\n    }\n  }\n  /**\n   * fail task with a TaskError from another task\n   * This is a convenience method for error propagation between tasks\n   * @param error - TaskError from another task\n   */\n  fail(error) {\n    if (error.type === \"abort\") {\n      this.abort(error.reason);\n    } else {\n      this.reject(error.reason);\n    }\n  }\n  /**\n   * Static method to wait for all tasks to resolve\n   * Returns a new task that resolves with an array of all results\n   * Rejects immediately if any task fails\n   *\n   * @param tasks - array of tasks to wait for\n   * @returns new task that resolves when all input tasks resolve\n   * @public\n   */\n  static all(tasks) {\n    const combinedTask = new _Task();\n    if (tasks.length === 0) {\n      combinedTask.resolve([]);\n      return combinedTask;\n    }\n    const results = new Array(tasks.length);\n    let resolvedCount = 0;\n    let isSettled = false;\n    tasks.forEach((task, index) => {\n      task.wait(\n        (result) => {\n          if (isSettled) return;\n          results[index] = result;\n          resolvedCount++;\n          if (resolvedCount === tasks.length) {\n            isSettled = true;\n            combinedTask.resolve(results);\n          }\n        },\n        (error) => {\n          if (isSettled) return;\n          isSettled = true;\n          if (error.type === \"abort\") {\n            combinedTask.abort(error.reason);\n          } else {\n            combinedTask.reject(error.reason);\n          }\n        }\n      );\n    });\n    return combinedTask;\n  }\n  /**\n   * Static method to wait for all tasks to settle (resolve, reject, or abort)\n   * Always resolves with an array of settlement results\n   *\n   * @param tasks - array of tasks to wait for\n   * @returns new task that resolves when all input tasks settle\n   * @public\n   */\n  static allSettled(tasks) {\n    const combinedTask = new _Task();\n    if (tasks.length === 0) {\n      combinedTask.resolve([]);\n      return combinedTask;\n    }\n    const results = new Array(tasks.length);\n    let settledCount = 0;\n    tasks.forEach((task, index) => {\n      task.wait(\n        (result) => {\n          results[index] = { status: \"resolved\", value: result };\n          settledCount++;\n          if (settledCount === tasks.length) {\n            combinedTask.resolve(results);\n          }\n        },\n        (error) => {\n          results[index] = {\n            status: error.type === \"abort\" ? \"aborted\" : \"rejected\",\n            reason: error.reason\n          };\n          settledCount++;\n          if (settledCount === tasks.length) {\n            combinedTask.resolve(results);\n          }\n        }\n      );\n    });\n    return combinedTask;\n  }\n  /**\n   * Static method that resolves/rejects with the first task that settles\n   *\n   * @param tasks - array of tasks to race\n   * @returns new task that settles with the first input task that settles\n   * @public\n   */\n  static race(tasks) {\n    const combinedTask = new _Task();\n    if (tasks.length === 0) {\n      combinedTask.reject(\"No tasks provided\");\n      return combinedTask;\n    }\n    let isSettled = false;\n    tasks.forEach((task) => {\n      task.wait(\n        (result) => {\n          if (isSettled) return;\n          isSettled = true;\n          combinedTask.resolve(result);\n        },\n        (error) => {\n          if (isSettled) return;\n          isSettled = true;\n          if (error.type === \"abort\") {\n            combinedTask.abort(error.reason);\n          } else {\n            combinedTask.reject(error.reason);\n          }\n        }\n      );\n    });\n    return combinedTask;\n  }\n  /**\n   * Utility to track progress of multiple tasks\n   *\n   * @param tasks - array of tasks to track\n   * @param onProgress - callback called when any task completes\n   * @returns new task that resolves when all input tasks resolve\n   * @public\n   */\n  static withProgress(tasks, onProgress) {\n    const combinedTask = _Task.all(tasks);\n    if (onProgress) {\n      let completedCount = 0;\n      tasks.forEach((task) => {\n        task.wait(\n          () => {\n            completedCount++;\n            onProgress(completedCount, tasks.length);\n          },\n          () => {\n            completedCount++;\n            onProgress(completedCount, tasks.length);\n          }\n        );\n      });\n    }\n    return combinedTask;\n  }\n};\nvar PdfSoftHyphenMarker = \"\\xAD\";\nvar PdfZeroWidthSpace = \"\\u200B\";\nvar PdfWordJoiner = \"\\u2060\";\nvar PdfBomOrZwnbsp = \"\\uFEFF\";\nvar PdfNonCharacterFFFE = \"\\uFFFE\";\nvar PdfNonCharacterFFFF = \"\\uFFFF\";\nvar PdfUnwantedTextMarkers = Object.freeze([\n  PdfSoftHyphenMarker,\n  PdfZeroWidthSpace,\n  PdfWordJoiner,\n  PdfBomOrZwnbsp,\n  PdfNonCharacterFFFE,\n  PdfNonCharacterFFFF\n]);\nvar PdfUnwantedTextRegex = new RegExp(`[${PdfUnwantedTextMarkers.join(\"\")}]`, \"g\");\nvar PdfBlendMode = /* @__PURE__ */ ((PdfBlendMode2) => {\n  PdfBlendMode2[PdfBlendMode2[\"Normal\"] = 0] = \"Normal\";\n  PdfBlendMode2[PdfBlendMode2[\"Multiply\"] = 1] = \"Multiply\";\n  PdfBlendMode2[PdfBlendMode2[\"Screen\"] = 2] = \"Screen\";\n  PdfBlendMode2[PdfBlendMode2[\"Overlay\"] = 3] = \"Overlay\";\n  PdfBlendMode2[PdfBlendMode2[\"Darken\"] = 4] = \"Darken\";\n  PdfBlendMode2[PdfBlendMode2[\"Lighten\"] = 5] = \"Lighten\";\n  PdfBlendMode2[PdfBlendMode2[\"ColorDodge\"] = 6] = \"ColorDodge\";\n  PdfBlendMode2[PdfBlendMode2[\"ColorBurn\"] = 7] = \"ColorBurn\";\n  PdfBlendMode2[PdfBlendMode2[\"HardLight\"] = 8] = \"HardLight\";\n  PdfBlendMode2[PdfBlendMode2[\"SoftLight\"] = 9] = \"SoftLight\";\n  PdfBlendMode2[PdfBlendMode2[\"Difference\"] = 10] = \"Difference\";\n  PdfBlendMode2[PdfBlendMode2[\"Exclusion\"] = 11] = \"Exclusion\";\n  PdfBlendMode2[PdfBlendMode2[\"Hue\"] = 12] = \"Hue\";\n  PdfBlendMode2[PdfBlendMode2[\"Saturation\"] = 13] = \"Saturation\";\n  PdfBlendMode2[PdfBlendMode2[\"Color\"] = 14] = \"Color\";\n  PdfBlendMode2[PdfBlendMode2[\"Luminosity\"] = 15] = \"Luminosity\";\n  return PdfBlendMode2;\n})(PdfBlendMode || {});\nvar MixedBlendMode = Symbol(\"mixed\");\nvar BLEND_MODE_INFOS = Object.freeze([\n  { id: 0, label: \"Normal\", css: \"normal\" },\n  { id: 1, label: \"Multiply\", css: \"multiply\" },\n  { id: 2, label: \"Screen\", css: \"screen\" },\n  { id: 3, label: \"Overlay\", css: \"overlay\" },\n  { id: 4, label: \"Darken\", css: \"darken\" },\n  { id: 5, label: \"Lighten\", css: \"lighten\" },\n  { id: 6, label: \"Color Dodge\", css: \"color-dodge\" },\n  { id: 7, label: \"Color Burn\", css: \"color-burn\" },\n  { id: 8, label: \"Hard Light\", css: \"hard-light\" },\n  { id: 9, label: \"Soft Light\", css: \"soft-light\" },\n  { id: 10, label: \"Difference\", css: \"difference\" },\n  { id: 11, label: \"Exclusion\", css: \"exclusion\" },\n  { id: 12, label: \"Hue\", css: \"hue\" },\n  { id: 13, label: \"Saturation\", css: \"saturation\" },\n  { id: 14, label: \"Color\", css: \"color\" },\n  { id: 15, label: \"Luminosity\", css: \"luminosity\" }\n]);\nvar enumToInfo = BLEND_MODE_INFOS.reduce(\n  (m2, info) => {\n    m2[info.id] = info;\n    return m2;\n  },\n  {}\n);\nvar cssToEnum = BLEND_MODE_INFOS.reduce((m2, info) => {\n  m2[info.css] = info.id;\n  return m2;\n}, {});\nvar blendModeSelectOptions = BLEND_MODE_INFOS.map((info) => ({\n  value: info.id,\n  label: info.label\n}));\nvar PdfAnnotationSubtype = /* @__PURE__ */ ((PdfAnnotationSubtype2) => {\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"UNKNOWN\"] = 0] = \"UNKNOWN\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"TEXT\"] = 1] = \"TEXT\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"LINK\"] = 2] = \"LINK\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"FREETEXT\"] = 3] = \"FREETEXT\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"LINE\"] = 4] = \"LINE\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"SQUARE\"] = 5] = \"SQUARE\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"CIRCLE\"] = 6] = \"CIRCLE\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"POLYGON\"] = 7] = \"POLYGON\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"POLYLINE\"] = 8] = \"POLYLINE\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"HIGHLIGHT\"] = 9] = \"HIGHLIGHT\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"UNDERLINE\"] = 10] = \"UNDERLINE\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"SQUIGGLY\"] = 11] = \"SQUIGGLY\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"STRIKEOUT\"] = 12] = \"STRIKEOUT\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"STAMP\"] = 13] = \"STAMP\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"CARET\"] = 14] = \"CARET\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"INK\"] = 15] = \"INK\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"POPUP\"] = 16] = \"POPUP\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"FILEATTACHMENT\"] = 17] = \"FILEATTACHMENT\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"SOUND\"] = 18] = \"SOUND\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"MOVIE\"] = 19] = \"MOVIE\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"WIDGET\"] = 20] = \"WIDGET\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"SCREEN\"] = 21] = \"SCREEN\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"PRINTERMARK\"] = 22] = \"PRINTERMARK\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"TRAPNET\"] = 23] = \"TRAPNET\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"WATERMARK\"] = 24] = \"WATERMARK\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"THREED\"] = 25] = \"THREED\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"RICHMEDIA\"] = 26] = \"RICHMEDIA\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"XFAWIDGET\"] = 27] = \"XFAWIDGET\";\n  PdfAnnotationSubtype2[PdfAnnotationSubtype2[\"REDACT\"] = 28] = \"REDACT\";\n  return PdfAnnotationSubtype2;\n})(PdfAnnotationSubtype || {});\nvar AppearanceMode = /* @__PURE__ */ ((AppearanceMode2) => {\n  AppearanceMode2[AppearanceMode2[\"Normal\"] = 0] = \"Normal\";\n  AppearanceMode2[AppearanceMode2[\"Rollover\"] = 1] = \"Rollover\";\n  AppearanceMode2[AppearanceMode2[\"Down\"] = 2] = \"Down\";\n  return AppearanceMode2;\n})(AppearanceMode || {});\nvar PdfAnnotationFlagName = Object.freeze({\n  [\n    1\n    /* INVISIBLE */\n  ]: \"invisible\",\n  [\n    2\n    /* HIDDEN */\n  ]: \"hidden\",\n  [\n    4\n    /* PRINT */\n  ]: \"print\",\n  [\n    8\n    /* NO_ZOOM */\n  ]: \"noZoom\",\n  [\n    16\n    /* NO_ROTATE */\n  ]: \"noRotate\",\n  [\n    32\n    /* NO_VIEW */\n  ]: \"noView\",\n  [\n    64\n    /* READ_ONLY */\n  ]: \"readOnly\",\n  [\n    128\n    /* LOCKED */\n  ]: \"locked\",\n  [\n    256\n    /* TOGGLE_NOVIEW */\n  ]: \"toggleNoView\"\n});\nvar PdfAnnotationFlagValue = Object.entries(\n  PdfAnnotationFlagName\n).reduce(\n  (acc, [bit, name]) => {\n    acc[name] = Number(bit);\n    return acc;\n  },\n  {}\n);\nvar PdfErrorCode = /* @__PURE__ */ ((PdfErrorCode2) => {\n  PdfErrorCode2[PdfErrorCode2[\"Ok\"] = 0] = \"Ok\";\n  PdfErrorCode2[PdfErrorCode2[\"Unknown\"] = 1] = \"Unknown\";\n  PdfErrorCode2[PdfErrorCode2[\"NotFound\"] = 2] = \"NotFound\";\n  PdfErrorCode2[PdfErrorCode2[\"WrongFormat\"] = 3] = \"WrongFormat\";\n  PdfErrorCode2[PdfErrorCode2[\"Password\"] = 4] = \"Password\";\n  PdfErrorCode2[PdfErrorCode2[\"Security\"] = 5] = \"Security\";\n  PdfErrorCode2[PdfErrorCode2[\"PageError\"] = 6] = \"PageError\";\n  PdfErrorCode2[PdfErrorCode2[\"XFALoad\"] = 7] = \"XFALoad\";\n  PdfErrorCode2[PdfErrorCode2[\"XFALayout\"] = 8] = \"XFALayout\";\n  PdfErrorCode2[PdfErrorCode2[\"Cancelled\"] = 9] = \"Cancelled\";\n  PdfErrorCode2[PdfErrorCode2[\"Initialization\"] = 10] = \"Initialization\";\n  PdfErrorCode2[PdfErrorCode2[\"NotReady\"] = 11] = \"NotReady\";\n  PdfErrorCode2[PdfErrorCode2[\"NotSupport\"] = 12] = \"NotSupport\";\n  PdfErrorCode2[PdfErrorCode2[\"LoadDoc\"] = 13] = \"LoadDoc\";\n  PdfErrorCode2[PdfErrorCode2[\"DocNotOpen\"] = 14] = \"DocNotOpen\";\n  PdfErrorCode2[PdfErrorCode2[\"CantCloseDoc\"] = 15] = \"CantCloseDoc\";\n  PdfErrorCode2[PdfErrorCode2[\"CantCreateNewDoc\"] = 16] = \"CantCreateNewDoc\";\n  PdfErrorCode2[PdfErrorCode2[\"CantImportPages\"] = 17] = \"CantImportPages\";\n  PdfErrorCode2[PdfErrorCode2[\"CantCreateAnnot\"] = 18] = \"CantCreateAnnot\";\n  PdfErrorCode2[PdfErrorCode2[\"CantSetAnnotRect\"] = 19] = \"CantSetAnnotRect\";\n  PdfErrorCode2[PdfErrorCode2[\"CantSetAnnotContent\"] = 20] = \"CantSetAnnotContent\";\n  PdfErrorCode2[PdfErrorCode2[\"CantRemoveInkList\"] = 21] = \"CantRemoveInkList\";\n  PdfErrorCode2[PdfErrorCode2[\"CantAddInkStoke\"] = 22] = \"CantAddInkStoke\";\n  PdfErrorCode2[PdfErrorCode2[\"CantReadAttachmentSize\"] = 23] = \"CantReadAttachmentSize\";\n  PdfErrorCode2[PdfErrorCode2[\"CantReadAttachmentContent\"] = 24] = \"CantReadAttachmentContent\";\n  PdfErrorCode2[PdfErrorCode2[\"CantFocusAnnot\"] = 25] = \"CantFocusAnnot\";\n  PdfErrorCode2[PdfErrorCode2[\"CantSelectText\"] = 26] = \"CantSelectText\";\n  PdfErrorCode2[PdfErrorCode2[\"CantSelectOption\"] = 27] = \"CantSelectOption\";\n  PdfErrorCode2[PdfErrorCode2[\"CantCheckField\"] = 28] = \"CantCheckField\";\n  return PdfErrorCode2;\n})(PdfErrorCode || {});\nvar PdfTaskHelper = class {\n  /**\n   * Create a task\n   * @returns new task\n   */\n  static create() {\n    return new Task();\n  }\n  /**\n   * Create a task that has been resolved with value\n   * @param result - resolved value\n   * @returns resolved task\n   */\n  static resolve(result) {\n    const task = new Task();\n    task.resolve(result);\n    return task;\n  }\n  /**\n   * Create a task that has been rejected with error\n   * @param reason - rejected error\n   * @returns rejected task\n   */\n  static reject(reason) {\n    const task = new Task();\n    task.reject(reason);\n    return task;\n  }\n  /**\n   * Create a task that has been aborted with error\n   * @param reason - aborted error\n   * @returns aborted task\n   */\n  static abort(reason) {\n    const task = new Task();\n    task.reject(reason);\n    return task;\n  }\n};\nfunction ignore() {\n}\n\n// ../core/dist/index.js\nvar m = \"SET_DOCUMENT\";\nvar Z = class {\n  constructor(t, e) {\n    if (this.id = t, this.registry = e, this.debouncedActions = {}, this.unsubscribeFromState = null, this.unsubscribeFromCoreStore = null, t !== this.constructor.id)\n      throw new Error(\n        `Plugin ID mismatch: ${t} !== ${this.constructor.id}`\n      );\n    this.coreStore = this.registry.getStore(), this.pluginStore = this.coreStore.getPluginStore(this.id), this.unsubscribeFromState = this.pluginStore.subscribeToState((i, r, n) => {\n      this.onStoreUpdated(n, r);\n    }), this.unsubscribeFromCoreStore = this.coreStore.subscribe((i, r, n) => {\n      this.onCoreStoreUpdated(n, r);\n    }), this.readyPromise = new Promise((i) => {\n      this.readyResolve = i;\n    }), this.readyResolve();\n  }\n  provides() {\n    if (!this._capability) {\n      const t = this.buildCapability();\n      this._capability = Object.freeze(t);\n    }\n    return this._capability;\n  }\n  /**\n   *  Get a copy of the current state\n   */\n  get state() {\n    return this.pluginStore.getState();\n  }\n  /**\n   *  Get a copy of the current core state\n   */\n  get coreState() {\n    return this.coreStore.getState();\n  }\n  /**\n   * @deprecated  use `this.state` Get a copy of the current state\n   */\n  getState() {\n    return this.pluginStore.getState();\n  }\n  /**\n   * @deprecated  use `this.coreState` Get a copy of the current core state\n   */\n  getCoreState() {\n    return this.coreStore.getState();\n  }\n  /**\n   * Core Dispatch\n   */\n  dispatchCoreAction(t) {\n    return this.coreStore.dispatchToCore(t);\n  }\n  /**\n   * Dispatch an action to all plugins\n   */\n  dispatchToAllPlugins(t) {\n    return this.coreStore.dispatch(t);\n  }\n  /**\n   * Dispatch an action\n   */\n  dispatch(t) {\n    return this.pluginStore.dispatch(t);\n  }\n  /**\n   * Dispatch an action with debouncing to prevent rapid repeated calls\n   * @param action The action to dispatch\n   * @param debounceTime Time in ms to debounce (default: 100ms)\n   * @returns boolean indicating whether the action was dispatched or debounced\n   */\n  debouncedDispatch(t, e = 100) {\n    const i = Date.now(), r = this.debouncedActions[t.type] || 0;\n    return i - r >= e ? (this.debouncedActions[t.type] = i, this.dispatch(t), true) : false;\n  }\n  /**\n   * Subscribe to state changes\n   */\n  subscribe(t) {\n    return this.pluginStore.subscribeToState(t);\n  }\n  /**\n   * Subscribe to core store changes\n   */\n  subscribeToCoreStore(t) {\n    return this.coreStore.subscribe(t);\n  }\n  /**\n   * Called when the plugin store state is updated\n   * @param oldState Previous state\n   * @param newState New state\n   */\n  onStoreUpdated(t, e) {\n  }\n  /**\n   * Called when the core store state is updated\n   * @param oldState Previous state\n   * @param newState New state\n   */\n  onCoreStoreUpdated(t, e) {\n  }\n  /**\n   * Cleanup method to be called when plugin is being destroyed\n   */\n  destroy() {\n    this.unsubscribeFromState && (this.unsubscribeFromState(), this.unsubscribeFromState = null), this.unsubscribeFromCoreStore && (this.unsubscribeFromCoreStore(), this.unsubscribeFromCoreStore = null);\n  }\n  /**\n   * Returns a promise that resolves when the plugin is ready\n   */\n  ready() {\n    return this.readyPromise;\n  }\n  /**\n   * Mark the plugin as ready\n   */\n  markReady() {\n    this.readyResolve();\n  }\n  /**\n   * Reset the ready state (useful for plugins that need to reinitialize)\n   */\n  resetReady() {\n    this.readyPromise = new Promise((t) => {\n      this.readyResolve = t;\n    });\n  }\n};\nvar N = class {\n  constructor(t, e) {\n    this.handler = t, this.options = e, this.lastRun = 0, this.handle = (i) => {\n      this.options.mode === \"debounce\" ? this.debounce(i) : this.throttle(i);\n    };\n  }\n  debounce(t) {\n    this.timeoutId && window.clearTimeout(this.timeoutId), this.timeoutId = window.setTimeout(() => {\n      this.handler(t), this.timeoutId = void 0;\n    }, this.options.wait);\n  }\n  throttle(t) {\n    if (this.options.mode === \"debounce\") return;\n    const e = Date.now(), i = this.options.throttleMode || \"leading-trailing\";\n    e - this.lastRun >= this.options.wait && (i === \"leading-trailing\" && this.handler(t), this.lastRun = e), this.timeoutId && window.clearTimeout(this.timeoutId), this.timeoutId = window.setTimeout(\n      () => {\n        this.handler(t), this.lastRun = Date.now(), this.timeoutId = void 0;\n      },\n      this.options.wait - (e - this.lastRun)\n    );\n  }\n  destroy() {\n    this.timeoutId && window.clearTimeout(this.timeoutId);\n  }\n};\nfunction f(s, t, e) {\n  if (s === t)\n    return true;\n  if (s == null || t == null)\n    return s === t;\n  const i = typeof s;\n  if (i !== typeof t) return false;\n  if (i === \"object\") {\n    e || (e = /* @__PURE__ */ new Set());\n    const n = F(s, t);\n    if (e.has(n))\n      return true;\n    e.add(n);\n    const o = Array.isArray(s), a = Array.isArray(t);\n    return o && a ? q(s, t, e) : !o && !a ? I(s, t, e) : false;\n  }\n  return false;\n}\nfunction F(s, t) {\n  return `${v(s)}__${v(t)}`;\n}\nvar k = 0;\nvar w = /* @__PURE__ */ new WeakMap();\nfunction v(s) {\n  return w.has(s) || w.set(s, ++k), w.get(s);\n}\nfunction q(s, t, e) {\n  if (s.length !== t.length) return false;\n  const i = new Array(t.length).fill(false);\n  t: for (let r = 0; r < s.length; r++) {\n    const n = s[r];\n    for (let o = 0; o < t.length; o++)\n      if (!i[o] && f(n, t[o], e)) {\n        i[o] = true;\n        continue t;\n      }\n    return false;\n  }\n  return true;\n}\nfunction I(s, t, e) {\n  const i = Object.keys(s).sort(), r = Object.keys(t).sort();\n  if (i.length !== r.length) return false;\n  for (let n = 0; n < i.length; n++)\n    if (i[n] !== r[n]) return false;\n  for (const n of i) {\n    const o = s[n], a = t[n];\n    if (!f(o, a, e))\n      return false;\n  }\n  return true;\n}\nfunction it(s, t = f) {\n  const e = /* @__PURE__ */ new Set(), i = /* @__PURE__ */ new Map();\n  let r = s;\n  const n = (a) => e.forEach((l) => l(a)), o = (a, l) => {\n    let h = a, g = () => {\n    };\n    if (l) {\n      const c = new N(a, l);\n      h = c.handle, g = () => c.destroy(), i.set(a, { wrapped: h, destroy: g });\n    }\n    return r !== void 0 && h(r), e.add(h), () => {\n      e.delete(h), g(), i.delete(a);\n    };\n  };\n  return {\n    /* emitter behaviour ---------------------------------------- */\n    get value() {\n      return r;\n    },\n    emit(a = void 0) {\n      (r === void 0 || !t(r, a)) && (r = a, n(a));\n    },\n    on: o,\n    off(a) {\n      const l = i.get(a);\n      l ? (e.delete(l.wrapped), l.destroy(), i.delete(a)) : e.delete(a);\n    },\n    clear() {\n      e.clear(), i.forEach((a) => a.destroy()), i.clear();\n    },\n    /* derived hook --------------------------------------------- */\n    select(a, l = f) {\n      return (h, g) => {\n        let c;\n        if (r !== void 0) {\n          const p = a(r);\n          c = p, h(p);\n        }\n        return o(\n          (p) => {\n            const y = a(p);\n            (c === void 0 || !l(c, y)) && (c = y, h(y));\n          },\n          g\n        );\n      };\n    }\n  };\n}\n\n// src/lib/actions.ts\nvar SET_ANNOTATIONS = \"ANNOTATION/SET_ANNOTATIONS\";\nvar REINDEX_PAGE_ANNOTATIONS = \"ANNOTATION/REINDEX_PAGE\";\nvar SELECT_ANNOTATION = \"ANNOTATION/SELECT_ANNOTATION\";\nvar DESELECT_ANNOTATION = \"ANNOTATION/DESELECT_ANNOTATION\";\nvar UPDATE_TOOL_DEFAULTS = \"ANNOTATION/UPDATE_TOOL_DEFAULTS\";\nvar ADD_COLOR_PRESET = \"ANNOTATION/ADD_COLOR_PRESET\";\nvar CREATE_ANNOTATION = \"ANNOTATION/CREATE_ANNOTATION\";\nvar PATCH_ANNOTATION = \"ANNOTATION/PATCH_ANNOTATION\";\nvar DELETE_ANNOTATION = \"ANNOTATION/DELETE_ANNOTATION\";\nvar COMMIT_PENDING_CHANGES = \"ANNOTATION/COMMIT\";\nvar STORE_PDF_ID = \"ANNOTATION/STORE_PDF_ID\";\nvar PURGE_ANNOTATION = \"ANNOTATION/PURGE_ANNOTATION\";\nvar SET_ACTIVE_VARIANT = \"ANNOTATION/SET_ACTIVE_VARIANT\";\nvar setAnnotations = (p) => ({\n  type: SET_ANNOTATIONS,\n  payload: p\n});\nvar reindexPageAnnotations = (pageIndex) => ({\n  type: REINDEX_PAGE_ANNOTATIONS,\n  payload: { pageIndex }\n});\nvar selectAnnotation = (pageIndex, localId) => ({\n  type: SELECT_ANNOTATION,\n  payload: { pageIndex, localId }\n});\nvar deselectAnnotation = () => ({ type: DESELECT_ANNOTATION });\nvar updateToolDefaults = (variantKey, patch) => ({ type: UPDATE_TOOL_DEFAULTS, payload: { variantKey, patch } });\nvar addColorPreset = (c) => ({\n  type: ADD_COLOR_PRESET,\n  payload: c\n});\nvar createAnnotation = (pageIndex, localId, annotation) => ({\n  type: CREATE_ANNOTATION,\n  payload: { pageIndex, localId, annotation }\n});\nvar patchAnnotation = (pageIndex, localId, patch) => ({\n  type: PATCH_ANNOTATION,\n  payload: { pageIndex, localId, patch }\n});\nvar deleteAnnotation = (pageIndex, localId) => ({\n  type: DELETE_ANNOTATION,\n  payload: { pageIndex, localId }\n});\nvar commitPendingChanges = () => ({ type: COMMIT_PENDING_CHANGES });\nvar storePdfId = (uid, pdfId) => ({\n  type: STORE_PDF_ID,\n  payload: { uid, pdfId }\n});\nvar purgeAnnotation = (uid) => ({\n  type: PURGE_ANNOTATION,\n  payload: { uid }\n});\nvar setActiveVariant = (k2) => ({\n  type: SET_ACTIVE_VARIANT,\n  payload: k2\n});\n\n// src/lib/utils.ts\nvar makeUid = (pageIndex, localId) => `p${pageIndex}#${localId}`;\nvar parseUid = (uid) => {\n  const [pg, rest] = uid.slice(1).split(\"#\");\n  return { pageIndex: Number(pg), localId: Number(rest) };\n};\n\n// src/lib/selectors.ts\nvar makeUid2 = (page, id) => `p${page}#${id}`;\nvar getAnnotationsByPageIndex = (s, page) => (s.pages[page] ?? []).map((uid) => s.byUid[uid]);\nvar getAnnotations = (s) => {\n  const out = {};\n  for (const p of Object.keys(s.pages).map(Number)) out[p] = getAnnotationsByPageIndex(s, p);\n  return out;\n};\nvar getSelectedAnnotation = (s) => s.selectedUid ? s.byUid[s.selectedUid] : null;\nvar getSelectedAnnotationWithPageIndex = (s) => {\n  if (!s.selectedUid) return null;\n  const { pageIndex, localId } = parseUid(s.selectedUid);\n  return { pageIndex, localId, annotation: s.byUid[s.selectedUid].object };\n};\nvar getSelectedAnnotationByPageIndex = (s, pageIndex) => {\n  if (!s.selectedUid) return null;\n  const pageUids = s.pages[pageIndex] ?? [];\n  if (pageUids.includes(s.selectedUid)) {\n    return s.byUid[s.selectedUid];\n  }\n  return null;\n};\nvar isInAnnotationVariant = (s) => s.activeVariant !== null;\nvar getSelectedAnnotationVariant = (s) => s.activeVariant;\nvar isAnnotationSelected = (s, page, id) => s.selectedUid === makeUid2(page, id);\n\n// src/lib/variant-key.ts\nvar makeVariantKey = (subtype, intent) => intent ? `${subtype}#${intent}` : `${subtype}`;\nvar parseVariantKey = (key) => {\n  const [subStr, intent] = key.split(\"#\");\n  return { subtype: Number(subStr), intent };\n};\nvar variantKeyFromAnnotation = (a) => makeVariantKey(a.type, a.intent);\n\n// src/lib/annotation-plugin.ts\nvar AnnotationPlugin = class extends Z {\n  constructor(id, registry, engine, config) {\n    super(id, registry);\n    this.ANNOTATION_HISTORY_TOPIC = \"annotations\";\n    this.state$ = it();\n    this.modeByVariant = /* @__PURE__ */ new Map();\n    this.variantByMode = /* @__PURE__ */ new Map();\n    this.activeVariantChange$ = it();\n    this.activeTool$ = it({\n      variantKey: null,\n      defaults: null\n    });\n    this.engine = engine;\n    this.config = config;\n    const selection = registry.getPlugin(\"selection\");\n    this.selection = selection?.provides() ?? null;\n    const history = registry.getPlugin(\"history\");\n    this.history = history?.provides() ?? null;\n    const interactionManager = registry.getPlugin(\"interaction-manager\");\n    this.interactionManager = interactionManager?.provides() ?? null;\n    this.coreStore.onAction(m, (_action, state) => {\n      const doc = state.core.document;\n      if (doc) {\n        this.getAllAnnotations(doc);\n      }\n    });\n  }\n  async initialize() {\n    for (const [variantKey, defaults] of Object.entries(this.state.toolDefaults)) {\n      this.registerTool(variantKey, defaults);\n    }\n    this.history?.onHistoryChange((topic) => {\n      if (topic === this.ANNOTATION_HISTORY_TOPIC && this.config.autoCommit !== false) {\n        this.commit();\n      }\n    });\n    this.interactionManager?.onModeChange((s) => {\n      const newVariant = this.variantByMode.get(s.activeMode) ?? null;\n      console.log(newVariant, this.state.activeVariant);\n      if (newVariant !== this.state.activeVariant) {\n        this.dispatch(setActiveVariant(newVariant));\n        this.activeVariantChange$.emit(newVariant);\n      }\n    });\n    this.selection?.onEndSelection(() => {\n      if (!this.state.activeVariant) return;\n      if (!(this.state.activeVariant === makeVariantKey(PdfAnnotationSubtype.HIGHLIGHT) || this.state.activeVariant === makeVariantKey(PdfAnnotationSubtype.UNDERLINE) || this.state.activeVariant === makeVariantKey(PdfAnnotationSubtype.STRIKEOUT) || this.state.activeVariant === makeVariantKey(PdfAnnotationSubtype.SQUIGGLY))) {\n        return;\n      }\n      const formattedSelection = this.selection?.getFormattedSelection();\n      if (!formattedSelection) return;\n      for (const selection of formattedSelection) {\n        const rect = selection.rect;\n        const segmentRects = selection.segmentRects;\n        const type = this.state.activeVariant;\n        const subtype = this.state.toolDefaults[type].subtype;\n        const color = this.state.toolDefaults[type].color;\n        const opacity = this.state.toolDefaults[type].opacity;\n        const blendMode = this.state.toolDefaults[type].blendMode ?? PdfBlendMode.Normal;\n        this.createAnnotation(selection.pageIndex, {\n          type: subtype,\n          rect,\n          segmentRects,\n          color,\n          opacity,\n          blendMode,\n          pageIndex: selection.pageIndex,\n          id: Date.now() + Math.random()\n        });\n      }\n      this.selection?.clear();\n    });\n  }\n  registerTool(variantKey, defaults) {\n    const modeId = defaults.interaction.mode;\n    const interactionMode = {\n      id: modeId,\n      scope: \"page\",\n      exclusive: defaults.interaction.exclusive,\n      cursor: defaults.interaction.cursor\n    };\n    this.interactionManager?.registerMode(interactionMode);\n    if (defaults.textSelection) {\n      this.selection?.enableForMode(modeId);\n    }\n    this.modeByVariant.set(variantKey, modeId);\n    this.variantByMode.set(modeId, variantKey);\n  }\n  buildCapability() {\n    return {\n      getPageAnnotations: (options) => {\n        return this.getPageAnnotations(options);\n      },\n      getSelectedAnnotation: () => {\n        return getSelectedAnnotation(this.state);\n      },\n      selectAnnotation: (pageIndex, annotationId) => {\n        this.selectAnnotation(pageIndex, annotationId);\n      },\n      deselectAnnotation: () => {\n        this.dispatch(deselectAnnotation());\n      },\n      getActiveVariant: () => {\n        return this.state.activeVariant;\n      },\n      setActiveVariant: (variantKey) => {\n        if (variantKey === this.state.activeVariant) return;\n        if (variantKey) {\n          const mode = this.modeByVariant.get(variantKey);\n          if (!mode) throw new Error(`Mode missing for variant ${variantKey}`);\n          this.interactionManager?.activate(mode);\n        } else {\n          this.interactionManager?.activate(\"default\");\n        }\n      },\n      getToolDefaults: (variantKey) => {\n        const defaults = this.state.toolDefaults[variantKey];\n        if (!defaults) {\n          throw new Error(`No defaults found for variant: ${variantKey}`);\n        }\n        return defaults;\n      },\n      getToolDefaultsBySubtypeAndIntent: (subtype, intent) => {\n        const variantKey = makeVariantKey(subtype, intent);\n        const defaults = this.state.toolDefaults[variantKey];\n        if (!defaults) {\n          throw new Error(`No defaults found for variant: ${variantKey}`);\n        }\n        return defaults;\n      },\n      getToolDefaultsBySubtype: (subtype) => {\n        const defaults = this.state.toolDefaults[subtype];\n        if (!defaults) {\n          throw new Error(`No defaults found for subtype: ${subtype}`);\n        }\n        return defaults;\n      },\n      setToolDefaults: (variantKey, patch) => {\n        this.dispatch(updateToolDefaults(variantKey, patch));\n      },\n      getColorPresets: () => [...this.state.colorPresets],\n      addColorPreset: (color) => this.dispatch(addColorPreset(color)),\n      createAnnotation: (pageIndex, annotation) => this.createAnnotation(pageIndex, annotation),\n      updateAnnotation: (pageIndex, localId, patch) => this.updateAnnotation(pageIndex, localId, patch),\n      deleteAnnotation: (pageIndex, localId) => this.deleteAnnotation(pageIndex, localId),\n      renderAnnotation: (options) => this.renderAnnotation(options),\n      onStateChange: this.state$.on,\n      onActiveVariantChange: this.activeVariantChange$.on,\n      onActiveToolChange: this.activeTool$.on,\n      commit: () => this.commit()\n    };\n  }\n  createActiveTool(mode, toolDefaults) {\n    if (mode === null) {\n      return { variantKey: null, defaults: null };\n    }\n    return { variantKey: mode, defaults: toolDefaults[mode] };\n  }\n  emitActiveTool(state) {\n    const activeTool = this.createActiveTool(state.activeVariant, state.toolDefaults);\n    this.activeTool$.emit(activeTool);\n  }\n  onStoreUpdated(prev, next) {\n    this.state$.emit(next);\n    if (prev.activeVariant !== next.activeVariant || prev.toolDefaults[prev.activeVariant ?? PdfAnnotationSubtype.HIGHLIGHT] !== next.toolDefaults[next.activeVariant ?? PdfAnnotationSubtype.HIGHLIGHT]) {\n      this.emitActiveTool(next);\n    }\n  }\n  getAllAnnotations(doc) {\n    const task = this.engine.getAllAnnotations(doc);\n    task.wait((annotations) => this.dispatch(setAnnotations(annotations)), ignore);\n  }\n  getPageAnnotations(options) {\n    const { pageIndex } = options;\n    const doc = this.coreState.core.document;\n    if (!doc) {\n      return PdfTaskHelper.reject({ code: PdfErrorCode.NotFound, message: \"Document not found\" });\n    }\n    const page = doc.pages.find((p) => p.index === pageIndex);\n    if (!page) {\n      return PdfTaskHelper.reject({ code: PdfErrorCode.NotFound, message: \"Page not found\" });\n    }\n    return this.engine.getPageAnnotations(doc, page);\n  }\n  renderAnnotation({\n    pageIndex,\n    annotation,\n    scaleFactor = 1,\n    rotation = Rotation.Degree0,\n    dpr = 1,\n    mode = AppearanceMode.Normal,\n    imageType = \"image/webp\"\n  }) {\n    const coreState = this.coreState.core;\n    if (!coreState.document) {\n      throw new Error(\"document does not open\");\n    }\n    const page = coreState.document.pages.find((page2) => page2.index === pageIndex);\n    if (!page) {\n      throw new Error(\"page does not exist\");\n    }\n    return this.engine.renderAnnotation(\n      coreState.document,\n      page,\n      annotation,\n      scaleFactor,\n      rotation,\n      dpr,\n      mode,\n      imageType\n    );\n  }\n  selectAnnotation(pageIndex, annotationId) {\n    this.dispatch(selectAnnotation(pageIndex, annotationId));\n  }\n  createAnnotation(pageIndex, annotation) {\n    const localId = annotation.id;\n    const execute = () => this.dispatch(createAnnotation(pageIndex, localId, annotation));\n    if (!this.history) {\n      execute();\n      if (this.config.autoCommit) this.commit();\n      return;\n    }\n    const command = {\n      execute,\n      undo: () => {\n        this.dispatch(deselectAnnotation());\n        this.dispatch(deleteAnnotation(pageIndex, localId));\n      }\n    };\n    this.history.register(command, this.ANNOTATION_HISTORY_TOPIC);\n  }\n  updateAnnotation(pageIndex, localId, patch) {\n    if (!this.history) {\n      this.dispatch(patchAnnotation(pageIndex, localId, patch));\n      if (this.config.autoCommit !== false) {\n        this.commit();\n      }\n      return;\n    }\n    const originalObject = this.state.byUid[makeUid(pageIndex, localId)].object;\n    const originalPatch = Object.fromEntries(\n      Object.keys(patch).map((key) => [key, originalObject[key]])\n    );\n    const command = {\n      execute: () => this.dispatch(patchAnnotation(pageIndex, localId, patch)),\n      undo: () => this.dispatch(patchAnnotation(pageIndex, localId, originalPatch))\n    };\n    this.history.register(command, this.ANNOTATION_HISTORY_TOPIC);\n  }\n  deleteAnnotation(pageIndex, localId) {\n    if (!this.history) {\n      this.dispatch(deselectAnnotation());\n      this.dispatch(deleteAnnotation(pageIndex, localId));\n      if (this.config.autoCommit !== false) {\n        this.commit();\n      }\n      return;\n    }\n    const originalAnnotation = this.state.byUid[makeUid(pageIndex, localId)].object;\n    const command = {\n      execute: () => {\n        this.dispatch(deselectAnnotation());\n        this.dispatch(deleteAnnotation(pageIndex, localId));\n      },\n      undo: () => this.dispatch(createAnnotation(pageIndex, localId, originalAnnotation))\n    };\n    this.history.register(command, this.ANNOTATION_HISTORY_TOPIC);\n  }\n  commit() {\n    const task = new Task();\n    if (!this.state.hasPendingChanges) return PdfTaskHelper.resolve(true);\n    const doc = this.coreState.core.document;\n    if (!doc)\n      return PdfTaskHelper.reject({ code: PdfErrorCode.NotFound, message: \"Document not found\" });\n    const creations = [];\n    const updates = [];\n    const deletionsByPage = /* @__PURE__ */ new Map();\n    const affectedPages = /* @__PURE__ */ new Set();\n    for (const [uid, ta] of Object.entries(this.state.byUid)) {\n      if (ta.commitState === \"synced\") continue;\n      const { pageIndex } = parseUid(uid);\n      const page = doc.pages.find((p) => p.index === pageIndex);\n      if (!page) continue;\n      affectedPages.add(pageIndex);\n      switch (ta.commitState) {\n        case \"new\":\n          const task2 = this.engine.createPageAnnotation(doc, page, ta.object);\n          task2.wait((annoId) => this.dispatch(storePdfId(uid, annoId)), ignore);\n          creations.push(task2);\n          break;\n        case \"dirty\":\n          updates.push(\n            this.engine.updatePageAnnotation(doc, page, { ...ta.object, id: ta.pdfId })\n          );\n          break;\n        case \"deleted\":\n          if (!deletionsByPage.has(pageIndex)) {\n            deletionsByPage.set(pageIndex, []);\n          }\n          deletionsByPage.get(pageIndex).push({ ta, uid });\n          break;\n      }\n    }\n    const deletionTasks = [];\n    for (const [pageIndex, deletions] of deletionsByPage.entries()) {\n      const page = doc.pages.find((p) => p.index === pageIndex);\n      deletions.sort((a, b) => (b.ta.pdfId ?? -1) - (a.ta.pdfId ?? -1));\n      for (const { ta, uid } of deletions) {\n        if (ta.pdfId !== void 0) {\n          const task2 = new Task();\n          const removeTask = this.engine.removePageAnnotation(doc, page, {\n            ...ta.object,\n            id: ta.pdfId\n          });\n          removeTask.wait(() => {\n            this.dispatch(purgeAnnotation(uid));\n            task2.resolve(true);\n          }, task2.fail);\n          deletionTasks.push(task2);\n        } else {\n          this.dispatch(purgeAnnotation(uid));\n        }\n      }\n    }\n    const allWriteTasks = [...creations, ...updates, ...deletionTasks];\n    Task.allSettled(allWriteTasks).wait(() => {\n      for (const pageIndex of affectedPages) {\n        this.dispatch(reindexPageAnnotations(pageIndex));\n      }\n      this.dispatch(commitPendingChanges());\n      task.resolve(true);\n    }, task.fail);\n    return task;\n  }\n};\nAnnotationPlugin.id = \"annotation\";\n\n// src/lib/reducer.ts\nvar DEFAULT_COLORS = [\n  \"#E44234\",\n  \"#FF8D00\",\n  \"#FFCD45\",\n  \"#5CC96E\",\n  \"#25D2D1\",\n  \"#597CE2\",\n  \"#C544CE\",\n  \"#7D2E25\"\n];\nvar patchAnno = (state, uid, patch) => {\n  const prev = state.byUid[uid];\n  if (!prev) return state;\n  return {\n    ...state,\n    byUid: {\n      ...state.byUid,\n      [uid]: {\n        ...prev,\n        commitState: prev.commitState === \"synced\" ? \"dirty\" : prev.commitState,\n        object: { ...prev.object, ...patch }\n      }\n    },\n    hasPendingChanges: true\n  };\n};\nvar initialState = (cfg) => ({\n  pages: {},\n  byUid: {},\n  selectedUid: null,\n  activeVariant: null,\n  toolDefaults: {\n    [makeVariantKey(PdfAnnotationSubtype.HIGHLIGHT)]: {\n      name: \"Highlight\",\n      subtype: PdfAnnotationSubtype.HIGHLIGHT,\n      interaction: { mode: \"highlight\", exclusive: false },\n      textSelection: true,\n      color: \"#FFCD45\",\n      opacity: 1,\n      blendMode: PdfBlendMode.Multiply\n    },\n    [makeVariantKey(PdfAnnotationSubtype.UNDERLINE)]: {\n      name: \"Underline\",\n      subtype: PdfAnnotationSubtype.UNDERLINE,\n      interaction: { mode: \"underline\", exclusive: false },\n      textSelection: true,\n      color: \"#E44234\",\n      opacity: 1,\n      blendMode: PdfBlendMode.Normal\n    },\n    [makeVariantKey(PdfAnnotationSubtype.STRIKEOUT)]: {\n      name: \"Strikeout\",\n      subtype: PdfAnnotationSubtype.STRIKEOUT,\n      interaction: { mode: \"strikeout\", exclusive: false },\n      textSelection: true,\n      color: \"#E44234\",\n      opacity: 1,\n      blendMode: PdfBlendMode.Normal\n    },\n    [makeVariantKey(PdfAnnotationSubtype.SQUIGGLY)]: {\n      name: \"Squiggly\",\n      subtype: PdfAnnotationSubtype.SQUIGGLY,\n      interaction: { mode: \"squiggly\", exclusive: false },\n      textSelection: true,\n      color: \"#E44234\",\n      opacity: 1,\n      blendMode: PdfBlendMode.Normal\n    },\n    [makeVariantKey(PdfAnnotationSubtype.INK)]: {\n      name: \"Ink\",\n      subtype: PdfAnnotationSubtype.INK,\n      interaction: { mode: \"ink\", exclusive: true, cursor: \"crosshair\" },\n      color: \"#E44234\",\n      opacity: 1,\n      strokeWidth: 11,\n      blendMode: PdfBlendMode.Normal\n    },\n    [makeVariantKey(PdfAnnotationSubtype.INK, \"InkHighlight\")]: {\n      name: \"Ink Highlight\",\n      subtype: PdfAnnotationSubtype.INK,\n      interaction: { mode: \"inkHighlight\", exclusive: true, cursor: \"crosshair\" },\n      color: \"#E44234\",\n      opacity: 1,\n      strokeWidth: 11,\n      blendMode: PdfBlendMode.Multiply\n    },\n    ...cfg.toolDefaults\n  },\n  colorPresets: cfg.colorPresets ?? DEFAULT_COLORS,\n  hasPendingChanges: false\n});\nvar reducer = (state, action) => {\n  switch (action.type) {\n    /*  bulk load from engine  */\n    case SET_ANNOTATIONS: {\n      const newPages = { ...state.pages };\n      const newByUid = { ...state.byUid };\n      for (const [pgStr, list] of Object.entries(action.payload)) {\n        const pageIndex = Number(pgStr);\n        const oldUidsOnPage = state.pages[pageIndex] || [];\n        for (const uid of oldUidsOnPage) {\n          delete newByUid[uid];\n        }\n        const newUidsOnPage = list.map((a, index) => {\n          const localId = Date.now() + Math.random() + index;\n          const uid = makeUid(pageIndex, localId);\n          newByUid[uid] = { localId, pdfId: a.id, commitState: \"synced\", object: a };\n          return uid;\n        });\n        newPages[pageIndex] = newUidsOnPage;\n      }\n      return { ...state, pages: newPages, byUid: newByUid };\n    }\n    /*  GUI bits  */\n    case SET_ACTIVE_VARIANT:\n      return { ...state, activeVariant: action.payload };\n    case SELECT_ANNOTATION:\n      return {\n        ...state,\n        selectedUid: makeUid(action.payload.pageIndex, action.payload.localId)\n      };\n    case DESELECT_ANNOTATION:\n      return { ...state, selectedUid: null };\n    case ADD_COLOR_PRESET:\n      return state.colorPresets.includes(action.payload) ? state : { ...state, colorPresets: [...state.colorPresets, action.payload] };\n    case UPDATE_TOOL_DEFAULTS: {\n      const { variantKey, patch } = action.payload;\n      const prev = state.toolDefaults[variantKey];\n      if (!prev) return state;\n      return {\n        ...state,\n        toolDefaults: {\n          ...state.toolDefaults,\n          [variantKey]: { ...prev, ...patch }\n        }\n      };\n    }\n    /*  create  */\n    case CREATE_ANNOTATION: {\n      const { pageIndex, localId, annotation } = action.payload;\n      const uid = makeUid(pageIndex, localId);\n      return {\n        ...state,\n        pages: { ...state.pages, [pageIndex]: [...state.pages[pageIndex] ?? [], uid] },\n        byUid: {\n          ...state.byUid,\n          [uid]: { localId, pdfId: void 0, commitState: \"new\", object: annotation }\n        },\n        hasPendingChanges: true\n      };\n    }\n    /*  delete  */\n    case DELETE_ANNOTATION: {\n      const { pageIndex, localId } = action.payload;\n      const uid = makeUid(pageIndex, localId);\n      if (!state.byUid[uid]) return state;\n      return {\n        ...state,\n        pages: {\n          ...state.pages,\n          [pageIndex]: (state.pages[pageIndex] ?? []).filter((u) => u !== uid)\n        },\n        byUid: {\n          ...state.byUid,\n          [uid]: { ...state.byUid[uid], commitState: \"deleted\" }\n        },\n        hasPendingChanges: true\n      };\n    }\n    /*  field edits  */\n    case PATCH_ANNOTATION: {\n      const uid = makeUid(action.payload.pageIndex, action.payload.localId);\n      return patchAnno(state, uid, action.payload.patch);\n    }\n    /*  commit bookkeeping  */\n    case COMMIT_PENDING_CHANGES: {\n      const cleaned = {};\n      for (const [uid, ta] of Object.entries(state.byUid)) {\n        cleaned[uid] = {\n          ...ta,\n          commitState: ta.commitState === \"dirty\" || ta.commitState === \"new\" ? \"synced\" : ta.commitState\n        };\n      }\n      return { ...state, byUid: cleaned, hasPendingChanges: false };\n    }\n    case REINDEX_PAGE_ANNOTATIONS: {\n      const { pageIndex } = action.payload;\n      const newByUid = { ...state.byUid };\n      const uidsOnPage = state.pages[pageIndex] || [];\n      const annosOnPage = uidsOnPage.map((uid) => state.byUid[uid]).filter((ta) => ta && ta.commitState !== \"deleted\");\n      annosOnPage.sort((a, b) => (a.pdfId ?? Infinity) - (b.pdfId ?? Infinity));\n      annosOnPage.forEach((ta, newPdfId) => {\n        const uid = makeUid(pageIndex, ta.localId);\n        newByUid[uid] = { ...newByUid[uid], pdfId: newPdfId };\n      });\n      return { ...state, byUid: newByUid };\n    }\n    case STORE_PDF_ID: {\n      const { uid, pdfId } = action.payload;\n      const ta = state.byUid[uid];\n      if (!ta) return state;\n      return {\n        ...state,\n        byUid: {\n          ...state.byUid,\n          [uid]: { ...ta, pdfId, commitState: \"synced\" }\n        }\n      };\n    }\n    case PURGE_ANNOTATION: {\n      const { uid } = action.payload;\n      const { [uid]: _gone, ...rest } = state.byUid;\n      return { ...state, byUid: rest };\n    }\n    default:\n      return state;\n  }\n};\n\n// src/lib/index.ts\nvar AnnotationPluginPackage = {\n  manifest,\n  create: (registry, engine, config) => new AnnotationPlugin(ANNOTATION_PLUGIN_ID, registry, engine, config),\n  reducer,\n  initialState: (_, config) => initialState(config)\n};\nexport {\n  ANNOTATION_PLUGIN_ID,\n  AnnotationPlugin,\n  AnnotationPluginPackage,\n  getAnnotations,\n  getAnnotationsByPageIndex,\n  getSelectedAnnotation,\n  getSelectedAnnotationByPageIndex,\n  getSelectedAnnotationVariant,\n  getSelectedAnnotationWithPageIndex,\n  isAnnotationSelected,\n  isInAnnotationVariant,\n  makeVariantKey,\n  manifest,\n  parseVariantKey,\n  variantKeyFromAnnotation\n};\n//# sourceMappingURL=index.js.map","/* ---------------------------------------------------------------- *\\\n|* LeftPanelAnnotationStyle  cleanedup, extensible sidebar         *|\n|*                                                                    *|\n|*  Uses Tailwind for styling                                        *|\n|*  Dynamically renders controls based on the active annotation      *|\n|*   subtype.                                                         *|\n|*  Currently supports:                                              *|\n|*      Highlight / Underline / Strikeout / Squiggly  color + opacity|\n|*      Ink                                           color + opacity + strokeWidth|\n|*  Easy to extend: add a new entry to CONTROL_MAP with the desired  *|\n|*   controls array.                                                  *|\n\\* ---------------------------------------------------------------- */\n\n/** @jsxImportSource preact */\nimport { h } from 'preact';\nimport { useEffect, useState } from 'preact/hooks';\nimport {\n  PdfAnnotationSubtype,\n  WebAlphaColor,\n  PdfAnnotationObject,\n  PdfInkAnnoObject,\n  blendModeSelectOptions,\n  PdfBlendMode,\n} from '@embedpdf/models';\nimport {\n  makeVariantKey,\n  type InkDefaults,\n  type SelectedAnnotation,\n} from '@embedpdf/plugin-annotation';\nimport { useAnnotationCapability } from '@embedpdf/plugin-annotation/preact';\nimport { useDebounce } from '../hooks/use-debounce';\nimport { Icon } from './ui/icon';\n\n/* ---------------------------------------------------------------- *\\\n|* Types                                                             *|\n\\* ---------------------------------------------------------------- */\ninterface LeftPanelAnnotationStyleProps {\n  selectedAnnotation: SelectedAnnotation | null;\n  activeVariant: string | null;\n  colorPresets: string[];\n}\n\n/** A single control description  used to generate the UI. */\ninterface ControlConfig {\n  id: 'color' | 'opacity' | 'strokeWidth' | 'blendMode';\n  label: string;\n  min?: number;\n  max?: number;\n  step?: number;\n}\n\n/* ---------------------------------------------------------------- *\\\n|* Control map  extend for new subtypes                            *|\n\\* ---------------------------------------------------------------- */\nconst CONTROL_MAP: Partial<Record<string, ControlConfig[]>> = {\n  [makeVariantKey(PdfAnnotationSubtype.HIGHLIGHT)]: [\n    { id: 'color', label: 'Color' },\n    { id: 'opacity', label: 'Opacity', min: 0.1, max: 1, step: 0.05 },\n    { id: 'blendMode', label: 'Blend Mode' },\n  ],\n  [makeVariantKey(PdfAnnotationSubtype.UNDERLINE)]: [\n    { id: 'color', label: 'Color' },\n    { id: 'opacity', label: 'Opacity', min: 0.1, max: 1, step: 0.05 },\n    { id: 'blendMode', label: 'Blend Mode' },\n  ],\n  [makeVariantKey(PdfAnnotationSubtype.STRIKEOUT)]: [\n    { id: 'color', label: 'Color' },\n    { id: 'opacity', label: 'Opacity', min: 0.1, max: 1, step: 0.05 },\n    { id: 'blendMode', label: 'Blend Mode' },\n  ],\n  [makeVariantKey(PdfAnnotationSubtype.SQUIGGLY)]: [\n    { id: 'color', label: 'Color' },\n    { id: 'opacity', label: 'Opacity', min: 0.1, max: 1, step: 0.05 },\n    { id: 'blendMode', label: 'Blend Mode' },\n  ],\n  [makeVariantKey(PdfAnnotationSubtype.INK)]: [\n    { id: 'color', label: 'Color' },\n    { id: 'opacity', label: 'Opacity', min: 0.1, max: 1, step: 0.05 },\n    { id: 'strokeWidth', label: 'Stroke width', min: 1, max: 30, step: 1 },\n  ],\n  [makeVariantKey(PdfAnnotationSubtype.INK, 'InkHighlight')]: [\n    { id: 'color', label: 'Color' },\n    { id: 'opacity', label: 'Opacity', min: 0.1, max: 1, step: 0.05 },\n    { id: 'strokeWidth', label: 'Stroke width', min: 1, max: 30, step: 1 },\n  ],\n};\n\n/* ---------------------------------------------------------------- *\\\n|* Helper components                                                  *|\n\\* ---------------------------------------------------------------- */\nconst Slider = ({\n  value,\n  min = 0,\n  max = 1,\n  step = 0.1,\n  onChange,\n}: {\n  value: number;\n  min?: number;\n  max?: number;\n  step?: number;\n  onChange: (val: number) => void;\n}) => (\n  <input\n    type=\"range\"\n    class=\"range-sm mb-2 h-1 w-full cursor-pointer appearance-none rounded-lg bg-gray-200 dark:bg-gray-700\"\n    value={value}\n    min={min}\n    max={max}\n    step={step}\n    onInput={(e) => onChange(parseFloat((e.target as HTMLInputElement).value))}\n  />\n);\n\nconst ColorSwatch = ({\n  color,\n  active,\n  onSelect,\n}: {\n  color: string;\n  active: boolean;\n  onSelect: (c: string) => void;\n}) => (\n  <button\n    title={color}\n    class={`h-5 w-5 rounded-full border border-gray-400 ${\n      active ? 'outline outline-2 outline-offset-2 outline-blue-500' : ''\n    }`}\n    style={{ backgroundColor: color }}\n    onClick={() => onSelect(color)}\n  />\n);\n\n/* ---------------------------------------------------------------- *\\\n|* Utility helpers                                                   *|\n\\* ---------------------------------------------------------------- */\nconst getAlphaFromAnnotation = (anno: PdfAnnotationObject): WebAlphaColor => {\n  switch (anno.type) {\n    case PdfAnnotationSubtype.HIGHLIGHT:\n    case PdfAnnotationSubtype.UNDERLINE:\n    case PdfAnnotationSubtype.STRIKEOUT:\n    case PdfAnnotationSubtype.SQUIGGLY:\n    case PdfAnnotationSubtype.INK:\n      return { color: anno.color, opacity: anno.opacity };\n    default:\n      return { color: '#FFFF00', opacity: 1 };\n  }\n};\n\n/* ---------------------------------------------------------------- *\\\n|* Main component                                                    *|\n\\* ---------------------------------------------------------------- */\nexport const leftPanelAnnotationStyleRenderer = ({\n  selectedAnnotation,\n  activeVariant,\n  colorPresets,\n}: LeftPanelAnnotationStyleProps) => {\n  const { provides: annotation } = useAnnotationCapability();\n\n  if (!annotation) return null;\n\n  if (!selectedAnnotation && !activeVariant)\n    return (\n      <div class=\"flex flex-col items-center gap-2 p-4 text-gray-500\">\n        <Icon icon=\"palette\" className=\"h-18 w-18 text-gray-500\" />\n        <div className=\"max-w-[150px] text-center text-sm text-gray-500\">\n          Select an annotation to see styles\n        </div>\n      </div>\n    );\n\n  const activeVariantKey = selectedAnnotation\n    ? makeVariantKey(selectedAnnotation.annotation.type, selectedAnnotation.annotation.intent)\n    : activeVariant!;\n\n  const defaults = annotation?.getToolDefaults(activeVariantKey);\n  // Resolve active subtype (selected annotation > current tool)\n  const activeSubtype: PdfAnnotationSubtype | null = defaults?.subtype ?? null;\n\n  const controls = CONTROL_MAP[activeVariantKey] ?? [];\n\n  const baseAlpha: WebAlphaColor = selectedAnnotation\n    ? getAlphaFromAnnotation(selectedAnnotation.annotation)\n    : { color: defaults.color, opacity: defaults.opacity };\n\n  /* ----------------- Color ----------------- */\n  const [color, setColor] = useState<string>(baseAlpha.color);\n  useEffect(() => setColor(baseAlpha.color), [baseAlpha.color]);\n\n  const changeColor = (c: string) => {\n    setColor(c);\n    applyPatch({ color: c });\n  };\n\n  /* ---------------- Opacity ---------------- */\n  const [opacityLocal, setOpacityLocal] = useState<number>(baseAlpha.opacity);\n  useEffect(() => setOpacityLocal(baseAlpha.opacity), [baseAlpha.opacity]);\n  const debouncedOpacity = useDebounce(opacityLocal, 300);\n  useEffect(() => applyPatch({ opacity: debouncedOpacity }), [debouncedOpacity]);\n\n  /* ------------- Stroke width -------------- */\n  const initialStrokeWidth = (() => {\n    if (activeSubtype !== PdfAnnotationSubtype.INK) return 1;\n    return selectedAnnotation?.annotation.type === PdfAnnotationSubtype.INK\n      ? (selectedAnnotation.annotation as PdfInkAnnoObject).strokeWidth\n      : (defaults as InkDefaults).strokeWidth;\n  })();\n\n  const [strokeWidthLocal, setStrokeWidthLocal] = useState<number>(initialStrokeWidth);\n  useEffect(() => setStrokeWidthLocal(initialStrokeWidth), [initialStrokeWidth]);\n  const debouncedStroke = useDebounce(strokeWidthLocal, 300);\n  useEffect(() => {\n    if (activeSubtype === PdfAnnotationSubtype.INK) {\n      applyPatch({ strokeWidth: debouncedStroke });\n    }\n  }, [debouncedStroke]);\n\n  /* ----- Blend mode ----- */\n  const baseBlendMode: PdfBlendMode =\n    (selectedAnnotation?.annotation as any)?.blendMode ??\n    (activeSubtype !== PdfAnnotationSubtype.INK && 'blendMode' in defaults\n      ? defaults.blendMode\n      : undefined) ??\n    PdfBlendMode.Normal;\n\n  const [blendModeLocal, setBlendModeLocal] = useState<PdfBlendMode>(baseBlendMode);\n  useEffect(() => setBlendModeLocal(baseBlendMode), [baseBlendMode]);\n\n  const onBlendModeChange = (val: number) => {\n    const bm = val as PdfBlendMode;\n    setBlendModeLocal(bm);\n    applyPatch({ blendMode: bm });\n  };\n\n  /* ---------------- Patch util ------------- */\n  function applyPatch(patch: Partial<any>) {\n    if (selectedAnnotation) {\n      annotation?.updateAnnotation(selectedAnnotation.pageIndex, selectedAnnotation.localId, patch);\n    } else if (activeVariant) {\n      annotation?.setToolDefaults(activeVariant, patch);\n    }\n  }\n\n  /* ---------------- Render ----------------- */\n  return (\n    <div class=\"p-4\">\n      <h2 class=\"text-md mb-4 font-medium\">\n        {selectedAnnotation ? `${defaults.name} styles` : `${defaults.name} defaults`}\n      </h2>\n\n      {controls.map((ctrl) => {\n        switch (ctrl.id) {\n          case 'color':\n            return (\n              <section key=\"color\" class=\"mb-6\">\n                <label class=\"mb-2 block text-sm font-medium text-gray-900 dark:text-white\">\n                  {ctrl.label}\n                </label>\n                <div class=\"flex justify-between gap-1\">\n                  {colorPresets.map((c) => (\n                    <ColorSwatch key={c} color={c} active={c === color} onSelect={changeColor} />\n                  ))}\n                </div>\n              </section>\n            );\n          case 'opacity':\n            return (\n              <section key=\"opacity\" class=\"mb-6\">\n                <label class=\"mb-1 block text-sm font-medium text-gray-900 dark:text-white\">\n                  {ctrl.label}\n                </label>\n                <Slider\n                  value={opacityLocal}\n                  min={ctrl.min}\n                  max={ctrl.max}\n                  step={ctrl.step}\n                  onChange={setOpacityLocal}\n                />\n                <span class=\"text-xs text-gray-500\">{Math.round(opacityLocal * 100)}%</span>\n              </section>\n            );\n          case 'strokeWidth':\n            return (\n              <section key=\"strokeWidth\" class=\"mb-6\">\n                <label class=\"mb-1 block text-sm font-medium text-gray-900 dark:text-white\">\n                  {ctrl.label}\n                </label>\n                <Slider\n                  value={strokeWidthLocal}\n                  min={ctrl.min}\n                  max={ctrl.max}\n                  step={ctrl.step}\n                  onChange={setStrokeWidthLocal}\n                />\n                <span class=\"text-xs text-gray-500\">{strokeWidthLocal}px</span>\n              </section>\n            );\n          case 'blendMode':\n            return (\n              <section key=\"blendMode\" class=\"mb-6\">\n                <label class=\"mb-1 block text-sm font-medium text-gray-900 dark:text-white\">\n                  {ctrl.label}\n                </label>\n                <select\n                  name=\"blendMode\"\n                  class=\"w-full rounded border border-gray-300 bg-white px-2 py-1 text-sm dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100\"\n                  value={blendModeLocal}\n                  onChange={(e) =>\n                    onBlendModeChange(parseInt((e.target as HTMLSelectElement).value, 10))\n                  }\n                >\n                  {blendModeSelectOptions.map((o) => (\n                    <option key={o.value} value={o.value}>\n                      {o.label}\n                    </option>\n                  ))}\n                </select>\n              </section>\n            );\n          default:\n            return null;\n        }\n      })}\n    </div>\n  );\n};\n","// src/lib/types.ts\nvar ZoomMode = /* @__PURE__ */ ((ZoomMode2) => {\n  ZoomMode2[\"Automatic\"] = \"automatic\";\n  ZoomMode2[\"FitPage\"] = \"fit-page\";\n  ZoomMode2[\"FitWidth\"] = \"fit-width\";\n  return ZoomMode2;\n})(ZoomMode || {});\nvar VerticalZoomFocus = /* @__PURE__ */ ((VerticalZoomFocus2) => {\n  VerticalZoomFocus2[VerticalZoomFocus2[\"Center\"] = 0] = \"Center\";\n  VerticalZoomFocus2[VerticalZoomFocus2[\"Top\"] = 1] = \"Top\";\n  return VerticalZoomFocus2;\n})(VerticalZoomFocus || {});\n\n// src/lib/manifest.ts\nvar ZOOM_PLUGIN_ID = \"zoom\";\nvar manifest = {\n  id: ZOOM_PLUGIN_ID,\n  name: \"Zoom Plugin\",\n  version: \"1.0.0\",\n  provides: [\"zoom\"],\n  requires: [\"viewport\", \"scroll\"],\n  optional: [\"interaction-manager\"],\n  defaultConfig: {\n    enabled: true,\n    defaultZoomLevel: \"automatic\" /* Automatic */,\n    minZoom: 0.2,\n    maxZoom: 60,\n    zoomStep: 0.1,\n    zoomRanges: [\n      {\n        min: 0.2,\n        max: 0.5,\n        step: 0.05\n      },\n      {\n        min: 0.5,\n        max: 1,\n        step: 0.1\n      },\n      {\n        min: 1,\n        max: 2,\n        step: 0.2\n      },\n      {\n        min: 2,\n        max: 4,\n        step: 0.4\n      },\n      {\n        min: 4,\n        max: 10,\n        step: 0.8\n      },\n      {\n        min: 10,\n        max: 20,\n        step: 1.6\n      },\n      {\n        min: 20,\n        max: 40,\n        step: 3.2\n      },\n      {\n        min: 40,\n        max: 60,\n        step: 6.4\n      }\n    ],\n    presets: [\n      {\n        name: \"Fit Page\",\n        value: \"fit-page\" /* FitPage */\n      },\n      {\n        name: \"Fit Width\",\n        value: \"fit-width\" /* FitWidth */\n      },\n      {\n        name: \"Automatic\",\n        value: \"automatic\" /* Automatic */\n      },\n      {\n        name: \"25%\",\n        value: 0.25\n      },\n      {\n        name: \"50%\",\n        value: 0.5\n      },\n      {\n        name: \"100%\",\n        value: 1\n      },\n      {\n        name: \"125%\",\n        value: 1.25\n      },\n      {\n        name: \"150%\",\n        value: 1.5\n      },\n      {\n        name: \"200%\",\n        value: 2\n      },\n      {\n        name: \"400%\",\n        value: 4\n      },\n      {\n        name: \"800%\",\n        value: 8\n      },\n      {\n        name: \"1600%\",\n        value: 16\n      }\n    ]\n  }\n};\n\n// src/lib/actions.ts\nvar SET_ZOOM_LEVEL = \"SET_ZOOM_LEVEL\";\nvar SET_INITIAL_ZOOM_LEVEL = \"SET_INITIAL_ZOOM_LEVEL\";\nfunction setZoomLevel(zoomLevel, currentZoomLevel) {\n  return {\n    type: SET_ZOOM_LEVEL,\n    payload: { zoomLevel, currentZoomLevel }\n  };\n}\nfunction setInitialZoomLevel(zoomLevel) {\n  return {\n    type: SET_INITIAL_ZOOM_LEVEL,\n    payload: { zoomLevel }\n  };\n}\n\n// src/lib/reducer.ts\nvar initialState = {\n  zoomLevel: \"automatic\" /* Automatic */,\n  currentZoomLevel: 1\n};\nvar zoomReducer = (state = initialState, action) => {\n  switch (action.type) {\n    case SET_ZOOM_LEVEL:\n      return {\n        ...state,\n        zoomLevel: action.payload.zoomLevel,\n        currentZoomLevel: action.payload.currentZoomLevel\n      };\n    case SET_INITIAL_ZOOM_LEVEL:\n      return {\n        ...state,\n        zoomLevel: action.payload.zoomLevel\n      };\n    default:\n      return state;\n  }\n};\n\n// ../models/dist/index.js\nfunction swap(size) {\n  const { width, height } = size;\n  return {\n    width: height,\n    height: width\n  };\n}\nfunction transformSize(size, rotation, scaleFactor) {\n  size = rotation % 2 === 0 ? size : swap(size);\n  return {\n    width: size.width * scaleFactor,\n    height: size.height * scaleFactor\n  };\n}\nfunction rotateRect(containerSize, rect, rotation) {\n  let x = rect.origin.x;\n  let y = rect.origin.y;\n  let size = rect.size;\n  switch (rotation) {\n    case 0:\n      break;\n    case 1:\n      x = containerSize.height - rect.origin.y - rect.size.height;\n      y = rect.origin.x;\n      size = swap(rect.size);\n      break;\n    case 2:\n      x = containerSize.width - rect.origin.x - rect.size.width;\n      y = containerSize.height - rect.origin.y - rect.size.height;\n      break;\n    case 3:\n      x = rect.origin.y;\n      y = containerSize.width - rect.origin.x - rect.size.width;\n      size = swap(rect.size);\n      break;\n  }\n  return {\n    origin: {\n      x,\n      y\n    },\n    size: {\n      width: size.width,\n      height: size.height\n    }\n  };\n}\nvar PdfSoftHyphenMarker = \"\\xAD\";\nvar PdfZeroWidthSpace = \"\\u200B\";\nvar PdfWordJoiner = \"\\u2060\";\nvar PdfBomOrZwnbsp = \"\\uFEFF\";\nvar PdfNonCharacterFFFE = \"\\uFFFE\";\nvar PdfNonCharacterFFFF = \"\\uFFFF\";\nvar PdfUnwantedTextMarkers = Object.freeze([\n  PdfSoftHyphenMarker,\n  PdfZeroWidthSpace,\n  PdfWordJoiner,\n  PdfBomOrZwnbsp,\n  PdfNonCharacterFFFE,\n  PdfNonCharacterFFFF\n]);\nvar PdfUnwantedTextRegex = new RegExp(`[${PdfUnwantedTextMarkers.join(\"\")}]`, \"g\");\nvar MixedBlendMode = Symbol(\"mixed\");\nvar BLEND_MODE_INFOS = Object.freeze([\n  { id: 0, label: \"Normal\", css: \"normal\" },\n  { id: 1, label: \"Multiply\", css: \"multiply\" },\n  { id: 2, label: \"Screen\", css: \"screen\" },\n  { id: 3, label: \"Overlay\", css: \"overlay\" },\n  { id: 4, label: \"Darken\", css: \"darken\" },\n  { id: 5, label: \"Lighten\", css: \"lighten\" },\n  { id: 6, label: \"Color Dodge\", css: \"color-dodge\" },\n  { id: 7, label: \"Color Burn\", css: \"color-burn\" },\n  { id: 8, label: \"Hard Light\", css: \"hard-light\" },\n  { id: 9, label: \"Soft Light\", css: \"soft-light\" },\n  { id: 10, label: \"Difference\", css: \"difference\" },\n  { id: 11, label: \"Exclusion\", css: \"exclusion\" },\n  { id: 12, label: \"Hue\", css: \"hue\" },\n  { id: 13, label: \"Saturation\", css: \"saturation\" },\n  { id: 14, label: \"Color\", css: \"color\" },\n  { id: 15, label: \"Luminosity\", css: \"luminosity\" }\n]);\nvar enumToInfo = BLEND_MODE_INFOS.reduce(\n  (m2, info) => {\n    m2[info.id] = info;\n    return m2;\n  },\n  {}\n);\nvar cssToEnum = BLEND_MODE_INFOS.reduce((m2, info) => {\n  m2[info.css] = info.id;\n  return m2;\n}, {});\nvar blendModeSelectOptions = BLEND_MODE_INFOS.map((info) => ({\n  value: info.id,\n  label: info.label\n}));\nvar PdfAnnotationFlagName = Object.freeze({\n  [\n    1\n    /* INVISIBLE */\n  ]: \"invisible\",\n  [\n    2\n    /* HIDDEN */\n  ]: \"hidden\",\n  [\n    4\n    /* PRINT */\n  ]: \"print\",\n  [\n    8\n    /* NO_ZOOM */\n  ]: \"noZoom\",\n  [\n    16\n    /* NO_ROTATE */\n  ]: \"noRotate\",\n  [\n    32\n    /* NO_VIEW */\n  ]: \"noView\",\n  [\n    64\n    /* READ_ONLY */\n  ]: \"readOnly\",\n  [\n    128\n    /* LOCKED */\n  ]: \"locked\",\n  [\n    256\n    /* TOGGLE_NOVIEW */\n  ]: \"toggleNoView\"\n});\nvar PdfAnnotationFlagValue = Object.entries(\n  PdfAnnotationFlagName\n).reduce(\n  (acc, [bit, name]) => {\n    acc[name] = Number(bit);\n    return acc;\n  },\n  {}\n);\n\n// ../core/dist/index.js\nvar m = \"SET_DOCUMENT\";\nvar E = \"SET_SCALE\";\nvar P = \"SET_ROTATION\";\nvar R = \"SET_PAGES\";\nvar Y = (s) => ({ type: E, payload: s });\nvar Q = (s) => s.pages.map(\n  (t) => t.map((e) => ({\n    ...e,\n    rotatedSize: transformSize(e.size, s.rotation, 1)\n  }))\n);\nvar Z = class {\n  constructor(t, e) {\n    if (this.id = t, this.registry = e, this.debouncedActions = {}, this.unsubscribeFromState = null, this.unsubscribeFromCoreStore = null, t !== this.constructor.id)\n      throw new Error(\n        `Plugin ID mismatch: ${t} !== ${this.constructor.id}`\n      );\n    this.coreStore = this.registry.getStore(), this.pluginStore = this.coreStore.getPluginStore(this.id), this.unsubscribeFromState = this.pluginStore.subscribeToState((i, r, n) => {\n      this.onStoreUpdated(n, r);\n    }), this.unsubscribeFromCoreStore = this.coreStore.subscribe((i, r, n) => {\n      this.onCoreStoreUpdated(n, r);\n    }), this.readyPromise = new Promise((i) => {\n      this.readyResolve = i;\n    }), this.readyResolve();\n  }\n  provides() {\n    if (!this._capability) {\n      const t = this.buildCapability();\n      this._capability = Object.freeze(t);\n    }\n    return this._capability;\n  }\n  /**\n   *  Get a copy of the current state\n   */\n  get state() {\n    return this.pluginStore.getState();\n  }\n  /**\n   *  Get a copy of the current core state\n   */\n  get coreState() {\n    return this.coreStore.getState();\n  }\n  /**\n   * @deprecated  use `this.state` Get a copy of the current state\n   */\n  getState() {\n    return this.pluginStore.getState();\n  }\n  /**\n   * @deprecated  use `this.coreState` Get a copy of the current core state\n   */\n  getCoreState() {\n    return this.coreStore.getState();\n  }\n  /**\n   * Core Dispatch\n   */\n  dispatchCoreAction(t) {\n    return this.coreStore.dispatchToCore(t);\n  }\n  /**\n   * Dispatch an action to all plugins\n   */\n  dispatchToAllPlugins(t) {\n    return this.coreStore.dispatch(t);\n  }\n  /**\n   * Dispatch an action\n   */\n  dispatch(t) {\n    return this.pluginStore.dispatch(t);\n  }\n  /**\n   * Dispatch an action with debouncing to prevent rapid repeated calls\n   * @param action The action to dispatch\n   * @param debounceTime Time in ms to debounce (default: 100ms)\n   * @returns boolean indicating whether the action was dispatched or debounced\n   */\n  debouncedDispatch(t, e = 100) {\n    const i = Date.now(), r = this.debouncedActions[t.type] || 0;\n    return i - r >= e ? (this.debouncedActions[t.type] = i, this.dispatch(t), true) : false;\n  }\n  /**\n   * Subscribe to state changes\n   */\n  subscribe(t) {\n    return this.pluginStore.subscribeToState(t);\n  }\n  /**\n   * Subscribe to core store changes\n   */\n  subscribeToCoreStore(t) {\n    return this.coreStore.subscribe(t);\n  }\n  /**\n   * Called when the plugin store state is updated\n   * @param oldState Previous state\n   * @param newState New state\n   */\n  onStoreUpdated(t, e) {\n  }\n  /**\n   * Called when the core store state is updated\n   * @param oldState Previous state\n   * @param newState New state\n   */\n  onCoreStoreUpdated(t, e) {\n  }\n  /**\n   * Cleanup method to be called when plugin is being destroyed\n   */\n  destroy() {\n    this.unsubscribeFromState && (this.unsubscribeFromState(), this.unsubscribeFromState = null), this.unsubscribeFromCoreStore && (this.unsubscribeFromCoreStore(), this.unsubscribeFromCoreStore = null);\n  }\n  /**\n   * Returns a promise that resolves when the plugin is ready\n   */\n  ready() {\n    return this.readyPromise;\n  }\n  /**\n   * Mark the plugin as ready\n   */\n  markReady() {\n    this.readyResolve();\n  }\n  /**\n   * Reset the ready state (useful for plugins that need to reinitialize)\n   */\n  resetReady() {\n    this.readyPromise = new Promise((t) => {\n      this.readyResolve = t;\n    });\n  }\n};\nvar N = class {\n  constructor(t, e) {\n    this.handler = t, this.options = e, this.lastRun = 0, this.handle = (i) => {\n      this.options.mode === \"debounce\" ? this.debounce(i) : this.throttle(i);\n    };\n  }\n  debounce(t) {\n    this.timeoutId && window.clearTimeout(this.timeoutId), this.timeoutId = window.setTimeout(() => {\n      this.handler(t), this.timeoutId = void 0;\n    }, this.options.wait);\n  }\n  throttle(t) {\n    if (this.options.mode === \"debounce\") return;\n    const e = Date.now(), i = this.options.throttleMode || \"leading-trailing\";\n    e - this.lastRun >= this.options.wait && (i === \"leading-trailing\" && this.handler(t), this.lastRun = e), this.timeoutId && window.clearTimeout(this.timeoutId), this.timeoutId = window.setTimeout(\n      () => {\n        this.handler(t), this.lastRun = Date.now(), this.timeoutId = void 0;\n      },\n      this.options.wait - (e - this.lastRun)\n    );\n  }\n  destroy() {\n    this.timeoutId && window.clearTimeout(this.timeoutId);\n  }\n};\nfunction tt(s, t, e) {\n  return s < t ? t : s > e ? e : s;\n}\nfunction f(s, t, e) {\n  if (s === t)\n    return true;\n  if (s == null || t == null)\n    return s === t;\n  const i = typeof s;\n  if (i !== typeof t) return false;\n  if (i === \"object\") {\n    e || (e = /* @__PURE__ */ new Set());\n    const n = F(s, t);\n    if (e.has(n))\n      return true;\n    e.add(n);\n    const o = Array.isArray(s), a = Array.isArray(t);\n    return o && a ? q(s, t, e) : !o && !a ? I(s, t, e) : false;\n  }\n  return false;\n}\nfunction F(s, t) {\n  return `${v(s)}__${v(t)}`;\n}\nvar k = 0;\nvar w = /* @__PURE__ */ new WeakMap();\nfunction v(s) {\n  return w.has(s) || w.set(s, ++k), w.get(s);\n}\nfunction q(s, t, e) {\n  if (s.length !== t.length) return false;\n  const i = new Array(t.length).fill(false);\n  t: for (let r = 0; r < s.length; r++) {\n    const n = s[r];\n    for (let o = 0; o < t.length; o++)\n      if (!i[o] && f(n, t[o], e)) {\n        i[o] = true;\n        continue t;\n      }\n    return false;\n  }\n  return true;\n}\nfunction I(s, t, e) {\n  const i = Object.keys(s).sort(), r = Object.keys(t).sort();\n  if (i.length !== r.length) return false;\n  for (let n = 0; n < i.length; n++)\n    if (i[n] !== r[n]) return false;\n  for (const n of i) {\n    const o = s[n], a = t[n];\n    if (!f(o, a, e))\n      return false;\n  }\n  return true;\n}\nfunction et() {\n  const s = /* @__PURE__ */ new Set();\n  return {\n    emit: (e = void 0) => s.forEach((i) => i(e)),\n    on: (e) => (s.add(e), () => s.delete(e)),\n    off: (e) => s.delete(e),\n    clear: () => s.clear()\n  };\n}\nfunction it(s, t = f) {\n  const e = /* @__PURE__ */ new Set(), i = /* @__PURE__ */ new Map();\n  let r = s;\n  const n = (a) => e.forEach((l) => l(a)), o = (a, l) => {\n    let h = a, g = () => {\n    };\n    if (l) {\n      const c = new N(a, l);\n      h = c.handle, g = () => c.destroy(), i.set(a, { wrapped: h, destroy: g });\n    }\n    return r !== void 0 && h(r), e.add(h), () => {\n      e.delete(h), g(), i.delete(a);\n    };\n  };\n  return {\n    /* emitter behaviour ---------------------------------------- */\n    get value() {\n      return r;\n    },\n    emit(a = void 0) {\n      (r === void 0 || !t(r, a)) && (r = a, n(a));\n    },\n    on: o,\n    off(a) {\n      const l = i.get(a);\n      l ? (e.delete(l.wrapped), l.destroy(), i.delete(a)) : e.delete(a);\n    },\n    clear() {\n      e.clear(), i.forEach((a) => a.destroy()), i.clear();\n    },\n    /* derived hook --------------------------------------------- */\n    select(a, l = f) {\n      return (h, g) => {\n        let c;\n        if (r !== void 0) {\n          const p = a(r);\n          c = p, h(p);\n        }\n        return o(\n          (p) => {\n            const y = a(p);\n            (c === void 0 || !l(c, y)) && (c = y, h(y));\n          },\n          g\n        );\n      };\n    }\n  };\n}\n\n// src/lib/zoom-plugin.ts\nvar ZoomPlugin = class extends Z {\n  /* ------------------------------------------------------------------ */\n  constructor(id, registry, cfg) {\n    super(id, registry);\n    /* ------------------------------------------------------------------ */\n    /* internals                                                           */\n    /* ------------------------------------------------------------------ */\n    this.zoom$ = et();\n    this.state$ = it();\n    this.viewportPlugin = registry.getPlugin(\"viewport\");\n    this.viewport = this.viewportPlugin.provides();\n    this.scroll = registry.getPlugin(\"scroll\").provides();\n    const interactionManager = registry.getPlugin(\"interaction-manager\");\n    this.interactionManager = interactionManager?.provides() ?? null;\n    this.minZoom = cfg.minZoom ?? 0.25;\n    this.maxZoom = cfg.maxZoom ?? 10;\n    this.zoomStep = cfg.zoomStep ?? 0.1;\n    this.presets = cfg.presets ?? [];\n    this.zoomRanges = this.normalizeRanges(cfg.zoomRanges ?? []);\n    this.dispatch(setInitialZoomLevel(cfg.defaultZoomLevel));\n    this.viewport.onViewportResize(() => this.recalcAuto(1 /* Top */), {\n      mode: \"debounce\",\n      wait: 150\n    });\n    this.coreStore.onAction(P, () => this.recalcAuto(1 /* Top */));\n    this.coreStore.onAction(R, () => this.recalcAuto(1 /* Top */));\n    this.coreStore.onAction(m, () => this.recalcAuto(1 /* Top */));\n    this.interactionManager?.registerMode({\n      id: \"marqueeZoom\",\n      scope: \"page\",\n      exclusive: true,\n      cursor: \"zoom-in\"\n    });\n    this.resetReady();\n  }\n  /* ------------------------------------------------------------------ */\n  /* capability                                                          */\n  /* ------------------------------------------------------------------ */\n  buildCapability() {\n    return {\n      onZoomChange: this.zoom$.on,\n      onStateChange: this.state$.on,\n      zoomIn: () => {\n        const cur = this.state.currentZoomLevel;\n        return this.handleRequest({ level: cur, delta: this.stepFor(cur) });\n      },\n      zoomOut: () => {\n        const cur = this.state.currentZoomLevel;\n        return this.handleRequest({ level: cur, delta: -this.stepFor(cur) });\n      },\n      zoomToArea: (pageIndex, rect) => this.handleZoomToArea(pageIndex, rect),\n      requestZoom: (level, c) => this.handleRequest({ level, center: c }),\n      requestZoomBy: (d, c) => {\n        const cur = this.state.currentZoomLevel;\n        const target = this.toZoom(cur + d);\n        return this.handleRequest({ level: target, center: c });\n      },\n      enableMarqueeZoom: () => {\n        this.interactionManager?.activate(\"marqueeZoom\");\n      },\n      disableMarqueeZoom: () => {\n        this.interactionManager?.activate(\"default\");\n      },\n      toggleMarqueeZoom: () => {\n        if (this.interactionManager?.getActiveMode() === \"marqueeZoom\") {\n          this.interactionManager?.activate(\"default\");\n        } else {\n          this.interactionManager?.activate(\"marqueeZoom\");\n        }\n      },\n      isMarqueeZoomActive: () => this.interactionManager?.getActiveMode() === \"marqueeZoom\",\n      getState: () => this.state,\n      getPresets: () => this.presets\n    };\n  }\n  /* ------------------------------------------------------------------ */\n  /* plugin lifecycle                                                   */\n  /* ------------------------------------------------------------------ */\n  async initialize() {\n  }\n  async destroy() {\n    this.zoom$.clear();\n  }\n  /**\n   * Sort ranges once, make sure they are sane\n   */\n  normalizeRanges(ranges) {\n    return [...ranges].filter((r) => r.step > 0 && r.max > r.min).sort((a, b) => a.min - b.min);\n  }\n  /** pick the step that applies to a given numeric zoom */\n  stepFor(zoom) {\n    const r = this.zoomRanges.find((r2) => zoom >= r2.min && zoom < r2.max);\n    return r ? r.step : this.zoomStep;\n  }\n  /** clamp + round helper reused later */\n  toZoom(v2) {\n    return parseFloat(tt(v2, this.minZoom, this.maxZoom).toFixed(2));\n  }\n  /* ------------------------------------------------------------------ */\n  /* main entry  handles **every** zoom request                          */\n  /* ------------------------------------------------------------------ */\n  handleRequest({\n    level,\n    delta = 0,\n    center,\n    focus = 0 /* Center */,\n    align = \"keep\"\n  }) {\n    const metrics = this.viewport.getMetrics();\n    const oldZoom = this.state.currentZoomLevel;\n    if (metrics.clientWidth === 0 || metrics.clientHeight === 0) {\n      return;\n    }\n    const base = typeof level === \"number\" ? level : this.computeZoomForMode(level, metrics);\n    if (base === false) {\n      return;\n    }\n    const exactZoom = tt(base + delta, this.minZoom, this.maxZoom);\n    const newZoom = Math.floor(exactZoom * 100) / 100;\n    const focusPoint = center ?? {\n      vx: metrics.clientWidth / 2,\n      vy: focus === 1 /* Top */ ? 0 : metrics.clientHeight / 2\n    };\n    const { desiredScrollLeft, desiredScrollTop } = this.computeScrollForZoomChange(\n      metrics,\n      oldZoom,\n      newZoom,\n      focusPoint,\n      align\n    );\n    if (!isNaN(desiredScrollLeft) && !isNaN(desiredScrollTop)) {\n      this.viewportPlugin.setViewportScrollMetrics({\n        scrollLeft: desiredScrollLeft,\n        scrollTop: desiredScrollTop\n      });\n    }\n    this.dispatch(setZoomLevel(typeof level === \"number\" ? newZoom : level, newZoom));\n    this.dispatchCoreAction(Y(newZoom));\n    this.markReady();\n    this.viewport.scrollTo({\n      x: desiredScrollLeft,\n      y: desiredScrollTop,\n      behavior: \"instant\"\n    });\n    const evt = {\n      oldZoom,\n      newZoom,\n      level,\n      center: focusPoint,\n      desiredScrollLeft,\n      desiredScrollTop,\n      viewport: metrics\n    };\n    this.zoom$.emit(evt);\n  }\n  /* ------------------------------------------------------------------ */\n  /* helpers                                                             */\n  /* ------------------------------------------------------------------ */\n  /** numeric zoom for Automatic / FitPage / FitWidth */\n  computeZoomForMode(mode, vp) {\n    const spreads = Q(this.coreState.core);\n    if (!spreads.length) return false;\n    const pgGap = this.scroll.getPageGap();\n    const vpGap = this.viewport.getViewportGap();\n    if (vp.clientWidth === 0 || vp.clientHeight === 0) {\n      return false;\n    }\n    const availableWidth = vp.clientWidth - 2 * vpGap;\n    const availableHeight = vp.clientHeight - 2 * vpGap;\n    if (availableWidth <= 0 || availableHeight <= 0) {\n      return false;\n    }\n    let maxContentW = 0, maxContentH = 0;\n    spreads.forEach((spread) => {\n      const contentW = spread.reduce((s, p, i) => s + p.rotatedSize.width + (i ? pgGap : 0), 0);\n      const contentH = Math.max(...spread.map((p) => p.rotatedSize.height));\n      maxContentW = Math.max(maxContentW, contentW);\n      maxContentH = Math.max(maxContentH, contentH);\n    });\n    switch (mode) {\n      case \"fit-width\" /* FitWidth */:\n        return availableWidth / maxContentW;\n      case \"fit-page\" /* FitPage */:\n        return Math.min(availableWidth / maxContentW, availableHeight / maxContentH);\n      case \"automatic\" /* Automatic */:\n        return Math.min(availableWidth / maxContentW, 1);\n      /* istanbul ignore next */\n      default:\n        return 1;\n    }\n  }\n  /** where to scroll so that *focus* stays stable after scaling          */\n  computeScrollForZoomChange(vp, oldZoom, newZoom, focus, align = \"keep\") {\n    const layout = this.scroll.getLayout();\n    const vpGap = this.viewport.getViewportGap();\n    const contentW = layout.totalContentSize.width;\n    const contentH = layout.totalContentSize.height;\n    const availableWidth = vp.clientWidth - 2 * vpGap;\n    const availableHeight = vp.clientHeight - 2 * vpGap;\n    const off = (availableSpace, cw, zoom) => cw * zoom < availableSpace ? (availableSpace - cw * zoom) / 2 : 0;\n    const offXold = off(availableWidth, contentW, oldZoom);\n    const offYold = off(availableHeight, contentH, oldZoom);\n    const offXnew = off(availableWidth, contentW, newZoom);\n    const offYnew = off(availableHeight, contentH, newZoom);\n    const cx = (vp.scrollLeft + focus.vx - vpGap - offXold) / oldZoom;\n    const cy = (vp.scrollTop + focus.vy - vpGap - offYold) / oldZoom;\n    const baseLeft = cx * newZoom + vpGap + offXnew;\n    const baseTop = cy * newZoom + vpGap + offYnew;\n    const desiredScrollLeft = align === \"center\" ? baseLeft - vp.clientWidth / 2 : baseLeft - focus.vx;\n    const desiredScrollTop = align === \"center\" ? baseTop - vp.clientHeight / 2 : baseTop - focus.vy;\n    return {\n      desiredScrollLeft: Math.max(0, desiredScrollLeft),\n      desiredScrollTop: Math.max(0, desiredScrollTop)\n    };\n  }\n  handleZoomToArea(pageIndex, rect) {\n    const rotation = this.coreState.core.rotation;\n    const vp = this.viewport.getMetrics();\n    const vpGap = this.viewport.getViewportGap();\n    const oldZ = this.state.currentZoomLevel;\n    const availableW = vp.clientWidth - 2 * vpGap;\n    const availableH = vp.clientHeight - 2 * vpGap;\n    const layout = this.scroll.getLayout();\n    const vItem = layout.virtualItems.find(\n      (it2) => it2.pageLayouts.some((p) => p.pageIndex === pageIndex)\n    );\n    if (!vItem) return;\n    const pageRel = vItem.pageLayouts.find((p) => p.pageIndex === pageIndex);\n    const rotatedRect = rotateRect(\n      {\n        width: pageRel.width,\n        height: pageRel.height\n      },\n      rect,\n      rotation\n    );\n    const targetZoom = this.toZoom(\n      Math.min(availableW / rotatedRect.size.width, availableH / rotatedRect.size.height)\n    );\n    const pageAbsX = vItem.x + pageRel.x;\n    const pageAbsY = vItem.y + pageRel.y;\n    const cxContent = pageAbsX + rotatedRect.origin.x + rotatedRect.size.width / 2;\n    const cyContent = pageAbsY + rotatedRect.origin.y + rotatedRect.size.height / 2;\n    const off = (avail, cw, z) => cw * z < avail ? (avail - cw * z) / 2 : 0;\n    const offXold = off(availableW, layout.totalContentSize.width, oldZ);\n    const offYold = off(availableH, layout.totalContentSize.height, oldZ);\n    const centerVX = vpGap + offXold + cxContent * oldZ - vp.scrollLeft;\n    const centerVY = vpGap + offYold + cyContent * oldZ - vp.scrollTop;\n    this.handleRequest({\n      level: targetZoom,\n      center: { vx: centerVX, vy: centerVY },\n      align: \"center\"\n    });\n  }\n  /** recalculates Automatic / Fit* when viewport or pages change */\n  recalcAuto(focus) {\n    const s = this.state;\n    if (s.zoomLevel === \"automatic\" /* Automatic */ || s.zoomLevel === \"fit-page\" /* FitPage */ || s.zoomLevel === \"fit-width\" /* FitWidth */)\n      this.handleRequest({ level: s.zoomLevel, focus });\n  }\n  onStoreUpdated(_prevState, newState) {\n    this.state$.emit(newState);\n  }\n};\nZoomPlugin.id = \"zoom\";\n\n// src/lib/index.ts\nvar ZoomPluginPackage = {\n  manifest,\n  create: (registry, _engine, config) => new ZoomPlugin(ZOOM_PLUGIN_ID, registry, config),\n  reducer: zoomReducer,\n  initialState\n};\nexport {\n  VerticalZoomFocus,\n  ZOOM_PLUGIN_ID,\n  ZoomMode,\n  ZoomPlugin,\n  ZoomPluginPackage,\n  initialState,\n  manifest\n};\n//# sourceMappingURL=index.js.map","import { BasePlugin as f } from \"@embedpdf/core\";\nimport { Rotation as u } from \"@embedpdf/models\";\nconst g = class g extends f {\n  constructor(e, n, r) {\n    super(e, n), this.engine = r;\n  }\n  async initialize(e) {\n  }\n  buildCapability() {\n    return {\n      renderPage: this.renderPage.bind(this),\n      renderPageRect: this.renderPageRect.bind(this)\n    };\n  }\n  renderPage({\n    pageIndex: e,\n    scaleFactor: n = 1,\n    dpr: r = 1,\n    rotation: a = u.Degree0,\n    options: s = { withAnnotations: !1 },\n    imageType: d = \"image/webp\"\n  }) {\n    const o = this.coreState.core;\n    if (!o.document)\n      throw new Error(\"document does not open\");\n    const t = o.document.pages.find((i) => i.index === e);\n    if (!t)\n      throw new Error(\"page does not exist\");\n    return this.engine.renderPage(\n      o.document,\n      t,\n      n,\n      a,\n      r,\n      s,\n      d\n    );\n  }\n  renderPageRect({\n    pageIndex: e,\n    scaleFactor: n = 1,\n    dpr: r = 1,\n    rect: a,\n    rotation: s = u.Degree0,\n    options: d = { withAnnotations: !1 },\n    imageType: o = \"image/webp\"\n  }) {\n    const t = this.coreState.core;\n    if (!t.document)\n      throw new Error(\"document does not open\");\n    const i = t.document.pages.find((m) => m.index === e);\n    if (!i)\n      throw new Error(\"page does not exist\");\n    return this.engine.renderPageRect(\n      t.document,\n      i,\n      n,\n      s,\n      r,\n      a,\n      d,\n      o\n    );\n  }\n};\ng.id = \"render\";\nlet c = g;\nconst p = \"render\", w = {\n  id: p,\n  name: \"Render Plugin\",\n  version: \"1.0.0\",\n  provides: [\"render\"],\n  requires: [],\n  optional: [],\n  defaultConfig: {\n    enabled: !0\n  }\n}, b = {\n  manifest: w,\n  create: (h, e) => new c(p, h, e),\n  reducer: () => {\n  },\n  initialState: {}\n};\nexport {\n  c as RenderPlugin,\n  b as RenderPluginPackage\n};\n//# sourceMappingURL=index.js.map\n","import { usePlugin as g, useCapability as R } from \"@embedpdf/core/preact\";\nimport { RenderPlugin as l } from \"@embedpdf/plugin-render\";\nimport { jsx as s } from \"preact/jsx-runtime\";\nimport { Fragment as L } from \"preact\";\nimport { useState as p, useRef as U, useEffect as b } from \"preact/hooks\";\nimport { ignore as h, PdfErrorCode as P } from \"@embedpdf/models\";\nconst I = () => g(l.id), j = () => R(l.id);\nfunction x({\n  pageIndex: t,\n  scaleFactor: n = 1,\n  dpr: o = 1,\n  style: a,\n  ...d\n}) {\n  const { provides: r } = j(), [i, m] = p(null), e = U(null);\n  return b(() => {\n    if (r) {\n      const u = r.renderPage({ pageIndex: t, scaleFactor: n, dpr: o });\n      return u.wait((f) => {\n        const c = URL.createObjectURL(f);\n        m(c), e.current = c;\n      }, h), () => {\n        e.current ? (URL.revokeObjectURL(e.current), e.current = null) : u.abort({\n          code: P.Cancelled,\n          message: \"canceled render task\"\n        });\n      };\n    }\n  }, [t, n, o, r]), /* @__PURE__ */ s(L, { children: i && /* @__PURE__ */ s(\n    \"img\",\n    {\n      src: i,\n      onLoad: () => {\n        e.current && (URL.revokeObjectURL(e.current), e.current = null);\n      },\n      ...d,\n      style: {\n        width: \"100%\",\n        height: \"100%\",\n        ...a || {}\n      }\n    }\n  ) });\n}\nexport {\n  x as RenderLayer,\n  j as useRenderCapability,\n  I as useRenderPlugin\n};\n//# sourceMappingURL=index.js.map\n","import { BasePlugin as g, createBehaviorEmitter as l, setRotation as p } from \"@embedpdf/core\";\nconst R = \"rotate\", f = {\n  id: R,\n  name: \"Rotate Plugin\",\n  version: \"1.0.0\",\n  provides: [\"rotate\"],\n  requires: [\"loader\"],\n  optional: [\"spread\"],\n  defaultConfig: {\n    enabled: !0\n  }\n};\nfunction w(o, t, e, r = !0) {\n  let a = 1, i = 0, s = 0, n = 1, c = 0, d = 0;\n  switch (o) {\n    case 1:\n      a = 0, i = 1, s = -1, n = 0, c = e;\n      break;\n    case 2:\n      a = -1, i = 0, s = 0, n = -1, c = t, d = e;\n      break;\n    case 3:\n      a = 0, i = -1, s = 1, n = 0, d = t;\n      break;\n  }\n  return r ? `matrix(${a},${i},${s},${n},${c},${d})` : [a, i, s, n, c, d];\n}\nfunction $(o) {\n  return (o + 1) % 4;\n}\nfunction k(o) {\n  return (o + 3) % 4;\n}\nconst u = class u extends g {\n  constructor(t, e, r) {\n    super(t, e), this.rotate$ = l(), this.resetReady();\n    const a = r.defaultRotation ?? this.coreState.core.rotation;\n    this.setRotation(a), this.markReady();\n  }\n  async initialize(t) {\n  }\n  setRotation(t) {\n    if (!this.coreState.core.pages)\n      throw new Error(\"Pages not loaded\");\n    this.dispatchCoreAction(p(t));\n  }\n  rotateForward() {\n    const t = $(this.coreState.core.rotation);\n    this.setRotation(t);\n  }\n  rotateBackward() {\n    const t = k(this.coreState.core.rotation);\n    this.setRotation(t);\n  }\n  buildCapability() {\n    return {\n      onRotateChange: this.rotate$.on,\n      setRotation: (t) => this.setRotation(t),\n      getRotation: () => this.coreState.core.rotation,\n      rotateForward: () => this.rotateForward(),\n      rotateBackward: () => this.rotateBackward(),\n      getMatrix: ({ w: t = 0, h: e = 0, asString: r = !0 } = {}) => w(this.coreState.core.rotation, t, e, r)\n    };\n  }\n  async destroy() {\n    this.rotate$.clear(), super.destroy();\n  }\n};\nu.id = \"rotate\";\nlet h = u;\nconst m = {\n  manifest: f,\n  create: (o, t, e) => new h(R, o, e),\n  reducer: () => {\n  },\n  initialState: {}\n};\nexport {\n  R as ROTATE_PLUGIN_ID,\n  h as RotatePlugin,\n  m as RotatePluginPackage,\n  f as manifest\n};\n//# sourceMappingURL=index.js.map\n","import { usePlugin as a, useCapability as e } from \"@embedpdf/core/preact\";\nimport { RotatePlugin as o } from \"@embedpdf/plugin-rotate\";\nimport { jsx as m } from \"preact/jsx-runtime\";\nconst c = () => a(o.id), u = () => e(o.id);\nfunction d({ children: r, pageSize: i, ...s }) {\n  const { provides: t } = u(), n = (t == null ? void 0 : t.getMatrix({\n    w: i.width,\n    h: i.height\n  })) || \"matrix(1, 0, 0, 1, 0, 0)\";\n  return /* @__PURE__ */ m(\n    \"div\",\n    {\n      ...s,\n      style: {\n        position: \"absolute\",\n        transformOrigin: \"0 0\",\n        transform: n\n      },\n      children: r\n    }\n  );\n}\nexport {\n  d as Rotate,\n  u as useRotateCapability,\n  c as useRotatePlugin\n};\n//# sourceMappingURL=index.js.map\n","import { BasePlugin as D, createBehaviorEmitter as q } from \"@embedpdf/core\";\nimport { transformSize as G, restoreRect as H, ignore as K } from \"@embedpdf/models\";\nconst C = \"tiling\", W = {\n  id: C,\n  name: \"Tiling Plugin\",\n  version: \"1.0.0\",\n  provides: [\"tiling\"],\n  requires: [\"render\", \"scroll\", \"viewport\"],\n  optional: [],\n  defaultConfig: {\n    enabled: !0,\n    tileSize: 768,\n    overlapPx: 2.5,\n    extraRings: 0\n  }\n}, z = \"UPDATE_VISIBLE_TILES\", k = \"MARK_TILE_STATUS\", M = (t) => ({\n  type: z,\n  payload: t\n}), P = (t, e, i) => ({ type: k, payload: { pageIndex: t, tileId: e, status: i } }), X = {\n  visibleTiles: {}\n}, Y = (t, e) => {\n  var i, s;\n  switch (e.type) {\n    case z: {\n      const a = e.payload, o = { ...t.visibleTiles };\n      for (const h in a) {\n        const r = Number(h), l = a[r], n = o[r] ?? [], u = (i = n.find((p) => !p.isFallback)) == null ? void 0 : i.srcScale, g = l[0].srcScale;\n        if (u !== void 0 && u !== g) {\n          const p = n.filter((d) => !d.isFallback && d.status === \"ready\").map((d) => ({ ...d, isFallback: !0 })), f = p.length > 0 ? [] : n.filter((d) => d.isFallback);\n          o[r] = [...f, ...p, ...l];\n        } else {\n          const p = new Set(l.map((c) => c.id)), f = [], d = /* @__PURE__ */ new Set();\n          for (const c of n)\n            (c.isFallback || p.has(c.id)) && (f.push(c), d.add(c.id));\n          for (const c of l)\n            d.has(c.id) || f.push(c);\n          o[r] = f;\n        }\n      }\n      return { ...t, visibleTiles: o };\n    }\n    case k: {\n      const { pageIndex: a, tileId: o, status: h } = e.payload, r = ((s = t.visibleTiles[a]) == null ? void 0 : s.map(\n        (g) => g.id === o ? { ...g, status: h } : g\n      )) ?? [], l = r.filter((g) => !g.isFallback), u = l.every((g) => g.status === \"ready\") ? l : r;\n      return {\n        ...t,\n        visibleTiles: { ...t.visibleTiles, [a]: u }\n      };\n    }\n    default:\n      return t;\n  }\n};\nfunction j({\n  tileSize: t = 768,\n  overlapPx: e = 2.5,\n  extraRings: i = 0,\n  scale: s,\n  rotation: a,\n  page: o,\n  metric: h\n}) {\n  const r = o.size.width * s, l = o.size.height * s, n = t - e, u = G(o.size, a, s), g = {\n    origin: { x: h.scaled.pageX, y: h.scaled.pageY },\n    size: { width: h.scaled.visibleWidth, height: h.scaled.visibleHeight }\n  }, b = H(u, g, a, 1), p = b.origin.x, f = b.origin.y, d = p + b.size.width, c = f + b.size.height, _ = Math.floor((r - 1) / n), E = Math.floor((l - 1) / n), F = Math.max(0, Math.floor(p / n) - i), L = Math.min(_, Math.floor((d - 1) / n) + i), V = Math.max(0, Math.floor(f / n) - i), $ = Math.min(E, Math.floor((c - 1) / n) + i), R = [];\n  for (let y = F; y <= L; y++) {\n    const T = y * n, m = Math.min(t, r - T), U = T / s, A = m / s;\n    for (let v = V; v <= $; v++) {\n      const S = v * n, w = Math.min(t, l - S), B = S / s, N = w / s;\n      R.push({\n        id: `p${o.index}-${s}-x${T}-y${S}-w${m}-h${w}`,\n        col: y,\n        row: v,\n        pageRect: { origin: { x: U, y: B }, size: { width: A, height: N } },\n        screenRect: {\n          origin: { x: T, y: S },\n          size: { width: m, height: w }\n        },\n        status: \"queued\",\n        srcScale: s,\n        isFallback: !1\n      });\n    }\n  }\n  return R;\n}\nconst I = class I extends D {\n  constructor(e, i, s) {\n    super(e, i), this.tileRendering$ = q(), this.config = s, this.renderCapability = this.registry.getPlugin(\"render\").provides(), this.scrollCapability = this.registry.getPlugin(\"scroll\").provides(), this.viewportCapability = this.registry.getPlugin(\"viewport\").provides(), this.scrollCapability.onScroll((a) => this.calculateVisibleTiles(a), {\n      mode: \"throttle\",\n      wait: 500,\n      throttleMode: \"trailing\"\n    });\n  }\n  async initialize() {\n  }\n  onCoreStoreUpdated(e, i) {\n    e.core.scale !== i.core.scale && this.calculateVisibleTiles(\n      this.scrollCapability.getMetrics(this.viewportCapability.getMetrics())\n    );\n  }\n  calculateVisibleTiles(e) {\n    var o;\n    if (!this.config.enabled) {\n      this.dispatch(M([]));\n      return;\n    }\n    const i = this.coreState.core.scale, s = this.coreState.core.rotation, a = {};\n    for (const h of e.pageVisibilityMetrics) {\n      const r = h.pageNumber - 1, l = (o = this.coreState.core.document) == null ? void 0 : o.pages[r];\n      if (!l) continue;\n      const n = j({\n        page: l,\n        metric: h,\n        scale: i,\n        rotation: s,\n        tileSize: this.config.tileSize,\n        overlapPx: this.config.overlapPx,\n        extraRings: this.config.extraRings\n      });\n      a[r] = n;\n    }\n    this.dispatch(M(a));\n  }\n  onStoreUpdated(e, i) {\n    this.tileRendering$.emit(i.visibleTiles);\n  }\n  buildCapability() {\n    return {\n      renderTile: this.renderTile.bind(this),\n      onTileRendering: this.tileRendering$.on\n    };\n  }\n  renderTile(e) {\n    if (!this.renderCapability)\n      throw new Error(\"Render capability not available.\");\n    this.dispatch(P(e.pageIndex, e.tile.id, \"rendering\"));\n    const i = this.renderCapability.renderPageRect({\n      pageIndex: e.pageIndex,\n      rect: e.tile.pageRect,\n      scaleFactor: e.tile.srcScale,\n      dpr: e.dpr\n    });\n    return i.wait(() => {\n      this.dispatch(P(e.pageIndex, e.tile.id, \"ready\"));\n    }, K), i;\n  }\n};\nI.id = \"tiling\";\nlet x = I;\nconst Q = {\n  manifest: W,\n  create: (t, e, i) => new x(C, t, i),\n  reducer: (t, e) => Y(t, e),\n  initialState: X\n};\nexport {\n  C as TILING_PLUGIN_ID,\n  x as TilingPlugin,\n  Q as TilingPluginPackage,\n  W as manifest\n};\n//# sourceMappingURL=index.js.map\n","import { usePlugin as y, useCapability as L } from \"@embedpdf/core/preact\";\nimport { TilingPlugin as f } from \"@embedpdf/plugin-tiling\";\nimport { jsx as u } from \"preact/jsx-runtime\";\nimport { useState as g, useRef as h, useEffect as m } from \"preact/hooks\";\nimport { ignore as v, PdfErrorCode as T } from \"@embedpdf/models\";\nconst O = () => y(f.id), p = () => L(f.id);\nfunction U({ pageIndex: n, tile: r, dpr: c, scale: s }) {\n  const { provides: t } = p(), [i, l] = g(), e = h(null), o = s / r.srcScale;\n  m(() => {\n    if (r.status === \"ready\" && e.current || !t) return;\n    const a = t.renderTile({ pageIndex: n, tile: r, dpr: c });\n    return a.wait((b) => {\n      const d = URL.createObjectURL(b);\n      e.current = d, l(d);\n    }, v), () => {\n      e.current ? (URL.revokeObjectURL(e.current), e.current = null) : a.abort({\n        code: T.Cancelled,\n        message: \"canceled render task\"\n      });\n    };\n  }, [n, r.id]);\n  const R = () => {\n    e.current && (URL.revokeObjectURL(e.current), e.current = null);\n  };\n  return i ? /* @__PURE__ */ u(\n    \"img\",\n    {\n      src: i,\n      onLoad: R,\n      style: {\n        position: \"absolute\",\n        left: r.screenRect.origin.x * o,\n        top: r.screenRect.origin.y * o,\n        width: r.screenRect.size.width * o,\n        height: r.screenRect.size.height * o,\n        display: \"block\"\n      }\n    }\n  ) : null;\n}\nfunction S({ pageIndex: n, scale: r, style: c, ...s }) {\n  const { provides: t } = p(), [i, l] = g([]);\n  return m(() => {\n    if (t)\n      return t.onTileRendering((e) => l(e[n]));\n  }, [t]), /* @__PURE__ */ u(\n    \"div\",\n    {\n      style: {\n        ...c\n      },\n      ...s,\n      children: i == null ? void 0 : i.map((e) => /* @__PURE__ */ u(\n        U,\n        {\n          pageIndex: n,\n          tile: e,\n          dpr: window.devicePixelRatio,\n          scale: r\n        },\n        e.id\n      ))\n    }\n  );\n}\nexport {\n  S as TilingLayer,\n  p as useTilingCapability,\n  O as useTilingPlugin\n};\n//# sourceMappingURL=index.js.map\n","// src/lib/manifest.ts\nvar THUMBNAIL_PLUGIN_ID = \"thumbnail\";\nvar manifest = {\n  id: THUMBNAIL_PLUGIN_ID,\n  name: \"Thumbnail Plugin\",\n  version: \"1.0.0\",\n  provides: [\"thumbnail\"],\n  requires: [\"render\"],\n  optional: [],\n  defaultConfig: {\n    enabled: true,\n    width: 150,\n    gap: 10,\n    buffer: 3,\n    labelHeight: 16\n  }\n};\n\n// ../models/dist/index.js\nvar PdfSoftHyphenMarker = \"\\xAD\";\nvar PdfZeroWidthSpace = \"\\u200B\";\nvar PdfWordJoiner = \"\\u2060\";\nvar PdfBomOrZwnbsp = \"\\uFEFF\";\nvar PdfNonCharacterFFFE = \"\\uFFFE\";\nvar PdfNonCharacterFFFF = \"\\uFFFF\";\nvar PdfUnwantedTextMarkers = Object.freeze([\n  PdfSoftHyphenMarker,\n  PdfZeroWidthSpace,\n  PdfWordJoiner,\n  PdfBomOrZwnbsp,\n  PdfNonCharacterFFFE,\n  PdfNonCharacterFFFF\n]);\nvar PdfUnwantedTextRegex = new RegExp(`[${PdfUnwantedTextMarkers.join(\"\")}]`, \"g\");\nvar MixedBlendMode = Symbol(\"mixed\");\nvar BLEND_MODE_INFOS = Object.freeze([\n  { id: 0, label: \"Normal\", css: \"normal\" },\n  { id: 1, label: \"Multiply\", css: \"multiply\" },\n  { id: 2, label: \"Screen\", css: \"screen\" },\n  { id: 3, label: \"Overlay\", css: \"overlay\" },\n  { id: 4, label: \"Darken\", css: \"darken\" },\n  { id: 5, label: \"Lighten\", css: \"lighten\" },\n  { id: 6, label: \"Color Dodge\", css: \"color-dodge\" },\n  { id: 7, label: \"Color Burn\", css: \"color-burn\" },\n  { id: 8, label: \"Hard Light\", css: \"hard-light\" },\n  { id: 9, label: \"Soft Light\", css: \"soft-light\" },\n  { id: 10, label: \"Difference\", css: \"difference\" },\n  { id: 11, label: \"Exclusion\", css: \"exclusion\" },\n  { id: 12, label: \"Hue\", css: \"hue\" },\n  { id: 13, label: \"Saturation\", css: \"saturation\" },\n  { id: 14, label: \"Color\", css: \"color\" },\n  { id: 15, label: \"Luminosity\", css: \"luminosity\" }\n]);\nvar enumToInfo = BLEND_MODE_INFOS.reduce(\n  (m2, info) => {\n    m2[info.id] = info;\n    return m2;\n  },\n  {}\n);\nvar cssToEnum = BLEND_MODE_INFOS.reduce((m2, info) => {\n  m2[info.css] = info.id;\n  return m2;\n}, {});\nvar blendModeSelectOptions = BLEND_MODE_INFOS.map((info) => ({\n  value: info.id,\n  label: info.label\n}));\nvar PdfAnnotationFlagName = Object.freeze({\n  [\n    1\n    /* INVISIBLE */\n  ]: \"invisible\",\n  [\n    2\n    /* HIDDEN */\n  ]: \"hidden\",\n  [\n    4\n    /* PRINT */\n  ]: \"print\",\n  [\n    8\n    /* NO_ZOOM */\n  ]: \"noZoom\",\n  [\n    16\n    /* NO_ROTATE */\n  ]: \"noRotate\",\n  [\n    32\n    /* NO_VIEW */\n  ]: \"noView\",\n  [\n    64\n    /* READ_ONLY */\n  ]: \"readOnly\",\n  [\n    128\n    /* LOCKED */\n  ]: \"locked\",\n  [\n    256\n    /* TOGGLE_NOVIEW */\n  ]: \"toggleNoView\"\n});\nvar PdfAnnotationFlagValue = Object.entries(\n  PdfAnnotationFlagName\n).reduce(\n  (acc, [bit, name]) => {\n    acc[name] = Number(bit);\n    return acc;\n  },\n  {}\n);\nfunction ignore() {\n}\n\n// ../core/dist/index.js\nvar m = \"SET_DOCUMENT\";\nvar Z = class {\n  constructor(t, e) {\n    if (this.id = t, this.registry = e, this.debouncedActions = {}, this.unsubscribeFromState = null, this.unsubscribeFromCoreStore = null, t !== this.constructor.id)\n      throw new Error(\n        `Plugin ID mismatch: ${t} !== ${this.constructor.id}`\n      );\n    this.coreStore = this.registry.getStore(), this.pluginStore = this.coreStore.getPluginStore(this.id), this.unsubscribeFromState = this.pluginStore.subscribeToState((i, r, n) => {\n      this.onStoreUpdated(n, r);\n    }), this.unsubscribeFromCoreStore = this.coreStore.subscribe((i, r, n) => {\n      this.onCoreStoreUpdated(n, r);\n    }), this.readyPromise = new Promise((i) => {\n      this.readyResolve = i;\n    }), this.readyResolve();\n  }\n  provides() {\n    if (!this._capability) {\n      const t = this.buildCapability();\n      this._capability = Object.freeze(t);\n    }\n    return this._capability;\n  }\n  /**\n   *  Get a copy of the current state\n   */\n  get state() {\n    return this.pluginStore.getState();\n  }\n  /**\n   *  Get a copy of the current core state\n   */\n  get coreState() {\n    return this.coreStore.getState();\n  }\n  /**\n   * @deprecated  use `this.state` Get a copy of the current state\n   */\n  getState() {\n    return this.pluginStore.getState();\n  }\n  /**\n   * @deprecated  use `this.coreState` Get a copy of the current core state\n   */\n  getCoreState() {\n    return this.coreStore.getState();\n  }\n  /**\n   * Core Dispatch\n   */\n  dispatchCoreAction(t) {\n    return this.coreStore.dispatchToCore(t);\n  }\n  /**\n   * Dispatch an action to all plugins\n   */\n  dispatchToAllPlugins(t) {\n    return this.coreStore.dispatch(t);\n  }\n  /**\n   * Dispatch an action\n   */\n  dispatch(t) {\n    return this.pluginStore.dispatch(t);\n  }\n  /**\n   * Dispatch an action with debouncing to prevent rapid repeated calls\n   * @param action The action to dispatch\n   * @param debounceTime Time in ms to debounce (default: 100ms)\n   * @returns boolean indicating whether the action was dispatched or debounced\n   */\n  debouncedDispatch(t, e = 100) {\n    const i = Date.now(), r = this.debouncedActions[t.type] || 0;\n    return i - r >= e ? (this.debouncedActions[t.type] = i, this.dispatch(t), true) : false;\n  }\n  /**\n   * Subscribe to state changes\n   */\n  subscribe(t) {\n    return this.pluginStore.subscribeToState(t);\n  }\n  /**\n   * Subscribe to core store changes\n   */\n  subscribeToCoreStore(t) {\n    return this.coreStore.subscribe(t);\n  }\n  /**\n   * Called when the plugin store state is updated\n   * @param oldState Previous state\n   * @param newState New state\n   */\n  onStoreUpdated(t, e) {\n  }\n  /**\n   * Called when the core store state is updated\n   * @param oldState Previous state\n   * @param newState New state\n   */\n  onCoreStoreUpdated(t, e) {\n  }\n  /**\n   * Cleanup method to be called when plugin is being destroyed\n   */\n  destroy() {\n    this.unsubscribeFromState && (this.unsubscribeFromState(), this.unsubscribeFromState = null), this.unsubscribeFromCoreStore && (this.unsubscribeFromCoreStore(), this.unsubscribeFromCoreStore = null);\n  }\n  /**\n   * Returns a promise that resolves when the plugin is ready\n   */\n  ready() {\n    return this.readyPromise;\n  }\n  /**\n   * Mark the plugin as ready\n   */\n  markReady() {\n    this.readyResolve();\n  }\n  /**\n   * Reset the ready state (useful for plugins that need to reinitialize)\n   */\n  resetReady() {\n    this.readyPromise = new Promise((t) => {\n      this.readyResolve = t;\n    });\n  }\n};\nvar N = class {\n  constructor(t, e) {\n    this.handler = t, this.options = e, this.lastRun = 0, this.handle = (i) => {\n      this.options.mode === \"debounce\" ? this.debounce(i) : this.throttle(i);\n    };\n  }\n  debounce(t) {\n    this.timeoutId && window.clearTimeout(this.timeoutId), this.timeoutId = window.setTimeout(() => {\n      this.handler(t), this.timeoutId = void 0;\n    }, this.options.wait);\n  }\n  throttle(t) {\n    if (this.options.mode === \"debounce\") return;\n    const e = Date.now(), i = this.options.throttleMode || \"leading-trailing\";\n    e - this.lastRun >= this.options.wait && (i === \"leading-trailing\" && this.handler(t), this.lastRun = e), this.timeoutId && window.clearTimeout(this.timeoutId), this.timeoutId = window.setTimeout(\n      () => {\n        this.handler(t), this.lastRun = Date.now(), this.timeoutId = void 0;\n      },\n      this.options.wait - (e - this.lastRun)\n    );\n  }\n  destroy() {\n    this.timeoutId && window.clearTimeout(this.timeoutId);\n  }\n};\nfunction f(s, t, e) {\n  if (s === t)\n    return true;\n  if (s == null || t == null)\n    return s === t;\n  const i = typeof s;\n  if (i !== typeof t) return false;\n  if (i === \"object\") {\n    e || (e = /* @__PURE__ */ new Set());\n    const n = F(s, t);\n    if (e.has(n))\n      return true;\n    e.add(n);\n    const o = Array.isArray(s), a = Array.isArray(t);\n    return o && a ? q(s, t, e) : !o && !a ? I(s, t, e) : false;\n  }\n  return false;\n}\nfunction F(s, t) {\n  return `${v(s)}__${v(t)}`;\n}\nvar k = 0;\nvar w = /* @__PURE__ */ new WeakMap();\nfunction v(s) {\n  return w.has(s) || w.set(s, ++k), w.get(s);\n}\nfunction q(s, t, e) {\n  if (s.length !== t.length) return false;\n  const i = new Array(t.length).fill(false);\n  t: for (let r = 0; r < s.length; r++) {\n    const n = s[r];\n    for (let o = 0; o < t.length; o++)\n      if (!i[o] && f(n, t[o], e)) {\n        i[o] = true;\n        continue t;\n      }\n    return false;\n  }\n  return true;\n}\nfunction I(s, t, e) {\n  const i = Object.keys(s).sort(), r = Object.keys(t).sort();\n  if (i.length !== r.length) return false;\n  for (let n = 0; n < i.length; n++)\n    if (i[n] !== r[n]) return false;\n  for (const n of i) {\n    const o = s[n], a = t[n];\n    if (!f(o, a, e))\n      return false;\n  }\n  return true;\n}\nfunction it(s, t = f) {\n  const e = /* @__PURE__ */ new Set(), i = /* @__PURE__ */ new Map();\n  let r = s;\n  const n = (a) => e.forEach((l) => l(a)), o = (a, l) => {\n    let h = a, g = () => {\n    };\n    if (l) {\n      const c = new N(a, l);\n      h = c.handle, g = () => c.destroy(), i.set(a, { wrapped: h, destroy: g });\n    }\n    return r !== void 0 && h(r), e.add(h), () => {\n      e.delete(h), g(), i.delete(a);\n    };\n  };\n  return {\n    /* emitter behaviour ---------------------------------------- */\n    get value() {\n      return r;\n    },\n    emit(a = void 0) {\n      (r === void 0 || !t(r, a)) && (r = a, n(a));\n    },\n    on: o,\n    off(a) {\n      const l = i.get(a);\n      l ? (e.delete(l.wrapped), l.destroy(), i.delete(a)) : e.delete(a);\n    },\n    clear() {\n      e.clear(), i.forEach((a) => a.destroy()), i.clear();\n    },\n    /* derived hook --------------------------------------------- */\n    select(a, l = f) {\n      return (h, g) => {\n        let c;\n        if (r !== void 0) {\n          const p = a(r);\n          c = p, h(p);\n        }\n        return o(\n          (p) => {\n            const y = a(p);\n            (c === void 0 || !l(c, y)) && (c = y, h(y));\n          },\n          g\n        );\n      };\n    }\n  };\n}\n\n// src/lib/thumbnail-plugin.ts\nvar ThumbnailPlugin = class extends Z {\n  constructor(id, registry, cfg) {\n    super(id, registry);\n    this.cfg = cfg;\n    this.thumbs = [];\n    this.window = null;\n    this.emitWindow = it();\n    this.taskCache = /* @__PURE__ */ new Map();\n    this.renderCapability = this.registry.getPlugin(\"render\").provides();\n    this.coreStore.onAction(m, (_action, state) => {\n      this.taskCache.clear();\n      this.setWindowState(state);\n    });\n  }\n  /* ------------ init ------------------------------------------------ */\n  async initialize() {\n  }\n  setWindowState(state) {\n    const core = state.core;\n    if (!core.document) return;\n    const W = this.cfg.width ?? 120;\n    const L = this.cfg.labelHeight ?? 16;\n    const GAP = this.cfg.gap ?? 8;\n    let offset = 0;\n    this.thumbs = core.document.pages.map((p) => {\n      const ratio = p.size.height / p.size.width;\n      const thumbH = Math.round(W * ratio);\n      const wrapH = thumbH + L;\n      const meta = {\n        pageIndex: p.index,\n        width: W,\n        height: thumbH,\n        wrapperHeight: wrapH,\n        top: offset,\n        labelHeight: L\n      };\n      offset += wrapH + GAP;\n      return meta;\n    });\n    this.window = {\n      start: -1,\n      end: -1,\n      items: [],\n      totalHeight: offset - GAP\n      // last item has no gap below\n    };\n    this.emitWindow.emit(this.window);\n  }\n  /* ------------ capability ----------------------------------------- */\n  buildCapability() {\n    return {\n      onWindow: this.emitWindow.on,\n      setViewport: (y, h) => this.updateWindow(y, h),\n      renderThumb: (idx, dpr) => this.renderThumb(idx, dpr)\n    };\n  }\n  /* ------------ windowing math ------------------------------------- */\n  updateWindow(scrollY, viewportH) {\n    const BUF = this.cfg.buffer ?? 3;\n    let low = 0, high = this.thumbs.length - 1, first = 0;\n    while (low <= high) {\n      const mid = low + high >> 1;\n      const m2 = this.thumbs[mid];\n      if (m2.top + m2.wrapperHeight < scrollY) low = mid + 1;\n      else {\n        first = mid;\n        high = mid - 1;\n      }\n    }\n    let last = first;\n    const limit = scrollY + viewportH;\n    while (last + 1 < this.thumbs.length && this.thumbs[last].top < limit) last++;\n    last = Math.min(this.thumbs.length - 1, last + BUF);\n    const start = Math.max(0, first - BUF);\n    if (this.window && start === this.window.start && last === this.window.end) return;\n    this.window = {\n      start,\n      end: last,\n      items: this.thumbs.slice(start, last + 1),\n      totalHeight: this.window.totalHeight\n    };\n    this.emitWindow.emit(this.window);\n  }\n  /* ------------ thumbnail raster ----------------------------------- */\n  renderThumb(idx, dpr) {\n    if (this.taskCache.has(idx)) return this.taskCache.get(idx);\n    const core = this.coreState.core;\n    const page = core.document.pages[idx];\n    const scale = (this.cfg.width ?? 120) / page.size.width;\n    const task = this.renderCapability.renderPageRect({\n      pageIndex: idx,\n      rect: { origin: { x: 0, y: 0 }, size: page.size },\n      scaleFactor: scale,\n      dpr\n    });\n    this.taskCache.set(idx, task);\n    task.wait(ignore, () => {\n      this.taskCache.delete(idx);\n    });\n    return task;\n  }\n};\nThumbnailPlugin.id = \"thumbnail\";\n\n// src/lib/index.ts\nvar ThumbnailPluginPackage = {\n  manifest,\n  create: (registry, _engine, config) => new ThumbnailPlugin(THUMBNAIL_PLUGIN_ID, registry, config),\n  reducer: () => {\n  },\n  initialState: {}\n};\nexport {\n  THUMBNAIL_PLUGIN_ID,\n  ThumbnailPlugin,\n  ThumbnailPluginPackage,\n  manifest\n};\n//# sourceMappingURL=index.js.map","import { h } from 'preact';\n\ninterface LoadingIndicatorProps {\n  size?: 'sm' | 'md' | 'lg';\n  className?: string;\n  text?: string;\n}\n\nexport function LoadingIndicator({\n  size = 'md',\n  className = '',\n  text = 'Loading...',\n}: LoadingIndicatorProps) {\n  const sizeClasses = {\n    sm: 'w-4 h-4',\n    md: 'w-8 h-8',\n    lg: 'w-12 h-12',\n  };\n\n  const textSizeClasses = {\n    sm: 'text-sm',\n    md: 'text-base',\n    lg: 'text-lg',\n  };\n\n  return (\n    <div className={`flex flex-col items-center justify-center gap-3 ${className}`}>\n      <div className=\"relative\">\n        {/* Outer spinning ring */}\n        <div\n          className={`${sizeClasses[size]} animate-spin rounded-full border-4 border-gray-200`}\n        />\n        {/* Inner spinning ring with blue-500 */}\n        <div\n          className={`${sizeClasses[size]} absolute left-0 top-0 animate-spin rounded-full border-4 border-transparent border-r-blue-500 border-t-blue-500`}\n        />\n      </div>\n      {text && (\n        <p className={`${textSizeClasses[size]} animate-pulse font-medium text-gray-600`}>{text}</p>\n      )}\n    </div>\n  );\n}\n\n// Alternative simpler spinner design\nexport function SimpleSpinner({\n  size = 'md',\n  className = '',\n}: Omit<LoadingIndicatorProps, 'text'>) {\n  const sizeClasses = {\n    sm: 'w-4 h-4 border-2',\n    md: 'w-6 h-6 border-2',\n    lg: 'w-8 h-8 border-3',\n  };\n\n  return (\n    <div\n      className={`${sizeClasses[size]} animate-spin rounded-full border-gray-200 border-t-blue-500 ${className}`}\n    />\n  );\n}\n\n// Full page loading overlay\nexport function LoadingOverlay({\n  text = 'Loading...',\n  className = '',\n}: Pick<LoadingIndicatorProps, 'text' | 'className'>) {\n  return (\n    <div\n      className={`fixed inset-0 z-50 flex items-center justify-center bg-white bg-opacity-90 ${className}`}\n    >\n      <LoadingIndicator size=\"lg\" text={text} />\n    </div>\n  );\n}\n","// src/lib/manifest.ts\nvar FULLSCREEN_PLUGIN_ID = \"fullscreen\";\nvar manifest = {\n  id: FULLSCREEN_PLUGIN_ID,\n  name: \"Fullscreen Plugin\",\n  version: \"1.0.0\",\n  provides: [\"fullscreen\"],\n  requires: [],\n  optional: [],\n  defaultConfig: {\n    enabled: true\n  }\n};\n\n// ../models/dist/index.js\nvar PdfSoftHyphenMarker = \"\\xAD\";\nvar PdfZeroWidthSpace = \"\\u200B\";\nvar PdfWordJoiner = \"\\u2060\";\nvar PdfBomOrZwnbsp = \"\\uFEFF\";\nvar PdfNonCharacterFFFE = \"\\uFFFE\";\nvar PdfNonCharacterFFFF = \"\\uFFFF\";\nvar PdfUnwantedTextMarkers = Object.freeze([\n  PdfSoftHyphenMarker,\n  PdfZeroWidthSpace,\n  PdfWordJoiner,\n  PdfBomOrZwnbsp,\n  PdfNonCharacterFFFE,\n  PdfNonCharacterFFFF\n]);\nvar PdfUnwantedTextRegex = new RegExp(`[${PdfUnwantedTextMarkers.join(\"\")}]`, \"g\");\nvar MixedBlendMode = Symbol(\"mixed\");\nvar BLEND_MODE_INFOS = Object.freeze([\n  { id: 0, label: \"Normal\", css: \"normal\" },\n  { id: 1, label: \"Multiply\", css: \"multiply\" },\n  { id: 2, label: \"Screen\", css: \"screen\" },\n  { id: 3, label: \"Overlay\", css: \"overlay\" },\n  { id: 4, label: \"Darken\", css: \"darken\" },\n  { id: 5, label: \"Lighten\", css: \"lighten\" },\n  { id: 6, label: \"Color Dodge\", css: \"color-dodge\" },\n  { id: 7, label: \"Color Burn\", css: \"color-burn\" },\n  { id: 8, label: \"Hard Light\", css: \"hard-light\" },\n  { id: 9, label: \"Soft Light\", css: \"soft-light\" },\n  { id: 10, label: \"Difference\", css: \"difference\" },\n  { id: 11, label: \"Exclusion\", css: \"exclusion\" },\n  { id: 12, label: \"Hue\", css: \"hue\" },\n  { id: 13, label: \"Saturation\", css: \"saturation\" },\n  { id: 14, label: \"Color\", css: \"color\" },\n  { id: 15, label: \"Luminosity\", css: \"luminosity\" }\n]);\nvar enumToInfo = BLEND_MODE_INFOS.reduce(\n  (m, info) => {\n    m[info.id] = info;\n    return m;\n  },\n  {}\n);\nvar cssToEnum = BLEND_MODE_INFOS.reduce((m, info) => {\n  m[info.css] = info.id;\n  return m;\n}, {});\nvar blendModeSelectOptions = BLEND_MODE_INFOS.map((info) => ({\n  value: info.id,\n  label: info.label\n}));\nvar PdfAnnotationFlagName = Object.freeze({\n  [\n    1\n    /* INVISIBLE */\n  ]: \"invisible\",\n  [\n    2\n    /* HIDDEN */\n  ]: \"hidden\",\n  [\n    4\n    /* PRINT */\n  ]: \"print\",\n  [\n    8\n    /* NO_ZOOM */\n  ]: \"noZoom\",\n  [\n    16\n    /* NO_ROTATE */\n  ]: \"noRotate\",\n  [\n    32\n    /* NO_VIEW */\n  ]: \"noView\",\n  [\n    64\n    /* READ_ONLY */\n  ]: \"readOnly\",\n  [\n    128\n    /* LOCKED */\n  ]: \"locked\",\n  [\n    256\n    /* TOGGLE_NOVIEW */\n  ]: \"toggleNoView\"\n});\nvar PdfAnnotationFlagValue = Object.entries(\n  PdfAnnotationFlagName\n).reduce(\n  (acc, [bit, name]) => {\n    acc[name] = Number(bit);\n    return acc;\n  },\n  {}\n);\n\n// ../core/dist/index.js\nvar Z = class {\n  constructor(t, e) {\n    if (this.id = t, this.registry = e, this.debouncedActions = {}, this.unsubscribeFromState = null, this.unsubscribeFromCoreStore = null, t !== this.constructor.id)\n      throw new Error(\n        `Plugin ID mismatch: ${t} !== ${this.constructor.id}`\n      );\n    this.coreStore = this.registry.getStore(), this.pluginStore = this.coreStore.getPluginStore(this.id), this.unsubscribeFromState = this.pluginStore.subscribeToState((i, r, n) => {\n      this.onStoreUpdated(n, r);\n    }), this.unsubscribeFromCoreStore = this.coreStore.subscribe((i, r, n) => {\n      this.onCoreStoreUpdated(n, r);\n    }), this.readyPromise = new Promise((i) => {\n      this.readyResolve = i;\n    }), this.readyResolve();\n  }\n  provides() {\n    if (!this._capability) {\n      const t = this.buildCapability();\n      this._capability = Object.freeze(t);\n    }\n    return this._capability;\n  }\n  /**\n   *  Get a copy of the current state\n   */\n  get state() {\n    return this.pluginStore.getState();\n  }\n  /**\n   *  Get a copy of the current core state\n   */\n  get coreState() {\n    return this.coreStore.getState();\n  }\n  /**\n   * @deprecated  use `this.state` Get a copy of the current state\n   */\n  getState() {\n    return this.pluginStore.getState();\n  }\n  /**\n   * @deprecated  use `this.coreState` Get a copy of the current core state\n   */\n  getCoreState() {\n    return this.coreStore.getState();\n  }\n  /**\n   * Core Dispatch\n   */\n  dispatchCoreAction(t) {\n    return this.coreStore.dispatchToCore(t);\n  }\n  /**\n   * Dispatch an action to all plugins\n   */\n  dispatchToAllPlugins(t) {\n    return this.coreStore.dispatch(t);\n  }\n  /**\n   * Dispatch an action\n   */\n  dispatch(t) {\n    return this.pluginStore.dispatch(t);\n  }\n  /**\n   * Dispatch an action with debouncing to prevent rapid repeated calls\n   * @param action The action to dispatch\n   * @param debounceTime Time in ms to debounce (default: 100ms)\n   * @returns boolean indicating whether the action was dispatched or debounced\n   */\n  debouncedDispatch(t, e = 100) {\n    const i = Date.now(), r = this.debouncedActions[t.type] || 0;\n    return i - r >= e ? (this.debouncedActions[t.type] = i, this.dispatch(t), true) : false;\n  }\n  /**\n   * Subscribe to state changes\n   */\n  subscribe(t) {\n    return this.pluginStore.subscribeToState(t);\n  }\n  /**\n   * Subscribe to core store changes\n   */\n  subscribeToCoreStore(t) {\n    return this.coreStore.subscribe(t);\n  }\n  /**\n   * Called when the plugin store state is updated\n   * @param oldState Previous state\n   * @param newState New state\n   */\n  onStoreUpdated(t, e) {\n  }\n  /**\n   * Called when the core store state is updated\n   * @param oldState Previous state\n   * @param newState New state\n   */\n  onCoreStoreUpdated(t, e) {\n  }\n  /**\n   * Cleanup method to be called when plugin is being destroyed\n   */\n  destroy() {\n    this.unsubscribeFromState && (this.unsubscribeFromState(), this.unsubscribeFromState = null), this.unsubscribeFromCoreStore && (this.unsubscribeFromCoreStore(), this.unsubscribeFromCoreStore = null);\n  }\n  /**\n   * Returns a promise that resolves when the plugin is ready\n   */\n  ready() {\n    return this.readyPromise;\n  }\n  /**\n   * Mark the plugin as ready\n   */\n  markReady() {\n    this.readyResolve();\n  }\n  /**\n   * Reset the ready state (useful for plugins that need to reinitialize)\n   */\n  resetReady() {\n    this.readyPromise = new Promise((t) => {\n      this.readyResolve = t;\n    });\n  }\n};\nvar N = class {\n  constructor(t, e) {\n    this.handler = t, this.options = e, this.lastRun = 0, this.handle = (i) => {\n      this.options.mode === \"debounce\" ? this.debounce(i) : this.throttle(i);\n    };\n  }\n  debounce(t) {\n    this.timeoutId && window.clearTimeout(this.timeoutId), this.timeoutId = window.setTimeout(() => {\n      this.handler(t), this.timeoutId = void 0;\n    }, this.options.wait);\n  }\n  throttle(t) {\n    if (this.options.mode === \"debounce\") return;\n    const e = Date.now(), i = this.options.throttleMode || \"leading-trailing\";\n    e - this.lastRun >= this.options.wait && (i === \"leading-trailing\" && this.handler(t), this.lastRun = e), this.timeoutId && window.clearTimeout(this.timeoutId), this.timeoutId = window.setTimeout(\n      () => {\n        this.handler(t), this.lastRun = Date.now(), this.timeoutId = void 0;\n      },\n      this.options.wait - (e - this.lastRun)\n    );\n  }\n  destroy() {\n    this.timeoutId && window.clearTimeout(this.timeoutId);\n  }\n};\nfunction f(s, t, e) {\n  if (s === t)\n    return true;\n  if (s == null || t == null)\n    return s === t;\n  const i = typeof s;\n  if (i !== typeof t) return false;\n  if (i === \"object\") {\n    e || (e = /* @__PURE__ */ new Set());\n    const n = F(s, t);\n    if (e.has(n))\n      return true;\n    e.add(n);\n    const o = Array.isArray(s), a = Array.isArray(t);\n    return o && a ? q(s, t, e) : !o && !a ? I(s, t, e) : false;\n  }\n  return false;\n}\nfunction F(s, t) {\n  return `${v(s)}__${v(t)}`;\n}\nvar k = 0;\nvar w = /* @__PURE__ */ new WeakMap();\nfunction v(s) {\n  return w.has(s) || w.set(s, ++k), w.get(s);\n}\nfunction q(s, t, e) {\n  if (s.length !== t.length) return false;\n  const i = new Array(t.length).fill(false);\n  t: for (let r = 0; r < s.length; r++) {\n    const n = s[r];\n    for (let o = 0; o < t.length; o++)\n      if (!i[o] && f(n, t[o], e)) {\n        i[o] = true;\n        continue t;\n      }\n    return false;\n  }\n  return true;\n}\nfunction I(s, t, e) {\n  const i = Object.keys(s).sort(), r = Object.keys(t).sort();\n  if (i.length !== r.length) return false;\n  for (let n = 0; n < i.length; n++)\n    if (i[n] !== r[n]) return false;\n  for (const n of i) {\n    const o = s[n], a = t[n];\n    if (!f(o, a, e))\n      return false;\n  }\n  return true;\n}\nfunction et() {\n  const s = /* @__PURE__ */ new Set();\n  return {\n    emit: (e = void 0) => s.forEach((i) => i(e)),\n    on: (e) => (s.add(e), () => s.delete(e)),\n    off: (e) => s.delete(e),\n    clear: () => s.clear()\n  };\n}\nfunction it(s, t = f) {\n  const e = /* @__PURE__ */ new Set(), i = /* @__PURE__ */ new Map();\n  let r = s;\n  const n = (a) => e.forEach((l) => l(a)), o = (a, l) => {\n    let h = a, g = () => {\n    };\n    if (l) {\n      const c = new N(a, l);\n      h = c.handle, g = () => c.destroy(), i.set(a, { wrapped: h, destroy: g });\n    }\n    return r !== void 0 && h(r), e.add(h), () => {\n      e.delete(h), g(), i.delete(a);\n    };\n  };\n  return {\n    /* emitter behaviour ---------------------------------------- */\n    get value() {\n      return r;\n    },\n    emit(a = void 0) {\n      (r === void 0 || !t(r, a)) && (r = a, n(a));\n    },\n    on: o,\n    off(a) {\n      const l = i.get(a);\n      l ? (e.delete(l.wrapped), l.destroy(), i.delete(a)) : e.delete(a);\n    },\n    clear() {\n      e.clear(), i.forEach((a) => a.destroy()), i.clear();\n    },\n    /* derived hook --------------------------------------------- */\n    select(a, l = f) {\n      return (h, g) => {\n        let c;\n        if (r !== void 0) {\n          const p = a(r);\n          c = p, h(p);\n        }\n        return o(\n          (p) => {\n            const y = a(p);\n            (c === void 0 || !l(c, y)) && (c = y, h(y));\n          },\n          g\n        );\n      };\n    }\n  };\n}\n\n// src/lib/actions.ts\nvar SET_FULLSCREEN = \"SET_FULLSCREEN\";\nfunction setFullscreen(payload) {\n  return { type: SET_FULLSCREEN, payload };\n}\n\n// src/lib/fullscreen-plugin.ts\nvar FullscreenPlugin = class extends Z {\n  constructor(id, registry) {\n    super(id, registry);\n    this.onStateChange$ = it();\n    this.fullscreenRequest$ = et();\n  }\n  async initialize(_) {\n  }\n  buildCapability() {\n    return {\n      isFullscreen: () => this.state.isFullscreen,\n      enableFullscreen: () => this.enableFullscreen(),\n      exitFullscreen: () => this.exitFullscreen(),\n      toggleFullscreen: () => this.toggleFullscreen(),\n      onRequest: this.fullscreenRequest$.on,\n      onStateChange: this.onStateChange$.on\n    };\n  }\n  toggleFullscreen() {\n    if (this.state.isFullscreen) {\n      this.exitFullscreen();\n    } else {\n      this.enableFullscreen();\n    }\n  }\n  enableFullscreen() {\n    this.fullscreenRequest$.emit(\"enter\");\n  }\n  exitFullscreen() {\n    this.fullscreenRequest$.emit(\"exit\");\n  }\n  onStoreUpdated(_, newState) {\n    this.onStateChange$.emit(newState);\n  }\n  setFullscreenState(isFullscreen) {\n    this.dispatch(setFullscreen(isFullscreen));\n  }\n  async destroy() {\n    this.fullscreenRequest$.clear();\n    super.destroy();\n  }\n};\nFullscreenPlugin.id = \"fullscreen\";\n\n// src/lib/reducer.ts\nvar initialState = {\n  isFullscreen: false\n};\nvar reducer = (state, action) => {\n  switch (action.type) {\n    case SET_FULLSCREEN:\n      return { ...state, isFullscreen: action.payload };\n    default:\n      return state;\n  }\n};\n\n// src/lib/index.ts\nvar FullscreenPluginPackage = {\n  manifest,\n  create: (registry) => new FullscreenPlugin(FULLSCREEN_PLUGIN_ID, registry),\n  reducer,\n  initialState\n};\nexport {\n  FULLSCREEN_PLUGIN_ID,\n  FullscreenPlugin,\n  FullscreenPluginPackage,\n  SET_FULLSCREEN,\n  initialState,\n  manifest,\n  setFullscreen\n};\n//# sourceMappingURL=index.js.map","// src/lib/manifest.ts\nvar BOOKMARK_PLUGIN_ID = \"bookmark\";\nvar manifest = {\n  id: BOOKMARK_PLUGIN_ID,\n  name: \"Bookmark Plugin\",\n  version: \"1.0.0\",\n  provides: [\"bookmark\"],\n  requires: [],\n  optional: [],\n  defaultConfig: {\n    enabled: true\n  }\n};\n\n// ../models/dist/index.js\nvar PdfSoftHyphenMarker = \"\\xAD\";\nvar PdfZeroWidthSpace = \"\\u200B\";\nvar PdfWordJoiner = \"\\u2060\";\nvar PdfBomOrZwnbsp = \"\\uFEFF\";\nvar PdfNonCharacterFFFE = \"\\uFFFE\";\nvar PdfNonCharacterFFFF = \"\\uFFFF\";\nvar PdfUnwantedTextMarkers = Object.freeze([\n  PdfSoftHyphenMarker,\n  PdfZeroWidthSpace,\n  PdfWordJoiner,\n  PdfBomOrZwnbsp,\n  PdfNonCharacterFFFE,\n  PdfNonCharacterFFFF\n]);\nvar PdfUnwantedTextRegex = new RegExp(`[${PdfUnwantedTextMarkers.join(\"\")}]`, \"g\");\nvar MixedBlendMode = Symbol(\"mixed\");\nvar BLEND_MODE_INFOS = Object.freeze([\n  { id: 0, label: \"Normal\", css: \"normal\" },\n  { id: 1, label: \"Multiply\", css: \"multiply\" },\n  { id: 2, label: \"Screen\", css: \"screen\" },\n  { id: 3, label: \"Overlay\", css: \"overlay\" },\n  { id: 4, label: \"Darken\", css: \"darken\" },\n  { id: 5, label: \"Lighten\", css: \"lighten\" },\n  { id: 6, label: \"Color Dodge\", css: \"color-dodge\" },\n  { id: 7, label: \"Color Burn\", css: \"color-burn\" },\n  { id: 8, label: \"Hard Light\", css: \"hard-light\" },\n  { id: 9, label: \"Soft Light\", css: \"soft-light\" },\n  { id: 10, label: \"Difference\", css: \"difference\" },\n  { id: 11, label: \"Exclusion\", css: \"exclusion\" },\n  { id: 12, label: \"Hue\", css: \"hue\" },\n  { id: 13, label: \"Saturation\", css: \"saturation\" },\n  { id: 14, label: \"Color\", css: \"color\" },\n  { id: 15, label: \"Luminosity\", css: \"luminosity\" }\n]);\nvar enumToInfo = BLEND_MODE_INFOS.reduce(\n  (m, info) => {\n    m[info.id] = info;\n    return m;\n  },\n  {}\n);\nvar cssToEnum = BLEND_MODE_INFOS.reduce((m, info) => {\n  m[info.css] = info.id;\n  return m;\n}, {});\nvar blendModeSelectOptions = BLEND_MODE_INFOS.map((info) => ({\n  value: info.id,\n  label: info.label\n}));\nvar PdfAnnotationFlagName = Object.freeze({\n  [\n    1\n    /* INVISIBLE */\n  ]: \"invisible\",\n  [\n    2\n    /* HIDDEN */\n  ]: \"hidden\",\n  [\n    4\n    /* PRINT */\n  ]: \"print\",\n  [\n    8\n    /* NO_ZOOM */\n  ]: \"noZoom\",\n  [\n    16\n    /* NO_ROTATE */\n  ]: \"noRotate\",\n  [\n    32\n    /* NO_VIEW */\n  ]: \"noView\",\n  [\n    64\n    /* READ_ONLY */\n  ]: \"readOnly\",\n  [\n    128\n    /* LOCKED */\n  ]: \"locked\",\n  [\n    256\n    /* TOGGLE_NOVIEW */\n  ]: \"toggleNoView\"\n});\nvar PdfAnnotationFlagValue = Object.entries(\n  PdfAnnotationFlagName\n).reduce(\n  (acc, [bit, name]) => {\n    acc[name] = Number(bit);\n    return acc;\n  },\n  {}\n);\n\n// ../core/dist/index.js\nvar Z = class {\n  constructor(t, e) {\n    if (this.id = t, this.registry = e, this.debouncedActions = {}, this.unsubscribeFromState = null, this.unsubscribeFromCoreStore = null, t !== this.constructor.id)\n      throw new Error(\n        `Plugin ID mismatch: ${t} !== ${this.constructor.id}`\n      );\n    this.coreStore = this.registry.getStore(), this.pluginStore = this.coreStore.getPluginStore(this.id), this.unsubscribeFromState = this.pluginStore.subscribeToState((i, r, n) => {\n      this.onStoreUpdated(n, r);\n    }), this.unsubscribeFromCoreStore = this.coreStore.subscribe((i, r, n) => {\n      this.onCoreStoreUpdated(n, r);\n    }), this.readyPromise = new Promise((i) => {\n      this.readyResolve = i;\n    }), this.readyResolve();\n  }\n  provides() {\n    if (!this._capability) {\n      const t = this.buildCapability();\n      this._capability = Object.freeze(t);\n    }\n    return this._capability;\n  }\n  /**\n   *  Get a copy of the current state\n   */\n  get state() {\n    return this.pluginStore.getState();\n  }\n  /**\n   *  Get a copy of the current core state\n   */\n  get coreState() {\n    return this.coreStore.getState();\n  }\n  /**\n   * @deprecated  use `this.state` Get a copy of the current state\n   */\n  getState() {\n    return this.pluginStore.getState();\n  }\n  /**\n   * @deprecated  use `this.coreState` Get a copy of the current core state\n   */\n  getCoreState() {\n    return this.coreStore.getState();\n  }\n  /**\n   * Core Dispatch\n   */\n  dispatchCoreAction(t) {\n    return this.coreStore.dispatchToCore(t);\n  }\n  /**\n   * Dispatch an action to all plugins\n   */\n  dispatchToAllPlugins(t) {\n    return this.coreStore.dispatch(t);\n  }\n  /**\n   * Dispatch an action\n   */\n  dispatch(t) {\n    return this.pluginStore.dispatch(t);\n  }\n  /**\n   * Dispatch an action with debouncing to prevent rapid repeated calls\n   * @param action The action to dispatch\n   * @param debounceTime Time in ms to debounce (default: 100ms)\n   * @returns boolean indicating whether the action was dispatched or debounced\n   */\n  debouncedDispatch(t, e = 100) {\n    const i = Date.now(), r = this.debouncedActions[t.type] || 0;\n    return i - r >= e ? (this.debouncedActions[t.type] = i, this.dispatch(t), true) : false;\n  }\n  /**\n   * Subscribe to state changes\n   */\n  subscribe(t) {\n    return this.pluginStore.subscribeToState(t);\n  }\n  /**\n   * Subscribe to core store changes\n   */\n  subscribeToCoreStore(t) {\n    return this.coreStore.subscribe(t);\n  }\n  /**\n   * Called when the plugin store state is updated\n   * @param oldState Previous state\n   * @param newState New state\n   */\n  onStoreUpdated(t, e) {\n  }\n  /**\n   * Called when the core store state is updated\n   * @param oldState Previous state\n   * @param newState New state\n   */\n  onCoreStoreUpdated(t, e) {\n  }\n  /**\n   * Cleanup method to be called when plugin is being destroyed\n   */\n  destroy() {\n    this.unsubscribeFromState && (this.unsubscribeFromState(), this.unsubscribeFromState = null), this.unsubscribeFromCoreStore && (this.unsubscribeFromCoreStore(), this.unsubscribeFromCoreStore = null);\n  }\n  /**\n   * Returns a promise that resolves when the plugin is ready\n   */\n  ready() {\n    return this.readyPromise;\n  }\n  /**\n   * Mark the plugin as ready\n   */\n  markReady() {\n    this.readyResolve();\n  }\n  /**\n   * Reset the ready state (useful for plugins that need to reinitialize)\n   */\n  resetReady() {\n    this.readyPromise = new Promise((t) => {\n      this.readyResolve = t;\n    });\n  }\n};\n\n// src/lib/bookmark-plugin.ts\nvar BookmarkPlugin = class extends Z {\n  constructor(id, registry, engine) {\n    super(id, registry);\n    this.engine = engine;\n  }\n  async initialize(_) {\n  }\n  buildCapability() {\n    return {\n      getBookmarks: this.getBookmarks.bind(this)\n    };\n  }\n  getBookmarks() {\n    const doc = this.coreState.core.document;\n    if (!doc) throw new Error(\"Document not open\");\n    return this.engine.getBookmarks(doc);\n  }\n};\nBookmarkPlugin.id = \"bookmark\";\n\n// src/lib/index.ts\nvar BookmarkPluginPackage = {\n  manifest,\n  create: (registry, engine) => new BookmarkPlugin(BOOKMARK_PLUGIN_ID, registry, engine),\n  reducer: () => {\n  },\n  initialState: {}\n};\nexport {\n  BOOKMARK_PLUGIN_ID,\n  BookmarkPlugin,\n  BookmarkPluginPackage,\n  manifest\n};\n//# sourceMappingURL=index.js.map","// src/lib/manifest.ts\nvar CAPTURE_PLUGIN_ID = \"capture\";\nvar manifest = {\n  id: CAPTURE_PLUGIN_ID,\n  name: \"Capture Plugin\",\n  version: \"1.0.0\",\n  provides: [\"capture\"],\n  requires: [\"render\", \"interaction-manager\"],\n  optional: [],\n  defaultConfig: {\n    enabled: true,\n    scale: 1,\n    imageType: \"image/png\",\n    withAnnotations: false\n  }\n};\n\n// ../models/dist/index.js\nvar PdfSoftHyphenMarker = \"\\xAD\";\nvar PdfZeroWidthSpace = \"\\u200B\";\nvar PdfWordJoiner = \"\\u2060\";\nvar PdfBomOrZwnbsp = \"\\uFEFF\";\nvar PdfNonCharacterFFFE = \"\\uFFFE\";\nvar PdfNonCharacterFFFF = \"\\uFFFF\";\nvar PdfUnwantedTextMarkers = Object.freeze([\n  PdfSoftHyphenMarker,\n  PdfZeroWidthSpace,\n  PdfWordJoiner,\n  PdfBomOrZwnbsp,\n  PdfNonCharacterFFFE,\n  PdfNonCharacterFFFF\n]);\nvar PdfUnwantedTextRegex = new RegExp(`[${PdfUnwantedTextMarkers.join(\"\")}]`, \"g\");\nvar MixedBlendMode = Symbol(\"mixed\");\nvar BLEND_MODE_INFOS = Object.freeze([\n  { id: 0, label: \"Normal\", css: \"normal\" },\n  { id: 1, label: \"Multiply\", css: \"multiply\" },\n  { id: 2, label: \"Screen\", css: \"screen\" },\n  { id: 3, label: \"Overlay\", css: \"overlay\" },\n  { id: 4, label: \"Darken\", css: \"darken\" },\n  { id: 5, label: \"Lighten\", css: \"lighten\" },\n  { id: 6, label: \"Color Dodge\", css: \"color-dodge\" },\n  { id: 7, label: \"Color Burn\", css: \"color-burn\" },\n  { id: 8, label: \"Hard Light\", css: \"hard-light\" },\n  { id: 9, label: \"Soft Light\", css: \"soft-light\" },\n  { id: 10, label: \"Difference\", css: \"difference\" },\n  { id: 11, label: \"Exclusion\", css: \"exclusion\" },\n  { id: 12, label: \"Hue\", css: \"hue\" },\n  { id: 13, label: \"Saturation\", css: \"saturation\" },\n  { id: 14, label: \"Color\", css: \"color\" },\n  { id: 15, label: \"Luminosity\", css: \"luminosity\" }\n]);\nvar enumToInfo = BLEND_MODE_INFOS.reduce(\n  (m, info) => {\n    m[info.id] = info;\n    return m;\n  },\n  {}\n);\nvar cssToEnum = BLEND_MODE_INFOS.reduce((m, info) => {\n  m[info.css] = info.id;\n  return m;\n}, {});\nvar blendModeSelectOptions = BLEND_MODE_INFOS.map((info) => ({\n  value: info.id,\n  label: info.label\n}));\nvar PdfAnnotationFlagName = Object.freeze({\n  [\n    1\n    /* INVISIBLE */\n  ]: \"invisible\",\n  [\n    2\n    /* HIDDEN */\n  ]: \"hidden\",\n  [\n    4\n    /* PRINT */\n  ]: \"print\",\n  [\n    8\n    /* NO_ZOOM */\n  ]: \"noZoom\",\n  [\n    16\n    /* NO_ROTATE */\n  ]: \"noRotate\",\n  [\n    32\n    /* NO_VIEW */\n  ]: \"noView\",\n  [\n    64\n    /* READ_ONLY */\n  ]: \"readOnly\",\n  [\n    128\n    /* LOCKED */\n  ]: \"locked\",\n  [\n    256\n    /* TOGGLE_NOVIEW */\n  ]: \"toggleNoView\"\n});\nvar PdfAnnotationFlagValue = Object.entries(\n  PdfAnnotationFlagName\n).reduce(\n  (acc, [bit, name]) => {\n    acc[name] = Number(bit);\n    return acc;\n  },\n  {}\n);\nfunction ignore() {\n}\n\n// ../core/dist/index.js\nvar Z = class {\n  constructor(t, e) {\n    if (this.id = t, this.registry = e, this.debouncedActions = {}, this.unsubscribeFromState = null, this.unsubscribeFromCoreStore = null, t !== this.constructor.id)\n      throw new Error(\n        `Plugin ID mismatch: ${t} !== ${this.constructor.id}`\n      );\n    this.coreStore = this.registry.getStore(), this.pluginStore = this.coreStore.getPluginStore(this.id), this.unsubscribeFromState = this.pluginStore.subscribeToState((i, r, n) => {\n      this.onStoreUpdated(n, r);\n    }), this.unsubscribeFromCoreStore = this.coreStore.subscribe((i, r, n) => {\n      this.onCoreStoreUpdated(n, r);\n    }), this.readyPromise = new Promise((i) => {\n      this.readyResolve = i;\n    }), this.readyResolve();\n  }\n  provides() {\n    if (!this._capability) {\n      const t = this.buildCapability();\n      this._capability = Object.freeze(t);\n    }\n    return this._capability;\n  }\n  /**\n   *  Get a copy of the current state\n   */\n  get state() {\n    return this.pluginStore.getState();\n  }\n  /**\n   *  Get a copy of the current core state\n   */\n  get coreState() {\n    return this.coreStore.getState();\n  }\n  /**\n   * @deprecated  use `this.state` Get a copy of the current state\n   */\n  getState() {\n    return this.pluginStore.getState();\n  }\n  /**\n   * @deprecated  use `this.coreState` Get a copy of the current core state\n   */\n  getCoreState() {\n    return this.coreStore.getState();\n  }\n  /**\n   * Core Dispatch\n   */\n  dispatchCoreAction(t) {\n    return this.coreStore.dispatchToCore(t);\n  }\n  /**\n   * Dispatch an action to all plugins\n   */\n  dispatchToAllPlugins(t) {\n    return this.coreStore.dispatch(t);\n  }\n  /**\n   * Dispatch an action\n   */\n  dispatch(t) {\n    return this.pluginStore.dispatch(t);\n  }\n  /**\n   * Dispatch an action with debouncing to prevent rapid repeated calls\n   * @param action The action to dispatch\n   * @param debounceTime Time in ms to debounce (default: 100ms)\n   * @returns boolean indicating whether the action was dispatched or debounced\n   */\n  debouncedDispatch(t, e = 100) {\n    const i = Date.now(), r = this.debouncedActions[t.type] || 0;\n    return i - r >= e ? (this.debouncedActions[t.type] = i, this.dispatch(t), true) : false;\n  }\n  /**\n   * Subscribe to state changes\n   */\n  subscribe(t) {\n    return this.pluginStore.subscribeToState(t);\n  }\n  /**\n   * Subscribe to core store changes\n   */\n  subscribeToCoreStore(t) {\n    return this.coreStore.subscribe(t);\n  }\n  /**\n   * Called when the plugin store state is updated\n   * @param oldState Previous state\n   * @param newState New state\n   */\n  onStoreUpdated(t, e) {\n  }\n  /**\n   * Called when the core store state is updated\n   * @param oldState Previous state\n   * @param newState New state\n   */\n  onCoreStoreUpdated(t, e) {\n  }\n  /**\n   * Cleanup method to be called when plugin is being destroyed\n   */\n  destroy() {\n    this.unsubscribeFromState && (this.unsubscribeFromState(), this.unsubscribeFromState = null), this.unsubscribeFromCoreStore && (this.unsubscribeFromCoreStore(), this.unsubscribeFromCoreStore = null);\n  }\n  /**\n   * Returns a promise that resolves when the plugin is ready\n   */\n  ready() {\n    return this.readyPromise;\n  }\n  /**\n   * Mark the plugin as ready\n   */\n  markReady() {\n    this.readyResolve();\n  }\n  /**\n   * Reset the ready state (useful for plugins that need to reinitialize)\n   */\n  resetReady() {\n    this.readyPromise = new Promise((t) => {\n      this.readyResolve = t;\n    });\n  }\n};\nfunction et() {\n  const s = /* @__PURE__ */ new Set();\n  return {\n    emit: (e = void 0) => s.forEach((i) => i(e)),\n    on: (e) => (s.add(e), () => s.delete(e)),\n    off: (e) => s.delete(e),\n    clear: () => s.clear()\n  };\n}\n\n// src/lib/capture-plugin.ts\nvar CapturePlugin = class extends Z {\n  constructor(id, registry, config) {\n    super(id, registry);\n    this.captureArea$ = et();\n    this.config = config;\n    this.renderCapability = this.registry.getPlugin(\"render\").provides();\n    this.interactionManagerCapability = this.registry.getPlugin(\"interaction-manager\").provides();\n    this.interactionManagerCapability.registerMode({\n      id: \"marqueeCapture\",\n      scope: \"page\",\n      exclusive: true,\n      cursor: \"crosshair\"\n    });\n  }\n  async initialize(_) {\n  }\n  buildCapability() {\n    return {\n      onCaptureArea: this.captureArea$.on,\n      captureArea: this.captureArea.bind(this),\n      enableMarqueeCapture: this.enableMarqueeCapture.bind(this),\n      disableMarqueeCapture: this.disableMarqueeCapture.bind(this),\n      toggleMarqueeCapture: this.toggleMarqueeCapture.bind(this),\n      isMarqueeCaptureActive: () => this.interactionManagerCapability?.getActiveMode() === \"marqueeCapture\"\n    };\n  }\n  captureArea(pageIndex, rect) {\n    this.disableMarqueeCapture();\n    const task = this.renderCapability.renderPageRect({\n      pageIndex,\n      rect,\n      imageType: this.config.imageType,\n      scaleFactor: this.config.scale,\n      options: {\n        withAnnotations: this.config.withAnnotations || false\n      }\n    });\n    task.wait((blob) => {\n      this.captureArea$.emit({\n        pageIndex,\n        rect,\n        blob,\n        imageType: this.config.imageType || \"image/png\",\n        scale: this.config.scale || 1,\n        withAnnotations: this.config.withAnnotations || false\n      });\n    }, ignore);\n  }\n  enableMarqueeCapture() {\n    this.interactionManagerCapability?.activate(\"marqueeCapture\");\n  }\n  disableMarqueeCapture() {\n    this.interactionManagerCapability?.activate(\"default\");\n  }\n  toggleMarqueeCapture() {\n    if (this.interactionManagerCapability?.getActiveMode() === \"marqueeCapture\") {\n      this.interactionManagerCapability?.activate(\"default\");\n    } else {\n      this.interactionManagerCapability?.activate(\"marqueeCapture\");\n    }\n  }\n};\nCapturePlugin.id = \"capture\";\n\n// src/lib/index.ts\nvar CapturePluginPackage = {\n  manifest,\n  create: (registry, _engine, config) => new CapturePlugin(CAPTURE_PLUGIN_ID, registry, config),\n  reducer: () => {\n  },\n  initialState: {}\n};\nexport {\n  CAPTURE_PLUGIN_ID,\n  CapturePlugin,\n  CapturePluginPackage,\n  manifest\n};\n//# sourceMappingURL=index.js.map","// src/lib/manifest.ts\nvar HISTORY_PLUGIN_ID = \"history\";\nvar manifest = {\n  id: HISTORY_PLUGIN_ID,\n  name: \"History Plugin\",\n  version: \"1.0.0\",\n  provides: [\"history\"],\n  requires: [],\n  optional: [],\n  defaultConfig: {\n    enabled: true\n  }\n};\n\n// ../models/dist/index.js\nvar PdfSoftHyphenMarker = \"\\xAD\";\nvar PdfZeroWidthSpace = \"\\u200B\";\nvar PdfWordJoiner = \"\\u2060\";\nvar PdfBomOrZwnbsp = \"\\uFEFF\";\nvar PdfNonCharacterFFFE = \"\\uFFFE\";\nvar PdfNonCharacterFFFF = \"\\uFFFF\";\nvar PdfUnwantedTextMarkers = Object.freeze([\n  PdfSoftHyphenMarker,\n  PdfZeroWidthSpace,\n  PdfWordJoiner,\n  PdfBomOrZwnbsp,\n  PdfNonCharacterFFFE,\n  PdfNonCharacterFFFF\n]);\nvar PdfUnwantedTextRegex = new RegExp(`[${PdfUnwantedTextMarkers.join(\"\")}]`, \"g\");\nvar MixedBlendMode = Symbol(\"mixed\");\nvar BLEND_MODE_INFOS = Object.freeze([\n  { id: 0, label: \"Normal\", css: \"normal\" },\n  { id: 1, label: \"Multiply\", css: \"multiply\" },\n  { id: 2, label: \"Screen\", css: \"screen\" },\n  { id: 3, label: \"Overlay\", css: \"overlay\" },\n  { id: 4, label: \"Darken\", css: \"darken\" },\n  { id: 5, label: \"Lighten\", css: \"lighten\" },\n  { id: 6, label: \"Color Dodge\", css: \"color-dodge\" },\n  { id: 7, label: \"Color Burn\", css: \"color-burn\" },\n  { id: 8, label: \"Hard Light\", css: \"hard-light\" },\n  { id: 9, label: \"Soft Light\", css: \"soft-light\" },\n  { id: 10, label: \"Difference\", css: \"difference\" },\n  { id: 11, label: \"Exclusion\", css: \"exclusion\" },\n  { id: 12, label: \"Hue\", css: \"hue\" },\n  { id: 13, label: \"Saturation\", css: \"saturation\" },\n  { id: 14, label: \"Color\", css: \"color\" },\n  { id: 15, label: \"Luminosity\", css: \"luminosity\" }\n]);\nvar enumToInfo = BLEND_MODE_INFOS.reduce(\n  (m, info) => {\n    m[info.id] = info;\n    return m;\n  },\n  {}\n);\nvar cssToEnum = BLEND_MODE_INFOS.reduce((m, info) => {\n  m[info.css] = info.id;\n  return m;\n}, {});\nvar blendModeSelectOptions = BLEND_MODE_INFOS.map((info) => ({\n  value: info.id,\n  label: info.label\n}));\nvar PdfAnnotationFlagName = Object.freeze({\n  [\n    1\n    /* INVISIBLE */\n  ]: \"invisible\",\n  [\n    2\n    /* HIDDEN */\n  ]: \"hidden\",\n  [\n    4\n    /* PRINT */\n  ]: \"print\",\n  [\n    8\n    /* NO_ZOOM */\n  ]: \"noZoom\",\n  [\n    16\n    /* NO_ROTATE */\n  ]: \"noRotate\",\n  [\n    32\n    /* NO_VIEW */\n  ]: \"noView\",\n  [\n    64\n    /* READ_ONLY */\n  ]: \"readOnly\",\n  [\n    128\n    /* LOCKED */\n  ]: \"locked\",\n  [\n    256\n    /* TOGGLE_NOVIEW */\n  ]: \"toggleNoView\"\n});\nvar PdfAnnotationFlagValue = Object.entries(\n  PdfAnnotationFlagName\n).reduce(\n  (acc, [bit, name]) => {\n    acc[name] = Number(bit);\n    return acc;\n  },\n  {}\n);\n\n// ../core/dist/index.js\nvar Z = class {\n  constructor(t, e) {\n    if (this.id = t, this.registry = e, this.debouncedActions = {}, this.unsubscribeFromState = null, this.unsubscribeFromCoreStore = null, t !== this.constructor.id)\n      throw new Error(\n        `Plugin ID mismatch: ${t} !== ${this.constructor.id}`\n      );\n    this.coreStore = this.registry.getStore(), this.pluginStore = this.coreStore.getPluginStore(this.id), this.unsubscribeFromState = this.pluginStore.subscribeToState((i, r, n) => {\n      this.onStoreUpdated(n, r);\n    }), this.unsubscribeFromCoreStore = this.coreStore.subscribe((i, r, n) => {\n      this.onCoreStoreUpdated(n, r);\n    }), this.readyPromise = new Promise((i) => {\n      this.readyResolve = i;\n    }), this.readyResolve();\n  }\n  provides() {\n    if (!this._capability) {\n      const t = this.buildCapability();\n      this._capability = Object.freeze(t);\n    }\n    return this._capability;\n  }\n  /**\n   *  Get a copy of the current state\n   */\n  get state() {\n    return this.pluginStore.getState();\n  }\n  /**\n   *  Get a copy of the current core state\n   */\n  get coreState() {\n    return this.coreStore.getState();\n  }\n  /**\n   * @deprecated  use `this.state` Get a copy of the current state\n   */\n  getState() {\n    return this.pluginStore.getState();\n  }\n  /**\n   * @deprecated  use `this.coreState` Get a copy of the current core state\n   */\n  getCoreState() {\n    return this.coreStore.getState();\n  }\n  /**\n   * Core Dispatch\n   */\n  dispatchCoreAction(t) {\n    return this.coreStore.dispatchToCore(t);\n  }\n  /**\n   * Dispatch an action to all plugins\n   */\n  dispatchToAllPlugins(t) {\n    return this.coreStore.dispatch(t);\n  }\n  /**\n   * Dispatch an action\n   */\n  dispatch(t) {\n    return this.pluginStore.dispatch(t);\n  }\n  /**\n   * Dispatch an action with debouncing to prevent rapid repeated calls\n   * @param action The action to dispatch\n   * @param debounceTime Time in ms to debounce (default: 100ms)\n   * @returns boolean indicating whether the action was dispatched or debounced\n   */\n  debouncedDispatch(t, e = 100) {\n    const i = Date.now(), r = this.debouncedActions[t.type] || 0;\n    return i - r >= e ? (this.debouncedActions[t.type] = i, this.dispatch(t), true) : false;\n  }\n  /**\n   * Subscribe to state changes\n   */\n  subscribe(t) {\n    return this.pluginStore.subscribeToState(t);\n  }\n  /**\n   * Subscribe to core store changes\n   */\n  subscribeToCoreStore(t) {\n    return this.coreStore.subscribe(t);\n  }\n  /**\n   * Called when the plugin store state is updated\n   * @param oldState Previous state\n   * @param newState New state\n   */\n  onStoreUpdated(t, e) {\n  }\n  /**\n   * Called when the core store state is updated\n   * @param oldState Previous state\n   * @param newState New state\n   */\n  onCoreStoreUpdated(t, e) {\n  }\n  /**\n   * Cleanup method to be called when plugin is being destroyed\n   */\n  destroy() {\n    this.unsubscribeFromState && (this.unsubscribeFromState(), this.unsubscribeFromState = null), this.unsubscribeFromCoreStore && (this.unsubscribeFromCoreStore(), this.unsubscribeFromCoreStore = null);\n  }\n  /**\n   * Returns a promise that resolves when the plugin is ready\n   */\n  ready() {\n    return this.readyPromise;\n  }\n  /**\n   * Mark the plugin as ready\n   */\n  markReady() {\n    this.readyResolve();\n  }\n  /**\n   * Reset the ready state (useful for plugins that need to reinitialize)\n   */\n  resetReady() {\n    this.readyPromise = new Promise((t) => {\n      this.readyResolve = t;\n    });\n  }\n};\nfunction et() {\n  const s = /* @__PURE__ */ new Set();\n  return {\n    emit: (e = void 0) => s.forEach((i) => i(e)),\n    on: (e) => (s.add(e), () => s.delete(e)),\n    off: (e) => s.delete(e),\n    clear: () => s.clear()\n  };\n}\n\n// src/lib/actions.ts\nvar SET_HISTORY_STATE = \"HISTORY/SET_STATE\";\nvar setHistoryState = (state) => ({\n  type: SET_HISTORY_STATE,\n  payload: state\n});\n\n// src/lib/history-plugin.ts\nvar HistoryPlugin = class extends Z {\n  constructor(id, registry) {\n    super(id, registry);\n    this.topicHistories = /* @__PURE__ */ new Map();\n    this.globalTimeline = [];\n    this.globalIndex = -1;\n    // This emitter will now broadcast the topic string of the affected history.\n    this.historyChange$ = et();\n  }\n  async initialize(_) {\n  }\n  getHistoryState() {\n    const topics = {};\n    Array.from(this.topicHistories.entries()).forEach(([topic, history]) => {\n      topics[topic] = {\n        canUndo: history.currentIndex > -1,\n        canRedo: history.currentIndex < history.commands.length - 1\n      };\n    });\n    return {\n      global: {\n        canUndo: this.globalIndex > -1,\n        canRedo: this.globalIndex < this.globalTimeline.length - 1\n      },\n      topics\n    };\n  }\n  // The emit function now accepts the topic to broadcast.\n  emitHistoryChange(topic) {\n    this.dispatch(setHistoryState(this.getHistoryState()));\n    this.historyChange$.emit(topic);\n  }\n  buildCapability() {\n    return {\n      getHistoryState: () => this.state,\n      onHistoryChange: this.historyChange$.on,\n      register: (command, topic) => {\n        if (!this.topicHistories.has(topic)) {\n          this.topicHistories.set(topic, { commands: [], currentIndex: -1 });\n        }\n        const topicHistory = this.topicHistories.get(topic);\n        topicHistory.commands.splice(topicHistory.currentIndex + 1);\n        topicHistory.commands.push(command);\n        topicHistory.currentIndex++;\n        const historyEntry = { command, topic };\n        this.globalTimeline.splice(this.globalIndex + 1);\n        this.globalTimeline.push(historyEntry);\n        this.globalIndex++;\n        command.execute();\n        this.emitHistoryChange(topic);\n      },\n      undo: (topic) => {\n        let affectedTopic;\n        if (topic) {\n          const topicHistory = this.topicHistories.get(topic);\n          if (topicHistory && topicHistory.currentIndex > -1) {\n            topicHistory.commands[topicHistory.currentIndex].undo();\n            topicHistory.currentIndex--;\n            affectedTopic = topic;\n          }\n        } else {\n          if (this.globalIndex > -1) {\n            const entry = this.globalTimeline[this.globalIndex];\n            entry.command.undo();\n            this.topicHistories.get(entry.topic).currentIndex--;\n            this.globalIndex--;\n            affectedTopic = entry.topic;\n          }\n        }\n        if (affectedTopic) this.emitHistoryChange(affectedTopic);\n      },\n      redo: (topic) => {\n        let affectedTopic;\n        if (topic) {\n          const topicHistory = this.topicHistories.get(topic);\n          if (topicHistory && topicHistory.currentIndex < topicHistory.commands.length - 1) {\n            topicHistory.currentIndex++;\n            topicHistory.commands[topicHistory.currentIndex].execute();\n            affectedTopic = topic;\n          }\n        } else {\n          if (this.globalIndex < this.globalTimeline.length - 1) {\n            this.globalIndex++;\n            const entry = this.globalTimeline[this.globalIndex];\n            entry.command.execute();\n            this.topicHistories.get(entry.topic).currentIndex++;\n            affectedTopic = entry.topic;\n          }\n        }\n        if (affectedTopic) this.emitHistoryChange(affectedTopic);\n      },\n      canUndo: (topic) => {\n        if (topic) {\n          const history = this.topicHistories.get(topic);\n          return !!history && history.currentIndex > -1;\n        }\n        return this.globalIndex > -1;\n      },\n      canRedo: (topic) => {\n        if (topic) {\n          const history = this.topicHistories.get(topic);\n          return !!history && history.currentIndex < history.commands.length - 1;\n        }\n        return this.globalIndex < this.globalTimeline.length - 1;\n      }\n    };\n  }\n};\nHistoryPlugin.id = \"history\";\n\n// src/lib/reducer.ts\nvar initialState = {\n  global: {\n    canUndo: false,\n    canRedo: false\n  },\n  topics: {}\n};\nvar reducer = (state = initialState, action) => {\n  switch (action.type) {\n    case SET_HISTORY_STATE:\n      return {\n        ...state,\n        ...action.payload\n      };\n    default:\n      return state;\n  }\n};\n\n// src/lib/index.ts\nvar HistoryPluginPackage = {\n  manifest,\n  create: (registry, _engine) => new HistoryPlugin(HISTORY_PLUGIN_ID, registry),\n  reducer,\n  initialState\n};\nexport {\n  HISTORY_PLUGIN_ID,\n  HistoryPlugin,\n  HistoryPluginPackage,\n  manifest\n};\n//# sourceMappingURL=index.js.map","import { h, Fragment } from 'preact';\nimport { useCaptureCapability } from '@embedpdf/plugin-capture/preact';\nimport { useState, useRef, useEffect } from 'preact/hooks';\nimport { Dialog } from './ui/dialog';\nimport { Button } from './ui/button';\n\ninterface CaptureData {\n  pageIndex: number;\n  rect: any;\n  blob: Blob;\n}\n\nexport function Capture() {\n  const { provides: capture } = useCaptureCapability();\n  const [open, setOpen] = useState(false);\n  const [captureData, setCaptureData] = useState<CaptureData | null>(null);\n  const [previewUrl, setPreviewUrl] = useState<string | null>(null);\n  const [downloadUrl, setDownloadUrl] = useState<string | null>(null);\n  const urlRef = useRef<string | null>(null);\n  const downloadLinkRef = useRef<HTMLAnchorElement>(null);\n\n  const handleClose = () => {\n    // Clean up object URLs\n    if (urlRef.current) {\n      URL.revokeObjectURL(urlRef.current);\n      urlRef.current = null;\n    }\n    if (downloadUrl) {\n      URL.revokeObjectURL(downloadUrl);\n      setDownloadUrl(null);\n    }\n    setOpen(false);\n    setCaptureData(null);\n    setPreviewUrl(null);\n  };\n\n  const handleDownload = () => {\n    if (!captureData || !downloadLinkRef.current) return;\n\n    // Create download URL and trigger download\n    const url = URL.createObjectURL(captureData.blob);\n    setDownloadUrl(url);\n\n    // Use the ref to trigger download\n    downloadLinkRef.current.href = url;\n    downloadLinkRef.current.download = `pdf-capture-page-${captureData.pageIndex + 1}.png`;\n    downloadLinkRef.current.click();\n\n    handleClose();\n  };\n\n  useEffect(() => {\n    if (!capture) return;\n\n    return capture.onCaptureArea(({ pageIndex, rect, blob }) => {\n      setCaptureData({ pageIndex, rect, blob });\n\n      // Create preview URL\n      const objectUrl = URL.createObjectURL(blob);\n      urlRef.current = objectUrl;\n      setPreviewUrl(objectUrl);\n      setOpen(true);\n    });\n  }, [capture]);\n\n  const handleImageLoad = () => {\n    // Clean up the object URL after image loads\n    if (urlRef.current) {\n      URL.revokeObjectURL(urlRef.current);\n      urlRef.current = null;\n    }\n  };\n\n  return (\n    <>\n      <Dialog open={open} onClose={handleClose} title=\"Capture PDF Area\">\n        <div className=\"space-y-6\">\n          <div className=\"flex justify-center\">\n            {previewUrl && (\n              <img\n                src={previewUrl}\n                onLoad={handleImageLoad}\n                alt=\"Captured PDF area\"\n                style={{\n                  maxWidth: '100%',\n                  maxHeight: '400px',\n                  border: '1px solid #e5e7eb',\n                  borderRadius: '4px',\n                  display: 'block',\n                }}\n              />\n            )}\n          </div>\n          <div className=\"flex justify-end space-x-3 border-t border-gray-200 pt-4\">\n            <Button\n              onClick={handleClose}\n              className=\"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm text-gray-700 hover:bg-gray-50\"\n            >\n              Cancel\n            </Button>\n            <Button\n              onClick={handleDownload}\n              disabled={!captureData}\n              className=\"rounded-md border border-transparent bg-blue-600 px-4 py-2 text-sm text-white hover:!bg-blue-700 disabled:cursor-not-allowed disabled:opacity-50\"\n            >\n              Download\n            </Button>\n          </div>\n        </div>\n      </Dialog>\n\n      {/* Hidden download link */}\n      <a ref={downloadLinkRef} style={{ display: 'none' }} href=\"\" download=\"\" />\n    </>\n  );\n}\n","import { h } from 'preact';\nimport { useInteractionManager } from '@embedpdf/plugin-interaction-manager/preact';\nimport { useEffect, useState } from 'preact/hooks';\n\ninterface HintState {\n  show: boolean;\n  mode: 'marqueeZoom' | 'marqueeCapture' | null;\n  isAnimating: boolean;\n}\n\nexport const HintLayer = () => {\n  const { provides: interactionManager } = useInteractionManager();\n  const [hint, setHint] = useState<HintState>({\n    show: false,\n    mode: null,\n    isAnimating: false,\n  });\n\n  useEffect(() => {\n    if (!interactionManager) return;\n\n    return interactionManager.onModeChange(({ activeMode }) => {\n      if (activeMode === 'marqueeZoom' || activeMode === 'marqueeCapture') {\n        // Show hint for these modes\n        setHint({\n          show: true,\n          mode: activeMode,\n          isAnimating: true,\n        });\n\n        // Hide hint after 3 seconds\n        const timeout = setTimeout(() => {\n          setHint((prev) => ({ ...prev, show: false }));\n        }, 3000);\n\n        return () => clearTimeout(timeout);\n      } else {\n        // Hide hint immediately when switching away from these modes\n        setHint({\n          show: false,\n          mode: null,\n          isAnimating: false,\n        });\n      }\n    });\n  }, [interactionManager]);\n\n  const handleAnimationEnd = () => {\n    if (!hint.show) {\n      setHint((prev) => ({ ...prev, isAnimating: false, mode: null }));\n    }\n  };\n\n  if (!hint.show && !hint.isAnimating) return null;\n\n  const hintText =\n    hint.mode === 'marqueeZoom' ? 'Drag to select area to zoom' : 'Drag to select area to capture';\n\n  const hintColor = hint.mode === 'marqueeZoom' ? 'rgba(33,150,243,0.8)' : 'rgba(76,175,80,0.8)';\n\n  return (\n    <div\n      className={`hint-overlay ${hint.show ? 'hint-show' : 'hint-hide'}`}\n      onAnimationEnd={handleAnimationEnd}\n      style={{\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        pointerEvents: 'none',\n        zIndex: 1000,\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        flexDirection: 'column',\n        gap: '20px',\n      }}\n    >\n      {/* Animated hint text */}\n      <div\n        className=\"hint-text\"\n        style={{\n          background: 'rgba(0, 0, 0, 0.8)',\n          color: 'white',\n          padding: '12px 20px',\n          borderRadius: '8px',\n          fontSize: '14px',\n          fontWeight: '500',\n          textAlign: 'center',\n          maxWidth: '250px',\n        }}\n      >\n        {hintText}\n      </div>\n\n      {/* Animated drag demonstration */}\n      <div\n        className=\"drag-demo\"\n        style={{\n          position: 'relative',\n          width: '150px',\n          height: '100px',\n        }}\n      >\n        {/* Static rectangle outline */}\n        <div\n          style={{\n            position: 'absolute',\n            top: '20px',\n            left: '20px',\n            width: '110px',\n            height: '60px',\n            border: `2px dashed ${hintColor}`,\n            borderRadius: '4px',\n            opacity: 0.6,\n          }}\n        />\n\n        {/* Animated growing rectangle */}\n        <div\n          className=\"animated-rect\"\n          style={{\n            position: 'absolute',\n            top: '20px',\n            left: '20px',\n            border: `2px solid ${hintColor}`,\n            backgroundColor: `${hintColor.replace('0.8', '0.15')}`,\n            borderRadius: '4px',\n          }}\n        />\n\n        {/* Realistic mouse cursor */}\n        <div\n          className=\"cursor-demo\"\n          style={{\n            position: 'absolute',\n            width: '20px',\n            height: '20px',\n          }}\n        >\n          <svg\n            width=\"20\"\n            height=\"20\"\n            viewBox=\"0 0 20 20\"\n            fill=\"none\"\n            xmlns=\"http://www.w3.org/2000/svg\"\n          >\n            {/* Cursor shadow */}\n            <path\n              d=\"M3.5 2.5L16.5 10L10 11.5L7.5 16.5L3.5 2.5Z\"\n              fill=\"rgba(0,0,0,0.3)\"\n              transform=\"translate(1,1)\"\n            />\n            {/* Main cursor */}\n            <path d=\"M3 2L16 10L10 11.5L7.5 16L3 2Z\" fill=\"white\" stroke=\"black\" strokeWidth=\"1\" />\n            {/* Cursor highlight */}\n            <path d=\"M4 3.5L13.5 9.5L9.5 10.5L7.5 14L4 3.5Z\" fill=\"rgba(255,255,255,0.8)\" />\n          </svg>\n        </div>\n      </div>\n\n      <style jsx>{`\n        .hint-overlay {\n          animation-duration: 0.3s;\n          animation-fill-mode: both;\n        }\n\n        .hint-show {\n          animation-name: hintFadeIn;\n        }\n\n        .hint-hide {\n          animation-name: hintFadeOut;\n        }\n\n        @keyframes hintFadeIn {\n          from {\n            opacity: 0;\n            transform: translateY(10px);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n\n        @keyframes hintFadeOut {\n          from {\n            opacity: 1;\n            transform: translateY(0);\n          }\n          to {\n            opacity: 0;\n            transform: translateY(-10px);\n          }\n        }\n\n        .animated-rect {\n          animation: rectGrow 2s ease-in-out infinite;\n        }\n\n        @keyframes rectGrow {\n          0% {\n            width: 0;\n            height: 0;\n          }\n          50% {\n            width: 110px;\n            height: 60px;\n          }\n          100% {\n            width: 110px;\n            height: 60px;\n            opacity: 0.7;\n          }\n        }\n\n        .cursor-demo {\n          animation: cursorMove 2s ease-in-out infinite;\n        }\n\n        @keyframes cursorMove {\n          0% {\n            top: 20px;\n            left: 20px;\n          }\n          50% {\n            top: 50px;\n            left: 80px;\n          }\n          100% {\n            top: 80px;\n            left: 130px;\n          }\n        }\n\n        .hint-text {\n          animation: textPulse 0.6s ease-in-out;\n        }\n\n        @keyframes textPulse {\n          0% {\n            transform: scale(0.9);\n          }\n          50% {\n            transform: scale(1.05);\n          }\n          100% {\n            transform: scale(1);\n          }\n        }\n      `}</style>\n    </div>\n  );\n};\n","import React, { useState, useEffect } from 'preact/compat';\nimport { h, Fragment } from 'preact';\nimport styles from '../styles/index.css';\nimport { EmbedPDF } from '@embedpdf/core/preact';\nimport { createPluginRegistration } from '@embedpdf/core';\nimport { usePdfiumEngine } from '@embedpdf/engines/preact';\nimport {\n  AllLogger,\n  ConsoleLogger,\n  NoopLogger,\n  PdfAnnotationSubtype,\n  PerfLogger,\n  Rotation,\n} from '@embedpdf/models';\nimport {\n  VIEWPORT_PLUGIN_ID,\n  ViewportPluginConfig,\n  ViewportPluginPackage,\n  ViewportState,\n} from '@embedpdf/plugin-viewport';\nimport { Viewport } from '@embedpdf/plugin-viewport/preact';\nimport {\n  SCROLL_PLUGIN_ID,\n  ScrollPlugin,\n  ScrollPluginConfig,\n  ScrollPluginPackage,\n  ScrollState,\n  ScrollStrategy,\n} from '@embedpdf/plugin-scroll';\nimport { Scroller } from '@embedpdf/plugin-scroll/preact';\nimport {\n  SPREAD_PLUGIN_ID,\n  SpreadMode,\n  SpreadPlugin,\n  SpreadPluginConfig,\n  SpreadPluginPackage,\n  SpreadState,\n} from '@embedpdf/plugin-spread';\nimport { LOADER_PLUGIN_ID, LoaderPlugin, LoaderPluginPackage } from '@embedpdf/plugin-loader';\nimport { FilePicker } from '@embedpdf/plugin-loader/preact';\nimport {\n  MenuItem,\n  defineComponent,\n  GlobalStoreState,\n  IconRegistry,\n  UIComponentType,\n  UIPlugin,\n  UIPluginConfig,\n  UIPluginPackage,\n  isActive,\n  UI_PLUGIN_ID,\n  isDisabled,\n} from '@embedpdf/plugin-ui';\nimport {\n  attachmentsRenderer,\n  commandMenuRenderer,\n  commentRender,\n  dividerRenderer,\n  groupedItemsRenderer,\n  headerRenderer,\n  iconButtonRenderer,\n  leftPanelMainRenderer,\n  LeftPanelMainProps,\n  outlineRenderer,\n  pageControlsContainerRenderer,\n  PageControlsProps,\n  pageControlsRenderer,\n  panelRenderer,\n  searchRenderer,\n  selectButtonRenderer,\n  tabButtonRenderer,\n  textSelectionMenuRenderer,\n  thumbnailsRender,\n  zoomRenderer,\n  ZoomRendererProps,\n  printModalRenderer,\n  annotationSelectionMenuRenderer,\n} from './renderers';\nimport { leftPanelAnnotationStyleRenderer } from './annotation-sidebar';\nimport { PluginUIProvider } from '@embedpdf/plugin-ui/preact';\nimport {\n  ZOOM_PLUGIN_ID,\n  ZoomMode,\n  ZoomPlugin,\n  ZoomPluginConfig,\n  ZoomPluginPackage,\n  ZoomState,\n} from '@embedpdf/plugin-zoom';\nimport { RenderPluginPackage } from '@embedpdf/plugin-render';\nimport { RenderLayer } from '@embedpdf/plugin-render/preact';\nimport {\n  ROTATE_PLUGIN_ID,\n  RotatePlugin,\n  RotatePluginConfig,\n  RotatePluginPackage,\n} from '@embedpdf/plugin-rotate';\nimport { Rotate } from '@embedpdf/plugin-rotate/preact';\nimport { SEARCH_PLUGIN_ID, SearchPluginPackage, SearchState } from '@embedpdf/plugin-search';\nimport { SearchLayer } from '@embedpdf/plugin-search/preact';\nimport {\n  SELECTION_PLUGIN_ID,\n  SelectionPlugin,\n  SelectionPluginPackage,\n  SelectionState,\n} from '@embedpdf/plugin-selection';\nimport { SelectionLayer, CopyToClipboard } from '@embedpdf/plugin-selection/preact';\nimport { TilingPluginConfig, TilingPluginPackage } from '@embedpdf/plugin-tiling';\nimport { TilingLayer } from '@embedpdf/plugin-tiling/preact';\nimport { ThumbnailPluginConfig, ThumbnailPluginPackage } from '@embedpdf/plugin-thumbnail';\nimport {\n  ANNOTATION_PLUGIN_ID,\n  AnnotationPlugin,\n  AnnotationPluginPackage,\n  AnnotationState,\n  getSelectedAnnotation,\n  getSelectedAnnotationWithPageIndex,\n  makeVariantKey,\n} from '@embedpdf/plugin-annotation';\nimport { AnnotationLayer } from '@embedpdf/plugin-annotation/preact';\nimport { PinchWrapper, MarqueeZoom } from '@embedpdf/plugin-zoom/preact';\nimport { LoadingIndicator } from './ui/loading-indicator';\nimport { PrintPluginConfig, PrintPluginPackage } from '@embedpdf/plugin-print';\nimport { PrintProvider } from '@embedpdf/plugin-print/preact';\nimport {\n  FULLSCREEN_PLUGIN_ID,\n  FullscreenPlugin,\n  FullscreenPluginPackage,\n  FullscreenState,\n} from '@embedpdf/plugin-fullscreen';\nimport { FullscreenProvider } from '@embedpdf/plugin-fullscreen/preact';\nimport { BookmarkPluginPackage } from '@embedpdf/plugin-bookmark';\nimport { EXPORT_PLUGIN_ID, ExportPlugin, ExportPluginPackage } from '@embedpdf/plugin-export';\nimport { Download } from '@embedpdf/plugin-export/preact';\nimport {\n  INTERACTION_MANAGER_PLUGIN_ID,\n  InteractionManagerPlugin,\n  InteractionManagerPluginPackage,\n  InteractionManagerState,\n} from '@embedpdf/plugin-interaction-manager';\nimport {\n  GlobalPointerProvider,\n  PagePointerProvider,\n} from '@embedpdf/plugin-interaction-manager/preact';\nimport { PanMode } from '@embedpdf/plugin-pan/preact';\nimport { PanPluginPackage } from '@embedpdf/plugin-pan';\nimport { CAPTURE_PLUGIN_ID, CapturePlugin, CapturePluginPackage } from '@embedpdf/plugin-capture';\nimport { MarqueeCapture } from '@embedpdf/plugin-capture/preact';\nimport {\n  HISTORY_PLUGIN_ID,\n  HistoryPlugin,\n  HistoryPluginPackage,\n  HistoryState,\n} from '@embedpdf/plugin-history';\nimport { Capture } from './capture';\nimport { HintLayer } from './hint-layer';\n\nexport { ScrollStrategy, ZoomMode, SpreadMode, Rotation };\n\n// **Enhanced Configuration Interface**\nexport interface PluginConfigs {\n  viewport?: ViewportPluginConfig;\n  scroll?: ScrollPluginConfig;\n  zoom?: ZoomPluginConfig;\n  spread?: SpreadPluginConfig;\n  rotate?: RotatePluginConfig;\n  tiling?: TilingPluginConfig;\n  thumbnail?: ThumbnailPluginConfig;\n  print?: PrintPluginConfig;\n}\n\nexport interface PDFViewerConfig {\n  src: string;\n  worker?: boolean;\n  wasmUrl?: string;\n  plugins?: PluginConfigs;\n  log?: boolean;\n}\n\n// **Default Plugin Configurations**\nconst DEFAULT_PLUGIN_CONFIGS: Required<PluginConfigs> = {\n  viewport: {\n    viewportGap: 10,\n  },\n  scroll: {\n    strategy: ScrollStrategy.Vertical,\n  },\n  zoom: {\n    defaultZoomLevel: ZoomMode.FitPage,\n  },\n  spread: {\n    defaultSpreadMode: SpreadMode.None,\n  },\n  rotate: {\n    defaultRotation: Rotation.Degree0,\n  },\n  tiling: {\n    tileSize: 768,\n    overlapPx: 2.5,\n    extraRings: 0,\n  },\n  thumbnail: {\n    width: 150,\n    gap: 10,\n    buffer: 3,\n    labelHeight: 30,\n  },\n  print: {\n    batchSize: 3,\n  },\n};\n\n// **Utility function to merge configurations**\nfunction mergePluginConfigs(userConfigs: PluginConfigs = {}): Required<PluginConfigs> {\n  return {\n    viewport: { ...DEFAULT_PLUGIN_CONFIGS.viewport, ...userConfigs.viewport },\n    scroll: { ...DEFAULT_PLUGIN_CONFIGS.scroll, ...userConfigs.scroll },\n    zoom: { ...DEFAULT_PLUGIN_CONFIGS.zoom, ...userConfigs.zoom },\n    spread: { ...DEFAULT_PLUGIN_CONFIGS.spread, ...userConfigs.spread },\n    rotate: { ...DEFAULT_PLUGIN_CONFIGS.rotate, ...userConfigs.rotate },\n    tiling: { ...DEFAULT_PLUGIN_CONFIGS.tiling, ...userConfigs.tiling },\n    thumbnail: { ...DEFAULT_PLUGIN_CONFIGS.thumbnail, ...userConfigs.thumbnail },\n    print: { ...DEFAULT_PLUGIN_CONFIGS.print, ...userConfigs.print },\n  };\n}\n\n// **Props for the PDFViewer Component**\ninterface PDFViewerProps {\n  config: PDFViewerConfig;\n}\n\ntype State = GlobalStoreState<{\n  [ZOOM_PLUGIN_ID]: ZoomState;\n  [VIEWPORT_PLUGIN_ID]: ViewportState;\n  [SCROLL_PLUGIN_ID]: ScrollState;\n  [SPREAD_PLUGIN_ID]: SpreadState;\n  [SEARCH_PLUGIN_ID]: SearchState;\n  [SELECTION_PLUGIN_ID]: SelectionState;\n  [ANNOTATION_PLUGIN_ID]: AnnotationState;\n  [FULLSCREEN_PLUGIN_ID]: FullscreenState;\n  [INTERACTION_MANAGER_PLUGIN_ID]: InteractionManagerState;\n  [HISTORY_PLUGIN_ID]: HistoryState;\n}>;\n\nexport const icons: IconRegistry = {\n  menu: {\n    id: 'menu',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-menu\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M4 8l16 0\" /><path d=\"M4 16l16 0\" /></svg>',\n  },\n  download: {\n    id: 'download',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-download\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2\" /><path d=\"M7 11l5 5l5 -5\" /><path d=\"M12 4l0 12\" /></svg>',\n  },\n  fullscreen: {\n    id: 'fullscreen',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-maximize\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M4 8v-2a2 2 0 0 1 2 -2h2\" /><path d=\"M4 16v2a2 2 0 0 0 2 2h2\" /><path d=\"M16 4h2a2 2 0 0 1 2 2v2\" /><path d=\"M16 20h2a2 2 0 0 0 2 -2v-2\" /></svg>',\n  },\n  fullscreenExit: {\n    id: 'fullscreenExit',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-maximize-off\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M4 8v-2c0 -.551 .223 -1.05 .584 -1.412\" /><path d=\"M4 16v2a2 2 0 0 0 2 2h2\" /><path d=\"M16 4h2a2 2 0 0 1 2 2v2\" /><path d=\"M16 20h2c.545 0 1.04 -.218 1.4 -.572\" /><path d=\"M3 3l18 18\" /></svg>',\n  },\n  save: {\n    id: 'save',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-device-floppy\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2\" /><path d=\"M12 14m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0\" /><path d=\"M14 4l0 4l-6 0l0 -4\" /></svg>',\n  },\n  print: {\n    id: 'print',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-printer\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M17 17h2a2 2 0 0 0 2 -2v-4a2 2 0 0 0 -2 -2h-14a2 2 0 0 0 -2 2v4a2 2 0 0 0 2 2h2\" /><path d=\"M17 9v-4a2 2 0 0 0 -2 -2h-6a2 2 0 0 0 -2 2v4\" /><path d=\"M7 13m0 2a2 2 0 0 1 2 -2h6a2 2 0 0 1 2 2v4a2 2 0 0 1 -2 2h-6a2 2 0 0 1 -2 -2z\" /></svg>',\n  },\n  settings: {\n    id: 'settings',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-settings\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z\" /><path d=\"M9 12a3 3 0 1 0 6 0a3 3 0 0 0 -6 0\" /></svg>',\n  },\n  viewSettings: {\n    id: 'viewSettings',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-file-settings\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M12 14m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0\" /><path d=\"M12 10.5v1.5\" /><path d=\"M12 16v1.5\" /><path d=\"M15.031 12.25l-1.299 .75\" /><path d=\"M10.268 15l-1.3 .75\" /><path d=\"M15 15.803l-1.285 -.773\" /><path d=\"M10.285 12.97l-1.285 -.773\" /><path d=\"M14 3v4a1 1 0 0 0 1 1h4\" /><path d=\"M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z\" /></svg>',\n  },\n  rotateClockwise: {\n    id: 'rotateClockwise',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-rotate-clockwise\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M4.05 11a8 8 0 1 1 .5 4m-.5 5v-5h5\" /></svg>',\n  },\n  rotateCounterClockwise: {\n    id: 'rotateCounterClockwise',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-rotate\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M19.95 11a8 8 0 1 0 -.5 4m.5 5v-5h-5\" /></svg>',\n  },\n  singlePage: {\n    id: 'singlePage',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-columns-1\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M5 3m0 1a1 1 0 0 1 1 -1h12a1 1 0 0 1 1 1v16a1 1 0 0 1 -1 1h-12a1 1 0 0 1 -1 -1z\" /></svg>',\n  },\n  doublePage: {\n    id: 'doublePage',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-columns-2\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M3 3m0 1a1 1 0 0 1 1 -1h16a1 1 0 0 1 1 1v16a1 1 0 0 1 -1 1h-16a1 1 0 0 1 -1 -1zm9 -1v18\" /></svg>',\n  },\n  zoomIn: {\n    id: 'zoomIn',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-circle-plus\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0\" /><path d=\"M9 12h6\" /><path d=\"M12 9v6\" /></svg>',\n  },\n  zoomOut: {\n    id: 'zoomOut',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-circle-minus\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0\" /><path d=\"M9 12l6 0\" /></svg>',\n  },\n  fitToWidth: {\n    id: 'fitToWidth',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-arrow-autofit-width\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M4 12v-6a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v6\" /><path d=\"M10 18h-7\" /><path d=\"M21 18h-7\" /><path d=\"M6 15l-3 3l3 3\" /><path d=\"M18 15l3 3l-3 3\" /></svg>',\n  },\n  fitToPage: {\n    id: 'fitToPage',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-arrow-autofit-height\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M12 20h-6a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h6\" /><path d=\"M18 14v7\" /><path d=\"M18 3v7\" /><path d=\"M15 18l3 3l3 -3\" /><path d=\"M15 6l3 -3l3 3\" /></svg>',\n  },\n  chevronRight: {\n    id: 'chevronRight',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-chevron-right\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M9 6l6 6l-6 6\" /></svg>',\n  },\n  chevronLeft: {\n    id: 'chevronLeft',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-chevron-left\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M15 6l-6 6l6 6\" /></svg>',\n  },\n  chevronDown: {\n    id: 'chevronDown',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-chevron-down\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M6 9l6 6l6 -6\" /></svg>',\n  },\n  search: {\n    id: 'search',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-search\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0\" /><path d=\"M21 21l-6 -6\" /></svg>',\n  },\n  comment: {\n    id: 'comment',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-message-dots\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M12 11v.01\" /><path d=\"M8 11v.01\" /><path d=\"M16 11v.01\" /><path d=\"M18 4a3 3 0 0 1 3 3v8a3 3 0 0 1 -3 3h-5l-5 3v-3h-2a3 3 0 0 1 -3 -3v-8a3 3 0 0 1 3 -3z\" /></svg>',\n  },\n  sidebar: {\n    id: 'sidebar',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-sidebar-left\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M4 18v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z\" /><path d=\"M14 18v-12a2 2 0 0 0 -2 -2h-6a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h6a2 2 0 0 0 2 -2z\" /></svg>',\n  },\n  dots: {\n    id: 'dots',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-dots\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M5 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0\" /><path d=\"M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0\" /><path d=\"M19 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0\" /></svg>',\n  },\n  vertical: {\n    id: 'vertical',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-arrows-vertical\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M8 7l4 -4l4 4\" /><path d=\"M8 17l4 4l4 -4\" /><path d=\"M12 3l0 18\" /></svg>',\n  },\n  horizontal: {\n    id: 'horizontal',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-arrows-horizontal\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M7 8l-4 4l4 4\" /><path d=\"M17 8l4 4l-4 4\" /><path d=\"M3 12l18 0\" /></svg>',\n  },\n  book: {\n    id: 'book',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-book\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M3 19a9 9 0 0 1 9 0a9 9 0 0 1 9 0\" /><path d=\"M3 6a9 9 0 0 1 9 0a9 9 0 0 1 9 0\" /><path d=\"M3 6l0 13\" /><path d=\"M12 6l0 13\" /><path d=\"M21 6l0 13\" /></svg>',\n  },\n  book2: {\n    id: 'book2',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-book-2\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M19 4v16h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12z\" /><path d=\"M19 16h-12a2 2 0 0 0 -2 2\" /><path d=\"M9 8h6\" /></svg>',\n  },\n  squares: {\n    id: 'squares',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-squares\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M8 10a2 2 0 0 1 2 -2h9a2 2 0 0 1 2 2v9a2 2 0 0 1 -2 2h-9a2 2 0 0 1 -2 -2z\" /><path d=\"M16 8v-3a2 2 0 0 0 -2 -2h-9a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h3\" /></svg>',\n  },\n  listTree: {\n    id: 'listTree',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-list-tree\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M9 6h11\" /><path d=\"M12 12h8\" /><path d=\"M15 18h5\" /><path d=\"M5 6v.01\" /><path d=\"M8 12v.01\" /><path d=\"M11 18v.01\" /></svg>',\n  },\n  paperclip: {\n    id: 'paperclip',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-paperclip\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M15 7l-6.5 6.5a1.5 1.5 0 0 0 3 3l6.5 -6.5a3 3 0 0 0 -6 -6l-6.5 6.5a4.5 4.5 0 0 0 9 9l6.5 -6.5\" /></svg>',\n  },\n  copy: {\n    id: 'copy',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-copy\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z\" /><path d=\"M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1\" /></svg>',\n  },\n  underline: {\n    id: 'underline',\n    svg: '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"100%\"  height=\"100%\" viewBox=\"0 0 24 24\" fill=\"none\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"icon icon-tabler icons-tabler-outline icon-tabler-baseline\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M4 20h16\" stroke=\"currentColor\" /><path d=\"M8 16v-8a4 4 0 1 1 8 0v8\" stroke=\"#000000\" /><path d=\"M8 10h8\" stroke=\"#000000\" /></svg>',\n  },\n  squiggly: {\n    id: 'squiggly',\n    svg: '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"100%\"  height=\"100%\" viewBox=\"0 0 24 24\" fill=\"none\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"icon icon-tabler icons-tabler-outline icon-tabler-baseline-wavy\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M8 16v-8a4 4 0 1 1 8 0v8\" stroke=\"#000000\" /><path d=\"M8 10h8\" stroke=\"#000000\" /><path d=\"M4 20c1.5 -1.5 3.5 -1.5 5 0s3.5 1.5 5 0 3.5 -1.5 5 0\" stroke=\"currentColor\" /></svg>',\n  },\n  strikethrough: {\n    id: 'strikethrough',\n    svg: '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"100%\"  height=\"100%\" viewBox=\"0 0 24 24\" fill=\"none\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"icon icon-tabler icons-tabler-outline icon-tabler-baseline\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M8 16v-8a4 4 0 1 1 8 0v8\" stroke=\"#000000\" /><path d=\"M4 10h16\" stroke=\"currentColor\" /></svg>',\n  },\n  highlight: {\n    id: 'highlight',\n    svg: '<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"100%\"  height=\"100%\" viewBox=\"0 0 24 24\" fill=\"none\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\" class=\"icon icon-tabler icons-tabler-outline icon-tabler-baseline-highlight\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><rect x=\"2\" y=\"6\" width=\"20\" height=\"16\" rx=\"2\" fill=\"currentColor\" stroke=\"none\" /><path d=\"M8 16v-8a4 4 0 1 1 8 0v8\" stroke=\"#000000\"/><path d=\"M8 10h8\" stroke=\"#000000\"/></svg>',\n  },\n  palette: {\n    id: 'palette',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-palette\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25\" /><path d=\"M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0\" /><path d=\"M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0\" /><path d=\"M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0\" /></svg>',\n  },\n  x: {\n    id: 'x',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-x\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M18 6l-12 12\" /><path d=\"M6 6l12 12\" /></svg>',\n  },\n  fileImport: {\n    id: 'fileImport',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-file-import\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M14 3v4a1 1 0 0 0 1 1h4\" /><path d=\"M5 13v-8a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2h-5.5m-9.5 -2h7m-3 -3l3 3l-3 3\" /></svg>',\n  },\n  hand: {\n    id: 'hand',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-hand-stop\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M8 13v-7.5a1.5 1.5 0 0 1 3 0v6.5\" /><path d=\"M11 5.5v-2a1.5 1.5 0 1 1 3 0v8.5\" /><path d=\"M14 5.5a1.5 1.5 0 0 1 3 0v6.5\" /><path d=\"M17 7.5a1.5 1.5 0 0 1 3 0v8.5a6 6 0 0 1 -6 6h-2h.208a6 6 0 0 1 -5.012 -2.7a69.74 69.74 0 0 1 -.196 -.3c-.312 -.479 -1.407 -2.388 -3.286 -5.728a1.5 1.5 0 0 1 .536 -2.022a1.867 1.867 0 0 1 2.28 .28l1.47 1.47\" /></svg>',\n  },\n  zoomInArea: {\n    id: 'zoomInArea',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-zoom-in-area\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M15 13v4\" /><path d=\"M13 15h4\" /><path d=\"M15 15m-5 0a5 5 0 1 0 10 0a5 5 0 1 0 -10 0\" /><path d=\"M22 22l-3 -3\" /><path d=\"M6 18h-1a2 2 0 0 1 -2 -2v-1\" /><path d=\"M3 11v-1\" /><path d=\"M3 6v-1a2 2 0 0 1 2 -2h1\" /><path d=\"M10 3h1\" /><path d=\"M15 3h1a2 2 0 0 1 2 2v1\" /></svg>',\n  },\n  screenshot: {\n    id: 'screenshot',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-screenshot\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M7 19a2 2 0 0 1 -2 -2\" /><path d=\"M5 13v-2\" /><path d=\"M5 7a2 2 0 0 1 2 -2\" /><path d=\"M11 5h2\" /><path d=\"M17 5a2 2 0 0 1 2 2\" /><path d=\"M19 11v2\" /><path d=\"M19 17v4\" /><path d=\"M21 19h-4\" /><path d=\"M13 19h-2\" /></svg>',\n  },\n  arrowBackUp: {\n    id: 'arrowBackUp',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-arrow-back-up\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M9 14l-4 -4l4 -4\" /><path d=\"M5 10h11a4 4 0 1 1 0 8h-1\" /></svg>',\n  },\n  arrowForwardUp: {\n    id: 'arrowForwardUp',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-arrow-forward-up\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M15 14l4 -4l-4 -4\" /><path d=\"M19 10h-11a4 4 0 1 0 0 8h1\" /></svg>',\n  },\n  trash: {\n    id: 'trash',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-trash\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M4 7l16 0\" /><path d=\"M10 11l0 6\" /><path d=\"M14 11l0 6\" /><path d=\"M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12\" /><path d=\"M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3\" /></svg>',\n  },\n  deviceFloppy: {\n    id: 'deviceFloppy',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\"  fill=\"none\"  stroke=\"currentColor\"  stroke-width=\"2\"  stroke-linecap=\"round\"  stroke-linejoin=\"round\"  class=\"icon icon-tabler icons-tabler-outline icon-tabler-device-floppy\"><path stroke=\"none\" d=\"M0 0h24v24H0z\" fill=\"none\"/><path d=\"M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2\" /><path d=\"M12 14m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0\" /><path d=\"M14 4l0 4l-6 0l0 -4\" /></svg>',\n  },\n  pencilMarker: {\n    id: 'pencilMarker',\n    svg: '<svg  xmlns=\"http://www.w3.org/2000/svg\"  width=\"100%\"  height=\"100%\"  viewBox=\"0 0 24 24\" class=\"icon icon-tabler icons-tabler-outline icon-tabler-writing-draw\" stroke-linejoin=\"round\" stroke-linecap=\"round\" stroke-width=\"2\" fill=\"none\"><g transform=\"rotate(47.565 12.1875 10.75)\"><path stroke=\"#000000\" d=\"m14.18752,16.75l0,-12c0,-1.1 -0.9,-2 -2,-2s-2,0.9 -2,2l0,12l2,2l2,-2z\"/><path stroke=\"#000000\" d=\"m10.18752,6.75l4,0\"/></g><path stroke=\"currentColor\" d=\"m19.37499,20.125c0.56874,0.0625 -4.04999,-0.5625 -6.41249,-0.4375c-2.3625,0.125 -4.75833,1.22916 -6.85624,1.625c-1.76458,0.6875 -3.40416,-0.9375 -1.98125,-2.49999\"/></svg>',\n  },\n};\n\nexport const menuItems: Record<string, MenuItem<State>> = {\n  menuCtr: {\n    id: 'menuCtr',\n    icon: 'menu',\n    label: 'Menu',\n    //shortcut: 'Shift+M',\n    //shortcutLabel: 'M',\n    type: 'menu',\n    children: ['openFile', 'download', 'enterFS', 'screenshot', 'print'],\n    active: (storeState) =>\n      storeState.plugins.ui.commandMenu.commandMenu.activeCommand === 'menuCtr',\n  },\n  download: {\n    id: 'download',\n    icon: 'download',\n    label: 'Download',\n    //shortcut: 'Shift+D',\n    //shortcutLabel: 'D',\n    type: 'action',\n    action: (registry) => {\n      const exportPlugin = registry.getPlugin<ExportPlugin>(EXPORT_PLUGIN_ID)?.provides();\n      if (exportPlugin) {\n        exportPlugin.download();\n      }\n    },\n  },\n  openFile: {\n    id: 'openFile',\n    icon: 'fileImport',\n    label: 'Open PDF',\n    type: 'action',\n    action: (registry) => {\n      const loader = registry.getPlugin<LoaderPlugin>(LOADER_PLUGIN_ID)?.provides();\n      if (loader) {\n        loader.openFileDialog();\n      }\n    },\n  },\n  enterFS: {\n    id: 'enterFS',\n    icon: (storeState) => {\n      const fullscreen = storeState.plugins.fullscreen.isFullscreen\n        ? 'fullscreenExit'\n        : 'fullscreen';\n      return fullscreen;\n    },\n    label: (storeState) => {\n      const fullscreen = storeState.plugins.fullscreen.isFullscreen\n        ? 'Exit full screen'\n        : 'Enter full screen';\n      return fullscreen;\n    },\n    //shortcut: 'Shift+F',\n    //shortcutLabel: 'F',\n    type: 'action',\n    action: (registry) => {\n      const fullscreen = registry.getPlugin<FullscreenPlugin>(FULLSCREEN_PLUGIN_ID)?.provides();\n      if (fullscreen) {\n        if (fullscreen.isFullscreen()) {\n          fullscreen.exitFullscreen();\n        } else {\n          fullscreen.enableFullscreen();\n        }\n      }\n    },\n  },\n  screenshot: {\n    id: 'screenshot',\n    icon: 'screenshot',\n    label: 'Screenshot',\n    type: 'action',\n    action: (registry) => {\n      const capture = registry.getPlugin<CapturePlugin>(CAPTURE_PLUGIN_ID)?.provides();\n      if (!capture) return;\n\n      if (capture.isMarqueeCaptureActive()) {\n        capture.disableMarqueeCapture();\n      } else {\n        capture.enableMarqueeCapture();\n      }\n    },\n    active: (storeState) =>\n      storeState.plugins[INTERACTION_MANAGER_PLUGIN_ID].activeMode === 'marqueeCapture',\n  },\n  save: {\n    id: 'save',\n    icon: 'save',\n    label: 'Save',\n    //shortcut: 'Shift+S',\n    //shortcutLabel: 'S',\n    type: 'action',\n    action: () => {\n      console.log('save');\n    },\n  },\n  print: {\n    id: 'print',\n    icon: 'print',\n    label: 'Print',\n    //shortcut: 'Shift+P',\n    //shortcutLabel: 'P',\n    type: 'action',\n    action: (registry, state) => {\n      const ui = registry.getPlugin<UIPlugin>(UI_PLUGIN_ID)?.provides();\n      if (ui) {\n        ui.updateComponentState({\n          componentType: 'floating',\n          componentId: 'printModal',\n          patch: {\n            open: true,\n          },\n        });\n      }\n    },\n  },\n  settings: {\n    id: 'settings',\n    icon: 'settings',\n    label: 'Settings',\n    //shortcut: 'Shift+E',\n    //shortcutLabel: 'E',\n    dividerBefore: true,\n    type: 'action',\n    action: () => {\n      console.log('settings');\n    },\n  },\n  /* --- View controls menu --- */\n  viewCtr: {\n    id: 'viewCtr',\n    icon: 'viewSettings',\n    label: 'View controls',\n    //shortcut: 'Shift+V',\n    //shortcutLabel: 'V',\n    type: 'menu',\n    children: ['pageOrientation', 'scrollLayout', 'pageLayout', 'enterFS'],\n    active: (storeState) =>\n      storeState.plugins.ui.commandMenu.commandMenu.activeCommand === 'viewCtr',\n  },\n  pageOrientation: {\n    id: 'pageOrientation',\n    label: 'Page orientation',\n    type: 'group',\n    children: ['rotateClockwise', 'rotateCounterClockwise'],\n  },\n  rotateClockwise: {\n    id: 'rotateClockwise',\n    label: 'Rotate clockwise',\n    icon: 'rotateClockwise',\n    type: 'action',\n    action: (registry) => {\n      const rotate = registry.getPlugin<RotatePlugin>(ROTATE_PLUGIN_ID)?.provides();\n      if (rotate) {\n        rotate.rotateForward();\n      }\n    },\n  },\n  rotateCounterClockwise: {\n    id: 'rotateCounterClockwise',\n    label: 'Rotate counter clockwise',\n    icon: 'rotateCounterClockwise',\n    type: 'action',\n    action: (registry) => {\n      const rotate = registry.getPlugin<RotatePlugin>(ROTATE_PLUGIN_ID)?.provides();\n      if (rotate) {\n        rotate.rotateBackward();\n      }\n    },\n  },\n  scrollLayout: {\n    id: 'scrollLayout',\n    label: 'Scroll layout',\n    type: 'group',\n    children: ['vertical', 'horizontal'],\n  },\n  vertical: {\n    id: 'vertical',\n    label: 'Vertical',\n    icon: 'vertical',\n    type: 'action',\n    active: (storeState) => storeState.plugins.scroll.strategy === ScrollStrategy.Vertical,\n    action: (registry) => {\n      const scroll = registry.getPlugin<ScrollPlugin>(SCROLL_PLUGIN_ID)?.provides();\n      if (scroll) {\n        scroll.setScrollStrategy(ScrollStrategy.Vertical);\n      }\n    },\n  },\n  horizontal: {\n    id: 'horizontal',\n    label: 'Horizontal',\n    icon: 'horizontal',\n    type: 'action',\n    active: (storeState) => storeState.plugins.scroll.strategy === ScrollStrategy.Horizontal,\n    action: (registry) => {\n      const scroll = registry.getPlugin<ScrollPlugin>(SCROLL_PLUGIN_ID)?.provides();\n      if (scroll) {\n        scroll.setScrollStrategy(ScrollStrategy.Horizontal);\n      }\n    },\n  },\n  pageLayout: {\n    id: 'pageLayout',\n    label: 'Page layout',\n    type: 'group',\n    children: ['singlePage', 'doublePage', 'coverFacingPage'],\n  },\n  singlePage: {\n    id: 'singlePage',\n    label: 'Single page',\n    icon: 'singlePage',\n    type: 'action',\n    disabled: (storeState) => storeState.plugins.scroll.strategy === ScrollStrategy.Horizontal,\n    active: (storeState) => storeState.plugins.spread.spreadMode === SpreadMode.None,\n    action: (registry) => {\n      const spread = registry.getPlugin<SpreadPlugin>(SPREAD_PLUGIN_ID)?.provides();\n      if (spread) {\n        spread.setSpreadMode(SpreadMode.None);\n      }\n    },\n  },\n  doublePage: {\n    id: 'doublePage',\n    label: 'Double page',\n    icon: 'book',\n    type: 'action',\n    disabled: (storeState) => storeState.plugins.scroll.strategy === ScrollStrategy.Horizontal,\n    active: (storeState) => storeState.plugins.spread.spreadMode === SpreadMode.Odd,\n    action: (registry) => {\n      const spread = registry.getPlugin<SpreadPlugin>(SPREAD_PLUGIN_ID)?.provides();\n      if (spread) {\n        spread.setSpreadMode(SpreadMode.Odd);\n      }\n    },\n  },\n  coverFacingPage: {\n    id: 'coverFacingPage',\n    label: 'Cover facing page',\n    icon: 'book2',\n    type: 'action',\n    disabled: (storeState) => storeState.plugins.scroll.strategy === ScrollStrategy.Horizontal,\n    active: (storeState) => storeState.plugins.spread.spreadMode === SpreadMode.Even,\n    action: (registry) => {\n      const spread = registry.getPlugin<SpreadPlugin>(SPREAD_PLUGIN_ID)?.provides();\n      if (spread) {\n        spread.setSpreadMode(SpreadMode.Even);\n      }\n    },\n  },\n  leftAction: {\n    id: 'leftAction',\n    label: 'Left action',\n    type: 'menu',\n    icon: 'dots',\n    children: ['viewCtr', 'zoom'],\n    active: (storeState) =>\n      storeState.plugins.ui.commandMenu.commandMenu.activeCommand === 'leftAction' ||\n      storeState.plugins.ui.commandMenu.commandMenu.activeCommand === 'zoom' ||\n      storeState.plugins.ui.commandMenu.commandMenu.activeCommand === 'changeZoomLevel' ||\n      storeState.plugins.ui.commandMenu.commandMenu.activeCommand === 'viewCtr',\n  },\n  zoom: {\n    id: 'zoom',\n    icon: 'zoomIn',\n    label: 'Zoom Controls',\n    //shortcut: 'Shift+Z',\n    //shortcutLabel: 'Z',\n    type: 'menu',\n    children: ['changeZoomLevel', 'zoomIn', 'zoomOut', 'fitToWidth', 'fitToPage', 'zoomInArea'],\n    active: (storeState) => storeState.plugins.ui.commandMenu.commandMenu.activeCommand === 'zoom',\n  },\n  zoomInArea: {\n    id: 'zoomInArea',\n    label: 'Zoom in area',\n    icon: 'zoomInArea',\n    type: 'action',\n    dividerBefore: true,\n    action: (registry) => {\n      const zoom = registry.getPlugin<ZoomPlugin>(ZOOM_PLUGIN_ID)?.provides();\n      if (!zoom) return;\n\n      if (zoom.isMarqueeZoomActive()) {\n        zoom.disableMarqueeZoom();\n      } else {\n        zoom.enableMarqueeZoom();\n      }\n    },\n    active: (storeState) =>\n      storeState.plugins[INTERACTION_MANAGER_PLUGIN_ID].activeMode === 'marqueeZoom',\n  },\n  changeZoomLevel: {\n    id: 'changeZoomLevel',\n    label: (storeState) =>\n      `Zoom level (${(storeState.plugins.zoom.currentZoomLevel * 100).toFixed(0)}%)`,\n    type: 'menu',\n    children: [\n      'zoom25',\n      'zoom50',\n      'zoom100',\n      'zoom125',\n      'zoom150',\n      'zoom200',\n      'zoom400',\n      'zoom800',\n      'zoom1600',\n    ],\n    active: (storeState) =>\n      storeState.plugins.ui.commandMenu.commandMenu.activeCommand === 'changeZoomLevel',\n  },\n  zoom25: {\n    id: 'zoom25',\n    label: '25%',\n    type: 'action',\n    active: (storeState) => storeState.plugins.zoom.currentZoomLevel === 0.25,\n    action: (registry) => {\n      const zoom = registry.getPlugin<ZoomPlugin>(ZOOM_PLUGIN_ID)?.provides();\n\n      if (zoom) {\n        zoom.requestZoom(0.25);\n      }\n    },\n  },\n  zoom50: {\n    id: 'zoom50',\n    label: '50%',\n    type: 'action',\n    active: (storeState) => storeState.plugins.zoom.currentZoomLevel === 0.5,\n    action: (registry) => {\n      const zoom = registry.getPlugin<ZoomPlugin>(ZOOM_PLUGIN_ID)?.provides();\n\n      if (zoom) {\n        zoom.requestZoom(0.5);\n      }\n    },\n  },\n  zoom100: {\n    id: 'zoom100',\n    label: '100%',\n    type: 'action',\n    active: (storeState) => storeState.plugins.zoom.currentZoomLevel === 1,\n    action: (registry) => {\n      const zoom = registry.getPlugin<ZoomPlugin>(ZOOM_PLUGIN_ID)?.provides();\n\n      if (zoom) {\n        zoom.requestZoom(1);\n      }\n    },\n  },\n  zoom125: {\n    id: 'zoom125',\n    label: '125%',\n    type: 'action',\n    active: (storeState) => storeState.plugins.zoom.currentZoomLevel === 1.25,\n    action: (registry) => {\n      const zoom = registry.getPlugin<ZoomPlugin>(ZOOM_PLUGIN_ID)?.provides();\n\n      if (zoom) {\n        zoom.requestZoom(1.25);\n      }\n    },\n  },\n  zoom150: {\n    id: 'zoom150',\n    label: '150%',\n    type: 'action',\n    active: (storeState) => storeState.plugins.zoom.currentZoomLevel === 1.5,\n    action: (registry) => {\n      const zoom = registry.getPlugin<ZoomPlugin>(ZOOM_PLUGIN_ID)?.provides();\n\n      if (zoom) {\n        zoom.requestZoom(1.5);\n      }\n    },\n  },\n  zoom200: {\n    id: 'zoom200',\n    label: '200%',\n    type: 'action',\n    active: (storeState) => storeState.plugins.zoom.currentZoomLevel === 2,\n    action: (registry) => {\n      const zoom = registry.getPlugin<ZoomPlugin>(ZOOM_PLUGIN_ID)?.provides();\n\n      if (zoom) {\n        zoom.requestZoom(2);\n      }\n    },\n  },\n  zoom400: {\n    id: 'zoom400',\n    label: '400%',\n    type: 'action',\n    active: (storeState) => storeState.plugins.zoom.currentZoomLevel === 4,\n    action: (registry) => {\n      const zoom = registry.getPlugin<ZoomPlugin>(ZOOM_PLUGIN_ID)?.provides();\n\n      if (zoom) {\n        zoom.requestZoom(4);\n      }\n    },\n  },\n  zoom800: {\n    id: 'zoom800',\n    label: '800%',\n    type: 'action',\n    active: (storeState) => storeState.plugins.zoom.currentZoomLevel === 8,\n    action: (registry) => {\n      const zoom = registry.getPlugin<ZoomPlugin>(ZOOM_PLUGIN_ID)?.provides();\n\n      if (zoom) {\n        zoom.requestZoom(8);\n      }\n    },\n  },\n  zoom1600: {\n    id: 'zoom1600',\n    label: '1600%',\n    type: 'action',\n    active: (storeState) => storeState.plugins.zoom.currentZoomLevel === 16,\n    action: (registry) => {\n      const zoom = registry.getPlugin<ZoomPlugin>(ZOOM_PLUGIN_ID)?.provides();\n\n      if (zoom) {\n        zoom.requestZoom(16);\n      }\n    },\n  },\n  zoomIn: {\n    id: 'zoomIn',\n    label: 'Zoom in',\n    icon: 'zoomIn',\n    type: 'action',\n    action: (registry) => {\n      const zoom = registry.getPlugin<ZoomPlugin>(ZOOM_PLUGIN_ID)?.provides();\n\n      if (zoom) {\n        zoom.zoomIn();\n      }\n    },\n  },\n  zoomOut: {\n    id: 'zoomOut',\n    label: 'Zoom out',\n    icon: 'zoomOut',\n    type: 'action',\n    action: (registry) => {\n      const zoom = registry.getPlugin<ZoomPlugin>(ZOOM_PLUGIN_ID)?.provides();\n\n      if (zoom) {\n        zoom.zoomOut();\n      }\n    },\n  },\n  search: {\n    id: 'search',\n    label: 'Search',\n    icon: 'search',\n    type: 'action',\n    action: (registry) => {\n      const ui = registry.getPlugin<UIPlugin>(UI_PLUGIN_ID)?.provides();\n\n      if (ui) {\n        ui.togglePanel({ id: 'rightPanel', visibleChild: 'search' });\n      }\n    },\n    active: (storeState) =>\n      storeState.plugins.ui.panel.rightPanel.open === true &&\n      storeState.plugins.ui.panel.rightPanel.visibleChild === 'search',\n  },\n  comment: {\n    id: 'comment',\n    label: 'Comment',\n    icon: 'comment',\n    type: 'action',\n    action: (registry) => {\n      const ui = registry.getPlugin<UIPlugin>(UI_PLUGIN_ID)?.provides();\n\n      if (ui) {\n        ui.togglePanel({ id: 'rightPanel', visibleChild: 'comment' });\n      }\n    },\n    active: (storeState) =>\n      storeState.plugins.ui.panel.rightPanel.open === true &&\n      storeState.plugins.ui.panel.rightPanel.visibleChild === 'comment',\n  },\n  fitToWidth: {\n    id: 'fitToWidth',\n    label: 'Fit to width',\n    icon: 'fitToWidth',\n    type: 'action',\n    active: (storeState) => storeState.plugins.zoom.zoomLevel === ZoomMode.FitWidth,\n    action: (registry) => {\n      const zoom = registry.getPlugin<ZoomPlugin>(ZOOM_PLUGIN_ID)?.provides();\n\n      if (zoom) {\n        zoom.requestZoom(ZoomMode.FitWidth);\n      }\n    },\n  },\n  fitToPage: {\n    id: 'fitToPage',\n    label: 'Fit to page',\n    icon: 'fitToPage',\n    type: 'action',\n    active: (storeState) => storeState.plugins.zoom.zoomLevel === ZoomMode.FitPage,\n    action: (registry) => {\n      const zoom = registry.getPlugin<ZoomPlugin>(ZOOM_PLUGIN_ID)?.provides();\n\n      if (zoom) {\n        zoom.requestZoom(ZoomMode.FitPage);\n      }\n    },\n  },\n  sidebar: {\n    id: 'sidebar',\n    label: 'Sidebar',\n    icon: 'sidebar',\n    type: 'action',\n    action: (registry, state) => {\n      const ui = registry.getPlugin<UIPlugin>(UI_PLUGIN_ID)?.provides();\n\n      if (ui) {\n        ui.togglePanel({\n          id: 'leftPanel',\n          visibleChild: 'leftPanelMain',\n          open:\n            state.plugins.ui.panel.leftPanel.open === true &&\n            state.plugins.ui.panel.leftPanel.visibleChild === 'leftPanelMain'\n              ? false\n              : true,\n        });\n      }\n    },\n    active: (storeState) =>\n      storeState.plugins.ui.panel.leftPanel.open === true &&\n      storeState.plugins.ui.panel.leftPanel.visibleChild === 'leftPanelMain',\n  },\n  sidebarMenu: {\n    id: 'sidebarMenu',\n    label: 'Sidebar Menu',\n    type: 'menu',\n    children: ['thumbnails', 'outline' /*, 'attachments'*/],\n  },\n  thumbnails: {\n    id: 'thumbnails',\n    label: 'Thumbnails',\n    icon: 'squares',\n    type: 'action',\n    action: (registry) => {\n      const ui = registry.getPlugin<UIPlugin>(UI_PLUGIN_ID)?.provides();\n\n      if (ui) {\n        ui.togglePanel({ id: 'leftPanel', visibleChild: 'leftPanelMain', open: true });\n        ui.updateComponentState({\n          componentType: 'custom',\n          componentId: 'leftPanelMain',\n          patch: {\n            visibleChild: 'thumbnails',\n          },\n        });\n      }\n    },\n    active: (storeState) =>\n      storeState.plugins.ui.custom.leftPanelMain.visibleChild === 'thumbnails',\n  },\n  outline: {\n    id: 'outline',\n    label: 'Outline',\n    icon: 'listTree',\n    type: 'action',\n    action: (registry) => {\n      const ui = registry.getPlugin<UIPlugin>(UI_PLUGIN_ID)?.provides();\n\n      if (ui) {\n        ui.togglePanel({ id: 'leftPanel', visibleChild: 'leftPanelMain', open: true });\n        ui.updateComponentState({\n          componentType: 'custom',\n          componentId: 'leftPanelMain',\n          patch: {\n            visibleChild: 'outline',\n          },\n        });\n      }\n    },\n    active: (storeState) => storeState.plugins.ui.custom.leftPanelMain.visibleChild === 'outline',\n  },\n  attachments: {\n    id: 'attachments',\n    label: 'Attachments',\n    icon: 'paperclip',\n    type: 'action',\n    action: (registry) => {\n      const ui = registry.getPlugin<UIPlugin>(UI_PLUGIN_ID)?.provides();\n\n      if (ui) {\n        ui.togglePanel({ id: 'leftPanel', visibleChild: 'leftPanelMain', open: true });\n        ui.updateComponentState({\n          componentType: 'custom',\n          componentId: 'leftPanelMain',\n          patch: {\n            visibleChild: 'attachments',\n          },\n        });\n      }\n    },\n    active: (storeState) =>\n      storeState.plugins.ui.custom.leftPanelMain.visibleChild === 'attachments',\n  },\n  view: {\n    id: 'view',\n    label: 'View',\n    type: 'action',\n    //shortcut: 'Shift+V',\n    //shortcutLabel: 'V',\n    action: (registry) => {\n      const ui = registry.getPlugin<UIPlugin>(UI_PLUGIN_ID)?.provides();\n      const annotation = registry.getPlugin<AnnotationPlugin>(ANNOTATION_PLUGIN_ID)?.provides();\n      if (ui) {\n        ui.setHeaderVisible({ id: 'toolsHeader', visible: false });\n        annotation?.setActiveVariant(null);\n      }\n    },\n    active: (storeState) => storeState.plugins.ui.header.toolsHeader.visible === false,\n  },\n  annotate: {\n    id: 'annotate',\n    label: 'Annotate',\n    type: 'action',\n    //shortcut: 'Shift+A',\n    //shortcutLabel: 'A',\n    action: (registry) => {\n      const ui = registry.getPlugin<UIPlugin>(UI_PLUGIN_ID)?.provides();\n\n      if (ui) {\n        ui.setHeaderVisible({ id: 'toolsHeader', visible: true, visibleChild: 'annotationTools' });\n      }\n    },\n    active: (storeState) =>\n      storeState.plugins.ui.header.toolsHeader.visible === true &&\n      storeState.plugins.ui.header.toolsHeader.visibleChild === 'annotationTools',\n  },\n  shapes: {\n    id: 'shapes',\n    label: 'Shapes',\n    type: 'action',\n    //shortcut: 'Shift+S',\n    //shortcutLabel: 'S',\n    action: (registry) => {\n      const ui = registry.getPlugin<UIPlugin>(UI_PLUGIN_ID)?.provides();\n\n      if (ui) {\n        ui.setHeaderVisible({ id: 'toolsHeader', visible: true, visibleChild: 'shapeTools' });\n      }\n    },\n    active: (storeState) =>\n      storeState.plugins.ui.header.toolsHeader.visible === true &&\n      storeState.plugins.ui.header.toolsHeader.visibleChild === 'shapeTools',\n  },\n  fillAndSign: {\n    id: 'fillAndSign',\n    label: 'Fill and Sign',\n    type: 'action',\n    action: (registry) => {\n      const ui = registry.getPlugin<UIPlugin>(UI_PLUGIN_ID)?.provides();\n\n      if (ui) {\n        ui.setHeaderVisible({ id: 'toolsHeader', visible: true, visibleChild: 'fillAndSignTools' });\n      }\n    },\n    active: (storeState) =>\n      storeState.plugins.ui.header.toolsHeader.visible === true &&\n      storeState.plugins.ui.header.toolsHeader.visibleChild === 'fillAndSignTools',\n  },\n  form: {\n    id: 'form',\n    label: 'Form',\n    type: 'action',\n    action: (registry) => {\n      const ui = registry.getPlugin<UIPlugin>(UI_PLUGIN_ID)?.provides();\n\n      if (ui) {\n        ui.setHeaderVisible({ id: 'toolsHeader', visible: true, visibleChild: 'formTools' });\n      }\n    },\n    active: (storeState) =>\n      storeState.plugins.ui.header.toolsHeader.visible === true &&\n      storeState.plugins.ui.header.toolsHeader.visibleChild === 'formTools',\n  },\n  tabOverflow: {\n    id: 'tabOverflow',\n    label: 'More',\n    icon: 'dots',\n    type: 'menu',\n    children: ['view', 'annotate' /*,'shapes', 'fillAndSign', 'form'*/],\n    active: (storeState) =>\n      storeState.plugins.ui.commandMenu.commandMenu.activeCommand === 'tabOverflow',\n  },\n  nextPage: {\n    id: 'nextPage',\n    label: 'Next page',\n    icon: 'chevronRight',\n    shortcut: 'ArrowRight',\n    shortcutLabel: 'Arrow Right',\n    type: 'action',\n    action: (registry) => {\n      const scroll = registry.getPlugin<ScrollPlugin>(SCROLL_PLUGIN_ID)?.provides();\n\n      if (scroll) {\n        scroll.scrollToNextPage();\n      }\n    },\n  },\n  previousPage: {\n    id: 'previousPage',\n    label: 'Previous page',\n    icon: 'chevronLeft',\n    type: 'action',\n    shortcut: 'ArrowLeft',\n    shortcutLabel: 'Arrow Left',\n    action: (registry) => {\n      const scroll = registry.getPlugin<ScrollPlugin>(SCROLL_PLUGIN_ID)?.provides();\n\n      if (scroll) {\n        scroll.scrollToPreviousPage();\n      }\n    },\n  },\n  copy: {\n    id: 'copy',\n    label: 'Copy',\n    icon: 'copy',\n    type: 'action',\n    shortcut: 'Meta+C',\n    shortcutLabel: 'Cmd+C',\n    action: (registry) => {\n      const selection = registry.getPlugin<SelectionPlugin>(SELECTION_PLUGIN_ID)?.provides();\n      if (selection) {\n        selection.copyToClipboard();\n        selection.clear();\n      }\n    },\n  },\n  underline: {\n    id: 'underline',\n    label: 'Underline',\n    type: 'action',\n    icon: 'underline',\n    action: (registry, state) => {\n      const annotation = registry.getPlugin<AnnotationPlugin>(ANNOTATION_PLUGIN_ID)?.provides();\n      if (annotation) {\n        if (\n          state.plugins.annotation.activeVariant === makeVariantKey(PdfAnnotationSubtype.UNDERLINE)\n        ) {\n          annotation.setActiveVariant(null);\n        } else {\n          annotation.setActiveVariant(makeVariantKey(PdfAnnotationSubtype.UNDERLINE));\n        }\n      }\n    },\n    active: (storeState) =>\n      storeState.plugins.annotation.activeVariant ===\n      makeVariantKey(PdfAnnotationSubtype.UNDERLINE),\n  },\n  squiggly: {\n    id: 'squiggly',\n    label: 'Squiggly',\n    type: 'action',\n    icon: 'squiggly',\n    action: (registry, state) => {\n      const annotation = registry.getPlugin<AnnotationPlugin>(ANNOTATION_PLUGIN_ID)?.provides();\n      if (annotation) {\n        if (\n          state.plugins.annotation.activeVariant === makeVariantKey(PdfAnnotationSubtype.SQUIGGLY)\n        ) {\n          annotation.setActiveVariant(null);\n        } else {\n          annotation.setActiveVariant(makeVariantKey(PdfAnnotationSubtype.SQUIGGLY));\n        }\n      }\n    },\n    active: (storeState) =>\n      storeState.plugins.annotation.activeVariant === makeVariantKey(PdfAnnotationSubtype.SQUIGGLY),\n  },\n  strikethrough: {\n    id: 'strikethrough',\n    label: 'Strikethrough',\n    type: 'action',\n    icon: 'strikethrough',\n    action: (registry, state) => {\n      const annotation = registry.getPlugin<AnnotationPlugin>(ANNOTATION_PLUGIN_ID)?.provides();\n      if (annotation) {\n        if (\n          state.plugins.annotation.activeVariant === makeVariantKey(PdfAnnotationSubtype.STRIKEOUT)\n        ) {\n          annotation.setActiveVariant(null);\n        } else {\n          annotation.setActiveVariant(makeVariantKey(PdfAnnotationSubtype.STRIKEOUT));\n        }\n      }\n    },\n    active: (storeState) =>\n      storeState.plugins.annotation.activeVariant ===\n      makeVariantKey(PdfAnnotationSubtype.STRIKEOUT),\n  },\n  highlight: {\n    id: 'highlight',\n    label: 'Highlight',\n    type: 'action',\n    icon: 'highlight',\n    action: (registry, state) => {\n      const annotation = registry.getPlugin<AnnotationPlugin>(ANNOTATION_PLUGIN_ID)?.provides();\n      if (annotation) {\n        if (\n          state.plugins.annotation.activeVariant === makeVariantKey(PdfAnnotationSubtype.HIGHLIGHT)\n        ) {\n          annotation.setActiveVariant(null);\n        } else {\n          annotation.setActiveVariant(makeVariantKey(PdfAnnotationSubtype.HIGHLIGHT));\n        }\n      }\n    },\n    active: (storeState) =>\n      storeState.plugins.annotation.activeVariant ===\n      makeVariantKey(PdfAnnotationSubtype.HIGHLIGHT),\n  },\n  freehand: {\n    id: 'freehand',\n    label: 'Freehand',\n    type: 'action',\n    icon: 'pencilMarker',\n    action: (registry, state) => {\n      const annotation = registry.getPlugin<AnnotationPlugin>(ANNOTATION_PLUGIN_ID)?.provides();\n      if (annotation) {\n        console.log(state.plugins.annotation.activeVariant);\n        if (state.plugins.annotation.activeVariant === makeVariantKey(PdfAnnotationSubtype.INK)) {\n          annotation.setActiveVariant(null);\n        } else {\n          annotation.deselectAnnotation();\n          annotation.setActiveVariant(makeVariantKey(PdfAnnotationSubtype.INK));\n        }\n      }\n    },\n    active: (storeState) =>\n      storeState.plugins.annotation.activeVariant === makeVariantKey(PdfAnnotationSubtype.INK),\n  },\n  squigglySelection: {\n    id: 'squigglySelection',\n    label: 'Squiggly Selection',\n    type: 'action',\n    icon: 'squiggly',\n    action: (registry) => {\n      const annotation = registry.getPlugin<AnnotationPlugin>(ANNOTATION_PLUGIN_ID)?.provides();\n      const selection = registry.getPlugin<SelectionPlugin>(SELECTION_PLUGIN_ID)?.provides();\n      if (!selection || !annotation) return;\n\n      const defaultSettings = annotation.getToolDefaults(\n        makeVariantKey(PdfAnnotationSubtype.SQUIGGLY),\n      );\n      const formattedSelection = selection.getFormattedSelection();\n      for (const selection of formattedSelection) {\n        annotation.createAnnotation(selection.pageIndex, {\n          id: Date.now() + Math.random(),\n          type: PdfAnnotationSubtype.SQUIGGLY,\n          color: defaultSettings.color,\n          opacity: defaultSettings.opacity,\n          pageIndex: selection.pageIndex,\n          rect: selection.rect,\n          segmentRects: selection.segmentRects,\n        });\n      }\n\n      selection.clear();\n    },\n  },\n  underlineSelection: {\n    id: 'underlineSelection',\n    label: 'Underline Selection',\n    type: 'action',\n    icon: 'underline',\n    action: (registry) => {\n      const annotation = registry.getPlugin<AnnotationPlugin>(ANNOTATION_PLUGIN_ID)?.provides();\n      const selection = registry.getPlugin<SelectionPlugin>(SELECTION_PLUGIN_ID)?.provides();\n      if (!selection || !annotation) return;\n\n      const defaultSettings = annotation.getToolDefaults(\n        makeVariantKey(PdfAnnotationSubtype.UNDERLINE),\n      );\n      const formattedSelection = selection.getFormattedSelection();\n      for (const selection of formattedSelection) {\n        annotation.createAnnotation(selection.pageIndex, {\n          id: Date.now() + Math.random(),\n          type: PdfAnnotationSubtype.UNDERLINE,\n          color: defaultSettings.color,\n          opacity: defaultSettings.opacity,\n          pageIndex: selection.pageIndex,\n          rect: selection.rect,\n          segmentRects: selection.segmentRects,\n        });\n      }\n\n      selection.clear();\n    },\n  },\n  strikethroughSelection: {\n    id: 'strikethroughSelection',\n    label: 'Strikethrough Selection',\n    type: 'action',\n    icon: 'strikethrough',\n    action: (registry) => {\n      const annotation = registry.getPlugin<AnnotationPlugin>(ANNOTATION_PLUGIN_ID)?.provides();\n      const selection = registry.getPlugin<SelectionPlugin>(SELECTION_PLUGIN_ID)?.provides();\n      if (!selection || !annotation) return;\n\n      const defaultSettings = annotation.getToolDefaults(\n        makeVariantKey(PdfAnnotationSubtype.STRIKEOUT),\n      );\n      const formattedSelection = selection.getFormattedSelection();\n      for (const selection of formattedSelection) {\n        annotation.createAnnotation(selection.pageIndex, {\n          id: Date.now() + Math.random(),\n          type: PdfAnnotationSubtype.STRIKEOUT,\n          color: defaultSettings.color,\n          opacity: defaultSettings.opacity,\n          pageIndex: selection.pageIndex,\n          rect: selection.rect,\n          segmentRects: selection.segmentRects,\n        });\n      }\n\n      selection.clear();\n    },\n  },\n  highlightSelection: {\n    id: 'highlightSelection',\n    label: 'Highlight Selection',\n    type: 'action',\n    icon: 'highlight',\n    action: (registry) => {\n      const annotation = registry.getPlugin<AnnotationPlugin>(ANNOTATION_PLUGIN_ID)?.provides();\n      const selection = registry.getPlugin<SelectionPlugin>(SELECTION_PLUGIN_ID)?.provides();\n      if (!selection || !annotation) return;\n\n      const defaultSettings = annotation.getToolDefaults(\n        makeVariantKey(PdfAnnotationSubtype.HIGHLIGHT),\n      );\n      const formattedSelection = selection.getFormattedSelection();\n      for (const selection of formattedSelection) {\n        annotation.createAnnotation(selection.pageIndex, {\n          id: Date.now() + Math.random(),\n          type: PdfAnnotationSubtype.HIGHLIGHT,\n          color: defaultSettings.color,\n          opacity: defaultSettings.opacity,\n          pageIndex: selection.pageIndex,\n          rect: selection.rect,\n          segmentRects: selection.segmentRects,\n        });\n      }\n\n      selection.clear();\n    },\n  },\n  styleAnnotation: {\n    id: 'styleAnnotation',\n    label: 'Style',\n    type: 'action',\n    icon: 'palette',\n    action: (registry, state) => {\n      const ui = registry.getPlugin<UIPlugin>(UI_PLUGIN_ID)?.provides();\n\n      if (ui) {\n        ui.togglePanel({\n          id: 'leftPanel',\n          visibleChild: 'leftPanelAnnotationStyle',\n          open:\n            state.plugins.ui.panel.leftPanel.open === true &&\n            state.plugins.ui.panel.leftPanel.visibleChild === 'leftPanelAnnotationStyle'\n              ? false\n              : true,\n        });\n      }\n    },\n    active: (storeState) =>\n      storeState.plugins.ui.panel.leftPanel.open === true &&\n      storeState.plugins.ui.panel.leftPanel.visibleChild === 'leftPanelAnnotationStyle',\n  },\n  deleteAnnotation: {\n    id: 'deleteAnnotation',\n    label: 'Delete',\n    type: 'action',\n    icon: 'trash',\n    action: (registry) => {\n      const annotation = registry.getPlugin<AnnotationPlugin>(ANNOTATION_PLUGIN_ID)?.provides();\n      if (!annotation) return;\n\n      const selectedAnnotation = annotation.getSelectedAnnotation();\n      if (!selectedAnnotation) return;\n\n      annotation.deleteAnnotation(selectedAnnotation.object.pageIndex, selectedAnnotation.localId);\n    },\n  },\n  panMode: {\n    id: 'panMode',\n    label: 'Pan',\n    type: 'action',\n    icon: 'hand',\n    action: (registry) => {\n      const interactionManager = registry\n        .getPlugin<InteractionManagerPlugin>(INTERACTION_MANAGER_PLUGIN_ID)\n        ?.provides();\n      if (!interactionManager) return;\n\n      if (interactionManager.getActiveMode() === 'panMode') {\n        interactionManager.activate('default');\n      } else {\n        interactionManager.activate('panMode');\n      }\n    },\n    active: (storeState) =>\n      storeState.plugins[INTERACTION_MANAGER_PLUGIN_ID].activeMode === 'panMode',\n  },\n  undo: {\n    id: 'undo',\n    label: 'Undo',\n    type: 'action',\n    icon: 'arrowBackUp',\n    action: (registry) => {\n      const history = registry.getPlugin<HistoryPlugin>(HISTORY_PLUGIN_ID)?.provides();\n      if (history) {\n        history.undo();\n      }\n    },\n    disabled: (storeState) => {\n      const history = storeState.plugins[HISTORY_PLUGIN_ID];\n      return !history.global.canUndo;\n    },\n  },\n  redo: {\n    id: 'redo',\n    label: 'Redo',\n    type: 'action',\n    icon: 'arrowForwardUp',\n    action: (registry) => {\n      const history = registry.getPlugin<HistoryPlugin>(HISTORY_PLUGIN_ID)?.provides();\n      if (history) {\n        history.redo();\n      }\n    },\n    disabled: (storeState) => {\n      const history = storeState.plugins[HISTORY_PLUGIN_ID];\n      return !history.global.canRedo;\n    },\n  },\n  commitAnnotations: {\n    id: 'commitAnnotations',\n    label: 'Commit',\n    type: 'action',\n    icon: 'deviceFloppy',\n    action: (registry) => {\n      const annotation = registry.getPlugin<AnnotationPlugin>(ANNOTATION_PLUGIN_ID)?.provides();\n      if (annotation) {\n        annotation.commit();\n      }\n    },\n  },\n};\n\n// Define components\nexport const components: Record<string, UIComponentType<State>> = {\n  menuButton: {\n    type: 'iconButton',\n    id: 'menuButton',\n    props: {\n      commandId: 'menuCtr',\n      active: false,\n      label: 'Menu',\n    },\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      active: isActive(menuItems.menuCtr, storeState),\n    }),\n  },\n  deleteAnnotationButton: {\n    type: 'iconButton',\n    id: 'deleteAnnotationButton',\n    props: {\n      commandId: 'deleteAnnotation',\n      active: false,\n      label: 'Delete',\n    },\n  },\n  styleButton: {\n    type: 'iconButton',\n    id: 'styleButton',\n    props: {\n      commandId: 'styleAnnotation',\n      active: false,\n      label: 'Style',\n    },\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      active: isActive(menuItems.styleAnnotation, storeState),\n    }),\n  },\n  undoButton: {\n    type: 'iconButton',\n    id: 'undoButton',\n    props: {\n      commandId: 'undo',\n      disabled: false,\n      label: 'Undo',\n    },\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      disabled: isDisabled(menuItems.undo, storeState),\n    }),\n  },\n  redoButton: {\n    type: 'iconButton',\n    id: 'redoButton',\n    props: {\n      commandId: 'redo',\n      disabled: false,\n      label: 'Redo',\n    },\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      disabled: isDisabled(menuItems.redo, storeState),\n    }),\n  },\n  commitAnnotationsButton: {\n    type: 'iconButton',\n    id: 'commitAnnotationsButton',\n    props: {\n      commandId: 'commitAnnotations',\n      active: false,\n      label: 'Commit',\n    },\n  },\n  copyButton: {\n    type: 'iconButton',\n    id: 'copyButton',\n    props: {\n      commandId: 'copy',\n      active: false,\n      label: 'Copy',\n    },\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      active: isActive(menuItems.copy, storeState),\n    }),\n  },\n  panModeButton: {\n    type: 'iconButton',\n    id: 'panModeButton',\n    props: {\n      commandId: 'panMode',\n      active: false,\n      label: 'Pan',\n    },\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      active: isActive(menuItems.panMode, storeState),\n    }),\n  },\n  underlineButton: {\n    type: 'iconButton',\n    id: 'underlineButton',\n    props: {\n      commandId: 'underline',\n      active: false,\n      label: 'Underline',\n      color: '#e44234',\n    },\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      active: isActive(menuItems.underline, storeState),\n      color:\n        storeState.plugins.annotation.toolDefaults[makeVariantKey(PdfAnnotationSubtype.UNDERLINE)]!\n          .color,\n    }),\n  },\n  squigglyButton: {\n    type: 'iconButton',\n    id: 'squigglyButton',\n    props: {\n      commandId: 'squiggly',\n      active: false,\n      label: 'Squiggly',\n      color: '#e44234',\n    },\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      active: isActive(menuItems.squiggly, storeState),\n      color:\n        storeState.plugins.annotation.toolDefaults[makeVariantKey(PdfAnnotationSubtype.SQUIGGLY)]!\n          .color,\n    }),\n  },\n  strikethroughButton: {\n    type: 'iconButton',\n    id: 'strikethroughButton',\n    props: {\n      commandId: 'strikethrough',\n      active: false,\n      label: 'Strikethrough',\n      color: '#e44234',\n    },\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      active: isActive(menuItems.strikethrough, storeState),\n      color:\n        storeState.plugins.annotation.toolDefaults[makeVariantKey(PdfAnnotationSubtype.STRIKEOUT)]!\n          .color,\n    }),\n  },\n  highlightButton: {\n    type: 'iconButton',\n    id: 'highlightButton',\n    props: {\n      commandId: 'highlight',\n      active: false,\n      label: 'Highlight',\n      color: '#ffcd45',\n    },\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      active: isActive(menuItems.highlight, storeState),\n      color:\n        storeState.plugins.annotation.toolDefaults[makeVariantKey(PdfAnnotationSubtype.HIGHLIGHT)]!\n          .color,\n    }),\n  },\n  freehandButton: {\n    type: 'iconButton',\n    id: 'freehandButton',\n    props: {\n      commandId: 'freehand',\n      active: false,\n      label: 'Freehand',\n      color: '#e44234',\n    },\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      active: isActive(menuItems.freehand, storeState),\n      color:\n        storeState.plugins.annotation.toolDefaults[makeVariantKey(PdfAnnotationSubtype.INK)]!.color,\n    }),\n  },\n  highlightSelectionButton: {\n    type: 'iconButton',\n    id: 'highlightSelectionButton',\n    props: {\n      commandId: 'highlightSelection',\n      color: '#ffcd45',\n    },\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      color:\n        storeState.plugins.annotation.toolDefaults[makeVariantKey(PdfAnnotationSubtype.HIGHLIGHT)]!\n          .color,\n    }),\n  },\n  underlineSelectionButton: {\n    type: 'iconButton',\n    id: 'underlineSelectionButton',\n    props: {\n      commandId: 'underlineSelection',\n      color: '#e44234',\n    },\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      color:\n        storeState.plugins.annotation.toolDefaults[makeVariantKey(PdfAnnotationSubtype.UNDERLINE)]!\n          .color,\n    }),\n  },\n  strikethroughSelectionButton: {\n    type: 'iconButton',\n    id: 'strikethroughSelectionButton',\n    props: {\n      commandId: 'strikethroughSelection',\n      color: '#e44234',\n    },\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      color:\n        storeState.plugins.annotation.toolDefaults[makeVariantKey(PdfAnnotationSubtype.STRIKEOUT)]!\n          .color,\n    }),\n  },\n  squigglySelectionButton: {\n    type: 'iconButton',\n    id: 'squigglySelectionButton',\n    props: {\n      commandId: 'squigglySelection',\n      color: '#e44234',\n    },\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      color:\n        storeState.plugins.annotation.toolDefaults[makeVariantKey(PdfAnnotationSubtype.SQUIGGLY)]!\n          .color,\n    }),\n  },\n  viewCtrButton: {\n    type: 'iconButton',\n    id: 'viewCtrButton',\n    props: {\n      commandId: 'viewCtr',\n      active: false,\n      label: 'View settings',\n    },\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      active: isActive(menuItems.viewCtr, storeState),\n    }),\n  },\n  commentButton: {\n    type: 'iconButton',\n    id: 'commentButton',\n    props: {\n      active: false,\n      commandId: 'comment',\n      label: 'Comment',\n    },\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      active: isActive(menuItems.comment, storeState),\n    }),\n  },\n  searchButton: {\n    type: 'iconButton',\n    id: 'searchButton',\n    props: {\n      active: false,\n      commandId: 'search',\n      label: 'Search',\n    },\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      active: isActive(menuItems.search, storeState),\n    }),\n  },\n  filePickerButton: {\n    type: 'iconButton',\n    id: 'filePickerButton',\n    props: {\n      label: 'Open File',\n      img: 'data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiAgd2lkdGg9IjI0IiAgaGVpZ2h0PSIyNCIgIHZpZXdCb3g9IjAgMCAyNCAyNCIgIGZpbGw9Im5vbmUiICBzdHJva2U9IiMzNDNhNDAiICBzdHJva2Utd2lkdGg9IjIiICBzdHJva2UtbGluZWNhcD0icm91bmQiICBzdHJva2UtbGluZWpvaW49InJvdW5kIiAgY2xhc3M9Imljb24gaWNvbi10YWJsZXIgaWNvbi10YWJsZXItb3V0bGluZSBpY29uLXRhYmxlci1maWxlLWltcG9ydCI+PHBhdGggc3Ryb2tlPSJub25lIiBkPSJNIDAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPjxwYXRoIGQ9Ik0xNCAzdjRhMSAxIDAgMCAwIDEgMWg0IiAvPjxwYXRoIGQ9Ik01IDEzdi04YTIgMiAwIDAgMSAyIC0yaDdsNSA1djExYTIgMiAwIDAgMSAtMiAyaC01LjVtLTkuNSAtMmg3bS0zIC0zbDMgM2wtMyAzIiAvPjwvc3ZnPg==',\n    },\n  },\n  downloadButton: {\n    type: 'iconButton',\n    id: 'downloadButton',\n    props: {\n      label: 'Download',\n      img: 'data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiAgd2lkdGg9IjI0IiAgaGVpZ2h0PSIyNCIgIHZpZXdCb3g9IjAgMCAyNCAyNCIgIGZpbGw9Im5vbmUiICBzdHJva2U9IiMzNDNhNDAiICBzdHJva2Utd2lkdGg9IjIiICBzdHJva2UtbGluZWNhcD0icm91bmQiICBzdHJva2UtbGluZWpvaW49InJvdW5kIiAgY2xhc3M9Imljb24gaWNvbi10YWJsZXIgaWNvbnMtdGFibGVyLW91dGxpbmUgaWNvbi10YWJsZXItZG93bmxvYWQiPjxwYXRoIHN0cm9rZT0ibm9uZSIgZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPjxwYXRoIGQ9Ik00IDE3djJhMiAyIDAgMCAwIDIgMmgxMmEyIDIgMCAwIDAgMiAtMnYtMiIgLz48cGF0aCBkPSJNNyAxMWw1IDVsNSAtNSIgLz48cGF0aCBkPSJNMTIgNGwwIDEyIiAvPjwvc3ZnPg==',\n    },\n  },\n  zoomButton: {\n    type: 'iconButton',\n    id: 'zoomButton',\n    props: {\n      commandId: 'zoom',\n      label: 'Zoom',\n      img: 'data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiAgd2lkdGg9IjI0IiAgaGVpZ2h0PSIyNCIgIHZpZXdCb3g9IjAgMCAyNCAyNCIgIGZpbGw9Im5vbmUiICBzdHJva2U9IiMzNDNhNDAiICBzdHJva2Utd2lkdGg9IjIiICBzdHJva2UtbGluZWNhcD0icm91bmQiICBzdHJva2UtbGluZWpvaW49InJvdW5kIiAgY2xhc3M9Imljb24gaWNvbi10YWJsZXIgaWNvbnMtdGFibGVyLW91dGxpbmUgaWNvbi10YWJsZXItY2lyY2xlLXBsdXMiPjxwYXRoIHN0cm9rZT0ibm9uZSIgZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPjxwYXRoIGQ9Ik0zIDEyYTkgOSAwIDEgMCAxOCAwYTkgOSAwIDAgMCAtMTggMCIgLz48cGF0aCBkPSJNOSAxMmg2IiAvPjxwYXRoIGQ9Ik0xMiA5djYiIC8+PC9zdmc+',\n    },\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      active:\n        isActive(menuItems.zoom, storeState) || isActive(menuItems.changeZoomLevel, storeState),\n    }),\n  },\n  sidebarButton: {\n    type: 'iconButton',\n    id: 'sidebarButton',\n    props: {\n      commandId: 'sidebar',\n      label: 'Sidebar',\n      active: false,\n    },\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      active: isActive(menuItems.sidebar, storeState),\n    }),\n  },\n  divider1: {\n    type: 'divider',\n    id: 'divider1',\n  },\n  expandLeftActionsButton: {\n    type: 'iconButton',\n    id: 'expandLeftActionsButton',\n    props: {\n      commandId: 'leftAction',\n      label: 'Left Panel Actions',\n    },\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      active: isActive(menuItems.leftAction, storeState),\n    }),\n  },\n  headerStart: {\n    id: 'headerStart',\n    type: 'groupedItems',\n    slots: [\n      { componentId: 'menuButton', priority: 0 },\n      { componentId: 'divider1', priority: 1, className: 'flex' },\n      { componentId: 'sidebarButton', priority: 2 },\n      { componentId: 'expandLeftActionsButton', priority: 3, className: '@min-[400px]:hidden' },\n      { componentId: 'viewCtrButton', priority: 4, className: 'hidden @min-[400px]:block' },\n      { componentId: 'divider1', priority: 6, className: 'hidden @min-[400px]:flex' },\n      {\n        componentId: 'zoomButton',\n        priority: 7,\n        className: 'hidden @min-[400px]:block @min-[600px]:hidden',\n      },\n      { componentId: 'zoom', priority: 8, className: 'hidden @min-[600px]:block' },\n      { componentId: 'divider1', priority: 9, className: 'hidden @min-[600px]:flex' },\n      { componentId: 'panModeButton', priority: 10, className: 'hidden @min-[600px]:block' },\n    ],\n    props: {\n      gap: 10,\n    },\n  },\n  viewTab: {\n    type: 'tabButton',\n    id: 'viewTab',\n    props: {\n      label: 'View',\n      commandId: 'view',\n      active: false,\n    },\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      active: isActive(menuItems.view, storeState),\n    }),\n  },\n  annotateTab: {\n    type: 'tabButton',\n    id: 'annotateTab',\n    props: {\n      label: 'Annotate',\n      commandId: 'annotate',\n      active: false,\n    },\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      active: isActive(menuItems.annotate, storeState),\n    }),\n  },\n  shapesTab: {\n    type: 'tabButton',\n    id: 'shapesTab',\n    props: {\n      label: 'Shapes',\n      commandId: 'shapes',\n      active: false,\n    },\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      active: isActive(menuItems.shapes, storeState),\n    }),\n  },\n  fillAndSignTab: {\n    type: 'tabButton',\n    id: 'fillAndSignTab',\n    props: {\n      label: 'Fill and Sign',\n      commandId: 'fillAndSign',\n      active: false,\n    },\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      active: isActive(menuItems.fillAndSign, storeState),\n    }),\n  },\n  formTab: {\n    type: 'tabButton',\n    id: 'formTab',\n    props: {\n      label: 'Form',\n      commandId: 'form',\n      active: false,\n    },\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      active: isActive(menuItems.form, storeState),\n    }),\n  },\n  tabOverflowButton: {\n    type: 'iconButton',\n    id: 'tabOverflowButton',\n    props: {\n      label: 'More',\n      commandId: 'tabOverflow',\n      active: false,\n    },\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      active: isActive(menuItems.tabOverflow, storeState),\n    }),\n  },\n  selectButton: {\n    type: 'selectButton',\n    id: 'selectButton',\n    props: {\n      menuCommandId: 'tabOverflow',\n      commandIds: ['view', 'annotate'],\n      activeCommandId: 'view',\n      active: false,\n    },\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      activeCommandId:\n        ownProps.commandIds.find((commandId) => isActive(menuItems[commandId], storeState)) ??\n        ownProps.commandIds[0],\n      active: isActive(menuItems.tabOverflow, storeState),\n    }),\n  },\n  headerCenter: {\n    id: 'headerCenter',\n    type: 'groupedItems',\n    slots: [\n      { componentId: 'selectButton', priority: 0, className: 'block @min-[500px]:hidden' },\n      { componentId: 'viewTab', priority: 1, className: 'hidden @min-[500px]:block' },\n      { componentId: 'annotateTab', priority: 2, className: 'hidden @min-[500px]:block' },\n    ],\n    props: {\n      gap: 10,\n    },\n  },\n  headerEnd: {\n    id: 'headerEnd',\n    type: 'groupedItems',\n    slots: [\n      { componentId: 'searchButton', priority: 1 },\n      //{ componentId: 'commentButton', priority: 2 },\n    ],\n    props: {\n      gap: 10,\n    },\n  },\n  pageControls: defineComponent<\n    { currentPage: number; pageCount: number },\n    PageControlsProps,\n    State\n  >()({\n    id: 'pageControls',\n    type: 'custom',\n    render: 'pageControls',\n    initialState: {\n      currentPage: 1,\n      pageCount: 1,\n    },\n    props: (initialState) => ({\n      currentPage: initialState.currentPage,\n      pageCount: initialState.pageCount,\n      nextPageCommandId: 'nextPage',\n      previousPageCommandId: 'previousPage',\n    }),\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      currentPage: storeState.plugins.scroll.currentPage,\n      pageCount: storeState.core.document?.pageCount ?? 1,\n    }),\n  }),\n  pageControlsContainer: {\n    id: 'pageControlsContainer',\n    type: 'floating',\n    props: {\n      scrollerPosition: 'outside',\n    },\n    render: 'pageControlsContainer',\n    slots: [{ componentId: 'pageControls', priority: 0 }],\n  },\n  textSelectionMenuButtons: {\n    id: 'textSelectionMenuButtons',\n    type: 'groupedItems',\n    slots: [\n      { componentId: 'copyButton', priority: 0 },\n      { componentId: 'highlightSelectionButton', priority: 1 },\n      { componentId: 'underlineSelectionButton', priority: 2 },\n      { componentId: 'strikethroughSelectionButton', priority: 3 },\n      { componentId: 'squigglySelectionButton', priority: 4 },\n    ],\n    props: {\n      gap: 10,\n    },\n  },\n  printModal: {\n    id: 'printModal',\n    type: 'floating',\n    render: 'printModal',\n    initialState: {\n      open: false,\n    },\n    props: (initialState) => ({\n      open: initialState.open,\n      scrollerPosition: 'outside',\n    }),\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      open: storeState.plugins.ui.floating.printModal.open,\n    }),\n  },\n  textSelectionMenu: {\n    id: 'textSelectionMenu',\n    type: 'floating',\n    render: 'textSelectionMenu',\n    props: {\n      open: false,\n      scrollerPosition: 'inside',\n    },\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      isScolling: storeState.plugins.viewport.isScrolling,\n      scale: storeState.core.scale,\n      rotation: storeState.core.rotation,\n      spread: storeState.plugins[SPREAD_PLUGIN_ID].spreadMode,\n      open:\n        storeState.plugins[SELECTION_PLUGIN_ID].active &&\n        !storeState.plugins[SELECTION_PLUGIN_ID].selecting,\n    }),\n    slots: [{ componentId: 'textSelectionMenuButtons', priority: 0 }],\n    getChildContext: {\n      direction: 'horizontal',\n    },\n  },\n  annotationSelectionMenuButtons: {\n    id: 'annotationSelectionMenuButtons',\n    type: 'groupedItems',\n    slots: [\n      { componentId: 'deleteAnnotationButton', priority: 0 },\n      { componentId: 'styleButton', priority: 1 },\n    ],\n    props: {\n      gap: 10,\n    },\n  },\n  annotationSelectionMenu: {\n    id: 'annotationSelectionMenu',\n    type: 'floating',\n    render: 'annotationSelectionMenu',\n    props: {\n      open: false,\n      scrollerPosition: 'inside',\n    },\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      isScolling: storeState.plugins.viewport.isScrolling,\n      scale: storeState.core.scale,\n      rotation: storeState.core.rotation,\n      selectedUid: storeState.plugins[ANNOTATION_PLUGIN_ID].selectedUid,\n      open: storeState.plugins[ANNOTATION_PLUGIN_ID].selectedUid !== null,\n    }),\n    slots: [{ componentId: 'annotationSelectionMenuButtons', priority: 0 }],\n    getChildContext: {\n      direction: 'horizontal',\n    },\n  },\n  topHeader: {\n    type: 'header',\n    id: 'topHeader',\n    slots: [\n      { componentId: 'headerStart', priority: 0 },\n      { componentId: 'headerCenter', priority: 1 },\n      { componentId: 'headerEnd', priority: 2 },\n    ],\n    getChildContext: (props) => ({\n      direction:\n        props.placement === 'top' || props.placement === 'bottom' ? 'horizontal' : 'vertical',\n    }),\n    props: {\n      placement: 'top',\n      style: {\n        backgroundColor: '#ffffff',\n        gap: '10px',\n      },\n    },\n  },\n  annotationTools: {\n    id: 'annotationTools',\n    type: 'groupedItems',\n    slots: [\n      { componentId: 'highlightButton', priority: 1 },\n      { componentId: 'underlineButton', priority: 2 },\n      { componentId: 'strikethroughButton', priority: 3 },\n      { componentId: 'squigglyButton', priority: 4 },\n      { componentId: 'freehandButton', priority: 5 },\n      { componentId: 'divider1', priority: 7 },\n      { componentId: 'styleButton', priority: 8 },\n      { componentId: 'divider1', priority: 9 },\n      { componentId: 'undoButton', priority: 10 },\n      { componentId: 'redoButton', priority: 11 },\n    ],\n    props: {\n      gap: 10,\n    },\n  },\n  toolsHeader: {\n    type: 'header',\n    id: 'toolsHeader',\n    initialState: {\n      visible: false,\n      visibleChild: null,\n    },\n    props: (initialState) => ({\n      placement: 'top',\n      visible: initialState.visible,\n      visibleChild: initialState.visibleChild,\n      style: {\n        backgroundColor: '#f1f3f5',\n        justifyContent: 'center',\n      },\n    }),\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      visible: storeState.plugins.ui.header.toolsHeader.visible,\n      visibleChild: storeState.plugins.ui.header.toolsHeader.visibleChild,\n    }),\n    slots: [{ componentId: 'annotationTools', priority: 0 }],\n    getChildContext: (props) => ({\n      direction:\n        props.placement === 'top' || props.placement === 'bottom' ? 'horizontal' : 'vertical',\n    }),\n  },\n  leftPanelAnnotationStyle: {\n    id: 'leftPanelAnnotationStyle',\n    type: 'custom',\n    render: 'leftPanelAnnotationStyle',\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      selectedAnnotation: getSelectedAnnotationWithPageIndex(\n        storeState.plugins[ANNOTATION_PLUGIN_ID],\n      ),\n      activeVariant: storeState.plugins[ANNOTATION_PLUGIN_ID].activeVariant,\n      colorPresets: storeState.plugins[ANNOTATION_PLUGIN_ID].colorPresets,\n      toolDefaults: storeState.plugins[ANNOTATION_PLUGIN_ID].toolDefaults,\n    }),\n  },\n  leftPanelMain: defineComponent<{ visibleChild: string }, LeftPanelMainProps, State>()({\n    id: 'leftPanelMain',\n    type: 'custom',\n    render: 'leftPanelMain',\n    initialState: {\n      visibleChild: 'thumbnails',\n    },\n    props: (initialState) => ({\n      visibleChild: initialState.visibleChild,\n      tabsCommandId: 'sidebarMenu',\n    }),\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      visibleChild: storeState.plugins.ui.custom.leftPanelMain.visibleChild,\n    }),\n    slots: [\n      { componentId: 'thumbnails', priority: 0 },\n      { componentId: 'outline', priority: 1 },\n      { componentId: 'attachments', priority: 2 },\n    ],\n  }),\n  leftPanel: {\n    id: 'leftPanel',\n    type: 'panel',\n    initialState: {\n      open: false,\n      visibleChild: 'leftPanelMain',\n    },\n    props: (initialState) => ({\n      open: initialState.open,\n      visibleChild: initialState.visibleChild,\n      location: 'left',\n    }),\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      open: storeState.plugins.ui.panel.leftPanel.open,\n      visibleChild: storeState.plugins.ui.panel.leftPanel.visibleChild,\n    }),\n    slots: [\n      { componentId: 'leftPanelMain', priority: 0 },\n      { componentId: 'leftPanelAnnotationStyle', priority: 1 },\n    ],\n  },\n  thumbnails: {\n    id: 'thumbnails',\n    type: 'custom',\n    render: 'thumbnails',\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      currentPage: storeState.plugins.scroll.currentPage,\n    }),\n  },\n  outline: {\n    id: 'outline',\n    type: 'custom',\n    render: 'outline',\n    props: {\n      document: null,\n    },\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      document: storeState.core.document,\n    }),\n  },\n  attachments: {\n    id: 'attachments',\n    type: 'custom',\n    render: 'attachments',\n  },\n  search: {\n    id: 'search',\n    type: 'custom',\n    render: 'search',\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      flags: storeState.plugins.search.flags,\n      results: storeState.plugins.search.results,\n      total: storeState.plugins.search.total,\n      activeResultIndex: storeState.plugins.search.activeResultIndex,\n      active: storeState.plugins.search.active,\n      query: storeState.plugins.search.query,\n      loading: storeState.plugins.search.loading,\n    }),\n  },\n  comment: {\n    id: 'comment',\n    type: 'custom',\n    render: 'comment',\n  },\n  commandMenu: {\n    id: 'commandMenu',\n    type: 'commandMenu',\n    initialState: {\n      open: false,\n      activeCommand: null,\n      triggerElement: undefined,\n      position: undefined,\n      flatten: false,\n    },\n    props: (initialState) => ({\n      open: initialState.open,\n      activeCommand: initialState.activeCommand,\n      triggerElement: initialState.triggerElement,\n      position: initialState.position,\n      flatten: initialState.flatten,\n    }),\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      open: storeState.plugins.ui.commandMenu.commandMenu.open,\n      activeCommand: storeState.plugins.ui.commandMenu.commandMenu.activeCommand,\n      triggerElement: storeState.plugins.ui.commandMenu.commandMenu.triggerElement,\n      position: storeState.plugins.ui.commandMenu.commandMenu.position,\n      flatten: storeState.plugins.ui.commandMenu.commandMenu.flatten,\n    }),\n  },\n  zoom: defineComponent<{ zoomLevel: number }, ZoomRendererProps, State>()({\n    id: 'zoom',\n    type: 'custom',\n    render: 'zoom',\n    initialState: {\n      zoomLevel: 1,\n    },\n    props: (initialState) => ({\n      zoomLevel: initialState.zoomLevel,\n      commandZoomIn: menuItems.zoomIn.id,\n      commandZoomOut: menuItems.zoomOut.id,\n      commandZoomMenu: menuItems.zoom.id,\n      zoomMenuActive: false,\n    }),\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      zoomLevel: storeState.plugins.zoom.currentZoomLevel,\n      zoomMenuActive:\n        isActive(menuItems.zoom, storeState) || isActive(menuItems.changeZoomLevel, storeState),\n    }),\n  }),\n  rightPanel: {\n    id: 'rightPanel',\n    type: 'panel',\n    initialState: {\n      open: false,\n      visibleChild: null,\n    },\n    props: (initialState) => ({\n      open: initialState.open,\n      visibleChild: initialState.visibleChild,\n      location: 'right',\n    }),\n    mapStateToProps: (storeState, ownProps) => ({\n      ...ownProps,\n      open: storeState.plugins.ui.panel.rightPanel.open,\n      visibleChild: storeState.plugins.ui.panel.rightPanel.visibleChild,\n    }),\n    slots: [\n      { componentId: 'search', priority: 0 },\n      { componentId: 'comment', priority: 1 },\n    ],\n  },\n};\n\n// UIPlugin configuration\nexport const uiConfig: UIPluginConfig = {\n  enabled: true,\n  components,\n  menuItems,\n  icons,\n};\n\nconst logger = new AllLogger([new ConsoleLogger(), new PerfLogger()]);\n\nexport function PDFViewer({ config }: PDFViewerProps) {\n  const { engine, isLoading } = usePdfiumEngine({\n    ...(config.wasmUrl && { wasmUrl: config.wasmUrl }),\n    worker: config.worker,\n    logger: config.log ? logger : undefined,\n  });\n\n  // **Merge user configurations with defaults**\n  const pluginConfigs = mergePluginConfigs(config.plugins);\n\n  if (!engine || isLoading)\n    return (\n      <>\n        <style>{styles}</style>\n        <div className=\"flex h-full w-full items-center justify-center\">\n          <LoadingIndicator size=\"lg\" text=\"Initializing PDF engine...\" />\n        </div>\n      </>\n    );\n\n  return (\n    <>\n      <style>{styles}</style>\n      <EmbedPDF\n        engine={engine}\n        onInitialized={async (registry) => {\n          const uiCapability = registry.getPlugin<UIPlugin>('ui')?.provides();\n\n          if (uiCapability) {\n            uiCapability.registerComponentRenderer('groupedItems', groupedItemsRenderer);\n            uiCapability.registerComponentRenderer('iconButton', iconButtonRenderer);\n            uiCapability.registerComponentRenderer('tabButton', tabButtonRenderer);\n            uiCapability.registerComponentRenderer('header', headerRenderer);\n            uiCapability.registerComponentRenderer('divider', dividerRenderer);\n            uiCapability.registerComponentRenderer('panel', panelRenderer);\n            uiCapability.registerComponentRenderer('search', searchRenderer);\n            uiCapability.registerComponentRenderer('zoom', zoomRenderer);\n            uiCapability.registerComponentRenderer(\n              'pageControlsContainer',\n              pageControlsContainerRenderer,\n            );\n            uiCapability.registerComponentRenderer('pageControls', pageControlsRenderer);\n            uiCapability.registerComponentRenderer('commandMenu', commandMenuRenderer);\n            uiCapability.registerComponentRenderer('comment', commentRender);\n            uiCapability.registerComponentRenderer('thumbnails', thumbnailsRender);\n            uiCapability.registerComponentRenderer('outline', outlineRenderer);\n            uiCapability.registerComponentRenderer('attachments', attachmentsRenderer);\n            uiCapability.registerComponentRenderer('selectButton', selectButtonRenderer);\n            uiCapability.registerComponentRenderer('textSelectionMenu', textSelectionMenuRenderer);\n            uiCapability.registerComponentRenderer(\n              'annotationSelectionMenu',\n              annotationSelectionMenuRenderer,\n            );\n            uiCapability.registerComponentRenderer('leftPanelMain', leftPanelMainRenderer);\n            uiCapability.registerComponentRenderer('printModal', printModalRenderer);\n            uiCapability.registerComponentRenderer(\n              'leftPanelAnnotationStyle',\n              leftPanelAnnotationStyleRenderer,\n            );\n          }\n        }}\n        plugins={[\n          createPluginRegistration(UIPluginPackage, uiConfig),\n          createPluginRegistration(LoaderPluginPackage, {\n            loadingOptions: {\n              type: 'url',\n              pdfFile: {\n                id: 'pdf',\n                url: config.src,\n              },\n              options: {\n                mode: 'full-fetch',\n              },\n            },\n          }),\n          createPluginRegistration(ViewportPluginPackage, pluginConfigs.viewport),\n          createPluginRegistration(ScrollPluginPackage, pluginConfigs.scroll),\n          createPluginRegistration(ZoomPluginPackage, pluginConfigs.zoom),\n          createPluginRegistration(SpreadPluginPackage, pluginConfigs.spread),\n          createPluginRegistration(RenderPluginPackage, {}),\n          createPluginRegistration(RotatePluginPackage, pluginConfigs.rotate),\n          createPluginRegistration(SearchPluginPackage, {}),\n          createPluginRegistration(SelectionPluginPackage, {}),\n          createPluginRegistration(TilingPluginPackage, pluginConfigs.tiling),\n          createPluginRegistration(ThumbnailPluginPackage, pluginConfigs.thumbnail),\n          createPluginRegistration(AnnotationPluginPackage, {}),\n          createPluginRegistration(PrintPluginPackage, pluginConfigs.print),\n          createPluginRegistration(FullscreenPluginPackage, {}),\n          createPluginRegistration(BookmarkPluginPackage, {}),\n          createPluginRegistration(ExportPluginPackage, {}),\n          createPluginRegistration(InteractionManagerPluginPackage, {}),\n          createPluginRegistration(PanPluginPackage, {}),\n          createPluginRegistration(CapturePluginPackage, {\n            scale: 2,\n            imageType: 'image/png',\n          }),\n          createPluginRegistration(HistoryPluginPackage, {}),\n        ]}\n      >\n        {({ pluginsReady }) => (\n          <PluginUIProvider>\n            {({ headers, panels, floating, commandMenu }) => (\n              <FullscreenProvider>\n                <PrintProvider>\n                  <div className=\"@container relative flex h-full w-full select-none flex-col\">\n                    {headers.top.length > 0 && <div>{headers.top}</div>}\n                    <div className=\"flex flex-1 flex-row overflow-hidden\">\n                      <div className=\"flex flex-col\">{headers.left}</div>\n                      <div className=\"flex flex-1 flex-col overflow-hidden md:flex-row\">\n                        {panels.left.length > 0 && <Fragment>{panels.left}</Fragment>}\n                        <div className=\"relative flex w-full flex-1 overflow-hidden\">\n                          <GlobalPointerProvider>\n                            <PanMode />\n                            <Viewport\n                              style={{\n                                width: '100%',\n                                height: '100%',\n                                flexGrow: 1,\n                                backgroundColor: '#f1f3f5',\n                                overflow: 'auto',\n                              }}\n                            >\n                              {!pluginsReady && (\n                                <div className=\"flex h-full w-full items-center justify-center\">\n                                  <LoadingIndicator size=\"lg\" text=\"Loading PDF document...\" />\n                                </div>\n                              )}\n                              {pluginsReady && (\n                                <PinchWrapper>\n                                  <Scroller\n                                    renderPage={({\n                                      pageIndex,\n                                      scale,\n                                      rotation,\n                                      width,\n                                      height,\n                                      rotatedHeight,\n                                      rotatedWidth,\n                                      document,\n                                    }) => (\n                                      <Rotate key={document?.id} pageSize={{ width, height }}>\n                                        <PagePointerProvider\n                                          rotation={rotation}\n                                          scale={scale}\n                                          pageWidth={rotatedWidth}\n                                          pageHeight={rotatedHeight}\n                                          pageIndex={pageIndex}\n                                          style={{\n                                            width,\n                                            height,\n                                          }}\n                                        >\n                                          <RenderLayer\n                                            pageIndex={pageIndex}\n                                            className=\"pointer-events-none\"\n                                          />\n                                          <TilingLayer\n                                            pageIndex={pageIndex}\n                                            scale={scale}\n                                            className=\"pointer-events-none\"\n                                          />\n                                          <SearchLayer\n                                            pageIndex={pageIndex}\n                                            scale={scale}\n                                            className=\"pointer-events-none\"\n                                          />\n                                          <HintLayer />\n                                          <AnnotationLayer\n                                            pageIndex={pageIndex}\n                                            scale={scale}\n                                            pageWidth={width}\n                                            pageHeight={height}\n                                            rotation={rotation}\n                                          />\n                                          <MarqueeZoom\n                                            pageIndex={pageIndex}\n                                            scale={scale}\n                                            pageWidth={width}\n                                            pageHeight={height}\n                                          />\n                                          <MarqueeCapture\n                                            pageIndex={pageIndex}\n                                            scale={scale}\n                                            pageWidth={width}\n                                            pageHeight={height}\n                                          />\n                                          <SelectionLayer pageIndex={pageIndex} scale={scale} />\n                                        </PagePointerProvider>\n                                      </Rotate>\n                                    )}\n                                    overlayElements={floating.insideScroller}\n                                  />\n                                </PinchWrapper>\n                              )}\n                              {floating.outsideScroller}\n                            </Viewport>\n                          </GlobalPointerProvider>\n                        </div>\n                        {panels.right.length > 0 && <Fragment>{panels.right}</Fragment>}\n                      </div>\n                      <div className=\"flex flex-col\">{headers.right}</div>\n                    </div>\n                    {headers.bottom.length > 0 && <div>{headers.bottom}</div>}\n                    {commandMenu}\n                  </div>\n                  <FilePicker />\n                  <Download />\n                  <Capture />\n                  <CopyToClipboard />\n                </PrintProvider>\n              </FullscreenProvider>\n            )}\n          </PluginUIProvider>\n        )}\n      </EmbedPDF>\n    </>\n  );\n}\n","import { h, render } from 'preact';\nimport { PDFViewer, PDFViewerConfig } from '@/components/app';\n\nexport class EmbedPdfContainer extends HTMLElement {\n  private root: ShadowRoot;\n  private _config?: PDFViewerConfig;\n\n  constructor() {\n    super();\n    this.root = this.attachShadow({ mode: 'open' });\n  }\n\n  connectedCallback() {\n    // If config isnt provided via script, build it from attributes\n    if (!this._config) {\n      this._config = {\n        src: this.getAttribute('src') || '/demo.pdf',\n        worker: this.getAttribute('worker') !== 'false',\n      };\n    }\n    this.renderViewer();\n  }\n\n  // Setter for config\n  set config(newConfig: PDFViewerConfig) {\n    this._config = newConfig;\n    if (this.isConnected) {\n      this.renderViewer();\n    }\n  }\n\n  // Getter for config\n  get config(): PDFViewerConfig | undefined {\n    return this._config;\n  }\n\n  renderViewer() {\n    if (!this._config) return;\n    render(<PDFViewer config={this._config} />, this.root);\n  }\n}\n","import { EmbedPdfContainer } from './web-components/container';\nimport {\n  PDFViewerConfig,\n  PluginConfigs,\n  ScrollStrategy,\n  ZoomMode,\n  SpreadMode,\n  Rotation,\n} from './components/app';\n\ntype ContainerConfig = PDFViewerConfig & {\n  type: 'container';\n  target: Element;\n};\n\ncustomElements.define('embedpdf-container', EmbedPdfContainer);\n\nfunction initContainer(config: ContainerConfig) {\n  const { type, target, ...viewerConfig } = config;\n  const embedPdfElement = document.createElement('embedpdf-container') as EmbedPdfContainer;\n  embedPdfElement.config = viewerConfig;\n  config.target.appendChild(embedPdfElement);\n\n  return embedPdfElement;\n}\n\nexport type ReturnContainerType = ReturnType<typeof initContainer>;\n\n// Export types for users\nexport type { PluginConfigs, ScrollStrategy, ZoomMode, SpreadMode, Rotation };\n\nexport default {\n  init: (\n    config: ContainerConfig,\n  ): ReturnType<typeof initContainer> | ReturnContainerType | undefined => {\n    if (config.type === 'container') {\n      return initContainer(config as ContainerConfig);\n    }\n  },\n};\n"],"names":["p","v","y","css","ref","insertAt","document","head","getElementsByTagName","style","createElement","type","firstChild","insertBefore","appendChild","styleSheet","cssText","createTextNode","t","r","u","i","o","f","c","n","e","__b","a","__r","diffed","l","__c","m","unmount","s","__","__h","__H","length","push","d","D","__N","setState","__f","filter","every","call","this","props","forEach","shouldComponentUpdate","componentWillUpdate","__e","h","__s","C","_","A","T","current","q","x","context","sub","value","j","shift","__P","z","B","__v","__k","__m","requestAnimationFrame","w","some","k","clearTimeout","cancelAnimationFrame","setTimeout","Rotation","Rotation2","toIntPos","Math","floor","toIntSize","width","ceil","height","toIntRect","origin","size","swap","transformSize","rotation","scaleFactor","quadToRect","xs","p1","p2","p3","p4","ys","min","max","rectToQuad","rotatePosition","containerSize","position","scalePosition","rotateRect","rect","scaleRect","transformRect","boundingRect","rects","minX","minY","maxX","maxY","makeMatrix","rectangle","b","C$9","constructor","dependencyGraph","Map","addNode","set","Set","hasCircularDependencies","add","get","has","delete","keys","resolveLoadOrder","Error","P","registry","isInitializing","pluginsReady","defaultWasmUrl","S","id","name","version","provides","requires","optional","defaultConfig","enabled","viewportGap","scrollEndDelay","useViewportCapability","Vertical","Horizontal","useScrollCapability","f$d","load","pdfFile","options","engine","openDocumentUrl","Promise","wait","reason","Button","_ref","children","onClick","_ref$active","active","_ref$disabled","disabled","_ref$className","className","tooltip","_objectWithoutProperties","_excluded","_objectSpread","concat","title","round","createCoords","oppositeSideMap","left","right","bottom","top","oppositeAlignmentMap","start","end","clamp","evaluate","param","getSide","placement","split","getAlignment","getOppositeAxis","axis","getAxisLength","yAxisSides","getSideAxis","getAlignmentAxis","getOppositeAlignmentPlacement","replace","alignment","lrPlacement","rlPlacement","tbPlacement","btPlacement","getOppositeAxisPlacements","flipAlignment","direction","rtl","list","side","isStart","getSideList","map","getOppositePlacement","getPaddingObject","padding","expandPaddingObject","rectToClientRect","computeCoordsFromPlacement","reference","floating","sideAxis","alignmentAxis","alignLength","isVertical","commonX","commonY","commonAlign","coords","async","detectOverflow","state","_await$platform$isEle","platform","elements","strategy","boundary","rootBoundary","elementContext","altBoundary","paddingObject","element","clippingClientRect","getClippingRect","isElement","contextElement","getDocumentElement","offsetParent","getOffsetParent","offsetScale","getScale","elementClientRect","convertOffsetParentRelativeRectToViewportRelativeRect","originSides","hasWindow","window","getNodeName","node","isNode","nodeName","toLowerCase","getWindow","_node$ownerDocument","ownerDocument","defaultView","documentElement","Node","Element","isHTMLElement","HTMLElement","isShadowRoot","ShadowRoot","invalidOverflowDisplayValues","isOverflowElement","overflow","overflowX","overflowY","display","getComputedStyle","test","tableElements","isTableElement","topLayerSelectors","isTopLayer","selector","matches","_e","transformProperties","willChangeValues","containValues","isContainingBlock","elementOrCss","webkit","isWebKit","containerType","backdropFilter","willChange","includes","contain","CSS","supports","lastTraversableNodeNames","isLastTraversableNode","getNodeScroll","scrollLeft","scrollTop","scrollX","scrollY","getParentNode","result","assignedSlot","parentNode","host","getNearestOverflowAncestor","body","getOverflowAncestors","traverseIframes","_node$ownerDocument2","scrollableAncestor","isBody","win","frameElement","getFrameElement","visualViewport","parent","Object","getPrototypeOf","getCssDimensions","parseFloat","hasOffset","offsetWidth","offsetHeight","shouldFallback","$","unwrapElement","domElement","getBoundingClientRect","Number","isFinite","noOffsets","getVisualOffsets","offsetLeft","offsetTop","includeScale","isFixedStrategy","clientRect","scale","visualOffsets","isFixed","floatingOffsetParent","shouldAddVisualOffsets","offsetWin","currentWin","currentIFrame","iframeScale","iframeRect","clientLeft","paddingLeft","clientTop","paddingTop","getWindowScrollBarX","leftScroll","getHTMLOffset","scroll","ignoreScrollbarX","htmlRect","absoluteOrFixed","getClientRectFromClippingAncestor","clippingAncestor","html","clientWidth","clientHeight","visualViewportBased","getViewportRect","scrollWidth","scrollHeight","getDocumentRect","getInnerBoundingClientRect","hasFixedPositionAncestor","stopNode","getRectRelativeToOffsetParent","isOffsetParentAnElement","offsets","setLeftRTLScrollbarOffset","offsetRect","htmlOffset","isStaticPositioned","getTrueOffsetParent","polyfill","rawOffsetParent","svgOffsetParent","currentNode","getContainingBlock","topLayer","clippingAncestors","cache","cachedResult","el","currentContainingBlockComputedStyle","elementIsFixed","computedStyle","currentNodeIsContaining","ancestor","getClippingElementAncestors","_c","firstClippingAncestor","clippingRect","reduce","accRect","getElementRects","data","getOffsetParentFn","getDimensionsFn","getDimensions","floatingDimensions","getClientRects","Array","from","isRTL","rectsAreEqual","autoUpdate","update","ancestorScroll","ancestorResize","elementResize","ResizeObserver","layoutShift","IntersectionObserver","animationFrame","referenceEl","ancestors","addEventListener","passive","cleanupIo","onMove","timeoutId","io","root","cleanup","_io","disconnect","refresh","skip","threshold","elementRectForRootMargin","rootMargin","isFirstUpdate","handleObserve","entries","ratio","intersectionRatio","observe","observeMove","frameId","reobserveFrame","resizeObserver","firstEntry","target","unobserve","_resizeObserver","prevRefRect","frameLoop","nextRefRect","_resizeObserver2","removeEventListener","offset","fn","_middlewareData$offse","_middlewareData$arrow","middlewareData","diffCoords","mainAxisMulti","crossAxisMulti","rawValue","mainAxis","crossAxis","convertValueToCoords","arrow","alignmentOffset","checkMainAxis","checkCrossAxis","limiter","detectOverflowOptions","mainAxisCoord","crossAxisCoord","maxSide","limitedCoords","flip","_middlewareData$flip","initialPlacement","fallbackPlacements","specifiedFallbackPlacements","fallbackStrategy","fallbackAxisSideDirection","initialSideAxis","isBasePlacement","oppositePlacement","getExpandedPlacements","hasFallbackAxisSideDirection","placements","overflows","overflowsData","sides","mainAlignmentSide","getAlignmentSides","_middlewareData$flip2","_overflowsData$filter","nextIndex","index","nextPlacement","reset","resetPlacement","sort","_overflowsData$filter2","currentSideAxis","acc","arrowDimensions","isYAxis","minProp","maxProp","clientProp","endDiff","startDiff","arrowOffsetParent","clientSize","centerToReference","largestPossiblePadding","minPadding","maxPadding","min$1","center","shouldAddOffset","centerOffset","computePosition","mergedOptions","platformWithCache","config","middleware","validMiddleware","Boolean","statefulPlacement","resetCount","nextX","nextY","computePosition$1","RefWrapper","_classCallCheck","_callSuper","arguments","_inherits","Component","_createClass","key","Tooltip","content","_ref$position","_ref$delay","delay","_ref$style","_ref$trigger","trigger","useRef","_useState2","_slicedToArray","useState","visible","setVisible","st","useEffect","_reference$current","base","arrowMw","then","_ref2","assign","_ref3","ax","ay","staticSide","_defineProperty","_reference$current2","refEl","floatEl","clear","show","hide","toggle","Fragment","role","visibility","E","Dropdown","open","_ref$placement","_ref$offsetSkidding","offsetSkidding","_ref$offsetDistance","offsetDistance","onShow","onHide","menuRef","setPosition","resolvedPlacement","resolvePlacement","handlePointer","ev","_ev$composedPath","_ev$composedPath2","path","composedPath","y2","Icon","svgContent","icon","iconManager","useIcon","isSvgDataUri","dataUriToSvgString","getSvgString","console","warn","iconElement","dangerouslySetInnerHTML","__html","useDebounce","undefined","debounced","setDebounced","Checkbox","label","checked","onChange","viewBox","fill","stroke","strokeWidth","strokeLinecap","strokeLinejoin","points","L","getHandlersForScope","onModeChange","getActiveInteractionMode","cursor","scope","onHandlerChange","g","getCurrentCursor","onCursorChange","onPointerDown","onPointerUp","onPointerMove","onPointerEnter","onPointerLeave","onPointerCancel","isPaused","getActiveMode","toPos","clientX","clientY","M","payload","mode","useInteractionManagerCapability","I","exclusive","useSelectionCapability","modeId","pageIndex","register","registerHandlers","handlers","registerAlways","setCursor","removeCursor","edgeVisible","vr","vp","menuHeight","margin","vpGap","isTop","menuPositionForSelection","boundingRects","scrollCap","vpCap","getMetrics","getViewportGap","first","last","firstVR","getRectPositionForPage","page","lastVR","bottomSpaceAvailable","topSpaceAvailable","Dialog","onClose","_ref$showCloseButton","showCloseButton","maxWidth","overlayRef","handleEscape","_jsx","_jsxs","stopPropagation","Rotation22","PRINT_PLUGIN_ID","manifest","offsetX","offsetY","iconButtonRenderer","commandId","color","ui","useUICapability","command","getMenuOrAction","handleClick","useCallback","preventDefault","triggerElement","currentTarget","executeCommand","source","variant","img","src","alt","tabButtonRenderer","_excluded2","dividerRenderer","groupedItemsRenderer","flexDirection","justifyContent","gap","headerRenderer","borderBottom","borderTop","borderRight","borderLeft","zIndex","paddingBottom","paddingRight","visibleChild","childId","leftPanelMainRenderer","tabsCommand","tabsCommandId","tabChildren","getItemsByIds","child","idx","array","isActive","isFirst","isLast","tabIndex","panelRenderer","_useSwipeGesture","isOpen","isFullscreen","setIsFullscreen","startY","currentY","elementRef","isDragging","handleStart","touches","handleMove","deltaY","handleEnd","useSwipeGesture","borderClass","location","togglePanel","HitLine","hit","_hit$context","before","match","after","truncatedLeft","truncatedRight","scrollIntoView","behavior","block","searchRenderer","inputRef","query","inputValue","setInputValue","search","useSearchCapability","debouncedValue","focus","stopSearch","searchAllPages","activeResultIndex","loading","scrollToItem","flags","handleFlagChange","flag","setFlags","_toConsumableArray","item","results","minCoordinates","Infinity","scrollToPage","pageNumber","pageCoordinates","grouped","_r$pageIndex","_map$_r$pageIndex","xmlns","fillRule","clipRule","placeholder","autoFocus","onInput","MatchFlag","MatchCase","MatchWholeWord","total","previousResult","nextResult","_ref4","_ref5","hits","_ref6","goToResult","zoomRenderer","zoom","useZoomCapability","commandZoomMenu","commandZoomIn","commandZoomOut","_useState4","zoomDropdownRef","zoomPercentage","zoomLevel","flatten","log","onSubmit","form","zoomStr","FormData","requestZoom","inputMode","pattern","zoomMenuActive","class","annotationSelectionMenuRenderer","annotation","useAnnotationCapability","viewport","selectedAnnotation","getSelectedAnnotation","object","transform","textSelectionMenuRenderer","selection","getBoundingRects","pageControlsContainerRenderer","_useState6","isVisible","setIsVisible","_useState8","isHovering","setIsHovering","hideTimeoutRef","startHideTimer","onScrollChange","scrollMetrics","onMouseEnter","onMouseLeave","pageControlsRenderer","isFirstPage","currentPage","isLastPage","pageCount","commandNextPage","nextPageCommandId","commandPreviousPage","previousPageCommandId","pageStr","parseInt","isNaN","commandMenuRenderer","_ref7","activeCommand","_useState0","history","setHistory","lastPushRef","items","getChildItems","currentMenu","pushMenu","menuId","prev","renderCommandItem","group","groupChildren","childIndex","divider","dividerBefore","hideCommandMenu","handleCommandClick","shortcutLabel","menuContent","previous","slice","commentRender","thumbnailsRender","ThumbnailsPane","selectedPage","wrapperHeight","ThumbImg","meta","labelHeight","outlineRenderer","bookmark","useBookmarkCapability","_useState10","bookmarks","setBookmarks","_useState12","expandedItems","setExpandedItems","task","getBookmarks","_ref8","firstLevelIds","ignore","abort","code","PdfErrorCode","Cancelled","message","renderBookmarkItem","_bookmark$children","level","itemId","hasChildren","isExpanded","action","destination","PdfZoomMode","XYZ","_props$document","pages","find","params","FitPage","handleBookmarkClick","newSet","toggleExpanded","attachmentsRenderer","selectButtonRenderer","_ref9","activeCommandId","menuCommandId","printModalRenderer","_scrollMetrics$pageVi","_usePrintAction","usePrintAction","executePrint","parsePageRange","progress","isPrinting","_useState14","PageRangeType","All","pageRangeType","setPageRangeType","_useState16","customPages","setCustomPages","_useState18","includeAnnotations","setIncludeAnnotations","_useState20","PrintQuality","Normal","quality","setQuality","_useState22","customPagesError","setCustomPagesError","totalPages","pageVisibilityMetrics","handleClose","updateComponentState","componentType","componentId","patch","handlePageRangeChange","handlePrint","_ref0","_asyncToGenerator","_regenerator","_callee","pageRange","parsed","printOptions","_t","_t2","_context","Current","Custom","trim","isValid","error","apply","isCustomPagesValid","High","status","ANNOTATION_PLUGIN_ID","autoCommit","CONTROL_MAP","makeVariantKey","PdfAnnotationSubtype","HIGHLIGHT","step","UNDERLINE","STRIKEOUT","SQUIGGLY","INK","Slider","_ref$min","_ref$max","_ref$step","ColorSwatch","onSelect","backgroundColor","leftPanelAnnotationStyleRenderer","_defaults$subtype","_CONTROL_MAP$activeVa","_selectedAnnotation$a","_selectedAnnotation$a2","activeVariant","colorPresets","activeVariantKey","intent","defaults","getToolDefaults","activeSubtype","subtype","controls","baseAlpha","anno","opacity","getAlphaFromAnnotation","setColor","changeColor","applyPatch","opacityLocal","setOpacityLocal","debouncedOpacity","initialStrokeWidth","strokeWidthLocal","setStrokeWidthLocal","debouncedStroke","baseBlendMode","blendMode","PdfBlendMode","blendModeLocal","setBlendModeLocal","updateAnnotation","localId","setToolDefaults","ctrl","val","bm","blendModeSelectOptions","ZoomMode","ZoomMode2","super","initialize","buildCapability","renderPage","bind","renderPageRect","dpr","Degree0","withAnnotations","imageType","coreState","core","R","W","tileSize","overlapPx","extraRings","useTilingCapability","THUMBNAIL_PLUGIN_ID","buffer","LoadingIndicator","_ref$size","_ref$text","text","sizeClasses","sm","md","lg","FULLSCREEN_PLUGIN_ID","BOOKMARK_PLUGIN_ID","CAPTURE_PLUGIN_ID","HISTORY_PLUGIN_ID","Capture","capture","useCaptureCapability","setOpen","captureData","setCaptureData","previewUrl","setPreviewUrl","downloadUrl","setDownloadUrl","urlRef","downloadLinkRef","URL","revokeObjectURL","onCaptureArea","blob","objectUrl","createObjectURL","onLoad","maxHeight","border","borderRadius","url","href","download","click","HintLayer","_useInteractionManage","onStateChange","useInteractionManager","interactionManager","isAnimating","hint","setHint","activeMode","timeout","hintText","hintColor","onAnimationEnd","pointerEvents","alignItems","background","fontSize","fontWeight","textAlign","jsx","DEFAULT_PLUGIN_CONFIGS","ScrollStrategy","defaultZoomLevel","spread","defaultSpreadMode","SpreadMode","None","rotate","defaultRotation","tiling","thumbnail","print","batchSize","menuItems","menuCtr","storeState","plugins","commandMenu","_registry$getPlugin","exportPlugin","getPlugin","EXPORT_PLUGIN_ID","openFile","_registry$getPlugin2","loader","LOADER_PLUGIN_ID","openFileDialog","enterFS","fullscreen","_registry$getPlugin3","exitFullscreen","enableFullscreen","screenshot","_registry$getPlugin4","isMarqueeCaptureActive","disableMarqueeCapture","enableMarqueeCapture","INTERACTION_MANAGER_PLUGIN_ID","save","_registry$getPlugin5","UI_PLUGIN_ID","settings","viewCtr","pageOrientation","rotateClockwise","_registry$getPlugin6","ROTATE_PLUGIN_ID","rotateForward","rotateCounterClockwise","_registry$getPlugin7","rotateBackward","scrollLayout","vertical","_registry$getPlugin8","SCROLL_PLUGIN_ID","setScrollStrategy","horizontal","_registry$getPlugin9","pageLayout","singlePage","spreadMode","_registry$getPlugin0","SPREAD_PLUGIN_ID","setSpreadMode","doublePage","Odd","_registry$getPlugin1","coverFacingPage","Even","_registry$getPlugin10","leftAction","zoomInArea","_registry$getPlugin11","ZOOM_PLUGIN_ID","isMarqueeZoomActive","disableMarqueeZoom","enableMarqueeZoom","changeZoomLevel","currentZoomLevel","toFixed","zoom25","_registry$getPlugin12","zoom50","_registry$getPlugin13","zoom100","_registry$getPlugin14","zoom125","_registry$getPlugin15","zoom150","_registry$getPlugin16","zoom200","_registry$getPlugin17","zoom400","_registry$getPlugin18","zoom800","_registry$getPlugin19","zoom1600","_registry$getPlugin20","zoomIn","_registry$getPlugin21","zoomOut","_registry$getPlugin22","_registry$getPlugin23","panel","rightPanel","comment","_registry$getPlugin24","fitToWidth","FitWidth","_registry$getPlugin25","fitToPage","_registry$getPlugin26","sidebar","_registry$getPlugin27","leftPanel","sidebarMenu","thumbnails","_registry$getPlugin28","custom","leftPanelMain","outline","_registry$getPlugin29","attachments","_registry$getPlugin30","view","_registry$getPlugin31","_registry$getPlugin32","setHeaderVisible","setActiveVariant","header","toolsHeader","annotate","_registry$getPlugin33","shapes","_registry$getPlugin34","fillAndSign","_registry$getPlugin35","_registry$getPlugin36","tabOverflow","nextPage","shortcut","_registry$getPlugin37","scrollToNextPage","previousPage","_registry$getPlugin38","scrollToPreviousPage","copy","_registry$getPlugin39","SELECTION_PLUGIN_ID","copyToClipboard","underline","_registry$getPlugin40","squiggly","_registry$getPlugin41","strikethrough","_registry$getPlugin42","highlight","_registry$getPlugin43","freehand","_registry$getPlugin44","deselectAnnotation","squigglySelection","_registry$getPlugin45","_registry$getPlugin46","_step","defaultSettings","_iterator","_createForOfIteratorHelper","getFormattedSelection","done","createAnnotation","Date","now","random","segmentRects","err","underlineSelection","_registry$getPlugin47","_registry$getPlugin48","_step2","_iterator2","strikethroughSelection","_registry$getPlugin49","_registry$getPlugin50","_step3","_iterator3","highlightSelection","_registry$getPlugin51","_registry$getPlugin52","_step4","_iterator4","styleAnnotation","_registry$getPlugin53","deleteAnnotation","_registry$getPlugin54","panMode","_registry$getPlugin55","activate","undo","_registry$getPlugin56","global","canUndo","redo","_registry$getPlugin57","canRedo","commitAnnotations","_registry$getPlugin58","commit","components","menuButton","mapStateToProps","ownProps","deleteAnnotationButton","styleButton","undoButton","isDisabled","redoButton","commitAnnotationsButton","copyButton","panModeButton","underlineButton","toolDefaults","squigglyButton","strikethroughButton","highlightButton","freehandButton","highlightSelectionButton","underlineSelectionButton","strikethroughSelectionButton","squigglySelectionButton","viewCtrButton","commentButton","searchButton","filePickerButton","downloadButton","zoomButton","sidebarButton","divider1","expandLeftActionsButton","headerStart","slots","priority","viewTab","annotateTab","shapesTab","fillAndSignTab","formTab","tabOverflowButton","selectButton","commandIds","_ownProps$commandIds$","headerCenter","headerEnd","pageControls","render","initialState","_storeState$core$docu","_storeState$core$docu2","pageControlsContainer","scrollerPosition","textSelectionMenuButtons","printModal","textSelectionMenu","isScolling","isScrolling","selecting","getChildContext","annotationSelectionMenuButtons","annotationSelectionMenu","selectedUid","topHeader","annotationTools","leftPanelAnnotationStyle","getSelectedAnnotationWithPageIndex","uiConfig","icons","menu","svg","fullscreenExit","viewSettings","chevronRight","chevronLeft","chevronDown","dots","book","book2","squares","listTree","paperclip","palette","fileImport","hand","arrowBackUp","arrowForwardUp","trash","deviceFloppy","pencilMarker","logger","PDFViewer","_onInitialized","_usePdfiumEngine","wasmUrl","worker","setEngine","setLoading","setError","engineRef","cancelled","createPdfiumEngine","import","pdfEngine","destroy","isLoading","usePdfiumEngine","pluginConfigs","userConfigs","mergePluginConfigs","styles","EmbedPDF","onInitialized","_registry$getPlugin59","uiCapability","registerComponentRenderer","_x","createPluginRegistration","UIPluginPackage","LoaderPluginPackage","loadingOptions","ViewportPluginPackage","ScrollPluginPackage","ZoomPluginPackage","SpreadPluginPackage","RenderPluginPackage","RotatePluginPackage","SearchPluginPackage","SelectionPluginPackage","TilingPluginPackage","ThumbnailPluginPackage","AnnotationPluginPackage","PrintPluginPackage","FullscreenPluginPackage","BookmarkPluginPackage","ExportPluginPackage","InteractionManagerPluginPackage","PanPluginPackage","CapturePluginPackage","HistoryPluginPackage","PluginUIProvider","headers","panels","FullscreenProvider","PrintProvider","GlobalPointerProvider","PanMode","Viewport","flexGrow","PinchWrapper","Scroller","rotatedHeight","rotatedWidth","Rotate","pageSize","PagePointerProvider","pageWidth","pageHeight","RenderLayer","TilingLayer","SearchLayer","AnnotationLayer","MarqueeZoom","MarqueeCapture","SelectionLayer","overlayElements","insideScroller","outsideScroller","FilePicker","Download","CopyToClipboard","EmbedPdfContainer","_this","attachShadow","_wrapNativeSuper","_config","getAttribute","renderViewer","newConfig","isConnected","customElements","define","embedpdf","init","viewerConfig","embedPdfElement","initContainer"],"mappings":"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","x_google_ignoreList":[0,1,2,14,15,16,17,19]}