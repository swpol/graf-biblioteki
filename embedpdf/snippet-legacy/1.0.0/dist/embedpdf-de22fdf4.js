function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=Array(t);i<t;i++)r[i]=e[i];return r}function t(e,t,i,r,o,n,s){try{var a=e[n](s),l=a.value}catch(e){return void i(e)}a.done?t(l):Promise.resolve(l).then(r,o)}function i(e){return function(){var i=this,r=arguments;return new Promise(function(o,n){var s=e.apply(i,r);function a(e){t(s,o,n,a,l,"next",e)}function l(e){t(s,o,n,a,l,"throw",e)}a(void 0)})}}function r(e,t,i){return t=c(t),function(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(e,u()?Reflect.construct(t,i||[],c(e).constructor):t.apply(e,i))}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,w(r.key),r)}}function s(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),Object.defineProperty(e,"prototype",{writable:!1}),e}function a(e,t){var i="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!i){if(Array.isArray(e)||(i=S(e))||t&&e&&"number"==typeof e.length){i&&(e=i);var r=0,o=function(){};return{s:o,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,s=!0,a=!1;return{s:function(){i=i.call(e)},n:function(){var e=i.next();return s=e.done,e},e:function(e){a=!0,n=e},f:function(){try{s||null==i.return||i.return()}finally{if(a)throw n}}}}function l(e,t,i){return(t=w(t))in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function c(e){return c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},c(e)}function d(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&b(e,t)}function u(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(u=function(){return!!e})()}function h(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),i.push.apply(i,r)}return i}function p(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?h(Object(i),!0).forEach(function(t){l(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):h(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function g(e,t){if(null==e)return{};var i,r,o=function(e,t){if(null==e)return{};var i={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(-1!==t.indexOf(r))continue;i[r]=e[r]}return i}(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)i=n[r],-1===t.indexOf(i)&&{}.propertyIsEnumerable.call(e,i)&&(o[i]=e[i])}return o}function f(){
/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/babel/babel/blob/main/packages/babel-helpers/LICENSE */
var e,t,i="function"==typeof Symbol?Symbol:{},r=i.iterator||"@@iterator",o=i.toStringTag||"@@toStringTag";function n(i,r,o,n){var l=r&&r.prototype instanceof a?r:a,c=Object.create(l.prototype);return m(c,"_invoke",function(i,r,o){var n,a,l,c=0,d=o||[],u=!1,h={p:0,n:0,v:e,a:p,f:p.bind(e,4),d:function(t,i){return n=t,a=0,l=e,h.n=i,s}};function p(i,r){for(a=i,l=r,t=0;!u&&c&&!o&&t<d.length;t++){var o,n=d[t],p=h.p,g=n[2];i>3?(o=g===r)&&(l=n[(a=n[4])?5:(a=3,3)],n[4]=n[5]=e):n[0]<=p&&((o=i<2&&p<n[1])?(a=0,h.v=r,h.n=n[1]):p<g&&(o=i<3||n[0]>r||r>g)&&(n[4]=i,n[5]=r,h.n=g,a=0))}if(o||i>1)return s;throw u=!0,r}return function(o,d,g){if(c>1)throw TypeError("Generator is already running");for(u&&1===d&&p(d,g),a=d,l=g;(t=a<2?e:l)||!u;){n||(a?a<3?(a>1&&(h.n=-1),p(a,l)):h.n=l:h.v=l);try{if(c=2,n){if(a||(o="next"),t=n[o]){if(!(t=t.call(n,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,a<2&&(a=0)}else 1===a&&(t=n.return)&&t.call(n),a<2&&(l=TypeError("The iterator does not provide a '"+o+"' method"),a=1);n=e}else if((t=(u=h.n<0)?l:i.call(r,h))!==s)break}catch(t){n=e,a=1,l=t}finally{c=1}}return{value:t,done:u}}}(i,o,n),!0),c}var s={};function a(){}function l(){}function c(){}t=Object.getPrototypeOf;var d=[][r]?t(t([][r]())):(m(t={},r,function(){return this}),t),u=c.prototype=a.prototype=Object.create(d);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,c):(e.__proto__=c,m(e,o,"GeneratorFunction")),e.prototype=Object.create(u),e}return l.prototype=c,m(u,"constructor",c),m(c,"constructor",l),l.displayName="GeneratorFunction",m(c,o,"GeneratorFunction"),m(u),m(u,o,"Generator"),m(u,r,function(){return this}),m(u,"toString",function(){return"[object Generator]"}),(f=function(){return{w:n,m:h}})()}function m(e,t,i,r){var o=Object.defineProperty;try{o({},"",{})}catch(e){o=0}m=function(e,t,i,r){if(t)o?o(e,t,{value:i,enumerable:!r,configurable:!r,writable:!r}):e[t]=i;else{function n(t,i){m(e,t,function(e){return this._invoke(t,i,e)})}n("next",0),n("throw",1),n("return",2)}},m(e,t,i,r)}function b(e,t){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},b(e,t)}function v(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var i=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=i){var r,o,n,s,a=[],l=!0,c=!1;try{if(n=(i=i.call(e)).next,0===t){if(Object(i)!==i)return;l=!1}else for(;!(l=(r=n.call(i)).done)&&(a.push(r.value),a.length!==t);l=!0);}catch(e){c=!0,o=e}finally{try{if(!l&&null!=i.return&&(s=i.return(),Object(s)!==s))return}finally{if(c)throw o}}return a}}(e,t)||S(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(t)||S(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function w(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var r=i.call(e,t||"default");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}function S(t,i){if(t){if("string"==typeof t)return e(t,i);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?e(t,i):void 0}}function C(e){var t="function"==typeof Map?new Map:void 0;return C=function(e){if(null===e||!function(e){try{return-1!==Function.toString.call(e).indexOf("[native code]")}catch(t){return"function"==typeof e}}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,i)}function i(){return function(e,t,i){if(u())return Reflect.construct.apply(null,arguments);var r=[null];r.push.apply(r,t);var o=new(e.bind.apply(e,r));return i&&b(o,i.prototype),o}(e,arguments,c(this).constructor)}return i.prototype=Object.create(e.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),b(i,e)},C(e)}var x,I,A,E,k,P,M,T,R,_,N,O,z={},L=[],D=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,F=Array.isArray;function H(e,t){for(var i in t)e[i]=t[i];return e}function $(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function j(e,t,i){var r,o,n,s={};for(n in t)"key"==n?r=t[n]:"ref"==n?o=t[n]:s[n]=t[n];if(arguments.length>2&&(s.children=arguments.length>3?x.call(arguments,2):i),"function"==typeof e&&null!=e.defaultProps)for(n in e.defaultProps)void 0===s[n]&&(s[n]=e.defaultProps[n]);return U(e,s,r,o,null)}function U(e,t,i,r,o){var n={type:e,props:t,key:i,ref:r,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:null==o?++A:o,__i:-1,__u:0};return null==o&&null!=I.vnode&&I.vnode(n),n}function B(e){return e.children}function G(e,t){this.props=e,this.context=t}function V(e,t){if(null==t)return e.__?V(e.__,e.__i+1):null;for(var i;t<e.__k.length;t++)if(null!=(i=e.__k[t])&&null!=i.__e)return i.__e;return"function"==typeof e.type?V(e):null}function W(e){var t,i;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(i=e.__k[t])&&null!=i.__e){e.__e=e.__c.base=i.__e;break}return W(e)}}function Z(e){(!e.__d&&(e.__d=!0)&&E.push(e)&&!q.__r++||k!=I.debounceRendering)&&((k=I.debounceRendering)||P)(q)}function q(){for(var e,t,i,r,o,n,s,a=1;E.length;)E.length>a&&E.sort(M),e=E.shift(),a=E.length,e.__d&&(i=void 0,o=(r=(t=e).__v).__e,n=[],s=[],t.__P&&((i=H({},r)).__v=r.__v+1,I.vnode&&I.vnode(i),ie(t.__P,i,r,t.__n,t.__P.namespaceURI,32&r.__u?[o]:null,n,null==o?V(r):o,!!(32&r.__u),s),i.__v=r.__v,i.__.__k[i.__i]=i,re(n,i,s),i.__e!=o&&W(i)));q.__r=0}function X(e,t,i,r,o,n,s,a,l,c,d){var u,h,p,g,f,m,b=r&&r.__k||L,v=t.length;for(l=function(e,t,i,r,o){var n,s,a,l,c,d=i.length,u=d,h=0;for(e.__k=new Array(o),n=0;n<o;n++)null!=(s=t[n])&&"boolean"!=typeof s&&"function"!=typeof s?(l=n+h,(s=e.__k[n]="string"==typeof s||"number"==typeof s||"bigint"==typeof s||s.constructor==String?U(null,s,null,null,null):F(s)?U(B,{children:s},null,null,null):null==s.constructor&&s.__b>0?U(s.type,s.props,s.key,s.ref?s.ref:null,s.__v):s).__=e,s.__b=e.__b+1,a=null,-1!=(c=s.__i=Q(s,i,l,u))&&(u--,(a=i[c])&&(a.__u|=2)),null==a||null==a.__v?(-1==c&&(o>d?h--:o<d&&h++),"function"!=typeof s.type&&(s.__u|=4)):c!=l&&(c==l-1?h--:c==l+1?h++:(c>l?h--:h++,s.__u|=4))):e.__k[n]=null;if(u)for(n=0;n<d;n++)null!=(a=i[n])&&!(2&a.__u)&&(a.__e==r&&(r=V(a)),se(a,a));return r}(i,t,b,l,v),u=0;u<v;u++)null!=(p=i.__k[u])&&(h=-1==p.__i?z:b[p.__i]||z,p.__i=u,m=ie(e,p,h,o,n,s,a,l,c,d),g=p.__e,p.ref&&h.ref!=p.ref&&(h.ref&&ne(h.ref,null,p),d.push(p.ref,p.__c||g,p)),null==f&&null!=g&&(f=g),4&p.__u||h.__k===p.__k?l=K(p,l,e):"function"==typeof p.type&&void 0!==m?l=m:g&&(l=g.nextSibling),p.__u&=-7);return i.__e=f,l}function K(e,t,i){var r,o;if("function"==typeof e.type){for(r=e.__k,o=0;r&&o<r.length;o++)r[o]&&(r[o].__=e,t=K(r[o],t,i));return t}e.__e!=t&&(t&&e.type&&!i.contains(t)&&(t=V(e)),i.insertBefore(e.__e,t||null),t=e.__e);do{t=t&&t.nextSibling}while(null!=t&&8==t.nodeType);return t}function Y(e,t){return t=t||[],null==e||"boolean"==typeof e||(F(e)?e.some(function(e){Y(e,t)}):t.push(e)),t}function Q(e,t,i,r){var o,n,s=e.key,a=e.type,l=t[i];if(null===l&&null==e.key||l&&s==l.key&&a==l.type&&!(2&l.__u))return i;if(r>(null==l||2&l.__u?0:1))for(o=i-1,n=i+1;o>=0||n<t.length;){if(o>=0){if((l=t[o])&&!(2&l.__u)&&s==l.key&&a==l.type)return o;o--}if(n<t.length){if((l=t[n])&&!(2&l.__u)&&s==l.key&&a==l.type)return n;n++}}return-1}function J(e,t,i){"-"==t[0]?e.setProperty(t,null==i?"":i):e[t]=null==i?"":"number"!=typeof i||D.test(t)?i:i+"px"}function ee(e,t,i,r,o){var n,s;e:if("style"==t)if("string"==typeof i)e.style.cssText=i;else{if("string"==typeof r&&(e.style.cssText=r=""),r)for(t in r)i&&t in i||J(e.style,t,"");if(i)for(t in i)r&&i[t]==r[t]||J(e.style,t,i[t])}else if("o"==t[0]&&"n"==t[1])n=t!=(t=t.replace(T,"$1")),s=t.toLowerCase(),t=s in e||"onFocusOut"==t||"onFocusIn"==t?s.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+n]=i,i?r?i.u=r.u:(i.u=R,e.addEventListener(t,n?N:_,n)):e.removeEventListener(t,n?N:_,n);else{if("http://www.w3.org/2000/svg"==o)t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if("width"!=t&&"height"!=t&&"href"!=t&&"list"!=t&&"form"!=t&&"tabIndex"!=t&&"download"!=t&&"rowSpan"!=t&&"colSpan"!=t&&"role"!=t&&"popover"!=t&&t in e)try{e[t]=null==i?"":i;break e}catch(e){}"function"==typeof i||(null==i||!1===i&&"-"!=t[4]?e.removeAttribute(t):e.setAttribute(t,"popover"==t&&1==i?"":i))}}function te(e){return function(t){if(this.l){var i=this.l[t.type+e];if(null==t.t)t.t=R++;else if(t.t<i.u)return;return i(I.event?I.event(t):t)}}}function ie(e,t,i,r,o,n,s,a,l,c){var d,u,h,p,g,f,m,b,v,y,w,S,C,A,E,k,P,M=t.type;if(null!=t.constructor)return null;128&i.__u&&(l=!!(32&i.__u),n=[a=t.__e=i.__e]),(d=I.__b)&&d(t);e:if("function"==typeof M)try{if(b=t.props,v="prototype"in M&&M.prototype.render,y=(d=M.contextType)&&r[d.__c],w=d?y?y.props.value:d.__:r,i.__c?m=(u=t.__c=i.__c).__=u.__E:(v?t.__c=u=new M(b,w):(t.__c=u=new G(b,w),u.constructor=M,u.render=ae),y&&y.sub(u),u.props=b,u.state||(u.state={}),u.context=w,u.__n=r,h=u.__d=!0,u.__h=[],u._sb=[]),v&&null==u.__s&&(u.__s=u.state),v&&null!=M.getDerivedStateFromProps&&(u.__s==u.state&&(u.__s=H({},u.__s)),H(u.__s,M.getDerivedStateFromProps(b,u.__s))),p=u.props,g=u.state,u.__v=t,h)v&&null==M.getDerivedStateFromProps&&null!=u.componentWillMount&&u.componentWillMount(),v&&null!=u.componentDidMount&&u.__h.push(u.componentDidMount);else{if(v&&null==M.getDerivedStateFromProps&&b!==p&&null!=u.componentWillReceiveProps&&u.componentWillReceiveProps(b,w),!u.__e&&null!=u.shouldComponentUpdate&&!1===u.shouldComponentUpdate(b,u.__s,w)||t.__v==i.__v){for(t.__v!=i.__v&&(u.props=b,u.state=u.__s,u.__d=!1),t.__e=i.__e,t.__k=i.__k,t.__k.some(function(e){e&&(e.__=t)}),S=0;S<u._sb.length;S++)u.__h.push(u._sb[S]);u._sb=[],u.__h.length&&s.push(u);break e}null!=u.componentWillUpdate&&u.componentWillUpdate(b,u.__s,w),v&&null!=u.componentDidUpdate&&u.__h.push(function(){u.componentDidUpdate(p,g,f)})}if(u.context=w,u.props=b,u.__P=e,u.__e=!1,C=I.__r,A=0,v){for(u.state=u.__s,u.__d=!1,C&&C(t),d=u.render(u.props,u.state,u.context),E=0;E<u._sb.length;E++)u.__h.push(u._sb[E]);u._sb=[]}else do{u.__d=!1,C&&C(t),d=u.render(u.props,u.state,u.context),u.state=u.__s}while(u.__d&&++A<25);u.state=u.__s,null!=u.getChildContext&&(r=H(H({},r),u.getChildContext())),v&&!h&&null!=u.getSnapshotBeforeUpdate&&(f=u.getSnapshotBeforeUpdate(p,g)),k=d,null!=d&&d.type===B&&null==d.key&&(k=oe(d.props.children)),a=X(e,F(k)?k:[k],t,i,r,o,n,s,a,l,c),u.base=t.__e,t.__u&=-161,u.__h.length&&s.push(u),m&&(u.__E=u.__=null)}catch(e){if(t.__v=null,l||null!=n)if(e.then){for(t.__u|=l?160:128;a&&8==a.nodeType&&a.nextSibling;)a=a.nextSibling;n[n.indexOf(a)]=null,t.__e=a}else for(P=n.length;P--;)$(n[P]);else t.__e=i.__e,t.__k=i.__k;I.__e(e,t,i)}else null==n&&t.__v==i.__v?(t.__k=i.__k,t.__e=i.__e):a=t.__e=function(e,t,i,r,o,n,s,a,l){var c,d,u,h,p,g,f,m=i.props,b=t.props,v=t.type;if("svg"==v?o="http://www.w3.org/2000/svg":"math"==v?o="http://www.w3.org/1998/Math/MathML":o||(o="http://www.w3.org/1999/xhtml"),null!=n)for(c=0;c<n.length;c++)if((p=n[c])&&"setAttribute"in p==!!v&&(v?p.localName==v:3==p.nodeType)){e=p,n[c]=null;break}if(null==e){if(null==v)return document.createTextNode(b);e=document.createElementNS(o,v,b.is&&b),a&&(I.__m&&I.__m(t,n),a=!1),n=null}if(null==v)m===b||a&&e.data==b||(e.data=b);else{if(n=n&&x.call(e.childNodes),m=i.props||z,!a&&null!=n)for(m={},c=0;c<e.attributes.length;c++)m[(p=e.attributes[c]).name]=p.value;for(c in m)if(p=m[c],"children"==c);else if("dangerouslySetInnerHTML"==c)u=p;else if(!(c in b)){if("value"==c&&"defaultValue"in b||"checked"==c&&"defaultChecked"in b)continue;ee(e,c,null,p,o)}for(c in b)p=b[c],"children"==c?h=p:"dangerouslySetInnerHTML"==c?d=p:"value"==c?g=p:"checked"==c?f=p:a&&"function"!=typeof p||m[c]===p||ee(e,c,p,m[c],o);if(d)a||u&&(d.__html==u.__html||d.__html==e.innerHTML)||(e.innerHTML=d.__html),t.__k=[];else if(u&&(e.innerHTML=""),X("template"==t.type?e.content:e,F(h)?h:[h],t,i,r,"foreignObject"==v?"http://www.w3.org/1999/xhtml":o,n,s,n?n[0]:i.__k&&V(i,0),a,l),null!=n)for(c=n.length;c--;)$(n[c]);a||(c="value","progress"==v&&null==g?e.removeAttribute("value"):null!=g&&(g!==e[c]||"progress"==v&&!g||"option"==v&&g!=m[c])&&ee(e,c,g,m[c],o),c="checked",null!=f&&f!=e[c]&&ee(e,c,f,m[c],o))}return e}(i.__e,t,i,r,o,n,s,l,c);return(d=I.diffed)&&d(t),128&t.__u?void 0:a}function re(e,t,i){for(var r=0;r<i.length;r++)ne(i[r],i[++r],i[++r]);I.__c&&I.__c(t,e),e.some(function(t){try{e=t.__h,t.__h=[],e.some(function(e){e.call(t)})}catch(e){I.__e(e,t.__v)}})}function oe(e){return"object"!=typeof e||null==e||e.__b&&e.__b>0?e:F(e)?e.map(oe):H({},e)}function ne(e,t,i){try{if("function"==typeof e){var r="function"==typeof e.__u;r&&e.__u(),r&&null==t||(e.__u=e(t))}else e.current=t}catch(e){I.__e(e,i)}}function se(e,t,i){var r,o;if(I.unmount&&I.unmount(e),(r=e.ref)&&(r.current&&r.current!=e.__e||ne(r,null,t)),null!=(r=e.__c)){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(e){I.__e(e,t)}r.base=r.__P=null}if(r=e.__k)for(o=0;o<r.length;o++)r[o]&&se(r[o],t,i||"function"!=typeof e.type);i||$(e.__e),e.__c=e.__=e.__e=void 0}function ae(e,t,i){return this.constructor(e,i)}function le(e,t,i){var r,o,n,s;t==document&&(t=document.documentElement),I.__&&I.__(e,t),o=(r="function"==typeof i)?null:i&&i.__k||t.__k,n=[],s=[],ie(t,e=(!r&&i||t).__k=j(B,null,[e]),o||z,z,t.namespaceURI,!r&&i?[i]:o?null:t.firstChild?x.call(t.childNodes):null,n,!r&&i?i:o?o.__e:t.firstChild,r,s),re(n,e,s)}function ce(e){function t(e){var i,r;return this.getChildContext||(i=new Set,(r={})[t.__c]=this,this.getChildContext=function(){return r},this.componentWillUnmount=function(){i=null},this.shouldComponentUpdate=function(e){this.props.value!=e.value&&i.forEach(function(e){e.__e=!0,Z(e)})},this.sub=function(e){i.add(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){i&&i.delete(e),t&&t.call(e)}}),e.children}return t.__c="__cC"+O++,t.__=e,t.Provider=t.__l=(t.Consumer=function(e,t){return e.children(t)}).contextType=t,t}x=L.slice,I={__e:function(e,t,i,r){for(var o,n,s;t=t.__;)if((o=t.__c)&&!o.__)try{if((n=o.constructor)&&null!=n.getDerivedStateFromError&&(o.setState(n.getDerivedStateFromError(e)),s=o.__d),null!=o.componentDidCatch&&(o.componentDidCatch(e,r||{}),s=o.__d),s)return o.__E=o}catch(t){e=t}throw e}},A=0,G.prototype.setState=function(e,t){var i;i=null!=this.__s&&this.__s!=this.state?this.__s:this.__s=H({},this.state),"function"==typeof e&&(e=e(H({},i),this.props)),e&&H(i,e),null!=e&&this.__v&&(t&&this._sb.push(t),Z(this))},G.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),Z(this))},G.prototype.render=B,E=[],P="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,M=function(e,t){return e.__v.__b-t.__v.__b},q.__r=0,T=/(PointerCapture)$|Capture$/i,R=0,_=te(!1),N=te(!0),O=0;var de='/*! tailwindcss v4.1.11 | MIT License | https://tailwindcss.com */@layer theme, base, components, utilities;@layer theme{:host,:root{--font-sans:ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--font-mono:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;--color-red-500:oklch(63.7% 0.237 25.331);--color-blue-50:oklch(97% 0.014 254.604);--color-blue-200:oklch(88.2% 0.059 254.128);--color-blue-500:oklch(62.3% 0.214 259.815);--color-blue-600:oklch(54.6% 0.245 262.881);--color-blue-700:oklch(48.8% 0.243 264.376);--color-blue-900:oklch(37.9% 0.146 265.522);--color-gray-50:oklch(98.5% 0.002 247.839);--color-gray-100:oklch(96.7% 0.003 264.542);--color-gray-200:oklch(92.8% 0.006 264.531);--color-gray-300:oklch(87.2% 0.01 258.338);--color-gray-400:oklch(70.7% 0.022 261.325);--color-gray-500:oklch(55.1% 0.027 264.364);--color-gray-600:oklch(44.6% 0.03 256.802);--color-gray-700:oklch(37.3% 0.034 259.733);--color-gray-800:oklch(27.8% 0.033 256.848);--color-gray-900:oklch(21% 0.034 264.665);--color-black:#000;--color-white:#fff;--spacing:0.25rem;--text-xs:0.75rem;--text-xs--line-height:1.33333;--text-sm:0.875rem;--text-sm--line-height:1.42857;--text-base:1rem;--text-base--line-height:1.5;--text-lg:1.125rem;--text-lg--line-height:1.55556;--font-weight-medium:500;--font-weight-semibold:600;--font-weight-bold:700;--leading-tight:1.25;--radius-md:0.375rem;--radius-lg:0.5rem;--ease-in-out:cubic-bezier(0.4,0,0.2,1);--animate-spin:spin 1s linear infinite;--animate-pulse:pulse 2s cubic-bezier(0.4,0,0.6,1) infinite;--default-transition-duration:150ms;--default-transition-timing-function:cubic-bezier(0.4,0,0.2,1);--default-font-family:var(--font-sans);--default-mono-font-family:var(--font-mono)}}@layer base{*,::backdrop,::file-selector-button,:after,:before{border:0 solid;box-sizing:border-box;margin:0;padding:0}:host,html{-webkit-text-size-adjust:100%;font-feature-settings:var(--default-font-feature-settings,normal);-webkit-tap-highlight-color:transparent;font-family:var(--default-font-family,ui-sans-serif,system-ui,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji");font-variation-settings:var(--default-font-variation-settings,normal);line-height:1.5;-moz-tab-size:4;-o-tab-size:4;tab-size:4}hr{border-top-width:1px;color:inherit;height:0}abbr:where([title]){-webkit-text-decoration:underline dotted;text-decoration:underline dotted}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit}a{color:inherit;-webkit-text-decoration:inherit;text-decoration:inherit}b,strong{font-weight:bolder}code,kbd,pre,samp{font-feature-settings:var(--default-mono-font-feature-settings,normal);font-family:var(--default-mono-font-family,ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace);font-size:1em;font-variation-settings:var(--default-mono-font-variation-settings,normal)}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}table{border-collapse:collapse;border-color:inherit;text-indent:0}:-moz-focusring{outline:auto}progress{vertical-align:baseline}summary{display:list-item}menu,ol,ul{list-style:none}audio,canvas,embed,iframe,img,object,svg,video{display:block;vertical-align:middle}img,video{height:auto;max-width:100%}::file-selector-button,button,input,optgroup,select,textarea{font-feature-settings:inherit;background-color:transparent;border-radius:0;color:inherit;font:inherit;font-variation-settings:inherit;letter-spacing:inherit;opacity:1}:where(select:is([multiple],[size])) optgroup{font-weight:bolder}:where(select:is([multiple],[size])) optgroup option{padding-inline-start:20px}::file-selector-button{margin-inline-end:4px}::-moz-placeholder{opacity:1}::placeholder{opacity:1}@supports (not (-webkit-appearance:-apple-pay-button)) or (contain-intrinsic-size:1px){::-moz-placeholder{color:currentcolor;@supports (color:color-mix(in lab,red,red)){color:color-mix(in oklab,currentcolor 50%,transparent)}}::placeholder{color:currentcolor;@supports (color:color-mix(in lab,red,red)){color:color-mix(in oklab,currentcolor 50%,transparent)}}}textarea{resize:vertical}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-date-and-time-value{min-height:1lh;text-align:inherit}::-webkit-datetime-edit{display:inline-flex}::-webkit-datetime-edit-fields-wrapper{padding:0}::-webkit-datetime-edit,::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-meridiem-field,::-webkit-datetime-edit-millisecond-field,::-webkit-datetime-edit-minute-field,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-second-field,::-webkit-datetime-edit-year-field{padding-block:0}:-moz-ui-invalid{box-shadow:none}::file-selector-button,button,input:where([type=button],[type=reset],[type=submit]){-webkit-appearance:button;-moz-appearance:button;appearance:button}::-webkit-inner-spin-button,::-webkit-outer-spin-button{height:auto}[hidden]:where(:not([hidden=until-found])){display:none!important}}@layer utilities{.\\@container{container-type:inline-size}.pointer-events-none{pointer-events:none}.visible{visibility:visible}.absolute{position:absolute}.fixed{position:fixed}.relative{position:relative}.static{position:static}.inset-0{inset:calc(var(--spacing)*0)}.inset-y-0{inset-block:calc(var(--spacing)*0)}.top-0{top:calc(var(--spacing)*0)}.right-0{right:calc(var(--spacing)*0)}.right-3{right:calc(var(--spacing)*3)}.bottom-0{bottom:calc(var(--spacing)*0)}.bottom-4{bottom:calc(var(--spacing)*4)}.left-0{left:calc(var(--spacing)*0)}.left-1\\/2{left:50%}.z-10{z-index:10}.z-50{z-index:50}.z-100{z-index:100}.col-start-1{grid-column-start:1}.row-start-1{grid-row-start:1}.container{width:100%;@media (width >= 40rem){max-width:40rem}@media (width >= 48rem){max-width:48rem}@media (width >= 64rem){max-width:64rem}@media (width >= 80rem){max-width:80rem}@media (width >= 96rem){max-width:96rem}}.mx-4{margin-inline:calc(var(--spacing)*4)}.my-2{margin-block:calc(var(--spacing)*2)}.my-4{margin-block:calc(var(--spacing)*4)}.mt-0\\.5{margin-top:calc(var(--spacing)*.5)}.mt-1{margin-top:calc(var(--spacing)*1)}.mt-2{margin-top:calc(var(--spacing)*2)}.mt-3{margin-top:calc(var(--spacing)*3)}.mt-5{margin-top:calc(var(--spacing)*5)}.mr-1{margin-right:calc(var(--spacing)*1)}.mr-2{margin-right:calc(var(--spacing)*2)}.mr-5{margin-right:calc(var(--spacing)*5)}.mb-1{margin-bottom:calc(var(--spacing)*1)}.mb-2{margin-bottom:calc(var(--spacing)*2)}.mb-3{margin-bottom:calc(var(--spacing)*3)}.mb-4{margin-bottom:calc(var(--spacing)*4)}.mb-6{margin-bottom:calc(var(--spacing)*6)}.block{display:block}.flex{display:flex}.hidden{display:none}.inline-flex{display:inline-flex}.h-1{height:calc(var(--spacing)*1)}.h-1\\/2{height:50%}.h-2{height:calc(var(--spacing)*2)}.h-3{height:calc(var(--spacing)*3)}.h-3\\.5{height:calc(var(--spacing)*3.5)}.h-4{height:calc(var(--spacing)*4)}.h-5{height:calc(var(--spacing)*5)}.h-6{height:calc(var(--spacing)*6)}.h-7{height:calc(var(--spacing)*7)}.h-8{height:calc(var(--spacing)*8)}.h-12{height:calc(var(--spacing)*12)}.h-18{height:calc(var(--spacing)*18)}.h-\\[1px\\]{height:1px}.h-\\[32px\\]{height:32px}.h-full{height:100%}.min-h-0{min-height:calc(var(--spacing)*0)}.\\!w-full{width:100%!important}.w-2{width:calc(var(--spacing)*2)}.w-3{width:calc(var(--spacing)*3)}.w-3\\.5{width:calc(var(--spacing)*3.5)}.w-4{width:calc(var(--spacing)*4)}.w-5{width:calc(var(--spacing)*5)}.w-6{width:calc(var(--spacing)*6)}.w-8{width:calc(var(--spacing)*8)}.w-12{width:calc(var(--spacing)*12)}.w-18{width:calc(var(--spacing)*18)}.w-\\[1px\\]{width:1px}.w-auto{width:auto}.w-full{width:100%}.max-w-\\[150px\\]{max-width:150px}.min-w-0{min-width:calc(var(--spacing)*0)}.min-w-\\[8rem\\]{min-width:8rem}.min-w-\\[32px\\]{min-width:32px}.flex-1{flex:1}.flex-none{flex:none}.flex-shrink-0,.shrink-0{flex-shrink:0}.-translate-x-1\\/2{--tw-translate-x:-50%}.-translate-x-1\\/2,.translate-x-\\[1px\\]{translate:var(--tw-translate-x) var(--tw-translate-y)}.translate-x-\\[1px\\]{--tw-translate-x:1px}.translate-y-\\[1px\\]{--tw-translate-y:1px;translate:var(--tw-translate-x) var(--tw-translate-y)}.rotate-45{rotate:45deg}.transform{transform:var(--tw-rotate-x,) var(--tw-rotate-y,) var(--tw-rotate-z,) var(--tw-skew-x,) var(--tw-skew-y,)}.animate-pulse{animation:var(--animate-pulse)}.animate-spin{animation:var(--animate-spin)}.cursor-grab{cursor:grab}.cursor-not-allowed{cursor:not-allowed}.cursor-pointer{cursor:pointer}.touch-pan-y{--tw-pan-y:pan-y;touch-action:var(--tw-pan-x,) var(--tw-pan-y,) var(--tw-pinch-zoom,)}.appearance-none{-webkit-appearance:none;-moz-appearance:none;appearance:none}.flex-col{flex-direction:column}.flex-row{flex-direction:row}.items-center{align-items:center}.items-start{align-items:flex-start}.justify-between{justify-content:space-between}.justify-center{justify-content:center}.justify-end{justify-content:flex-end}.gap-1{gap:calc(var(--spacing)*1)}.gap-2{gap:calc(var(--spacing)*2)}.gap-3{gap:calc(var(--spacing)*3)}.gap-4{gap:calc(var(--spacing)*4)}.space-y-2{:where(&>:not(:last-child)){--tw-space-y-reverse:0;margin-block-end:calc(var(--spacing)*2*(1 - var(--tw-space-y-reverse)));margin-block-start:calc(var(--spacing)*2*var(--tw-space-y-reverse))}}.space-y-6{:where(&>:not(:last-child)){--tw-space-y-reverse:0;margin-block-end:calc(var(--spacing)*6*(1 - var(--tw-space-y-reverse)));margin-block-start:calc(var(--spacing)*6*var(--tw-space-y-reverse))}}.space-x-3{:where(&>:not(:last-child)){--tw-space-x-reverse:0;margin-inline-end:calc(var(--spacing)*3*(1 - var(--tw-space-x-reverse)));margin-inline-start:calc(var(--spacing)*3*var(--tw-space-x-reverse))}}.divide-y{:where(&>:not(:last-child)){--tw-divide-y-reverse:0;border-bottom-style:var(--tw-border-style);border-bottom-width:calc(1px*(1 - var(--tw-divide-y-reverse)));border-top-style:var(--tw-border-style);border-top-width:calc(1px*var(--tw-divide-y-reverse))}}.divide-gray-100{:where(&>:not(:last-child)){border-color:var(--color-gray-100)}}.self-center{align-self:center}.truncate{text-overflow:ellipsis;white-space:nowrap}.overflow-hidden,.truncate{overflow:hidden}.overflow-y-auto{overflow-y:auto}.rounded{border-radius:.25rem}.rounded-\\[3px\\]{border-radius:3px}.rounded-full{border-radius:calc(infinity * 1px)}.rounded-lg{border-radius:var(--radius-lg)}.rounded-md{border-radius:var(--radius-md)}.rounded-none{border-radius:0}.rounded-l-md{border-bottom-left-radius:var(--radius-md);border-top-left-radius:var(--radius-md)}.rounded-r-md{border-bottom-right-radius:var(--radius-md);border-top-right-radius:var(--radius-md)}.border{border-style:var(--tw-border-style);border-width:1px}.border-0{border-style:var(--tw-border-style);border-width:0}.border-1{border-style:var(--tw-border-style);border-width:1px}.border-2{border-style:var(--tw-border-style);border-width:2px}.border-3{border-style:var(--tw-border-style);border-width:3px}.border-4{border-style:var(--tw-border-style);border-width:4px}.border-t{border-top-style:var(--tw-border-style);border-top-width:1px}.border-r-0{border-right-style:var(--tw-border-style);border-right-width:0}.border-b{border-bottom-style:var(--tw-border-style);border-bottom-width:1px}.border-b-2{border-bottom-style:var(--tw-border-style);border-bottom-width:2px}.border-none{--tw-border-style:none;border-style:none}.border-\\[\\#cfd4da\\]{border-color:#cfd4da}.border-blue-200{border-color:var(--color-blue-200)}.border-blue-500{border-color:var(--color-blue-500)}.border-blue-600{border-color:var(--color-blue-600)}.border-gray-200{border-color:var(--color-gray-200)}.border-gray-300{border-color:var(--color-gray-300)}.border-gray-400{border-color:var(--color-gray-400)}.border-gray-600{border-color:var(--color-gray-600)}.border-red-500{border-color:var(--color-red-500)}.border-transparent{border-color:transparent}.border-t-blue-500{border-top-color:var(--color-blue-500)}.border-r-blue-500{border-right-color:var(--color-blue-500)}.border-b-blue-500{border-bottom-color:var(--color-blue-500)}.border-b-transparent{border-bottom-color:transparent}.bg-\\[\\#f1f3f5\\]{background-color:#f1f3f5}.bg-\\[\\#f8f9fa\\]{background-color:#f8f9fa}.bg-black\\/50{background-color:color-mix(in srgb,#000 50%,transparent);@supports (color:color-mix(in lab,red,red)){background-color:color-mix(in oklab,var(--color-black) 50%,transparent)}}.bg-blue-50{background-color:var(--color-blue-50)}.bg-blue-200{background-color:var(--color-blue-200)}.bg-blue-500{background-color:var(--color-blue-500)}.bg-blue-600{background-color:var(--color-blue-600)}.bg-gray-100{background-color:var(--color-gray-100)}.bg-gray-200{background-color:var(--color-gray-200)}.bg-gray-300{background-color:var(--color-gray-300)}.bg-gray-900{background-color:var(--color-gray-900)}.bg-inherit{background-color:inherit}.bg-transparent{background-color:transparent}.bg-white{background-color:var(--color-white)}.bg-white\\/80{background-color:color-mix(in srgb,#fff 80%,transparent);@supports (color:color-mix(in lab,red,red)){background-color:color-mix(in oklab,var(--color-white) 80%,transparent)}}.object-contain{-o-object-fit:contain;object-fit:contain}.p-0{padding:calc(var(--spacing)*0)}.p-1{padding:calc(var(--spacing)*1)}.p-3{padding:calc(var(--spacing)*3)}.p-4{padding:calc(var(--spacing)*4)}.p-6{padding:calc(var(--spacing)*6)}.p-\\[5px\\]{padding:5px}.px-2{padding-inline:calc(var(--spacing)*2)}.px-3{padding-inline:calc(var(--spacing)*3)}.px-4{padding-inline:calc(var(--spacing)*4)}.px-6{padding-inline:calc(var(--spacing)*6)}.py-1{padding-block:calc(var(--spacing)*1)}.py-1\\.5{padding-block:calc(var(--spacing)*1.5)}.py-2{padding-block:calc(var(--spacing)*2)}.py-3{padding-block:calc(var(--spacing)*3)}.py-4{padding-block:calc(var(--spacing)*4)}.pt-4{padding-top:calc(var(--spacing)*4)}.pr-2{padding-right:calc(var(--spacing)*2)}.pr-3{padding-right:calc(var(--spacing)*3)}.pr-4{padding-right:calc(var(--spacing)*4)}.pr-8{padding-right:calc(var(--spacing)*8)}.pr-9{padding-right:calc(var(--spacing)*9)}.pb-2{padding-bottom:calc(var(--spacing)*2)}.pl-2{padding-left:calc(var(--spacing)*2)}.pl-3{padding-left:calc(var(--spacing)*3)}.pl-8{padding-left:calc(var(--spacing)*8)}.text-center{text-align:center}.text-left{text-align:left}.text-right{text-align:right}.text-base{font-size:var(--text-base);line-height:var(--tw-leading,var(--text-base--line-height))}.text-lg{font-size:var(--text-lg);line-height:var(--tw-leading,var(--text-lg--line-height))}.text-sm{font-size:var(--text-sm);line-height:var(--tw-leading,var(--text-sm--line-height))}.text-xs{font-size:var(--text-xs);line-height:var(--tw-leading,var(--text-xs--line-height))}.text-\\[13px\\]{font-size:13px}.leading-tight{--tw-leading:var(--leading-tight);line-height:var(--leading-tight)}.font-bold{--tw-font-weight:var(--font-weight-bold);font-weight:var(--font-weight-bold)}.font-medium{--tw-font-weight:var(--font-weight-medium);font-weight:var(--font-weight-medium)}.font-semibold{--tw-font-weight:var(--font-weight-semibold);font-weight:var(--font-weight-semibold)}.whitespace-nowrap{white-space:nowrap}.text-blue-500{color:var(--color-blue-500)}.text-blue-700{color:var(--color-blue-700)}.text-blue-900{color:var(--color-blue-900)}.text-gray-400{color:var(--color-gray-400)}.text-gray-500{color:var(--color-gray-500)}.text-gray-600{color:var(--color-gray-600)}.text-gray-700{color:var(--color-gray-700)}.text-gray-900{color:var(--color-gray-900)}.text-red-500{color:var(--color-red-500)}.text-white{color:var(--color-white)}.uppercase{text-transform:uppercase}.underline{text-decoration-line:underline}.opacity-0{opacity:0}.opacity-50{opacity:50%}.opacity-100{opacity:100%}.shadow{--tw-shadow:0 1px 3px 0 var(--tw-shadow-color,rgba(0,0,0,.1)),0 1px 2px -1px var(--tw-shadow-color,rgba(0,0,0,.1))}.shadow,.shadow-md{box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}.shadow-md{--tw-shadow:0 4px 6px -1px var(--tw-shadow-color,rgba(0,0,0,.1)),0 2px 4px -2px var(--tw-shadow-color,rgba(0,0,0,.1))}.shadow-sm{--tw-shadow:0 1px 3px 0 var(--tw-shadow-color,rgba(0,0,0,.1)),0 1px 2px -1px var(--tw-shadow-color,rgba(0,0,0,.1))}.shadow-sm,.shadow-xs{box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}.shadow-xs{--tw-shadow:0 1px 2px 0 var(--tw-shadow-color,rgba(0,0,0,.05))}.ring{--tw-ring-shadow:var(--tw-ring-inset,) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color,currentcolor);box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}.ring-blue-500{--tw-ring-color:var(--color-blue-500)}.outline,.outline-1{outline-width:1px}.outline,.outline-1,.outline-2{outline-style:var(--tw-outline-style)}.outline-2{outline-width:2px}.-outline-offset-1{outline-offset:-1px}.-outline-offset-2{outline-offset:-2px}.outline-offset-2{outline-offset:2px}.outline-blue-500{outline-color:var(--color-blue-500)}.outline-gray-300{outline-color:var(--color-gray-300)}.filter{filter:var(--tw-blur,) var(--tw-brightness,) var(--tw-contrast,) var(--tw-grayscale,) var(--tw-hue-rotate,) var(--tw-invert,) var(--tw-saturate,) var(--tw-sepia,) var(--tw-drop-shadow,)}.backdrop-blur{--tw-backdrop-blur:blur(8px);-webkit-backdrop-filter:var(--tw-backdrop-blur,) var(--tw-backdrop-brightness,) var(--tw-backdrop-contrast,) var(--tw-backdrop-grayscale,) var(--tw-backdrop-hue-rotate,) var(--tw-backdrop-invert,) var(--tw-backdrop-opacity,) var(--tw-backdrop-saturate,) var(--tw-backdrop-sepia,);backdrop-filter:var(--tw-backdrop-blur,) var(--tw-backdrop-brightness,) var(--tw-backdrop-contrast,) var(--tw-backdrop-grayscale,) var(--tw-backdrop-hue-rotate,) var(--tw-backdrop-invert,) var(--tw-backdrop-opacity,) var(--tw-backdrop-saturate,) var(--tw-backdrop-sepia,)}.transition-all{transition-duration:var(--tw-duration,var(--default-transition-duration));transition-property:all;transition-timing-function:var(--tw-ease,var(--default-transition-timing-function))}.transition-colors{transition-duration:var(--tw-duration,var(--default-transition-duration));transition-property:color,background-color,border-color,outline-color,text-decoration-color,fill,stroke,--tw-gradient-from,--tw-gradient-via,--tw-gradient-to;transition-timing-function:var(--tw-ease,var(--default-transition-timing-function))}.transition-opacity{transition-duration:var(--tw-duration,var(--default-transition-duration));transition-property:opacity;transition-timing-function:var(--tw-ease,var(--default-transition-timing-function))}.duration-150{--tw-duration:150ms;transition-duration:.15s}.duration-200{--tw-duration:200ms;transition-duration:.2s}.duration-300{--tw-duration:300ms;transition-duration:.3s}.ease-in-out{--tw-ease:var(--ease-in-out);transition-timing-function:var(--ease-in-out)}.outline-none{--tw-outline-style:none;outline-style:none}.select-none{-webkit-user-select:none;-moz-user-select:none;user-select:none}.peer-checked\\:opacity-100{&:is(:where(.peer):checked~*){opacity:100%}}.first\\:mt-0{&:first-child{margin-top:calc(var(--spacing)*0)}}.checked\\:border-blue-600{&:checked{border-color:var(--color-blue-600)}}.checked\\:bg-blue-600{&:checked{background-color:var(--color-blue-600)}}.hover\\:border-\\[\\#1a466b\\]{&:hover{@media (hover:hover){border-bottom-color:#1a466b;border-left-color:#1a466b;border-right-color:#1a466b;border-top-color:#1a466b}}}.hover\\:border-b-gray-500{&:hover{@media (hover:hover){border-bottom-color:var(--color-gray-500)}}}.hover\\:\\!bg-blue-700{&:hover{@media (hover:hover){background-color:var(--color-blue-700)!important}}}.hover\\:bg-blue-900{&:hover{@media (hover:hover){background-color:var(--color-blue-900)}}}.hover\\:bg-gray-50{&:hover{@media (hover:hover){background-color:var(--color-gray-50)}}}.hover\\:bg-gray-100{&:hover{@media (hover:hover){background-color:var(--color-gray-100)}}}.hover\\:bg-gray-200{&:hover{@media (hover:hover){background-color:var(--color-gray-200)}}}.hover\\:bg-transparent{&:hover{@media (hover:hover){background-color:transparent}}}.hover\\:text-gray-700{&:hover{@media (hover:hover){color:var(--color-gray-700)}}}.hover\\:text-white{&:hover{@media (hover:hover){color:var(--color-white)}}}.hover\\:ring{&:hover{@media (hover:hover){--tw-ring-shadow:var(--tw-ring-inset,) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color,currentcolor);box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}}}.hover\\:ring-0{&:hover{@media (hover:hover){--tw-ring-shadow:var(--tw-ring-inset,) 0 0 0 calc(var(--tw-ring-offset-width)) var(--tw-ring-color,currentcolor);box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}}}.hover\\:ring-\\[\\#1a466b\\]{&:hover{@media (hover:hover){--tw-ring-color:#1a466b}}}.hover\\:ring-transparent{&:hover{@media (hover:hover){--tw-ring-color:transparent}}}.focus\\:border-blue-500{&:focus{border-color:var(--color-blue-500)}}.focus\\:border-red-500{&:focus{border-color:var(--color-red-500)}}.focus\\:ring-1{&:focus{--tw-ring-shadow:var(--tw-ring-inset,) 0 0 0 calc(1px + var(--tw-ring-offset-width)) var(--tw-ring-color,currentcolor);box-shadow:var(--tw-inset-shadow),var(--tw-inset-ring-shadow),var(--tw-ring-offset-shadow),var(--tw-ring-shadow),var(--tw-shadow)}}.focus\\:ring-blue-500{&:focus{--tw-ring-color:var(--color-blue-500)}}.focus\\:ring-red-500{&:focus{--tw-ring-color:var(--color-red-500)}}.focus\\:outline-none{&:focus{--tw-outline-style:none;outline-style:none}}.active\\:cursor-grabbing{&:active{cursor:grabbing}}.disabled\\:cursor-not-allowed{&:disabled{cursor:not-allowed}}.disabled\\:opacity-50{&:disabled{opacity:50%}}.\\@max-\\[600px\\]\\:\\!bottom-0,.\\@max-\\[600px\\]\\:\\!left-0,.\\@max-\\[600px\\]\\:\\!right-0,.\\@max-\\[600px\\]\\:\\!top-auto,.\\@min-\\[400px\\]\\:block,.\\@min-\\[400px\\]\\:flex,.\\@min-\\[400px\\]\\:hidden,.\\@min-\\[500px\\]\\:block,.\\@min-\\[500px\\]\\:hidden,.\\@min-\\[600px\\]\\:block,.\\@min-\\[600px\\]\\:flex,.\\@min-\\[600px\\]\\:hidden,.dark\\:bg-gray-700,.dark\\:bg-gray-800,.dark\\:border-gray-600,.dark\\:text-gray-100,.dark\\:text-white,.md\\:border,.md\\:border-gray-200,.md\\:border-l,.md\\:border-r,.md\\:border-t-0,.md\\:flex,.md\\:flex-none,.md\\:flex-row,.md\\:h-auto,.md\\:h-full,.md\\:hidden,.md\\:items-center,.md\\:justify-center,.md\\:max-h-\\[80vh\\],.md\\:max-w-\\[90vw\\],.md\\:min-w-\\[275px\\],.md\\:rounded-lg,.md\\:shadow-lg,.md\\:static,.md\\:w-\\[275px\\],.md\\:w-\\[28rem\\]{@media (prefers-color-scheme:dark){color:var(--color-white)}}}@import url("https://fonts.googleapis.com/css2?family=Open Sans:wght@400;600&amp;display=swap");:host{--tw-translate-x:0;--tw-translate-y:0;--tw-translate-z:0;--tw-rotate-x:rotateX(0);--tw-rotate-y:rotateY(0);--tw-rotate-z:rotateZ(0);--tw-skew-x:skewX(0);--tw-skew-y:skewY(0);--tw-border-style:solid;--tw-gradient-from:#0000;--tw-gradient-via:#0000;--tw-gradient-to:#0000;--tw-gradient-from-position:0%;--tw-gradient-via-position:50%;--tw-gradient-to-position:100%;--tw-shadow:0 0 #0000;--tw-inset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-inset-ring-shadow:0 0 #0000;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-offset-shadow:0 0 #0000;--tw-outline-style:solid;display:flex;flex-direction:column;height:100%;overflow:hidden;width:100%}@property --tw-translate-x{syntax:"*";inherits:false;initial-value:0}@property --tw-translate-y{syntax:"*";inherits:false;initial-value:0}@property --tw-translate-z{syntax:"*";inherits:false;initial-value:0}@property --tw-rotate-x{syntax:"*";inherits:false}@property --tw-rotate-y{syntax:"*";inherits:false}@property --tw-rotate-z{syntax:"*";inherits:false}@property --tw-skew-x{syntax:"*";inherits:false}@property --tw-skew-y{syntax:"*";inherits:false}@property --tw-pan-x{syntax:"*";inherits:false}@property --tw-pan-y{syntax:"*";inherits:false}@property --tw-pinch-zoom{syntax:"*";inherits:false}@property --tw-space-y-reverse{syntax:"*";inherits:false;initial-value:0}@property --tw-space-x-reverse{syntax:"*";inherits:false;initial-value:0}@property --tw-divide-y-reverse{syntax:"*";inherits:false;initial-value:0}@property --tw-border-style{syntax:"*";inherits:false;initial-value:solid}@property --tw-leading{syntax:"*";inherits:false}@property --tw-font-weight{syntax:"*";inherits:false}@property --tw-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-shadow-color{syntax:"*";inherits:false}@property --tw-shadow-alpha{syntax:"<percentage>";inherits:false;initial-value:100%}@property --tw-inset-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-inset-shadow-color{syntax:"*";inherits:false}@property --tw-inset-shadow-alpha{syntax:"<percentage>";inherits:false;initial-value:100%}@property --tw-ring-color{syntax:"*";inherits:false}@property --tw-ring-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-inset-ring-color{syntax:"*";inherits:false}@property --tw-inset-ring-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-ring-inset{syntax:"*";inherits:false}@property --tw-ring-offset-width{syntax:"<length>";inherits:false;initial-value:0}@property --tw-ring-offset-color{syntax:"*";inherits:false;initial-value:#fff}@property --tw-ring-offset-shadow{syntax:"*";inherits:false;initial-value:0 0 #0000}@property --tw-outline-style{syntax:"*";inherits:false;initial-value:solid}@property --tw-blur{syntax:"*";inherits:false}@property --tw-brightness{syntax:"*";inherits:false}@property --tw-contrast{syntax:"*";inherits:false}@property --tw-grayscale{syntax:"*";inherits:false}@property --tw-hue-rotate{syntax:"*";inherits:false}@property --tw-invert{syntax:"*";inherits:false}@property --tw-opacity{syntax:"*";inherits:false}@property --tw-saturate{syntax:"*";inherits:false}@property --tw-sepia{syntax:"*";inherits:false}@property --tw-drop-shadow{syntax:"*";inherits:false}@property --tw-drop-shadow-color{syntax:"*";inherits:false}@property --tw-drop-shadow-alpha{syntax:"<percentage>";inherits:false;initial-value:100%}@property --tw-drop-shadow-size{syntax:"*";inherits:false}@property --tw-backdrop-blur{syntax:"*";inherits:false}@property --tw-backdrop-brightness{syntax:"*";inherits:false}@property --tw-backdrop-contrast{syntax:"*";inherits:false}@property --tw-backdrop-grayscale{syntax:"*";inherits:false}@property --tw-backdrop-hue-rotate{syntax:"*";inherits:false}@property --tw-backdrop-invert{syntax:"*";inherits:false}@property --tw-backdrop-opacity{syntax:"*";inherits:false}@property --tw-backdrop-saturate{syntax:"*";inherits:false}@property --tw-backdrop-sepia{syntax:"*";inherits:false}@property --tw-duration{syntax:"*";inherits:false}@property --tw-ease{syntax:"*";inherits:false}@keyframes spin{to{transform:rotate(1turn)}}@keyframes pulse{50%{opacity:.5}}@layer properties{@supports ((-webkit-hyphens:none) and (not (margin-trim:inline))) or ((-moz-orient:inline) and (not (color:rgb(from red r g b)))){*,::backdrop,:after,:before{--tw-translate-x:0;--tw-translate-y:0;--tw-translate-z:0;--tw-rotate-x:initial;--tw-rotate-y:initial;--tw-rotate-z:initial;--tw-skew-x:initial;--tw-skew-y:initial;--tw-pan-x:initial;--tw-pan-y:initial;--tw-pinch-zoom:initial;--tw-space-y-reverse:0;--tw-space-x-reverse:0;--tw-divide-y-reverse:0;--tw-border-style:solid;--tw-leading:initial;--tw-font-weight:initial;--tw-shadow:0 0 #0000;--tw-shadow-color:initial;--tw-shadow-alpha:100%;--tw-inset-shadow:0 0 #0000;--tw-inset-shadow-color:initial;--tw-inset-shadow-alpha:100%;--tw-ring-color:initial;--tw-ring-shadow:0 0 #0000;--tw-inset-ring-color:initial;--tw-inset-ring-shadow:0 0 #0000;--tw-ring-inset:initial;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-offset-shadow:0 0 #0000;--tw-outline-style:solid;--tw-blur:initial;--tw-brightness:initial;--tw-contrast:initial;--tw-grayscale:initial;--tw-hue-rotate:initial;--tw-invert:initial;--tw-opacity:initial;--tw-saturate:initial;--tw-sepia:initial;--tw-drop-shadow:initial;--tw-drop-shadow-color:initial;--tw-drop-shadow-alpha:100%;--tw-drop-shadow-size:initial;--tw-backdrop-blur:initial;--tw-backdrop-brightness:initial;--tw-backdrop-contrast:initial;--tw-backdrop-grayscale:initial;--tw-backdrop-hue-rotate:initial;--tw-backdrop-invert:initial;--tw-backdrop-opacity:initial;--tw-backdrop-saturate:initial;--tw-backdrop-sepia:initial;--tw-duration:initial;--tw-ease:initial}}}';!function(e,t){void 0===t&&(t={});var i=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===i&&r.firstChild?r.insertBefore(o,r.firstChild):r.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}(de);var ue=0;function he(e,t,i,r,o,n){t||(t={});var s,a,l=t;if("ref"in l)for(a in l={},t)"ref"==a?s=t[a]:l[a]=t[a];var c={type:e,props:l,key:i,ref:s,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:--ue,__i:-1,__u:0,__source:o,__self:n};if("function"==typeof e&&(s=e.defaultProps))for(a in s)void 0===l[a]&&(l[a]=s[a]);return I.vnode&&I.vnode(c),c}var pe,ge,fe,me,be=0,ve=[],ye=I,we=ye.__b,Se=ye.__r,Ce=ye.diffed,xe=ye.__c,Ie=ye.unmount,Ae=ye.__;function Ee(e,t){ye.__h&&ye.__h(ge,e,be||t),be=0;var i=ge.__H||(ge.__H={__:[],__h:[]});return e>=i.__.length&&i.__.push({}),i.__[e]}function ke(e){return be=1,function(e,t,i){var r=Ee(pe++,2);if(r.t=e,!r.__c&&(r.__=[i?i(t):$e(void 0,t),function(e){var t=r.__N?r.__N[0]:r.__[0],i=r.t(t,e);t!==i&&(r.__N=[i,r.__[1]],r.__c.setState({}))}],r.__c=ge,!ge.__f)){var o=function(e,t,i){if(!r.__c.__H)return!0;var o=r.__c.__H.__.filter(function(e){return!!e.__c});if(o.every(function(e){return!e.__N}))return!n||n.call(this,e,t,i);var s=r.__c.props!==e;return o.forEach(function(e){if(e.__N){var t=e.__[0];e.__=e.__N,e.__N=void 0,t!==e.__[0]&&(s=!0)}}),n&&n.call(this,e,t,i)||s};ge.__f=!0;var n=ge.shouldComponentUpdate,s=ge.componentWillUpdate;ge.componentWillUpdate=function(e,t,i){if(this.__e){var r=n;n=void 0,o(e,t,i),n=r}s&&s.call(this,e,t,i)},ge.shouldComponentUpdate=o}return r.__N||r.__}($e,e)}function Pe(e,t){var i=Ee(pe++,3);!ye.__s&&He(i.__H,t)&&(i.__=e,i.u=t,ge.__H.__h.push(i))}function Me(e,t){var i=Ee(pe++,4);!ye.__s&&He(i.__H,t)&&(i.__=e,i.u=t,ge.__h.push(i))}function Te(e){return be=5,Re(function(){return{current:e}},[])}function Re(e,t){var i=Ee(pe++,7);return He(i.__H,t)&&(i.__=e(),i.__H=t,i.__h=e),i.__}function _e(e,t){return be=8,Re(function(){return e},t)}function Ne(e){var t=ge.context[e.__c],i=Ee(pe++,9);return i.c=e,t?(null==i.__&&(i.__=!0,t.sub(ge)),t.props.value):e.__}function Oe(){for(var e;e=ve.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(De),e.__H.__h.forEach(Fe),e.__H.__h=[]}catch(t){e.__H.__h=[],ye.__e(t,e.__v)}}ye.__b=function(e){ge=null,we&&we(e)},ye.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),Ae&&Ae(e,t)},ye.__r=function(e){Se&&Se(e),pe=0;var t=(ge=e.__c).__H;t&&(fe===ge?(t.__h=[],ge.__h=[],t.__.forEach(function(e){e.__N&&(e.__=e.__N),e.u=e.__N=void 0})):(t.__h.forEach(De),t.__h.forEach(Fe),t.__h=[],pe=0)),fe=ge},ye.diffed=function(e){Ce&&Ce(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(1!==ve.push(t)&&me===ye.requestAnimationFrame||((me=ye.requestAnimationFrame)||Le)(Oe)),t.__H.__.forEach(function(e){e.u&&(e.__H=e.u),e.u=void 0})),fe=ge=null},ye.__c=function(e,t){t.some(function(e){try{e.__h.forEach(De),e.__h=e.__h.filter(function(e){return!e.__||Fe(e)})}catch(i){t.some(function(e){e.__h&&(e.__h=[])}),t=[],ye.__e(i,e.__v)}}),xe&&xe(e,t)},ye.unmount=function(e){Ie&&Ie(e);var t,i=e.__c;i&&i.__H&&(i.__H.__.forEach(function(e){try{De(e)}catch(e){t=e}}),i.__H=void 0,t&&ye.__e(t,i.__v))};var ze="function"==typeof requestAnimationFrame;function Le(e){var t,i=function(){clearTimeout(r),ze&&cancelAnimationFrame(t),setTimeout(e)},r=setTimeout(i,35);ze&&(t=requestAnimationFrame(i))}function De(e){var t=ge,i=e.__c;"function"==typeof i&&(e.__c=void 0,i()),ge=t}function Fe(e){var t=ge;e.__c=e.__(),ge=t}function He(e,t){return!e||e.length!==t.length||t.some(function(t,i){return t!==e[i]})}function $e(e,t){return"function"==typeof t?t(e):t}var je=(e=>(e[e.Degree0=0]="Degree0",e[e.Degree90=1]="Degree90",e[e.Degree180=2]="Degree180",e[e.Degree270=3]="Degree270",e))(je||{});function Ue(e){return{x:Math.floor(e.x),y:Math.floor(e.y)}}function Be(e){return{width:Math.ceil(e.width),height:Math.ceil(e.height)}}function Ge(e){return{origin:Ue(e.origin),size:Be(e.size)}}function Ve(e){const{width:t,height:i}=e;return{width:i,height:t}}function We(e,t,i){return{width:(e=t%2==0?e:Ve(e)).width*i,height:e.height*i}}function Ze(e){const t=[e.p1.x,e.p2.x,e.p3.x,e.p4.x],i=[e.p1.y,e.p2.y,e.p3.y,e.p4.y];return{origin:{x:Math.min(...t),y:Math.min(...i)},size:{width:Math.max(...t)-Math.min(...t),height:Math.max(...i)-Math.min(...i)}}}function qe(e){return{p1:{x:e.origin.x,y:e.origin.y},p2:{x:e.origin.x+e.size.width,y:e.origin.y},p3:{x:e.origin.x+e.size.width,y:e.origin.y+e.size.height},p4:{x:e.origin.x,y:e.origin.y+e.size.height}}}function Xe(e,t,i){let r=t.x,o=t.y;switch(i){case 0:r=t.x,o=t.y;break;case 1:r=e.height-t.y,o=t.x;break;case 2:r=e.width-t.x,o=e.height-t.y;break;case 3:r=t.y,o=e.width-t.x}return{x:r,y:o}}function Ke(e,t){return{x:e.x*t,y:e.y*t}}function Ye(e,t,i){let r=t.origin.x,o=t.origin.y,n=t.size;switch(i){case 0:break;case 1:r=e.height-t.origin.y-t.size.height,o=t.origin.x,n=Ve(t.size);break;case 2:r=e.width-t.origin.x-t.size.width,o=e.height-t.origin.y-t.size.height;break;case 3:r=t.origin.y,o=e.width-t.origin.x-t.size.width,n=Ve(t.size)}return{origin:{x:r,y:o},size:{width:n.width,height:n.height}}}function Qe(e,t){return{origin:{x:e.origin.x*t,y:e.origin.y*t},size:{width:e.size.width*t,height:e.size.height*t}}}function Je(e,t,i,r){return Qe(Ye(e,t,i),r)}function et(e){if(0===e.length)return null;let t=e[0].origin.x,i=e[0].origin.y,r=e[0].origin.x+e[0].size.width,o=e[0].origin.y+e[0].size.height;for(const n of e)t=Math.min(t,n.origin.x),i=Math.min(i,n.origin.y),r=Math.max(r,n.origin.x+n.size.width),o=Math.max(o,n.origin.y+n.size.height);return{origin:{x:t,y:i},size:{width:r-t,height:o-i}}}var tt=(e,t,i)=>{const{width:r,height:o}=e.size;switch(t){case 0:return{a:i,b:0,c:0,d:-i,e:0,f:o*i};case 1:return{a:0,b:i,c:i,d:0,e:0,f:0};case 2:return{a:-i,b:0,c:0,d:i,e:r*i,f:0};case 3:return{a:0,b:-i,c:-i,d:0,e:o*i,f:r*i}}},it=class{debug(){}info(){}warn(){}error(){}perf(){}},rt=class extends Error{constructor(e){super(`Task aborted: ${JSON.stringify(e)}`),this.name="TaskAbortedError"}},ot=class extends Error{constructor(e){super(`Task rejected: ${JSON.stringify(e)}`),this.name="TaskRejectedError"}},nt=class e{constructor(){this.state={stage:0},this.resolvedCallbacks=[],this.rejectedCallbacks=[],this._promise=null}toPromise(){return this._promise||(this._promise=new Promise((e,t)=>{this.wait(t=>e(t),e=>{"abort"===e.type?t(new rt(e.reason)):t(new ot(e.reason))})})),this._promise}wait(e,t){switch(this.state.stage){case 0:this.resolvedCallbacks.push(e),this.rejectedCallbacks.push(t);break;case 1:e(this.state.result);break;case 2:t({type:"reject",reason:this.state.reason});break;case 3:t({type:"abort",reason:this.state.reason})}}resolve(e){if(0===this.state.stage){this.state={stage:1,result:e};for(const t of this.resolvedCallbacks)try{t(e)}catch(e){}this.resolvedCallbacks=[],this.rejectedCallbacks=[]}}reject(e){if(0===this.state.stage){this.state={stage:2,reason:e};for(const t of this.rejectedCallbacks)try{t({type:"reject",reason:e})}catch(e){}this.resolvedCallbacks=[],this.rejectedCallbacks=[]}}abort(e){if(0===this.state.stage){this.state={stage:3,reason:e};for(const t of this.rejectedCallbacks)try{t({type:"abort",reason:e})}catch(e){}this.resolvedCallbacks=[],this.rejectedCallbacks=[]}}fail(e){"abort"===e.type?this.abort(e.reason):this.reject(e.reason)}static all(t){const i=new e;if(0===t.length)return i.resolve([]),i;const r=new Array(t.length);let o=0,n=!1;return t.forEach((e,s)=>{e.wait(e=>{n||(r[s]=e,o++,o===t.length&&(n=!0,i.resolve(r)))},e=>{n||(n=!0,"abort"===e.type?i.abort(e.reason):i.reject(e.reason))})}),i}static allSettled(t){const i=new e;if(0===t.length)return i.resolve([]),i;const r=new Array(t.length);let o=0;return t.forEach((e,n)=>{e.wait(e=>{r[n]={status:"resolved",value:e},o++,o===t.length&&i.resolve(r)},e=>{r[n]={status:"abort"===e.type?"aborted":"rejected",reason:e.reason},o++,o===t.length&&i.resolve(r)})}),i}static race(t){const i=new e;if(0===t.length)return i.reject("No tasks provided"),i;let r=!1;return t.forEach(e=>{e.wait(e=>{r||(r=!0,i.resolve(e))},e=>{r||(r=!0,"abort"===e.type?i.abort(e.reason):i.reject(e.reason))})}),i}static withProgress(t,i){const r=e.all(t);if(i){let e=0;t.forEach(r=>{r.wait(()=>{e++,i(e,t.length)},()=>{e++,i(e,t.length)})})}return r}},st=Object.freeze(["","","","\ufeff","",""]),at=new RegExp(`[${st.join("")}]`,"g");function lt(e){return e.replace(at,"")}var ct=(e=>(e[e.Unknown=0]="Unknown",e[e.XYZ=1]="XYZ",e[e.FitPage=2]="FitPage",e[e.FitHorizontal=3]="FitHorizontal",e[e.FitVertical=4]="FitVertical",e[e.FitRectangle=5]="FitRectangle",e))(ct||{}),dt=(e=>(e[e.Normal=0]="Normal",e[e.Multiply=1]="Multiply",e[e.Screen=2]="Screen",e[e.Overlay=3]="Overlay",e[e.Darken=4]="Darken",e[e.Lighten=5]="Lighten",e[e.ColorDodge=6]="ColorDodge",e[e.ColorBurn=7]="ColorBurn",e[e.HardLight=8]="HardLight",e[e.SoftLight=9]="SoftLight",e[e.Difference=10]="Difference",e[e.Exclusion=11]="Exclusion",e[e.Hue=12]="Hue",e[e.Saturation=13]="Saturation",e[e.Color=14]="Color",e[e.Luminosity=15]="Luminosity",e))(dt||{}),ut=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);ut.reduce((e,t)=>(e[t.id]=t,e),{}),ut.reduce((e,t)=>(e[t.css]=t.id,e),{});var ht=ut.map(e=>({value:e.id,label:e.label})),pt=(e=>(e[e.Unsupported=0]="Unsupported",e[e.Goto=1]="Goto",e[e.RemoteGoto=2]="RemoteGoto",e[e.URI=3]="URI",e[e.LaunchAppOrOpenFile=4]="LaunchAppOrOpenFile",e))(pt||{}),gt=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.TEXT=1]="TEXT",e[e.LINK=2]="LINK",e[e.FREETEXT=3]="FREETEXT",e[e.LINE=4]="LINE",e[e.SQUARE=5]="SQUARE",e[e.CIRCLE=6]="CIRCLE",e[e.POLYGON=7]="POLYGON",e[e.POLYLINE=8]="POLYLINE",e[e.HIGHLIGHT=9]="HIGHLIGHT",e[e.UNDERLINE=10]="UNDERLINE",e[e.SQUIGGLY=11]="SQUIGGLY",e[e.STRIKEOUT=12]="STRIKEOUT",e[e.STAMP=13]="STAMP",e[e.CARET=14]="CARET",e[e.INK=15]="INK",e[e.POPUP=16]="POPUP",e[e.FILEATTACHMENT=17]="FILEATTACHMENT",e[e.SOUND=18]="SOUND",e[e.MOVIE=19]="MOVIE",e[e.WIDGET=20]="WIDGET",e[e.SCREEN=21]="SCREEN",e[e.PRINTERMARK=22]="PRINTERMARK",e[e.TRAPNET=23]="TRAPNET",e[e.WATERMARK=24]="WATERMARK",e[e.THREED=25]="THREED",e[e.RICHMEDIA=26]="RICHMEDIA",e[e.XFAWIDGET=27]="XFAWIDGET",e[e.REDACT=28]="REDACT",e))(gt||{}),ft=(e=>(e[e.Normal=0]="Normal",e[e.Rollover=1]="Rollover",e[e.Down=2]="Down",e))(ft||{}),mt=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.PUSHBUTTON=1]="PUSHBUTTON",e[e.CHECKBOX=2]="CHECKBOX",e[e.RADIOBUTTON=3]="RADIOBUTTON",e[e.COMBOBOX=4]="COMBOBOX",e[e.LISTBOX=5]="LISTBOX",e[e.TEXTFIELD=6]="TEXTFIELD",e[e.SIGNATURE=7]="SIGNATURE",e[e.XFA=8]="XFA",e[e.XFA_CHECKBOX=9]="XFA_CHECKBOX",e[e.XFA_COMBOBOX=10]="XFA_COMBOBOX",e[e.XFA_IMAGEFIELD=11]="XFA_IMAGEFIELD",e[e.XFA_LISTBOX=12]="XFA_LISTBOX",e[e.XFA_PUSHBUTTON=13]="XFA_PUSHBUTTON",e[e.XFA_SIGNATURE=14]="XFA_SIGNATURE",e[e.XFA_TEXTFIELD=15]="XFA_TEXTFIELD",e))(mt||{}),bt=(e=>(e[e.Color=0]="Color",e[e.InteriorColor=1]="InteriorColor",e))(bt||{}),vt=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.SOLID=1]="SOLID",e[e.DASHED=2]="DASHED",e[e.BEVELED=3]="BEVELED",e[e.INSET=4]="INSET",e[e.UNDERLINE=5]="UNDERLINE",e[e.CLOUDY=6]="CLOUDY",e))(vt||{}),yt=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.TEXT=1]="TEXT",e[e.PATH=2]="PATH",e[e.IMAGE=3]="IMAGE",e[e.SHADING=4]="SHADING",e[e.FORM=5]="FORM",e))(yt||{}),wt=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});function St(e){return Object.keys(wt).filter(t=>0!==(e&t)).map(e=>wt[e])}Object.entries(wt).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var Ct=(e=>(e[e.None=0]="None",e[e.MatchCase=1]="MatchCase",e[e.MatchWholeWord=2]="MatchWholeWord",e[e.MatchConsecutive=4]="MatchConsecutive",e))(Ct||{}),xt=(e=>(e[e.Ok=0]="Ok",e[e.Unknown=1]="Unknown",e[e.NotFound=2]="NotFound",e[e.WrongFormat=3]="WrongFormat",e[e.Password=4]="Password",e[e.Security=5]="Security",e[e.PageError=6]="PageError",e[e.XFALoad=7]="XFALoad",e[e.XFALayout=8]="XFALayout",e[e.Cancelled=9]="Cancelled",e[e.Initialization=10]="Initialization",e[e.NotReady=11]="NotReady",e[e.NotSupport=12]="NotSupport",e[e.LoadDoc=13]="LoadDoc",e[e.DocNotOpen=14]="DocNotOpen",e[e.CantCloseDoc=15]="CantCloseDoc",e[e.CantCreateNewDoc=16]="CantCreateNewDoc",e[e.CantImportPages=17]="CantImportPages",e[e.CantCreateAnnot=18]="CantCreateAnnot",e[e.CantSetAnnotRect=19]="CantSetAnnotRect",e[e.CantSetAnnotContent=20]="CantSetAnnotContent",e[e.CantRemoveInkList=21]="CantRemoveInkList",e[e.CantAddInkStoke=22]="CantAddInkStoke",e[e.CantReadAttachmentSize=23]="CantReadAttachmentSize",e[e.CantReadAttachmentContent=24]="CantReadAttachmentContent",e[e.CantFocusAnnot=25]="CantFocusAnnot",e[e.CantSelectText=26]="CantSelectText",e[e.CantSelectOption=27]="CantSelectOption",e[e.CantCheckField=28]="CantCheckField",e))(xt||{}),It=class{static create(){return new nt}static resolve(e){const t=new nt;return t.resolve(e),t}static reject(e){const t=new nt;return t.reject(e),t}static abort(e){const t=new nt;return t.reject(e),t}};function At(e){const t=e=>Math.max(0,Math.min(255,e)),i=e=>t(e).toString(16).padStart(2,"0");return{color:`#${i(e.red)}${i(e.green)}${i(e.blue)}`,opacity:t(e.alpha)/255}}function Et({color:e,opacity:t}){/^#?[0-9a-f]{3}$/i.test(e)&&(e=e.replace(/^#?([0-9a-f])([0-9a-f])([0-9a-f])$/i,"#$1$1$2$2$3$3").toLowerCase());const[,i,r,o]=/^#?([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(e)??(()=>{throw new Error(`Invalid hex colour: ${e}`)})();return{red:parseInt(i,16),green:parseInt(r,16),blue:parseInt(o,16),alpha:((e,t=255)=>Math.max(0,Math.min(t,e)))(Math.round(255*t))}}function kt(e){if(!e?.startsWith("D:")||e.length<16)return;const t=+e.slice(2,6),i=+e.slice(6,8)-1,r=+e.slice(8,10),o=+e.slice(10,12),n=+e.slice(12,14),s=+e.slice(14,16);return new Date(Date.UTC(t,i,r,o,n,s))}function Pt(e=new Date){const t=(e,t=2)=>e.toString().padStart(t,"0");return`D:${e.getUTCFullYear()}${t(e.getUTCMonth()+1)}${t(e.getUTCDate())}${t(e.getUTCHours())}${t(e.getUTCMinutes())}${t(e.getUTCSeconds())}`}function Mt(){}let Tt=class{constructor(){this.dependencyGraph=new Map}addNode(e,t=[]){this.dependencyGraph.set(e,new Set(t))}hasCircularDependencies(){const e=new Set,t=new Set,i=r=>{e.add(r),t.add(r);const o=this.dependencyGraph.get(r)||new Set;for(const r of o)if(e.has(r)){if(t.has(r))return!0}else if(i(r))return!0;return t.delete(r),!1};for(const t of this.dependencyGraph.keys())if(!e.has(t)&&i(t))return!0;return!1}resolveLoadOrder(){if(this.hasCircularDependencies())throw new Error("Circular dependencies detected");const e=[],t=new Set,i=new Set,r=o=>{if(i.has(o))throw new Error("Circular dependency");if(t.has(o))return;i.add(o);const n=this.dependencyGraph.get(o)||new Set;for(const e of n)r(e);i.delete(o),t.add(o),e.push(o)};for(const e of this.dependencyGraph.keys())t.has(e)||r(e);return e}},Rt=class extends Error{constructor(e){super(e),this.name="PluginRegistrationError"}},_t=class extends Error{constructor(e){super(e),this.name="PluginNotFoundError"}},Nt=class extends Error{constructor(e){super(e),this.name="CircularDependencyError"}},Ot=class extends Error{constructor(e){super(e),this.name="PluginConfigurationError"}},zt=class{constructor(e,t){this.store=e,this.pluginId=t}getState(){return this.store.getState().plugins[this.pluginId]}dispatch(e){return this.store.dispatchToPlugin(this.pluginId,e)}subscribeToState(e){return this.store.subscribeToPlugin(this.pluginId,(t,i,r)=>{e(t,i,r)})}onAction(e,t){return this.store.onAction(e,(e,i,r)=>{t(e,i.plugins[this.pluginId],r.plugins[this.pluginId])})}};const Lt="LOAD_DOCUMENT",Dt="SET_DOCUMENT",Ft="SET_DOCUMENT_ERROR",Ht="SET_SCALE",$t="SET_ROTATION",jt="SET_PAGES",Ut=[Lt,Dt,Ft,Ht,$t,jt];let Bt=class{constructor(e,t){this.initialCoreState=t,this.pluginReducers={},this.listeners=[],this.pluginListeners={},this.state={core:t,plugins:{}},this.coreReducer=e}addPluginReducer(e,t,i){this.state.plugins[e]=i,this.pluginReducers[e]=t}dispatchToCore(e){if(!this.coreReducer)return this.getState();const t=this.getState();this.state.core=this.coreReducer(this.state.core,e);const i=this.getState();return this.listeners.forEach(r=>r(e,i,t)),i}dispatchToPlugin(e,t,i=!0){const r=this.getState(),o=this.pluginReducers[e];if(!o)return r;const n=r.plugins[e],s=o(n,t);this.state.plugins[e]=s;const a=this.getState();return i&&this.listeners.forEach(e=>e(t,a,r)),this.pluginListeners[e]&&this.pluginListeners[e].forEach(e=>{e(t,s,n)}),s}dispatch(e){const t=this.getState();this.isCoreAction(e)&&(this.state.core=this.coreReducer(this.state.core,e));for(const i in this.pluginReducers){const r=this.pluginReducers[i],o=t.plugins[i];r&&(this.state.plugins[i]=r(o,e))}const i=this.getState();return this.listeners.forEach(r=>r(e,i,t)),i}getState(){return{core:{...this.state.core},plugins:{...this.state.plugins}}}subscribe(e){return this.listeners.push(e),()=>{this.listeners=this.listeners.filter(t=>t!==e)}}subscribeToPlugin(e,t){if(!(e in this.state.plugins))throw new Error(`Plugin state not found for plugin "${e}". Did you forget to call addPluginReducer?`);return this.pluginListeners[e]||(this.pluginListeners[e]=[]),this.pluginListeners[e].push(t),()=>{this.pluginListeners[e]=this.pluginListeners[e].filter(e=>e!==t),0===this.pluginListeners[e].length&&delete this.pluginListeners[e]}}onAction(e,t){return this.subscribe((i,r,o)=>{i.type===e&&t(i,r,o)})}getPluginStore(e){if(!(e in this.state.plugins))throw new Error(`Plugin state not found for plugin "${e}". Did you forget to call addPluginReducer?`);return new zt(this,e)}isCoreAction(e){return Ut.includes(e.type)}destroy(){var e,t;this.listeners.length=0;for(const i in this.pluginListeners)null==(t=null==(e=this.pluginListeners[i])?void 0:e.splice)||t.call(e,0);this.pluginListeners={},this.pluginReducers={},this.state.plugins={},this.state.core={...this.initialCoreState}}};const Gt=e=>e.pages.map(t=>t.map(t=>({...t,rotatedSize:We(t.size,e.rotation,1)}))),Vt=(e,t)=>{switch(t.type){case Lt:return{...e,loading:!0,error:null};case Dt:return{...e,document:t.payload,pages:t.payload.pages.map(e=>[e]),loading:!1,error:null};case $t:return{...e,rotation:t.payload};case jt:return{...e,pages:t.payload};case Ft:return{...e,loading:!1,error:t.payload};case Ht:return{...e,scale:t.payload};default:return e}};let Wt=class{constructor(e,t){this.plugins=new Map,this.manifests=new Map,this.capabilities=new Map,this.status=new Map,this.configurations=new Map,this.engineInitialized=!1,this.initPromise=null,this.pendingRegistrations=[],this.processingRegistrations=[],this.initialized=!1,this.isInitializing=!1,this.pluginsReadyPromise=null,this.destroyed=!1,this.resolver=new Tt,this.engine=e,this.initialCoreState=(e=>({scale:(null==e?void 0:e.scale)??1,rotation:(null==e?void 0:e.rotation)??je.Degree0,document:null,pages:[],loading:!1,error:null}))(t),this.store=new Bt(Vt,this.initialCoreState)}async ensureEngineInitialized(){this.engineInitialized||(this.engine.initialize?(await this.engine.initialize().toPromise(),this.engineInitialized=!0):this.engineInitialized=!0)}registerPlugin(e,t){if(this.initialized&&!this.isInitializing)throw new Rt("Cannot register plugins after initialization");this.validateManifest(e.manifest),this.store.addPluginReducer(e.manifest.id,e.reducer,"function"==typeof e.initialState?e.initialState(this.initialCoreState,{...e.manifest.defaultConfig,...t}):e.initialState),this.pendingRegistrations.push({package:e,config:t})}getStore(){return this.store}getEngine(){return this.engine}pluginsReady(){return this.pluginsReadyPromise||(this.pluginsReadyPromise=(async()=>{this.initialized||await this.initialize();const e=Array.from(this.plugins.values()).map(e=>"function"==typeof e.ready?e.ready():Promise.resolve());await Promise.all(e)})()),this.pluginsReadyPromise}async initialize(){if(this.destroyed)throw new Rt("Registry has been destroyed");return this.initPromise||(this.initPromise=(async()=>{var e;if(this.initialized)throw new Rt("Registry is already initialized");this.isInitializing=!0;try{if(await this.ensureEngineInitialized(),this.destroyed)return;for(;this.pendingRegistrations.length>0;){if(this.destroyed)return;this.processingRegistrations=[...this.pendingRegistrations],this.pendingRegistrations=[];for(const e of this.processingRegistrations){const t=new Set,i=[...e.package.manifest.requires,...e.package.manifest.optional];for(const e of i){const i=this.processingRegistrations.find(t=>t.package.manifest.provides.includes(e));i&&t.add(i.package.manifest.id)}this.resolver.addNode(e.package.manifest.id,[...t])}const e=this.resolver.resolveLoadOrder();for(const t of e){const e=this.processingRegistrations.find(e=>e.package.manifest.id===t);await this.initializePlugin(e.package.manifest,e.package.create,e.config)}this.processingRegistrations=[],this.resolver=new Tt}for(const t of this.plugins.values())await(null==(e=t.postInitialize)?void 0:e.call(t).catch(e=>{console.error(`Error in postInitialize for plugin ${t.id}`,e),this.status.set(t.id,"error")}));this.initialized=!0}catch(e){throw e instanceof Error?new Nt(`Failed to resolve plugin dependencies: ${e.message}`):e}finally{this.isInitializing=!1}})()),this.initPromise}async initializePlugin(e,t,i){const r={...e.defaultConfig,...i};this.validateConfig(e.id,r,e.defaultConfig);const o=t(this,this.engine,r);this.validatePlugin(o);for(const t of e.requires)if(!this.capabilities.has(t))throw new Rt(`Missing required capability: ${t} for plugin ${e.id}`);for(const t of e.optional)this.capabilities.has(t)&&console.debug(`Optional capability ${t} is available for plugin ${e.id}`);console.log("initializePlugin",e.id,e.provides);for(const t of e.provides){if(this.capabilities.has(t))throw new Rt(`Capability ${t} is already provided by plugin ${this.capabilities.get(t)}`);this.capabilities.set(t,e.id)}this.plugins.set(e.id,o),this.manifests.set(e.id,e),this.status.set(e.id,"registered"),this.configurations.set(e.id,r);try{o.initialize&&await o.initialize(r),this.status.set(e.id,"active")}catch(t){throw this.plugins.delete(e.id),this.manifests.delete(e.id),console.log("initializePlugin failed",e.id,e.provides),e.provides.forEach(e=>this.capabilities.delete(e)),t}}getPluginConfig(e){const t=this.configurations.get(e);if(!t)throw new _t(`Configuration for plugin ${e} not found`);return t}validateConfig(e,t,i){const r=Object.keys(i).filter(e=>!t.hasOwnProperty(e));if(r.length>0)throw new Ot(`Missing required configuration keys for plugin ${e}: ${r.join(", ")}`)}async updatePluginConfig(e,t){const i=this.getPlugin(e);if(!i)throw new _t(`Plugin ${e} not found`);const r=this.manifests.get(e),o=this.configurations.get(e);if(!r||!o)throw new _t(`Plugin ${e} not found`);const n={...o,...t};this.validateConfig(e,n,r.defaultConfig),this.configurations.set(e,n),i.initialize&&await i.initialize(n)}registerPluginBatch(e){for(const t of e)this.registerPlugin(t.package,t.config)}async unregisterPlugin(e){const t=this.plugins.get(e);if(!t)throw new _t(`Plugin ${e} is not registered`);const i=this.manifests.get(e);if(!i)throw new _t(`Manifest for plugin ${e} not found`);for(const[t,r]of this.manifests.entries())if(t!==e&&[...r.requires,...r.optional].some(e=>i.provides.includes(e)))throw new Rt(`Cannot unregister plugin ${e}: plugin ${t} depends on it`);try{t.destroy&&await t.destroy();for(const e of i.provides)this.capabilities.delete(e);this.plugins.delete(e),this.manifests.delete(e),this.status.delete(e)}catch(t){throw t instanceof Error?new Error(`Failed to unregister plugin ${e}: ${t.message}`):t}}getPlugin(e){return this.plugins.get(e)||null}getCapabilityProvider(e){const t=this.capabilities.get(e);return t?this.getPlugin(t):null}hasCapability(e){return this.capabilities.has(e)}getAllPlugins(){return Array.from(this.plugins.values())}getPluginStatus(e){const t=this.status.get(e);if(!t)throw new _t(`Plugin ${e} not found`);return t}validatePlugin(e){if(!e.id)throw new Rt("Plugin must have an id")}validateManifest(e){if(!e.id)throw new Rt("Manifest must have an id");if(!e.name)throw new Rt("Manifest must have a name");if(!e.version)throw new Rt("Manifest must have a version");if(!Array.isArray(e.provides))throw new Rt("Manifest must have a provides array");if(!Array.isArray(e.requires))throw new Rt("Manifest must have a requires array");if(!Array.isArray(e.optional))throw new Rt("Manifest must have an optional array")}isDestroyed(){return this.destroyed}async destroy(){var e;if(this.destroyed)throw new Rt("Registry has already been destroyed");this.destroyed=!0;try{await this.initPromise}catch{}for(const t of Array.from(this.plugins.values()).reverse())await(null==(e=t.destroy)?void 0:e.call(t));this.store.destroy(),this.plugins.clear(),this.manifests.clear(),this.capabilities.clear(),this.status.clear(),this.pendingRegistrations.length=0,this.processingRegistrations.length=0}};function Zt(e,t){return{package:e,config:t}}let qt=class{constructor(e,t){if(this.id=e,this.registry=t,this.debouncedActions={},this.unsubscribeFromState=null,this.unsubscribeFromCoreStore=null,e!==this.constructor.id)throw new Error(`Plugin ID mismatch: ${e} !== ${this.constructor.id}`);this.coreStore=this.registry.getStore(),this.pluginStore=this.coreStore.getPluginStore(this.id),this.unsubscribeFromState=this.pluginStore.subscribeToState((e,t,i)=>{this.onStoreUpdated(i,t)}),this.unsubscribeFromCoreStore=this.coreStore.subscribe((e,t,i)=>{this.onCoreStoreUpdated(i,t)}),this.readyPromise=new Promise(e=>{this.readyResolve=e}),this.readyResolve()}provides(){if(!this._capability){const e=this.buildCapability();this._capability=Object.freeze(e)}return this._capability}get state(){return this.pluginStore.getState()}get coreState(){return this.coreStore.getState()}getState(){return this.pluginStore.getState()}getCoreState(){return this.coreStore.getState()}dispatchCoreAction(e){return this.coreStore.dispatchToCore(e)}dispatchToAllPlugins(e){return this.coreStore.dispatch(e)}dispatch(e){return this.pluginStore.dispatch(e)}debouncedDispatch(e,t=100){const i=Date.now();return i-(this.debouncedActions[e.type]||0)>=t&&(this.debouncedActions[e.type]=i,this.dispatch(e),!0)}subscribe(e){return this.pluginStore.subscribeToState(e)}subscribeToCoreStore(e){return this.coreStore.subscribe(e)}onStoreUpdated(e,t){}onCoreStoreUpdated(e,t){}destroy(){this.unsubscribeFromState&&(this.unsubscribeFromState(),this.unsubscribeFromState=null),this.unsubscribeFromCoreStore&&(this.unsubscribeFromCoreStore(),this.unsubscribeFromCoreStore=null)}ready(){return this.readyPromise}markReady(){this.readyResolve()}resetReady(){this.readyPromise=new Promise(e=>{this.readyResolve=e})}},Xt=class{constructor(e,t){this.handler=e,this.options=t,this.lastRun=0,this.handle=e=>{"debounce"===this.options.mode?this.debounce(e):this.throttle(e)}}debounce(e){this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.timeoutId=void 0},this.options.wait)}throttle(e){if("debounce"===this.options.mode)return;const t=Date.now(),i=this.options.throttleMode||"leading-trailing";t-this.lastRun>=this.options.wait&&("leading-trailing"===i&&this.handler(e),this.lastRun=t),this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.lastRun=Date.now(),this.timeoutId=void 0},this.options.wait-(t-this.lastRun))}destroy(){this.timeoutId&&window.clearTimeout(this.timeoutId)}};function Kt(e,t,i){if(e===t)return!0;if(null==e||null==t)return e===t;const r=typeof e;if(r!==typeof t)return!1;if("object"===r){i||(i=new Set);const r=function(e,t){return`${Jt(e)}__${Jt(t)}`}(e,t);if(i.has(r))return!0;i.add(r);const o=Array.isArray(e),n=Array.isArray(t);return o&&n?function(e,t,i){if(e.length!==t.length)return!1;const r=new Array(t.length).fill(!1);e:for(let o=0;o<e.length;o++){const n=e[o];for(let e=0;e<t.length;e++)if(!r[e]&&Kt(n,t[e],i)){r[e]=!0;continue e}return!1}return!0}(e,t,i):!o&&!n&&function(e,t,i){const r=Object.keys(e).sort(),o=Object.keys(t).sort();if(r.length!==o.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!==o[e])return!1;for(const o of r){if(!Kt(e[o],t[o],i))return!1}return!0}(e,t,i)}return!1}let Yt=0;const Qt=new WeakMap;function Jt(e){return Qt.has(e)||Qt.set(e,++Yt),Qt.get(e)}function ei(){const e=new Set;return{emit:(t=void 0)=>e.forEach(e=>e(t)),on:t=>(e.add(t),()=>e.delete(t)),off:t=>e.delete(t),clear:()=>e.clear()}}function ti(e,t=Kt){const i=new Set,r=new Map;let o=e;const n=(e,t)=>{let n=e,s=()=>{};if(t){const i=new Xt(e,t);n=i.handle,s=()=>i.destroy(),r.set(e,{wrapped:n,destroy:s})}return void 0!==o&&n(o),i.add(n),()=>{i.delete(n),s(),r.delete(e)}};return{get value(){return o},emit(e=void 0){(void 0===o||!t(o,e))&&(o=e,(e=>{i.forEach(t=>t(e))})(e))},on:n,off(e){const t=r.get(e);t?(i.delete(t.wrapped),t.destroy(),r.delete(e)):i.delete(e)},clear(){i.clear(),r.forEach(e=>e.destroy()),r.clear()},select:(e,t=Kt)=>(i,r)=>{let s;if(void 0!==o){const t=e(o);s=t,i(t)}return n(r=>{const o=e(r);(void 0===s||!t(s,o))&&(s=o,i(o))},r)}}}const ii=ce({registry:null,isInitializing:!0,pluginsReady:!1});function ri({engine:e,onInitialized:t,plugins:i,children:r}){const[o,n]=ke(null),[s,a]=ke(!0),[l,c]=ke(!1),d=Te(t);return Pe(()=>{d.current=t},[t]),Pe(()=>{const t=new Wt(e);return t.registerPluginBatch(i),(async()=>{var e;await t.initialize(),!t.isDestroyed()&&(await(null==(e=d.current)?void 0:e.call(d,t)),!t.isDestroyed()&&(t.pluginsReady().then(()=>{t.isDestroyed()||c(!0)}),n(t),a(!1)))})().catch(console.error),()=>{t.destroy(),n(null),a(!0),c(!1)}},[e,i]),he(ii.Provider,{value:{registry:o,isInitializing:s,pluginsReady:l},children:"function"==typeof r?r({registry:o,isInitializing:s,pluginsReady:l}):r})}function oi(){const e=Ne(ii);if(void 0===e)throw new Error("useCapability must be used within a PDFContext.Provider");const{registry:t,isInitializing:i}=e;if(i)return e;if(null===t)throw new Error("PDF registry failed to initialize properly");return e}function ni(e){const{registry:t}=oi();if(null===t)return{plugin:null,isLoading:!0,ready:new Promise(()=>{})};const i=t.getPlugin(e);if(!i)throw new Error(`Plugin ${e} not found`);return{plugin:i,isLoading:!1,ready:i.ready()}}function si(e){const{plugin:t,isLoading:i,ready:r}=ni(e);if(!t)return{provides:null,isLoading:i,ready:r};if(!t.provides)throw new Error(`Plugin ${e} does not provide a capability`);return{provides:t.provides(),isLoading:i,ready:r}}const ai="https://cdn.jsdelivr.net/npm/@embedpdf/pdfium@1.0.11/dist/pdfium.wasm";const li="viewport",ci={id:li,name:"Viewport Plugin",version:"1.0.0",provides:["viewport"],requires:[],optional:[],defaultConfig:{enabled:!0,viewportGap:10,scrollEndDelay:300}},di="SET_VIEWPORT_METRICS",ui="SET_VIEWPORT_SCROLL_METRICS",hi="SET_VIEWPORT_GAP",pi="SET_SCROLL_ACTIVITY";const gi={viewportGap:0,viewportMetrics:{width:0,height:0,scrollTop:0,scrollLeft:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0,relativePosition:{x:0,y:0}},isScrolling:!1},fi=class extends qt{constructor(e,t,i){super(e,t),this.id=e,this.viewportResize$=ti(),this.viewportMetrics$=ti(),this.scrollMetrics$=ti(),this.scrollReq$=ei(),this.scrollActivity$=ti(),this.rectProvider=null,i.viewportGap&&this.dispatch(function(e){return{type:hi,payload:e}}(i.viewportGap)),this.scrollEndDelay=i.scrollEndDelay||300}buildCapability(){return{getViewportGap:()=>this.state.viewportGap,getMetrics:()=>this.state.viewportMetrics,getBoundingRect:()=>{var e;return(null==(e=this.rectProvider)?void 0:e.call(this))??{origin:{x:0,y:0},size:{width:0,height:0}}},scrollTo:e=>this.scrollTo(e),isScrolling:()=>this.state.isScrolling,onScrollChange:this.scrollMetrics$.on,onViewportChange:this.viewportMetrics$.on,onViewportResize:this.viewportResize$.on,onScrollActivity:this.scrollActivity$.on}}setViewportResizeMetrics(e){this.dispatch(function(e){return{type:di,payload:e}}(e)),this.viewportResize$.emit(this.state.viewportMetrics)}setViewportScrollMetrics(e){(e.scrollTop!==this.state.viewportMetrics.scrollTop||e.scrollLeft!==this.state.viewportMetrics.scrollLeft)&&(this.dispatch(function(e){return{type:ui,payload:e}}(e)),this.bumpScrollActivity(),this.scrollMetrics$.emit({scrollTop:e.scrollTop,scrollLeft:e.scrollLeft}))}onScrollRequest(e){return this.scrollReq$.on(e)}registerBoundingRectProvider(e){this.rectProvider=e}bumpScrollActivity(){this.debouncedDispatch(function(e){return{type:pi,payload:e}}(!1),this.scrollEndDelay)}scrollTo(e){const{x:t,y:i,center:r,behavior:o="auto"}=e;if(r){const e=this.state.viewportMetrics,r=t-e.clientWidth/2,n=i-e.clientHeight/2;this.scrollReq$.emit({x:r,y:n,behavior:o})}else this.scrollReq$.emit({x:t,y:i,behavior:o})}onStoreUpdated(e,t){e!==t&&(this.viewportMetrics$.emit(t.viewportMetrics),e.isScrolling!==t.isScrolling&&this.scrollActivity$.emit(t.isScrolling))}async initialize(e){}async destroy(){super.destroy(),this.viewportMetrics$.clear(),this.viewportResize$.clear(),this.scrollMetrics$.clear(),this.scrollReq$.clear(),this.scrollActivity$.clear(),this.rectProvider=null,this.scrollEndTimer&&clearTimeout(this.scrollEndTimer)}};fi.id="viewport";let mi=fi;const bi={manifest:ci,create:(e,t,i)=>new mi(li,e,i),reducer:(e=gi,t)=>{switch(t.type){case hi:return{...e,viewportGap:t.payload};case di:return{...e,viewportMetrics:{width:t.payload.width,height:t.payload.height,scrollTop:t.payload.scrollTop,scrollLeft:t.payload.scrollLeft,clientWidth:t.payload.clientWidth,clientHeight:t.payload.clientHeight,scrollWidth:t.payload.scrollWidth,scrollHeight:t.payload.scrollHeight,relativePosition:{x:t.payload.scrollWidth<=t.payload.clientWidth?0:t.payload.scrollLeft/(t.payload.scrollWidth-t.payload.clientWidth),y:t.payload.scrollHeight<=t.payload.clientHeight?0:t.payload.scrollTop/(t.payload.scrollHeight-t.payload.clientHeight)}}};case ui:return{...e,viewportMetrics:{...e.viewportMetrics,scrollTop:t.payload.scrollTop,scrollLeft:t.payload.scrollLeft},isScrolling:!0};case pi:return{...e,isScrolling:t.payload};default:return e}},initialState:gi},vi=()=>si(mi.id);function yi(){const{plugin:e}=ni(mi.id),t=Te(null);return Me(()=>{if(!e)return;const i=t.current;if(!i)return;e.registerBoundingRectProvider(()=>{const e=i.getBoundingClientRect();return{origin:{x:e.left,y:e.top},size:{width:e.width,height:e.height}}});const r=()=>{e.setViewportScrollMetrics({scrollTop:i.scrollTop,scrollLeft:i.scrollLeft})};i.addEventListener("scroll",r);const o=new ResizeObserver(()=>{e.setViewportResizeMetrics({width:i.offsetWidth,height:i.offsetHeight,clientWidth:i.clientWidth,clientHeight:i.clientHeight,scrollTop:i.scrollTop,scrollLeft:i.scrollLeft,scrollWidth:i.scrollWidth,scrollHeight:i.scrollHeight})});o.observe(i);const n=e.onScrollRequest(({x:e,y:t,behavior:r="auto"})=>{requestAnimationFrame(()=>{i.scrollTo({left:e,top:t,behavior:r})})});return()=>{e.registerBoundingRectProvider(null),i.removeEventListener("scroll",r),o.disconnect(),n()}},[e]),t}function wi({children:e,...t}){const[i,r]=ke(0),o=yi(),{provides:n}=vi();Pe(()=>{n&&r(n.getViewportGap())},[n]);const{style:s,...a}=t;return he("div",{...a,ref:o,style:{..."object"==typeof s?s:{},padding:`${i}px`},children:e})}var Si=(e=>(e.Vertical="vertical",e.Horizontal="horizontal",e))(Si||{});let Ci=class{constructor(e){this.pageGap=e.pageGap??20,this.viewportGap=e.viewportGap??20,this.bufferSize=e.bufferSize??2}getVisibleRange(e,t,i){const r=this.getScrollOffset(e),o=r,n=r+this.getClientSize(e);let s=0;for(;s<t.length&&(t[s].offset+t[s].height)*i<=o;)s++;let a=s;for(;a<t.length&&t[a].offset*i<=n;)a++;return{start:Math.max(0,s-this.bufferSize),end:Math.min(t.length-1,a+this.bufferSize-1)}}handleScroll(e,t,i){const r=this.getVisibleRange(e,t,i),o=t.slice(r.start,r.end+1),n=this.calculatePageVisibility(o,e,i),s=n.map(e=>e.pageNumber),a=t.slice(r.start,r.end+1).flatMap(e=>e.index),l=this.determineCurrentPage(n),c=t[r.start],d=t[r.end],u=c?c.offset*i:0,h=d?(t[t.length-1].offset+t[t.length-1].height)*i-(d.offset+d.height)*i:0;return{currentPage:l,visiblePages:s,pageVisibilityMetrics:n,renderedPageIndexes:a,scrollOffset:{x:e.scrollLeft,y:e.scrollTop},startSpacing:u,endSpacing:h}}calculatePageVisibility(e,t,i){const r=[];return e.forEach(e=>{e.pageLayouts.forEach(o=>{const n=e.x*i,s=e.y*i,a=n+o.x*i,l=s+o.y*i,c=o.rotatedWidth*i,d=o.rotatedHeight*i,u=t.scrollLeft,h=t.scrollTop,p=u+t.clientWidth,g=h+t.clientHeight,f=Math.max(a,u),m=Math.max(l,h),b=Math.min(a+c,p),v=Math.min(l+d,g);if(f<b&&m<v){const e=b-f,t=v-m,n=c*d,s=e*t;r.push({pageNumber:o.pageNumber,viewportX:f-u,viewportY:m-h,visiblePercentage:s/n*100,original:{pageX:(f-a)/i,pageY:(m-l)/i,visibleWidth:e/i,visibleHeight:t/i,scale:1},scaled:{pageX:f-a,pageY:m-l,visibleWidth:e,visibleHeight:t,scale:i}})}})}),r}determineCurrentPage(e){if(0===e.length)return 1;const t=Math.max(...e.map(e=>e.visiblePercentage)),i=e.filter(e=>e.visiblePercentage===t);return 1===i.length?i[0].pageNumber:i.sort((e,t)=>e.pageNumber-t.pageNumber)[0].pageNumber}getRectLocationForPage(e,t){const i=t.find(t=>t.pageNumbers.includes(e));if(!i)return null;const r=i.pageLayouts.find(t=>t.pageNumber===e);return r?{origin:{x:i.x+r.x,y:i.y+r.y},size:{width:r.width,height:r.height}}:null}getScrollPositionForPage(e,t,i,r,o){const n=this.getRectLocationForPage(e,t);if(!n)return null;const s=Ke(n.origin,i);if(o){const e=(a={width:n.size.width,height:n.size.height},l={x:o.x,y:o.y},c=i,Ke(Xe(a,l,r),c));return{x:s.x+e.x+this.viewportGap,y:s.y+e.y+this.viewportGap}}var a,l,c;return{x:s.x+this.viewportGap,y:s.y+this.viewportGap}}getRectPositionForPage(e,t,i,r,o){const n=this.getRectLocationForPage(e,t);if(!n)return null;const s=Ke(n.origin,i),a=Je({width:n.size.width,height:n.size.height},o,r,i);return{origin:{x:s.x+a.origin.x,y:s.y+a.origin.y},size:a.size}}},xi=class extends Ci{constructor(e){super(e)}createVirtualItems(e){let t=0;return e.map((e,i)=>{let r=0;const o=e.map(e=>{const t={pageNumber:e.index+1,pageIndex:e.index,x:r,y:0,width:e.size.width,height:e.size.height,rotatedWidth:e.rotatedSize.width,rotatedHeight:e.rotatedSize.height};return r+=e.rotatedSize.width+this.pageGap,t}),n=e.reduce((t,i,r)=>t+i.rotatedSize.width+(r<e.length-1?this.pageGap:0),0),s=Math.max(...e.map(e=>e.rotatedSize.height)),a={id:`item-${i}`,x:0,y:t,offset:t,width:n,height:s,pageLayouts:o,pageNumbers:e.map(e=>e.index+1),index:i};return t+=s+this.pageGap,a})}getTotalContentSize(e){if(0===e.length)return{width:0,height:0};const t=Math.max(...e.map(e=>e.width));return{width:t,height:e[e.length-1].y+e[e.length-1].height}}getScrollOffset(e){return e.scrollTop}getClientSize(e){return e.clientHeight}},Ii=class extends Ci{constructor(e){super(e)}createVirtualItems(e){let t=0;return e.map((e,i)=>{let r=0;const o=e.map(e=>{const t={pageNumber:e.index+1,pageIndex:e.index,x:r,y:0,width:e.size.width,height:e.size.height,rotatedWidth:e.rotatedSize.width,rotatedHeight:e.rotatedSize.height};return r+=e.rotatedSize.width+this.pageGap,t}),n=e.reduce((t,i,r)=>t+i.rotatedSize.width+(r<e.length-1?this.pageGap:0),0),s=Math.max(...e.map(e=>e.rotatedSize.height)),a={id:`item-${i}`,x:t,y:0,offset:t,width:n,height:s,pageLayouts:o,pageNumbers:e.map(e=>e.index+1),index:i};return t+=n+this.pageGap,a})}getTotalContentSize(e){if(0===e.length)return{width:0,height:0};const t=e[e.length-1].x+e[e.length-1].width,i=Math.max(...e.map(e=>e.height));return{width:t,height:i}}getScrollOffset(e){return e.scrollLeft}getClientSize(e){return e.clientWidth}};const Ai="UPDATE_SCROLL_STATE",Ei="UPDATE_TOTAL_PAGES";function ki(e){return{type:Ai,payload:e}}const Pi=class extends qt{constructor(e,t,i){var r,o,n,s;super(e,t),this.id=e,this.config=i,this.currentScale=1,this.currentRotation=je.Degree0,this.currentPage=1,this.layoutReady=!1,this.layout$=ti(),this.scroll$=ti(),this.state$=ti(),this.scrollerLayout$=ti(),this.pageChange$=ti(),this.layoutReady$=ti(),this.viewport=this.registry.getPlugin("viewport").provides(),this.strategyConfig={pageGap:(null==(r=this.config)?void 0:r.pageGap)??10,viewportGap:this.viewport.getViewportGap(),bufferSize:(null==(o=this.config)?void 0:o.bufferSize)??2},this.strategy=(null==(n=this.config)?void 0:n.strategy)===Si.Horizontal?new Ii(this.strategyConfig):new xi(this.strategyConfig),this.initialPage=null==(s=this.config)?void 0:s.initialPage,this.currentScale=this.coreState.core.scale,this.currentRotation=this.coreState.core.rotation,this.viewport.onViewportChange(e=>this.commitMetrics(this.computeMetrics(e)),{mode:"throttle",wait:250}),this.coreStore.onAction(Dt,(e,t)=>{const i=t.core.pages.length;this.dispatch(function(e){return{type:Ei,payload:e}}(i)),this.pageChange$.emit({pageNumber:this.currentPage,totalPages:i}),this.refreshAll(Gt(t.core),this.viewport.getMetrics())}),this.coreStore.onAction($t,(e,t)=>this.refreshAll(Gt(t.core),this.viewport.getMetrics())),this.coreStore.onAction(jt,(e,t)=>this.refreshAll(Gt(t.core),this.viewport.getMetrics()))}computeLayout(e){const t=this.strategy.createVirtualItems(e);return{virtualItems:t,totalContentSize:this.strategy.getTotalContentSize(t)}}computeMetrics(e,t=this.state.virtualItems){return this.strategy.handleScroll(e,t,this.currentScale)}commit(e,t){this.dispatch(ki(e)),null!=t&&t.layout&&this.layout$.emit(t.layout),null!=t&&t.metrics&&(this.scroll$.emit(t.metrics),t.metrics.currentPage!==this.currentPage&&(this.currentPage=t.metrics.currentPage,this.pageChange$.emit({pageNumber:this.currentPage,totalPages:this.state.totalPages}))),this.scrollerLayout$.emit(this.getScrollerLayoutFromState())}commitMetrics(e){this.commit(e,{metrics:e})}refreshAll(e,t){const i=this.computeLayout(e),r=this.computeMetrics(t,i.virtualItems);this.commit({...i,...r},{layout:i,metrics:r})}getVirtualItemsFromState(){return this.state.virtualItems||[]}getScrollerLayoutFromState(){const e=this.coreState.core.scale;return((e,t)=>({startSpacing:e.startSpacing,endSpacing:e.endSpacing,totalWidth:e.totalContentSize.width*t,totalHeight:e.totalContentSize.height*t,pageGap:e.pageGap*t,strategy:e.strategy,items:e.renderedPageIndexes.map(i=>({...e.virtualItems[i],pageLayouts:e.virtualItems[i].pageLayouts.map(e=>({...e,rotatedWidth:e.rotatedWidth*t,rotatedHeight:e.rotatedHeight*t,width:e.width*t,height:e.height*t}))}))}))(this.state,e)}pushScrollLayout(){this.scrollerLayout$.emit(this.getScrollerLayoutFromState())}onStoreUpdated(e,t){this.pushScrollLayout()}onCoreStoreUpdated(e,t){e.core.scale!==t.core.scale&&(this.currentScale=t.core.scale,this.commitMetrics(this.computeMetrics(this.viewport.getMetrics()))),e.core.rotation!==t.core.rotation&&(this.currentRotation=t.core.rotation)}setScrollStrategy(e){if(e===Si.Horizontal&&this.strategy instanceof Ii||e===Si.Vertical&&this.strategy instanceof xi)return;this.strategy=e===Si.Horizontal?new Ii(this.strategyConfig):new xi(this.strategyConfig),this.dispatch(ki({strategy:e}));const t=Gt(this.coreState.core);this.refreshAll(t,this.viewport.getMetrics())}setLayoutReady(){this.layoutReady||(this.layoutReady=!0,this.layoutReady$.emit(!0))}buildCapability(){return{onStateChange:this.state$.on,onLayoutChange:this.layout$.on,onScroll:this.scroll$.on,onPageChange:this.pageChange$.on,onScrollerData:this.scrollerLayout$.on,onLayoutReady:this.layoutReady$.on,getCurrentPage:()=>this.currentPage,getTotalPages:()=>this.state.totalPages,scrollToPage:e=>{const{pageNumber:t,behavior:i="smooth",pageCoordinates:r,center:o=!1}=e,n=this.getVirtualItemsFromState(),s=this.strategy.getScrollPositionForPage(t,n,this.currentScale,this.currentRotation,r);s&&this.viewport.scrollTo({...s,behavior:i,center:o})},scrollToNextPage:(e="smooth")=>{const t=this.getVirtualItemsFromState(),i=t.findIndex(e=>e.pageNumbers.includes(this.currentPage));if(i>=0&&i<t.length-1){const r=t[i+1],o=this.strategy.getScrollPositionForPage(r.pageNumbers[0],t,this.currentScale,this.currentRotation);o&&this.viewport.scrollTo({...o,behavior:e})}},scrollToPreviousPage:(e="smooth")=>{const t=this.getVirtualItemsFromState(),i=t.findIndex(e=>e.pageNumbers.includes(this.currentPage));if(i>0){const r=t[i-1],o=this.strategy.getScrollPositionForPage(r.pageNumbers[0],t,this.currentScale,this.currentRotation);o&&this.viewport.scrollTo({...o,behavior:e})}},getMetrics:this.getMetrics.bind(this),getLayout:this.getLayout.bind(this),getRectPositionForPage:this.getRectPositionForPage.bind(this),getPageGap:()=>this.state.pageGap,getScrollerLayout:()=>this.getScrollerLayoutFromState(),setScrollStrategy:e=>this.setScrollStrategy(e)}}getMetrics(e){const t=e||this.viewport.getMetrics(),i=this.getVirtualItemsFromState();return this.strategy.handleScroll(t,i,this.currentScale)}getLayout(){return{virtualItems:this.state.virtualItems,totalContentSize:this.state.totalContentSize}}getRectPositionForPage(e,t,i,r){return this.strategy.getRectPositionForPage(e+1,this.state.virtualItems,i??this.currentScale,r??this.currentRotation,t)}async initialize(){}async destroy(){this.layout$.clear(),this.scroll$.clear(),this.pageChange$.clear(),this.state$.clear(),this.scrollerLayout$.clear(),this.layoutReady$.clear(),super.destroy()}};Pi.id="scroll";let Mi=Pi;const Ti="scroll",Ri={currentPage:1,visiblePages:[],pageVisibilityMetrics:[],renderedPageIndexes:[],scrollOffset:{x:0,y:0},startSpacing:0,endSpacing:0},_i={manifest:{id:Ti,name:"Scroll Plugin",version:"1.0.0",provides:["scroll"],requires:["viewport"],optional:[],defaultConfig:{enabled:!0,pageGap:10}},create:(e,t,i)=>new Mi(Ti,e,i),reducer:(e,t)=>{switch(t.type){case Ei:return{...e,totalPages:t.payload};case Ht:return{...e,scale:t.payload};case Ai:return{...e,...t.payload};case"SET_DESIRED_SCROLL_POSITION":return{...e,desiredScrollPosition:t.payload};default:return e}},initialState:(e,t)=>((e,t)=>({virtualItems:[],totalPages:e.pages.length,totalContentSize:{width:0,height:0},desiredScrollPosition:{x:0,y:0},strategy:t.strategy??Si.Vertical,pageGap:t.pageGap??10,scale:e.scale,...Ri}))(e,t)},Ni=()=>si(Mi.id);function Oi({renderPage:e,overlayElements:t,...i}){const{provides:r}=Ni(),{plugin:o}=ni(Mi.id),{registry:n}=oi(),[s,a]=ke(()=>(null==r?void 0:r.getScrollerLayout())??null);if(Pe(()=>{if(r)return r.onScrollerData(a)},[r]),Pe(()=>{o&&o.setLayoutReady()},[o]),!s||!n)return null;const l=n.getStore().getState();return he("div",{...i,style:{width:`${s.totalWidth}px`,height:`${s.totalHeight}px`,position:"relative",boxSizing:"border-box",margin:"0 auto",...s.strategy===Si.Horizontal&&{display:"flex",flexDirection:"row"}},children:[he("div",{style:{...s.strategy===Si.Horizontal?{width:s.startSpacing,height:"100%",flexShrink:0}:{height:s.startSpacing,width:"100%"}}}),he("div",{style:{gap:s.pageGap,display:"flex",alignItems:"center",position:"relative",boxSizing:"border-box",...s.strategy===Si.Horizontal?{flexDirection:"row",minHeight:"100%"}:{flexDirection:"column",minWidth:"fit-content"}},children:s.items.map(t=>he("div",{style:{display:"flex",justifyContent:"center",gap:s.pageGap},children:t.pageLayouts.map(t=>he("div",{style:{width:`${t.rotatedWidth}px`,height:`${t.rotatedHeight}px`},children:e({...t,rotation:l.core.rotation,scale:l.core.scale,document:l.core.document})},t.pageNumber))},t.pageNumbers[0]))}),he("div",{style:{...s.strategy===Si.Horizontal?{width:s.endSpacing,height:"100%",flexShrink:0}:{height:s.endSpacing,width:"100%"}}}),t]})}var zi=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${zi.join("")}]`,"g");var Li=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);Li.reduce((e,t)=>(e[t.id]=t,e),{}),Li.reduce((e,t)=>(e[t.css]=t.id,e),{}),Li.map(e=>({value:e.id,label:e.label}));var Di=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});Object.entries(Di).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var Fi=e=>({type:"SET_PAGES",payload:e}),Hi=class{constructor(e,t){if(this.id=e,this.registry=t,this.debouncedActions={},this.unsubscribeFromState=null,this.unsubscribeFromCoreStore=null,e!==this.constructor.id)throw new Error(`Plugin ID mismatch: ${e} !== ${this.constructor.id}`);this.coreStore=this.registry.getStore(),this.pluginStore=this.coreStore.getPluginStore(this.id),this.unsubscribeFromState=this.pluginStore.subscribeToState((e,t,i)=>{this.onStoreUpdated(i,t)}),this.unsubscribeFromCoreStore=this.coreStore.subscribe((e,t,i)=>{this.onCoreStoreUpdated(i,t)}),this.readyPromise=new Promise(e=>{this.readyResolve=e}),this.readyResolve()}provides(){if(!this._capability){const e=this.buildCapability();this._capability=Object.freeze(e)}return this._capability}get state(){return this.pluginStore.getState()}get coreState(){return this.coreStore.getState()}getState(){return this.pluginStore.getState()}getCoreState(){return this.coreStore.getState()}dispatchCoreAction(e){return this.coreStore.dispatchToCore(e)}dispatchToAllPlugins(e){return this.coreStore.dispatch(e)}dispatch(e){return this.pluginStore.dispatch(e)}debouncedDispatch(e,t=100){const i=Date.now();return i-(this.debouncedActions[e.type]||0)>=t&&(this.debouncedActions[e.type]=i,this.dispatch(e),!0)}subscribe(e){return this.pluginStore.subscribeToState(e)}subscribeToCoreStore(e){return this.coreStore.subscribe(e)}onStoreUpdated(e,t){}onCoreStoreUpdated(e,t){}destroy(){this.unsubscribeFromState&&(this.unsubscribeFromState(),this.unsubscribeFromState=null),this.unsubscribeFromCoreStore&&(this.unsubscribeFromCoreStore(),this.unsubscribeFromCoreStore=null)}ready(){return this.readyPromise}markReady(){this.readyResolve()}resetReady(){this.readyPromise=new Promise(e=>{this.readyResolve=e})}};var $i=(e=>(e.None="none",e.Odd="odd",e.Even="even",e))($i||{}),ji="SET_SPREAD_MODE";function Ui(e){return{type:ji,payload:e}}var Bi=class extends Hi{constructor(e,t,i){super(e,t),this.spreadEmitter$=function(){const e=new Set;return{emit:(t=void 0)=>e.forEach(e=>e(t)),on:t=>(e.add(t),()=>e.delete(t)),off:t=>e.delete(t),clear:()=>e.clear()}}(),this.resetReady(),this.dispatch(Ui(i.defaultSpreadMode??"none"));t.getPlugin("loader").provides().onDocumentLoaded(e=>this.documentLoaded(e))}async initialize(e){e.defaultSpreadMode&&this.dispatch(Ui(e.defaultSpreadMode))}documentLoaded(e){this.dispatchCoreAction(Fi(this.getSpreadPagesObjects(e.pages))),this.markReady()}getSpreadPagesObjects(e){if(!e.length)return[];switch(this.state.spreadMode){case"none":default:return e.map(e=>[e]);case"odd":return Array.from({length:Math.ceil(e.length/2)},(t,i)=>e.slice(2*i,2*i+2));case"even":return[[e[0]],...Array.from({length:Math.ceil((e.length-1)/2)},(t,i)=>e.slice(1+2*i,1+2*i+2))]}}setSpreadMode(e){const t=this.state.spreadMode,i=this.coreState.core.document;if(!i)throw new Error("Document not loaded");t!==e&&(this.dispatch(Ui(e)),this.dispatchCoreAction(Fi(this.getSpreadPagesObjects(i.pages))),this.notifySpreadChange(e))}notifySpreadChange(e){this.spreadEmitter$.emit(e)}buildCapability(){return{onSpreadChange:this.spreadEmitter$.on,setSpreadMode:e=>this.setSpreadMode(e),getSpreadMode:()=>this.state.spreadMode,getSpreadPagesObjects:e=>this.getSpreadPagesObjects(e)}}async destroy(){this.spreadEmitter$.clear()}};Bi.id="spread";var Gi="spread",Vi={spreadMode:"none"},Wi={manifest:{id:Gi,name:"Spread Plugin",version:"1.0.0",provides:["spread"],requires:["loader"],optional:[],defaultConfig:{enabled:!0}},create:(e,t,i)=>new Bi(Gi,e,i),reducer:(e=Vi,t)=>t.type===ji?{...e,spreadMode:t.payload}:e,initialState:Vi};let Zi=class{async load(e){const{pdfFile:t,options:i,engine:r}=e,o=r.openDocumentUrl(t,i);return new Promise((e,t)=>{o.wait(t=>e(t),e=>{"abort"===e.type?t(new Error(`PDF loading aborted: ${e.reason}`)):t(new Error(`PDF loading failed: ${e.reason}`))})})}},qi=class{async load(e){const{pdfFile:t,options:i,engine:r}=e,o=r.openDocumentFromBuffer(t,(null==i?void 0:i.password)||"");return new Promise((e,t)=>{o.wait(t=>e(t),e=>{"abort"===e.type?t(new Error(`PDF loading aborted: ${e.reason}`)):t(new Error(`PDF loading failed: ${e.reason}`))})})}},Xi=class{constructor(){this.strategies=new Map,this.strategyResolvers=[];const e=new qi;this.registerStrategy("url",new Zi),this.registerStrategy("buffer",e),this.addStrategyResolver(e=>function(e){return"url"===e.type}(e)?this.strategies.get("url"):this.strategies.get("buffer"))}registerStrategy(e,t){this.strategies.set(e,t)}getStrategy(e){return this.strategies.get(e)}addStrategyResolver(e){this.strategyResolvers.push(e)}async loadDocument(e){try{const t=this.resolveStrategy(e);if(!t)throw new Error("No suitable strategy found for the given options");return await t.load(e)}catch(e){throw console.error("Error loading document:",e),e}}resolveStrategy(e){for(const t of this.strategyResolvers){const i=t(e);if(i)return i}}};const Ki=class extends qt{constructor(e,t,i){super(e,t),this.id=e,this.engine=i,this.loaderHandlers$=ti(),this.documentLoadedHandlers$=ti(),this.openFileRequest$=ei(),this.documentLoader=new Xi}buildCapability(){return{onLoaderEvent:this.loaderHandlers$.on,onDocumentLoaded:this.documentLoadedHandlers$.on,onOpenFileRequest:this.openFileRequest$.on,openFileDialog:()=>this.openFileRequest$.emit("open"),loadDocument:e=>this.loadDocument(e),registerStrategy:(e,t)=>this.documentLoader.registerStrategy(e,t),getDocument:()=>this.loadedDocument,addStrategyResolver:e=>this.documentLoader.addStrategyResolver(e)}}async initialize(e){e.defaultStrategies&&Object.entries(e.defaultStrategies).forEach(([e,t])=>{this.documentLoader.registerStrategy(e,t)}),e.loadingOptions&&(this.loadingOptions=e.loadingOptions)}async postInitialize(){this.loadingOptions&&await this.loadDocument(this.loadingOptions)}async loadDocument(e){try{this.loaderHandlers$.emit({type:"start",documentId:e.pdfFile.id}),this.dispatchCoreAction({type:Lt});const t=await this.documentLoader.loadDocument({...e,engine:this.engine});return this.dispatchCoreAction((e=>({type:Dt,payload:e}))(t)),this.loadedDocument=t,this.loaderHandlers$.emit({type:"complete",documentId:e.pdfFile.id}),this.documentLoadedHandlers$.emit(t),t}catch(t){const i={type:"error",documentId:e.pdfFile.id,error:t instanceof Error?t:new Error(String(t))};throw this.loaderHandlers$.emit(i),t}}async destroy(){this.loaderHandlers$.clear(),this.documentLoadedHandlers$.clear(),this.openFileRequest$.clear(),super.destroy()}};Ki.id="loader";let Yi=Ki;const Qi="loader",Ji={manifest:{id:Qi,name:"Loader Plugin",version:"1.0.0",provides:["loader"],requires:[],optional:[],metadata:{name:"Loader Plugin",description:"A plugin for loading PDF documents",version:"1.0.0",author:"EmbedPDF",license:"MIT"},defaultConfig:{enabled:!0}},create:(e,t)=>new Yi(Qi,e,t),reducer:()=>{},initialState:{}};function er(){const{provides:e}=si(Yi.id),t=Te(null);return Pe(()=>e?e.onOpenFileRequest(e=>{"open"===e&&t.current&&t.current.click()}):void 0,[e]),he(B,{children:he("input",{ref:t,type:"file",accept:"application/pdf",style:{display:"none"},onChange:async t=>{var i;const r=null==(i=t.currentTarget.files)?void 0:i[0];r&&e&&await e.loadDocument({type:"buffer",pdfFile:{id:Math.random().toString(36).substring(2,15),content:await r.arrayBuffer()}})}})})}var tr=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${tr.join("")}]`,"g");var ir=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);ir.reduce((e,t)=>(e[t.id]=t,e),{}),ir.reduce((e,t)=>(e[t.css]=t.id,e),{}),ir.map(e=>({value:e.id,label:e.label}));var rr=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});Object.entries(rr).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var or=class{constructor(e,t){if(this.id=e,this.registry=t,this.debouncedActions={},this.unsubscribeFromState=null,this.unsubscribeFromCoreStore=null,e!==this.constructor.id)throw new Error(`Plugin ID mismatch: ${e} !== ${this.constructor.id}`);this.coreStore=this.registry.getStore(),this.pluginStore=this.coreStore.getPluginStore(this.id),this.unsubscribeFromState=this.pluginStore.subscribeToState((e,t,i)=>{this.onStoreUpdated(i,t)}),this.unsubscribeFromCoreStore=this.coreStore.subscribe((e,t,i)=>{this.onCoreStoreUpdated(i,t)}),this.readyPromise=new Promise(e=>{this.readyResolve=e}),this.readyResolve()}provides(){if(!this._capability){const e=this.buildCapability();this._capability=Object.freeze(e)}return this._capability}get state(){return this.pluginStore.getState()}get coreState(){return this.coreStore.getState()}getState(){return this.pluginStore.getState()}getCoreState(){return this.coreStore.getState()}dispatchCoreAction(e){return this.coreStore.dispatchToCore(e)}dispatchToAllPlugins(e){return this.coreStore.dispatch(e)}dispatch(e){return this.pluginStore.dispatch(e)}debouncedDispatch(e,t=100){const i=Date.now();return i-(this.debouncedActions[e.type]||0)>=t&&(this.debouncedActions[e.type]=i,this.dispatch(e),!0)}subscribe(e){return this.pluginStore.subscribeToState(e)}subscribeToCoreStore(e){return this.coreStore.subscribe(e)}onStoreUpdated(e,t){}onCoreStoreUpdated(e,t){}destroy(){this.unsubscribeFromState&&(this.unsubscribeFromState(),this.unsubscribeFromState=null),this.unsubscribeFromCoreStore&&(this.unsubscribeFromCoreStore(),this.unsubscribeFromCoreStore=null)}ready(){return this.readyPromise}markReady(){this.readyResolve()}resetReady(){this.readyPromise=new Promise(e=>{this.readyResolve=e})}};function nr(e,t,i){if(e===t)return!0;if(null==e||null==t)return e===t;const r=typeof e;if(r!==typeof t)return!1;if("object"===r){i||(i=new Set);const r=function(e,t){return`${lr(e)}__${lr(t)}`}(e,t);if(i.has(r))return!0;i.add(r);const o=Array.isArray(e),n=Array.isArray(t);return o&&n?function(e,t,i){if(e.length!==t.length)return!1;const r=new Array(t.length).fill(!1);e:for(let o=0;o<e.length;o++){const n=e[o];for(let e=0;e<t.length;e++)if(!r[e]&&nr(n,t[e],i)){r[e]=!0;continue e}return!1}return!0}(e,t,i):!o&&!n&&function(e,t,i){const r=Object.keys(e).sort(),o=Object.keys(t).sort();if(r.length!==o.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!==o[e])return!1;for(const o of r){if(!nr(e[o],t[o],i))return!1}return!0}(e,t,i)}return!1}var sr=0,ar=new WeakMap;function lr(e){return ar.has(e)||ar.set(e,++sr),ar.get(e)}var cr=class{constructor(e,t){this.children=[],this.updateCallbacks=[],this.hadUpdateBeforeListeners=!1,this.componentConfig=e;const i=e.props||{};if("function"==typeof i){const t=i(e.initialState);this.props={...t,id:e.id}}else this.props={...i,id:e.id};this.type=e.type,this.registry=t}addChild(e,t,i=0,r){this.children.push({id:e,component:t,priority:i,className:r}),this.sortChildren()}sortChildren(){this.children.sort((e,t)=>e.priority-t.priority)}removeChild(e){this.children=this.children.filter(t=>t.component!==e)}clearChildren(){this.children=[]}get getRenderType(){return this.componentConfig.render||this.type}getRenderer(){return this.registry[this.getRenderType]}getChildren(){return this.children}getChildContext(e){const t=this.componentConfig.getChildContext;return"function"==typeof t?{...e,...t(this.props)}:t&&"object"==typeof t?{...e,...t}:e}update(e){const{id:t,...i}=e;this.props={...this.props,...i},0===this.updateCallbacks.length&&(this.hadUpdateBeforeListeners=!0),this.notifyUpdate()}onUpdate(e){return this.updateCallbacks.push(e),this.hadUpdateBeforeListeners}offUpdate(e){this.updateCallbacks=this.updateCallbacks.filter(t=>t!==e)}notifyUpdate(){this.updateCallbacks.forEach(e=>e())}},dr="UI_INIT_COMPONENTS",ur="UI_SET_HEADER_VISIBLE",hr="UI_TOGGLE_PANEL",pr="UI_SHOW_COMMAND_MENU",gr="UI_HIDE_COMMAND_MENU",fr="UI_UPDATE_COMPONENT_STATE",mr=e=>({type:gr,payload:e}),br={panel:{},header:{},groupedItems:{},divider:{},iconButton:{},tabButton:{},selectButton:{},custom:{},floating:{},commandMenu:{}};function vr(e,t){const i=e=>"function"==typeof e?e(t):e;return"group"===e.type?{...e,label:i(e.label)??""}:{...e,icon:i(e.icon)??"",label:i(e.label)??"",visible:i(e.visible)??!0,active:i(e.active)??!1,disabled:i(e.disabled)??!1}}function yr(e,t){const i=vr(e,t);return"group"!==i.type&&!!i.active}function wr(e,t){const i=vr(e,t);return"group"!==i.type&&!!i.disabled}var Sr=class e{constructor(e={},t){this.registry={},this.shortcutMap={},this.eventController=function(){const e=new Map;return{emit(t,i){const r=e.get(t);r&&r.forEach(e=>e(i))},on(t,i){return e.has(t)||e.set(t,new Set),e.get(t).add(i),()=>this.off(t,i)},off(t,i){const r=e.get(t);r&&(r.delete(i),0===r.size&&e.delete(t))}}}(),this.pluginRegistry=t,this.registerItems(e),this.setupKeyboardListeners()}get state(){return this.pluginRegistry.getStore().getState()}registerItem(e){this.registry[e.id]&&console.warn(`Menu item with ID ${e.id} already exists and will be overwritten`),this.registry[e.id]=e,"shortcut"in e&&e.shortcut&&(this.shortcutMap[this.normalizeShortcut(e.shortcut)]=e.id)}registerItems(e){Object.values(e).forEach(e=>{this.registerItem(e)})}resolve(e){return vr(this.registry[e],this.state)}getMenuItem(e){const t=this.resolve(e);if(t)return{item:t,isGroup:"group"===t.type,isMenu:"menu"===t.type,isAction:"action"===t.type}}getAction(e){const t=this.getMenuItem(e);if(t&&t.isAction)return t.item}getMenuOrAction(e){const t=this.getMenuItem(e);if(t)return t.item}getAllItems(){return{...this.registry}}getItemsByIds(e){return e.map(e=>this.resolve(e)).filter(e=>void 0!==e)}getChildItems(e,t={}){const i=this.resolve(e);if(!i||!("children"in i)||!i.children?.length)return[];const r=this.getItemsByIds(i.children);if(!t.flatten)return r;const o=[];for(const e of r)if("group"===e.type)o.push(e);else if("menu"===e.type){const t=this.getChildItems(e.id,{flatten:!0});o.push(...t)}else o.push(e);return o}executeCommand(t,i={}){const r=this.getMenuItem(t);if(!r)return void console.warn(`Menu item '${t}' not found`);if("group"===r.item.type)return void console.warn(`Cannot execute group '${t}'`);const{item:o}=r;o.disabled?console.warn(`Menu item '${t}' is disabled`):r.isAction?(o.action(this.pluginRegistry,this.state),this.eventController.emit(e.EVENTS.COMMAND_EXECUTED,{command:o,source:i.source||"api"})):"children"in o&&o.children?.length&&this.handleSubmenu(o,i)}executeShortcut(t){const i=this.normalizeShortcut(t),r=this.shortcutMap[i];return!!r&&(this.executeCommand(r,{source:"shortcut"}),this.eventController.emit(e.EVENTS.SHORTCUT_EXECUTED,{shortcut:i,itemId:r}),!0)}on(e,t){return this.eventController.on(e,t)}off(e,t){this.eventController.off(e,t)}handleSubmenu(t,i){this.eventController.emit(e.EVENTS.MENU_REQUESTED,{menuId:t.id,triggerElement:i.triggerElement,position:i.position,flatten:i.flatten||!1})}setupKeyboardListeners(){if("undefined"==typeof window)return;document.addEventListener("keydown",e=>{const t=e.target;if("INPUT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable)return;const i=this.buildShortcutString(e);i&&this.executeShortcut(i)&&e.preventDefault()})}buildShortcutString(e){const t=[];e.ctrlKey&&t.push("Ctrl"),e.shiftKey&&t.push("Shift"),e.altKey&&t.push("Alt"),e.metaKey&&t.push("Meta");const i=e.key;if(!["Control","Shift","Alt","Meta"].includes(i)){const e=1===i.length?i.toUpperCase():i;return[...t,e].join("+")}return null}normalizeShortcut(e){return e.split("+").map(e=>e.trim()).join("+")}capabilities(){return{registerItem:this.registerItem.bind(this),registerItems:this.registerItems.bind(this),executeCommand:this.executeCommand.bind(this),getAction:this.getAction.bind(this),getMenuOrAction:this.getMenuOrAction.bind(this),getChildItems:this.getChildItems.bind(this),getItemsByIds:this.getItemsByIds.bind(this),getAllItems:this.getAllItems.bind(this)}}};Sr.EVENTS={COMMAND_EXECUTED:"menu:command_executed",MENU_REQUESTED:"menu:requested",SHORTCUT_EXECUTED:"menu:shortcut_executed"};var Cr=Sr,xr=class{constructor(e){this.icons={},this.registerIcons(e)}registerIcon(e){this.icons[e.id]&&console.warn(`Icon with ID ${e.id} already exists and will be overwritten`),this.icons[e.id]=e}registerIcons(e){Array.isArray(e)?e.forEach(e=>this.registerIcon(e)):Object.entries(e).forEach(([e,t])=>this.registerIcon(t))}getAllIcons(){return{...this.icons}}getIcon(e){return this.icons[e]}isSvgString(e){return e.trim().startsWith("<svg")&&e.includes("</svg>")}isSvgDataUri(e){return e.startsWith("data:image/svg+xml;base64,")}getSvgString(e){return this.isSvgString(e)?e:this.isSvgDataUri(e)?this.dataUriToSvgString(e):this.getIcon(e)?.svg}dataUriToSvgString(e){const t=e.substring(26);return atob(t)}svgStringToDataUri(e){return`data:image/svg+xml;base64,${btoa(e)}`}capabilities(){return{registerIcon:this.registerIcon.bind(this),registerIcons:this.registerIcons.bind(this),getIcon:this.getIcon.bind(this),getAllIcons:this.getAllIcons.bind(this),getSvgString:this.getSvgString.bind(this),isSvgString:this.isSvgString.bind(this),isSvgDataUri:this.isSvgDataUri.bind(this),dataUriToSvgString:this.dataUriToSvgString.bind(this),svgStringToDataUri:this.svgStringToDataUri.bind(this)}}},Ir=class extends or{constructor(e,t,i){super(e,t),this.componentRenderers={},this.components={},this.mapStateCallbacks={},this.globalStoreSubscription=()=>{},this.config=i,this.menuManager=new Cr(i.menuItems||{},this.registry),this.iconManager=new xr(i.icons||[]),this.setupCommandEventHandlers(),this.globalStoreSubscription=this.registry.getStore().subscribe((e,t)=>{this.onGlobalStoreChange(t)})}async initialize(){this.buildComponents(),this.linkGroupedItems(),this.setInitialStateUIComponents()}setupCommandEventHandlers(){this.menuManager.on(Cr.EVENTS.MENU_REQUESTED,e=>{const{menuId:t,triggerElement:i,position:r,flatten:o}=e;if(this.state.commandMenu.commandMenu?.activeCommand===t)return this.dispatch(mr({id:"commandMenu"}));this.dispatch({type:pr,payload:{id:"commandMenu",commandId:t,triggerElement:i,position:r,flatten:o}})}),this.menuManager.on(Cr.EVENTS.COMMAND_EXECUTED,e=>{console.log("Command executed:",e.command.id,"source:",e.source)})}addComponent(e,t){this.components[e]&&console.warn(`Component with ID ${e} already exists and will be overwritten`);const i=new cr(t,this.componentRenderers);return this.components[e]=i,"function"==typeof t.mapStateToProps&&(this.mapStateCallbacks[e]=t.mapStateToProps),i}buildComponents(){Object.entries(this.config.components).forEach(([e,t])=>{this.addComponent(e,t)})}linkGroupedItems(){Object.values(this.components).forEach(e=>{if(Ar(e)){const t=e.componentConfig;t.slots?.forEach(i=>{const r=this.components[i.componentId];r?e.addChild(i.componentId,r,i.priority,i.className):console.warn(`Child component ${i.componentId} not found for GroupedItems ${t.id}`)})}})}setInitialStateUIComponents(){const e=br;Object.entries(this.config.components).forEach(([t,i])=>{i.initialState?e[i.type][t]=i.initialState:e[i.type][t]={}}),this.dispatch({type:dr,payload:e})}onGlobalStoreChange(e){for(const[t,i]of Object.entries(this.components)){const r=this.mapStateCallbacks[t];if(!r)continue;const{id:o,...n}=i.props,s=r(e,n);nr(n,{...n,...s})||i.update(s)}}addSlot(e,t,i,r){const o=this.components[e];if(!o)return void console.error(`Parent component ${e} not found`);if(!Ar(o))return void console.error(`Parent component ${e} does not support slots`);const n=this.components[t];if(!n)return void console.error(`Child component ${t} not found`);const s=o.getChildren();let a=i;if(void 0===a){a=(s.length>0?Math.max(...s.map(e=>e.priority)):0)+10}o.addChild(t,n,a,r)}buildCapability(){return{registerComponentRenderer:(e,t)=>{this.componentRenderers[e]=t},getComponent:e=>this.components[e],registerComponent:this.addComponent.bind(this),getCommandMenu:()=>Object.values(this.components).find(e=>function(e){return"commandMenu"===e.type}(e)),hideCommandMenu:()=>this.debouncedDispatch(mr({id:"commandMenu"}),100),getFloatingComponents:e=>Object.values(this.components).filter(e=>Pr(e)).filter(t=>!e||t.props.scrollerPosition===e),getHeadersByPlacement:e=>Object.values(this.components).filter(e=>Er(e)).filter(t=>t.props.placement===e),getPanelsByLocation:e=>Object.values(this.components).filter(e=>kr(e)).filter(t=>t.props.location===e),addSlot:this.addSlot.bind(this),togglePanel:e=>{this.dispatch((e=>({type:hr,payload:e}))(e))},setHeaderVisible:e=>{this.dispatch((e=>({type:ur,payload:e}))(e))},updateComponentState:e=>{this.dispatch((e=>({type:fr,payload:e}))(e))},...this.iconManager.capabilities(),...this.menuManager.capabilities()}}async destroy(){this.globalStoreSubscription(),this.components={},this.componentRenderers={},this.mapStateCallbacks={}}};function Ar(e){return function(e){return"groupedItems"===e.type}(e)||Er(e)||kr(e)||Pr(e)||function(e){return"custom"===e.type}(e)}function Er(e){return"header"===e.type}function kr(e){return"panel"===e.type}function Pr(e){return"floating"===e.type}Ir.id="ui";var Mr="ui",Tr={manifest:{id:Mr,name:"UI Plugin",version:"1.0.0",provides:["ui"],requires:[],optional:[],defaultConfig:{enabled:!0,components:{}}},create:(e,t,i)=>new Ir(Mr,e,i),reducer:(e=br,t)=>{switch(t.type){case dr:return{...e,...t.payload};case hr:{const i=e.panel[t.payload.id]||{},{open:r,visibleChild:o}=t.payload,n=i.visibleChild;let s=i.open,a=i.visibleChild;return o===n?s=void 0!==r?r:!i.open:(a=o,s=!0),{...e,panel:{...e.panel,[t.payload.id]:{...i,open:s,visibleChild:a}}}}case ur:return{...e,header:{...e.header,[t.payload.id]:{...e.header[t.payload.id],visible:t.payload.visible,visibleChild:t.payload.visibleChild}}};case pr:return{...e,commandMenu:{...e.commandMenu,[t.payload.id]:{activeCommand:t.payload.commandId,triggerElement:t.payload.triggerElement,position:t.payload.position,open:!0,flatten:t.payload.flatten}}};case gr:return{...e,commandMenu:{...e.commandMenu,[t.payload.id]:{...e.commandMenu[t.payload.id],open:!1,activeCommand:null,triggerElement:void 0,position:void 0,flatten:!1}}};case fr:{const{componentType:i,componentId:r,patch:o}=t.payload;if(!e[i]||!e[i][r])return e;const n=e[i][r],s=Object.fromEntries(Object.entries(o).filter(([e])=>e in n));return 0===Object.keys(s).length?e:{...e,[i]:{...e[i],[r]:{...n,...s}}}}default:return e}},initialState:br},Rr=["id","children","onClick","active","disabled","className","tooltip","ref"];function _r(e){var t=e.id,i=e.children,r=e.onClick,o=e.active,n=void 0!==o&&o,s=e.disabled,a=void 0!==s&&s,l=e.className,c=void 0===l?"":l,d=e.tooltip,u=e.ref,h=g(e,Rr);return j("button",p({id:t,ref:u,onClick:r,className:"flex h-[32px] w-auto min-w-[32px] items-center justify-center rounded-md p-[5px] transition-colors ".concat(n?"border-none bg-blue-50 text-blue-500 shadow ring ring-blue-500":"hover:bg-gray-100 hover:ring hover:ring-[#1a466b]"," ").concat(a?"cursor-not-allowed opacity-50 hover:bg-transparent hover:ring-0":"cursor-pointer"," ").concat(c," "),title:d},h),i)}const Nr=Math.min,Or=Math.max,zr=Math.round,Lr=Math.floor,Dr=e=>({x:e,y:e}),Fr={left:"right",right:"left",bottom:"top",top:"bottom"},Hr={start:"end",end:"start"};function $r(e,t,i){return Or(e,Nr(t,i))}function jr(e,t){return"function"==typeof e?e(t):e}function Ur(e){return e.split("-")[0]}function Br(e){return e.split("-")[1]}function Gr(e){return"x"===e?"y":"x"}function Vr(e){return"y"===e?"height":"width"}const Wr=new Set(["top","bottom"]);function Zr(e){return Wr.has(Ur(e))?"y":"x"}function qr(e){return Gr(Zr(e))}function Xr(e){return e.replace(/start|end/g,e=>Hr[e])}const Kr=["left","right"],Yr=["right","left"],Qr=["top","bottom"],Jr=["bottom","top"];function eo(e,t,i,r){const o=Br(e);let n=function(e,t,i){switch(e){case"top":case"bottom":return i?t?Yr:Kr:t?Kr:Yr;case"left":case"right":return t?Qr:Jr;default:return[]}}(Ur(e),"start"===i,r);return o&&(n=n.map(e=>e+"-"+o),t&&(n=n.concat(n.map(Xr)))),n}function to(e){return e.replace(/left|right|bottom|top/g,e=>Fr[e])}function io(e){return"number"!=typeof e?function(e){return{top:0,right:0,bottom:0,left:0,...e}}(e):{top:e,right:e,bottom:e,left:e}}function ro(e){const{x:t,y:i,width:r,height:o}=e;return{width:r,height:o,top:i,left:t,right:t+r,bottom:i+o,x:t,y:i}}function oo(e,t,i){let{reference:r,floating:o}=e;const n=Zr(t),s=qr(t),a=Vr(s),l=Ur(t),c="y"===n,d=r.x+r.width/2-o.width/2,u=r.y+r.height/2-o.height/2,h=r[a]/2-o[a]/2;let p;switch(l){case"top":p={x:d,y:r.y-o.height};break;case"bottom":p={x:d,y:r.y+r.height};break;case"right":p={x:r.x+r.width,y:u};break;case"left":p={x:r.x-o.width,y:u};break;default:p={x:r.x,y:r.y}}switch(Br(t)){case"start":p[s]-=h*(i&&c?-1:1);break;case"end":p[s]+=h*(i&&c?-1:1)}return p}async function no(e,t){var i;void 0===t&&(t={});const{x:r,y:o,platform:n,rects:s,elements:a,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:d="viewport",elementContext:u="floating",altBoundary:h=!1,padding:p=0}=jr(t,e),g=io(p),f=a[h?"floating"===u?"reference":"floating":u],m=ro(await n.getClippingRect({element:null==(i=await(null==n.isElement?void 0:n.isElement(f)))||i?f:f.contextElement||await(null==n.getDocumentElement?void 0:n.getDocumentElement(a.floating)),boundary:c,rootBoundary:d,strategy:l})),b="floating"===u?{x:r,y:o,width:s.floating.width,height:s.floating.height}:s.reference,v=await(null==n.getOffsetParent?void 0:n.getOffsetParent(a.floating)),y=await(null==n.isElement?void 0:n.isElement(v))&&await(null==n.getScale?void 0:n.getScale(v))||{x:1,y:1},w=ro(n.convertOffsetParentRelativeRectToViewportRelativeRect?await n.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:b,offsetParent:v,strategy:l}):b);return{top:(m.top-w.top+g.top)/y.y,bottom:(w.bottom-m.bottom+g.bottom)/y.y,left:(m.left-w.left+g.left)/y.x,right:(w.right-m.right+g.right)/y.x}}const so=new Set(["left","top"]);function ao(){return"undefined"!=typeof window}function lo(e){return ho(e)?(e.nodeName||"").toLowerCase():"#document"}function co(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function uo(e){var t;return null==(t=(ho(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function ho(e){return!!ao()&&(e instanceof Node||e instanceof co(e).Node)}function po(e){return!!ao()&&(e instanceof Element||e instanceof co(e).Element)}function go(e){return!!ao()&&(e instanceof HTMLElement||e instanceof co(e).HTMLElement)}function fo(e){return!(!ao()||"undefined"==typeof ShadowRoot)&&(e instanceof ShadowRoot||e instanceof co(e).ShadowRoot)}const mo=new Set(["inline","contents"]);function bo(e){const{overflow:t,overflowX:i,overflowY:r,display:o}=Mo(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+i)&&!mo.has(o)}const vo=new Set(["table","td","th"]);function yo(e){return vo.has(lo(e))}const wo=[":popover-open",":modal"];function So(e){return wo.some(t=>{try{return e.matches(t)}catch(e){return!1}})}const Co=["transform","translate","scale","rotate","perspective"],xo=["transform","translate","scale","rotate","perspective","filter"],Io=["paint","layout","strict","content"];function Ao(e){const t=Eo(),i=po(e)?Mo(e):e;return Co.some(e=>!!i[e]&&"none"!==i[e])||!!i.containerType&&"normal"!==i.containerType||!t&&!!i.backdropFilter&&"none"!==i.backdropFilter||!t&&!!i.filter&&"none"!==i.filter||xo.some(e=>(i.willChange||"").includes(e))||Io.some(e=>(i.contain||"").includes(e))}function Eo(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}const ko=new Set(["html","body","#document"]);function Po(e){return ko.has(lo(e))}function Mo(e){return co(e).getComputedStyle(e)}function To(e){return po(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Ro(e){if("html"===lo(e))return e;const t=e.assignedSlot||e.parentNode||fo(e)&&e.host||uo(e);return fo(t)?t.host:t}function _o(e){const t=Ro(e);return Po(t)?e.ownerDocument?e.ownerDocument.body:e.body:go(t)&&bo(t)?t:_o(t)}function No(e,t,i){var r;void 0===t&&(t=[]),void 0===i&&(i=!0);const o=_o(e),n=o===(null==(r=e.ownerDocument)?void 0:r.body),s=co(o);if(n){const e=Oo(s);return t.concat(s,s.visualViewport||[],bo(o)?o:[],e&&i?No(e):[])}return t.concat(o,No(o,[],i))}function Oo(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function zo(e){const t=Mo(e);let i=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const o=go(e),n=o?e.offsetWidth:i,s=o?e.offsetHeight:r,a=zr(i)!==n||zr(r)!==s;return a&&(i=n,r=s),{width:i,height:r,$:a}}function Lo(e){return po(e)?e:e.contextElement}function Do(e){const t=Lo(e);if(!go(t))return Dr(1);const i=t.getBoundingClientRect(),{width:r,height:o,$:n}=zo(t);let s=(n?zr(i.width):i.width)/r,a=(n?zr(i.height):i.height)/o;return s&&Number.isFinite(s)||(s=1),a&&Number.isFinite(a)||(a=1),{x:s,y:a}}const Fo=Dr(0);function Ho(e){const t=co(e);return Eo()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:Fo}function $o(e,t,i,r){void 0===t&&(t=!1),void 0===i&&(i=!1);const o=e.getBoundingClientRect(),n=Lo(e);let s=Dr(1);t&&(r?po(r)&&(s=Do(r)):s=Do(e));const a=function(e,t,i){return void 0===t&&(t=!1),!(!i||t&&i!==co(e))&&t}(n,i,r)?Ho(n):Dr(0);let l=(o.left+a.x)/s.x,c=(o.top+a.y)/s.y,d=o.width/s.x,u=o.height/s.y;if(n){const e=co(n),t=r&&po(r)?co(r):r;let i=e,o=Oo(i);for(;o&&r&&t!==i;){const e=Do(o),t=o.getBoundingClientRect(),r=Mo(o),n=t.left+(o.clientLeft+parseFloat(r.paddingLeft))*e.x,s=t.top+(o.clientTop+parseFloat(r.paddingTop))*e.y;l*=e.x,c*=e.y,d*=e.x,u*=e.y,l+=n,c+=s,i=co(o),o=Oo(i)}}return ro({width:d,height:u,x:l,y:c})}function jo(e,t){const i=To(e).scrollLeft;return t?t.left+i:$o(uo(e)).left+i}function Uo(e,t,i){void 0===i&&(i=!1);const r=e.getBoundingClientRect();return{x:r.left+t.scrollLeft-(i?0:jo(e,r)),y:r.top+t.scrollTop}}const Bo=new Set(["absolute","fixed"]);function Go(e,t,i){let r;if("viewport"===t)r=function(e,t){const i=co(e),r=uo(e),o=i.visualViewport;let n=r.clientWidth,s=r.clientHeight,a=0,l=0;if(o){n=o.width,s=o.height;const e=Eo();(!e||e&&"fixed"===t)&&(a=o.offsetLeft,l=o.offsetTop)}return{width:n,height:s,x:a,y:l}}(e,i);else if("document"===t)r=function(e){const t=uo(e),i=To(e),r=e.ownerDocument.body,o=Or(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),n=Or(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let s=-i.scrollLeft+jo(e);const a=-i.scrollTop;return"rtl"===Mo(r).direction&&(s+=Or(t.clientWidth,r.clientWidth)-o),{width:o,height:n,x:s,y:a}}(uo(e));else if(po(t))r=function(e,t){const i=$o(e,!0,"fixed"===t),r=i.top+e.clientTop,o=i.left+e.clientLeft,n=go(e)?Do(e):Dr(1);return{width:e.clientWidth*n.x,height:e.clientHeight*n.y,x:o*n.x,y:r*n.y}}(t,i);else{const i=Ho(e);r={x:t.x-i.x,y:t.y-i.y,width:t.width,height:t.height}}return ro(r)}function Vo(e,t){const i=Ro(e);return!(i===t||!po(i)||Po(i))&&("fixed"===Mo(i).position||Vo(i,t))}function Wo(e,t,i){const r=go(t),o=uo(t),n="fixed"===i,s=$o(e,!0,n,t);let a={scrollLeft:0,scrollTop:0};const l=Dr(0);function c(){l.x=jo(o)}if(r||!r&&!n)if(("body"!==lo(t)||bo(o))&&(a=To(t)),r){const e=$o(t,!0,n,t);l.x=e.x+t.clientLeft,l.y=e.y+t.clientTop}else o&&c();n&&!r&&o&&c();const d=!o||r||n?Dr(0):Uo(o,a);return{x:s.left+a.scrollLeft-l.x-d.x,y:s.top+a.scrollTop-l.y-d.y,width:s.width,height:s.height}}function Zo(e){return"static"===Mo(e).position}function qo(e,t){if(!go(e)||"fixed"===Mo(e).position)return null;if(t)return t(e);let i=e.offsetParent;return uo(e)===i&&(i=i.ownerDocument.body),i}function Xo(e,t){const i=co(e);if(So(e))return i;if(!go(e)){let t=Ro(e);for(;t&&!Po(t);){if(po(t)&&!Zo(t))return t;t=Ro(t)}return i}let r=qo(e,t);for(;r&&yo(r)&&Zo(r);)r=qo(r,t);return r&&Po(r)&&Zo(r)&&!Ao(r)?i:r||function(e){let t=Ro(e);for(;go(t)&&!Po(t);){if(Ao(t))return t;if(So(t))return null;t=Ro(t)}return null}(e)||i}const Ko={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{elements:t,rect:i,offsetParent:r,strategy:o}=e;const n="fixed"===o,s=uo(r),a=!!t&&So(t.floating);if(r===s||a&&n)return i;let l={scrollLeft:0,scrollTop:0},c=Dr(1);const d=Dr(0),u=go(r);if((u||!u&&!n)&&(("body"!==lo(r)||bo(s))&&(l=To(r)),go(r))){const e=$o(r);c=Do(r),d.x=e.x+r.clientLeft,d.y=e.y+r.clientTop}const h=!s||u||n?Dr(0):Uo(s,l,!0);return{width:i.width*c.x,height:i.height*c.y,x:i.x*c.x-l.scrollLeft*c.x+d.x+h.x,y:i.y*c.y-l.scrollTop*c.y+d.y+h.y}},getDocumentElement:uo,getClippingRect:function(e){let{element:t,boundary:i,rootBoundary:r,strategy:o}=e;const n=[..."clippingAncestors"===i?So(t)?[]:function(e,t){const i=t.get(e);if(i)return i;let r=No(e,[],!1).filter(e=>po(e)&&"body"!==lo(e)),o=null;const n="fixed"===Mo(e).position;let s=n?Ro(e):e;for(;po(s)&&!Po(s);){const t=Mo(s),i=Ao(s);i||"fixed"!==t.position||(o=null),(n?!i&&!o:!i&&"static"===t.position&&o&&Bo.has(o.position)||bo(s)&&!i&&Vo(e,s))?r=r.filter(e=>e!==s):o=t,s=Ro(s)}return t.set(e,r),r}(t,this._c):[].concat(i),r],s=n[0],a=n.reduce((e,i)=>{const r=Go(t,i,o);return e.top=Or(r.top,e.top),e.right=Nr(r.right,e.right),e.bottom=Nr(r.bottom,e.bottom),e.left=Or(r.left,e.left),e},Go(t,s,o));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}},getOffsetParent:Xo,getElementRects:async function(e){const t=this.getOffsetParent||Xo,i=this.getDimensions,r=await i(e.floating);return{reference:Wo(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){const{width:t,height:i}=zo(e);return{width:t,height:i}},getScale:Do,isElement:po,isRTL:function(e){return"rtl"===Mo(e).direction}};function Yo(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Qo(e,t,i,r){void 0===r&&(r={});const{ancestorScroll:o=!0,ancestorResize:n=!0,elementResize:s="function"==typeof ResizeObserver,layoutShift:a="function"==typeof IntersectionObserver,animationFrame:l=!1}=r,c=Lo(e),d=o||n?[...c?No(c):[],...No(t)]:[];d.forEach(e=>{o&&e.addEventListener("scroll",i,{passive:!0}),n&&e.addEventListener("resize",i)});const u=c&&a?function(e,t){let i,r=null;const o=uo(e);function n(){var e;clearTimeout(i),null==(e=r)||e.disconnect(),r=null}return function s(a,l){void 0===a&&(a=!1),void 0===l&&(l=1),n();const c=e.getBoundingClientRect(),{left:d,top:u,width:h,height:p}=c;if(a||t(),!h||!p)return;const g={rootMargin:-Lr(u)+"px "+-Lr(o.clientWidth-(d+h))+"px "+-Lr(o.clientHeight-(u+p))+"px "+-Lr(d)+"px",threshold:Or(0,Nr(1,l))||1};let f=!0;function m(t){const r=t[0].intersectionRatio;if(r!==l){if(!f)return s();r?s(!1,r):i=setTimeout(()=>{s(!1,1e-7)},1e3)}1!==r||Yo(c,e.getBoundingClientRect())||s(),f=!1}try{r=new IntersectionObserver(m,{...g,root:o.ownerDocument})}catch(e){r=new IntersectionObserver(m,g)}r.observe(e)}(!0),n}(c,i):null;let h,p=-1,g=null;s&&(g=new ResizeObserver(e=>{let[r]=e;r&&r.target===c&&g&&(g.unobserve(t),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var e;null==(e=g)||e.observe(t)})),i()}),c&&!l&&g.observe(c),g.observe(t));let f=l?$o(e):null;return l&&function t(){const r=$o(e);f&&!Yo(f,r)&&i();f=r,h=requestAnimationFrame(t)}(),i(),()=>{var e;d.forEach(e=>{o&&e.removeEventListener("scroll",i),n&&e.removeEventListener("resize",i)}),null==u||u(),null==(e=g)||e.disconnect(),g=null,l&&cancelAnimationFrame(h)}}const Jo=function(e){return void 0===e&&(e=0),{name:"offset",options:e,async fn(t){var i,r;const{x:o,y:n,placement:s,middlewareData:a}=t,l=await async function(e,t){const{placement:i,platform:r,elements:o}=e,n=await(null==r.isRTL?void 0:r.isRTL(o.floating)),s=Ur(i),a=Br(i),l="y"===Zr(i),c=so.has(s)?-1:1,d=n&&l?-1:1,u=jr(t,e);let{mainAxis:h,crossAxis:p,alignmentAxis:g}="number"==typeof u?{mainAxis:u,crossAxis:0,alignmentAxis:null}:{mainAxis:u.mainAxis||0,crossAxis:u.crossAxis||0,alignmentAxis:u.alignmentAxis};return a&&"number"==typeof g&&(p="end"===a?-1*g:g),l?{x:p*d,y:h*c}:{x:h*c,y:p*d}}(t,e);return s===(null==(i=a.offset)?void 0:i.placement)&&null!=(r=a.arrow)&&r.alignmentOffset?{}:{x:o+l.x,y:n+l.y,data:{...l,placement:s}}}}},en=function(e){return void 0===e&&(e={}),{name:"shift",options:e,async fn(t){const{x:i,y:r,placement:o}=t,{mainAxis:n=!0,crossAxis:s=!1,limiter:a={fn:e=>{let{x:t,y:i}=e;return{x:t,y:i}}},...l}=jr(e,t),c={x:i,y:r},d=await no(t,l),u=Zr(Ur(o)),h=Gr(u);let p=c[h],g=c[u];if(n){const e="y"===h?"bottom":"right";p=$r(p+d["y"===h?"top":"left"],p,p-d[e])}if(s){const e="y"===u?"bottom":"right";g=$r(g+d["y"===u?"top":"left"],g,g-d[e])}const f=a.fn({...t,[h]:p,[u]:g});return{...f,data:{x:f.x-i,y:f.y-r,enabled:{[h]:n,[u]:s}}}}}},tn=function(e){return void 0===e&&(e={}),{name:"flip",options:e,async fn(t){var i,r;const{placement:o,middlewareData:n,rects:s,initialPlacement:a,platform:l,elements:c}=t,{mainAxis:d=!0,crossAxis:u=!0,fallbackPlacements:h,fallbackStrategy:p="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:f=!0,...m}=jr(e,t);if(null!=(i=n.arrow)&&i.alignmentOffset)return{};const b=Ur(o),v=Zr(a),y=Ur(a)===a,w=await(null==l.isRTL?void 0:l.isRTL(c.floating)),S=h||(y||!f?[to(a)]:function(e){const t=to(e);return[Xr(e),t,Xr(t)]}(a)),C="none"!==g;!h&&C&&S.push(...eo(a,f,g,w));const x=[a,...S],I=await no(t,m),A=[];let E=(null==(r=n.flip)?void 0:r.overflows)||[];if(d&&A.push(I[b]),u){const e=function(e,t,i){void 0===i&&(i=!1);const r=Br(e),o=qr(e),n=Vr(o);let s="x"===o?r===(i?"end":"start")?"right":"left":"start"===r?"bottom":"top";return t.reference[n]>t.floating[n]&&(s=to(s)),[s,to(s)]}(o,s,w);A.push(I[e[0]],I[e[1]])}if(E=[...E,{placement:o,overflows:A}],!A.every(e=>e<=0)){var k,P;const e=((null==(k=n.flip)?void 0:k.index)||0)+1,t=x[e];if(t){if(!("alignment"===u&&v!==Zr(t))||E.every(e=>e.overflows[0]>0&&Zr(e.placement)===v))return{data:{index:e,overflows:E},reset:{placement:t}}}let i=null==(P=E.filter(e=>e.overflows[0]<=0).sort((e,t)=>e.overflows[1]-t.overflows[1])[0])?void 0:P.placement;if(!i)switch(p){case"bestFit":{var M;const e=null==(M=E.filter(e=>{if(C){const t=Zr(e.placement);return t===v||"y"===t}return!0}).map(e=>[e.placement,e.overflows.filter(e=>e>0).reduce((e,t)=>e+t,0)]).sort((e,t)=>e[1]-t[1])[0])?void 0:M[0];e&&(i=e);break}case"initialPlacement":i=a}if(o!==i)return{reset:{placement:i}}}return{}}}},rn=e=>({name:"arrow",options:e,async fn(t){const{x:i,y:r,placement:o,rects:n,platform:s,elements:a,middlewareData:l}=t,{element:c,padding:d=0}=jr(e,t)||{};if(null==c)return{};const u=io(d),h={x:i,y:r},p=qr(o),g=Vr(p),f=await s.getDimensions(c),m="y"===p,b=m?"top":"left",v=m?"bottom":"right",y=m?"clientHeight":"clientWidth",w=n.reference[g]+n.reference[p]-h[p]-n.floating[g],S=h[p]-n.reference[p],C=await(null==s.getOffsetParent?void 0:s.getOffsetParent(c));let x=C?C[y]:0;x&&await(null==s.isElement?void 0:s.isElement(C))||(x=a.floating[y]||n.floating[g]);const I=w/2-S/2,A=x/2-f[g]/2-1,E=Nr(u[b],A),k=Nr(u[v],A),P=E,M=x-f[g]-k,T=x/2-f[g]/2+I,R=$r(P,T,M),_=!l.arrow&&null!=Br(o)&&T!==R&&n.reference[g]/2-(T<P?E:k)-f[g]/2<0,N=_?T<P?T-P:T-M:0;return{[p]:h[p]+N,data:{[p]:R,centerOffset:T-R-N,..._&&{alignmentOffset:N}},reset:_}}}),on=(e,t,i)=>{const r=new Map,o={platform:Ko,...i},n={...o.platform,_c:r};return(async(e,t,i)=>{const{placement:r="bottom",strategy:o="absolute",middleware:n=[],platform:s}=i,a=n.filter(Boolean),l=await(null==s.isRTL?void 0:s.isRTL(t));let c=await s.getElementRects({reference:e,floating:t,strategy:o}),{x:d,y:u}=oo(c,r,l),h=r,p={},g=0;for(let i=0;i<a.length;i++){const{name:n,fn:f}=a[i],{x:m,y:b,data:v,reset:y}=await f({x:d,y:u,initialPlacement:r,placement:h,strategy:o,middlewareData:p,rects:c,platform:s,elements:{reference:e,floating:t}});d=null!=m?m:d,u=null!=b?b:u,p={...p,[n]:{...p[n],...v}},y&&g<=50&&(g++,"object"==typeof y&&(y.placement&&(h=y.placement),y.rects&&(c=!0===y.rects?await s.getElementRects({reference:e,floating:t,strategy:o}):y.rects),({x:d,y:u}=oo(c,h,l))),i=-1)}return{x:d,y:u,placement:h,strategy:o,middlewareData:p}})(e,t,{...o,platform:n})};var nn=function(){function e(){return o(this,e),r(this,e,arguments)}return d(e,G),s(e,[{key:"render",value:function(){return this.props.children}}])}();function sn(e){var t=e.children,i=e.content,r=e.position,o=void 0===r?"top":r,n=e.className,s=void 0===n?"":n,a=e.delay,c=void 0===a?200:a,d=e.style,u=void 0===d?"dark":d,h=e.trigger,p=void 0===h?"hover":h,g=Te(null),f=Te(null),m=Te(null),b=v(ke(!1),2),y=b[0],w=b[1],S=Te(null);return Pe(function(){var e;if(null!==(e=g.current)&&void 0!==e&&e.base&&f.current)return Qo(g.current.base,f.current,function(){on(g.current.base,f.current,{placement:o,middleware:[Jo(8),tn(),en({padding:8}),rn({element:m.current,padding:6})]}).then(function(e){var t,i=e.x,r=e.y,o=e.placement,n=e.middlewareData;Object.assign(f.current.style,{left:"".concat(i,"px"),top:"".concat(r,"px")});var s=null!==(t=n.arrow)&&void 0!==t?t:{},a=s.x,c=s.y,d={top:"bottom",bottom:"top",left:"right",right:"left"}[o.split("-")[0]];Object.assign(m.current.style,l({left:null!=a?"".concat(a,"px"):"",top:null!=c?"".concat(c,"px"):"",right:"",bottom:""},d,"-4px"))})})},[o,y]),Pe(function(){var e,t=null===(e=g.current)||void 0===e?void 0:e.base,i=f.current;if(t&&i){var r=function(){S.current&&clearTimeout(S.current)},o=function(){r(),S.current=setTimeout(function(){return w(!0)},c)},n=function(){r(),w(!1)},s=function(){return w(function(e){return!e})};return"hover"===p?(t.addEventListener("mouseenter",o),t.addEventListener("mouseleave",n),i.addEventListener("mouseenter",o),i.addEventListener("mouseleave",n),t.addEventListener("pointerdown",n)):"click"===p&&t.addEventListener("click",s),"none"===p&&(S.current&&clearTimeout(S.current),w(!1)),function(){r(),"hover"===p?(t.removeEventListener("mouseenter",o),t.removeEventListener("mouseleave",n),i.removeEventListener("mouseenter",o),i.removeEventListener("mouseleave",n),t.removeEventListener("pointerdown",n)):"click"===p&&t.removeEventListener("click",s)}}},[p,c]),j(B,null,j("div",{ref:f,role:"tooltip",className:"z-100 pointer-events-none absolute select-none whitespace-nowrap rounded-lg px-3 py-2 text-sm shadow-md transition-opacity duration-150 ".concat("dark"===u?"bg-gray-900 text-white":"border border-gray-200 bg-white text-gray-900"," ").concat(y?"opacity-100":"opacity-0"," ").concat(s," "),style:{visibility:y?"visible":"hidden"}},i,j("div",{ref:m,className:"absolute h-2 w-2 rotate-45 bg-inherit ".concat("light"===u?"border border-gray-200":""," ")})),j(nn,{ref:g},t))}function an(e,t){for(var i in e)if("__source"!==i&&!(i in t))return!0;for(var r in t)if("__source"!==r&&e[r]!==t[r])return!0;return!1}function ln(e,t){this.props=e,this.context=t}(ln.prototype=new G).isPureReactComponent=!0,ln.prototype.shouldComponentUpdate=function(e,t){return an(this.props,e)||an(this.state,t)};var cn=I.__b;I.__b=function(e){e.type&&e.type.__f&&e.ref&&(e.props.ref=e.ref,e.ref=null),cn&&cn(e)};var dn=I.__e;I.__e=function(e,t,i,r){if(e.then)for(var o,n=t;n=n.__;)if((o=n.__c)&&o.__c)return null==t.__e&&(t.__e=i.__e,t.__k=i.__k),o.__c(e,t);dn(e,t,i,r)};var un=I.unmount;function hn(e,t,i){return e&&(e.__c&&e.__c.__H&&(e.__c.__H.__.forEach(function(e){"function"==typeof e.__c&&e.__c()}),e.__c.__H=null),null!=(e=function(e,t){for(var i in t)e[i]=t[i];return e}({},e)).__c&&(e.__c.__P===i&&(e.__c.__P=t),e.__c.__e=!0,e.__c=null),e.__k=e.__k&&e.__k.map(function(e){return hn(e,t,i)})),e}function pn(e,t,i){return e&&i&&(e.__v=null,e.__k=e.__k&&e.__k.map(function(e){return pn(e,t,i)}),e.__c&&e.__c.__P===t&&(e.__e&&i.appendChild(e.__e),e.__c.__e=!0,e.__c.__P=i)),e}function gn(){this.__u=0,this.o=null,this.__b=null}function fn(e){var t=e.__.__c;return t&&t.__a&&t.__a(e)}function mn(){this.i=null,this.l=null}I.unmount=function(e){var t=e.__c;t&&t.__R&&t.__R(),t&&32&e.__u&&(e.type=null),un&&un(e)},(gn.prototype=new G).__c=function(e,t){var i=t.__c,r=this;null==r.o&&(r.o=[]),r.o.push(i);var o=fn(r.__v),n=!1,s=function(){n||(n=!0,i.__R=null,o?o(a):a())};i.__R=s;var a=function(){if(! --r.__u){if(r.state.__a){var e=r.state.__a;r.__v.__k[0]=pn(e,e.__c.__P,e.__c.__O)}var t;for(r.setState({__a:r.__b=null});t=r.o.pop();)t.forceUpdate()}};r.__u++||32&t.__u||r.setState({__a:r.__b=r.__v.__k[0]}),e.then(s,s)},gn.prototype.componentWillUnmount=function(){this.o=[]},gn.prototype.render=function(e,t){if(this.__b){if(this.__v.__k){var i=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=hn(this.__b,i,r.__O=r.__P)}this.__b=null}var o=t.__a&&j(B,null,e.fallback);return o&&(o.__u&=-33),[j(B,null,t.__a?null:e.children),o]};var bn=function(e,t,i){if(++i[1]===i[0]&&e.l.delete(t),e.props.revealOrder&&("t"!==e.props.revealOrder[0]||!e.l.size))for(i=e.i;i;){for(;i.length>3;)i.pop()();if(i[1]<i[0])break;e.i=i=i[2]}};(mn.prototype=new G).__a=function(e){var t=this,i=fn(t.__v),r=t.l.get(e);return r[0]++,function(o){var n=function(){t.props.revealOrder?(r.push(o),bn(t,e,r)):o()};i?i(n):n()}},mn.prototype.render=function(e){this.i=null,this.l=new Map;var t=Y(e.children);e.revealOrder&&"b"===e.revealOrder[0]&&t.reverse();for(var i=t.length;i--;)this.l.set(t[i],this.i=[1,0,this.i]);return e.children},mn.prototype.componentDidUpdate=mn.prototype.componentDidMount=function(){var e=this;this.l.forEach(function(t,i){bn(e,i,t)})};var vn="undefined"!=typeof Symbol&&Symbol.for&&Symbol.for("react.element")||60103,yn=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image(!S)|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,wn=/^on(Ani|Tra|Tou|BeforeInp|Compo)/,Sn=/[A-Z0-9]/g,Cn="undefined"!=typeof document,xn=function(e){return("undefined"!=typeof Symbol&&"symbol"==typeof Symbol()?/fil|che|rad/:/fil|che|ra/).test(e)};G.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(e){Object.defineProperty(G.prototype,e,{configurable:!0,get:function(){return this["UNSAFE_"+e]},set:function(t){Object.defineProperty(this,e,{configurable:!0,writable:!0,value:t})}})});var In=I.event;function An(){}function En(){return this.cancelBubble}function kn(){return this.defaultPrevented}I.event=function(e){return In&&(e=In(e)),e.persist=An,e.isPropagationStopped=En,e.isDefaultPrevented=kn,e.nativeEvent=e};var Pn={enumerable:!1,configurable:!0,get:function(){return this.class}},Mn=I.vnode;I.vnode=function(e){"string"==typeof e.type&&function(e){var t=e.props,i=e.type,r={},o=-1===i.indexOf("-");for(var n in t){var s=t[n];if(!("value"===n&&"defaultValue"in t&&null==s||Cn&&"children"===n&&"noscript"===i||"class"===n||"className"===n)){var a=n.toLowerCase();"defaultValue"===n&&"value"in t&&null==t.value?n="value":"download"===n&&!0===s?s="":"translate"===a&&"no"===s?s=!1:"o"===a[0]&&"n"===a[1]?"ondoubleclick"===a?n="ondblclick":"onchange"!==a||"input"!==i&&"textarea"!==i||xn(t.type)?"onfocus"===a?n="onfocusin":"onblur"===a?n="onfocusout":wn.test(n)&&(n=a):a=n="oninput":o&&yn.test(n)?n=n.replace(Sn,"-$&").toLowerCase():null===s&&(s=void 0),"oninput"===a&&r[n=a]&&(n="oninputCapture"),r[n]=s}}"select"==i&&r.multiple&&Array.isArray(r.value)&&(r.value=Y(t.children).forEach(function(e){e.props.selected=-1!=r.value.indexOf(e.props.value)})),"select"==i&&null!=r.defaultValue&&(r.value=Y(t.children).forEach(function(e){e.props.selected=r.multiple?-1!=r.defaultValue.indexOf(e.props.value):r.defaultValue==e.props.value})),t.class&&!t.className?(r.class=t.class,Object.defineProperty(r,"className",Pn)):(t.className&&!t.class||t.class&&t.className)&&(r.class=r.className=t.className),e.props=r}(e),e.$$typeof=vn,Mn&&Mn(e)};var Tn=I.__r;I.__r=function(e){Tn&&Tn(e),e.__c};var Rn=I.diffed;I.diffed=function(e){Rn&&Rn(e);var t=e.props,i=e.__e;null!=i&&"textarea"===e.type&&"value"in t&&t.value!==i.value&&(i.value=null==t.value?"":t.value)};var _n=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${_n.join("")}]`,"g");var Nn=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);Nn.reduce((e,t)=>(e[t.id]=t,e),{}),Nn.reduce((e,t)=>(e[t.css]=t.id,e),{}),Nn.map(e=>({value:e.id,label:e.label}));var On=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});Object.entries(On).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var zn=ce({registry:null,isInitializing:!0,pluginsReady:!1});function Ln(e){const{registry:t}=function(){const e=Ne(zn);if(void 0===e)throw new Error("useCapability must be used within a PDFContext.Provider");const{registry:t,isInitializing:i}=e;if(i)return e;if(null===t)throw new Error("PDF registry failed to initialize properly");return e}();if(null===t)return{plugin:null,isLoading:!0,ready:new Promise(()=>{})};const i=t.getPlugin(e);if(!i)throw new Error(`Plugin ${e} not found`);return{plugin:i,isLoading:!1,ready:i.ready()}}var Dn=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${Dn.join("")}]`,"g");var Fn=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);Fn.reduce((e,t)=>(e[t.id]=t,e),{}),Fn.reduce((e,t)=>(e[t.css]=t.id,e),{}),Fn.map(e=>({value:e.id,label:e.label}));var Hn=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});Object.entries(Hn).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var $n=class{constructor(e,t){if(this.id=e,this.registry=t,this.debouncedActions={},this.unsubscribeFromState=null,this.unsubscribeFromCoreStore=null,e!==this.constructor.id)throw new Error(`Plugin ID mismatch: ${e} !== ${this.constructor.id}`);this.coreStore=this.registry.getStore(),this.pluginStore=this.coreStore.getPluginStore(this.id),this.unsubscribeFromState=this.pluginStore.subscribeToState((e,t,i)=>{this.onStoreUpdated(i,t)}),this.unsubscribeFromCoreStore=this.coreStore.subscribe((e,t,i)=>{this.onCoreStoreUpdated(i,t)}),this.readyPromise=new Promise(e=>{this.readyResolve=e}),this.readyResolve()}provides(){if(!this._capability){const e=this.buildCapability();this._capability=Object.freeze(e)}return this._capability}get state(){return this.pluginStore.getState()}get coreState(){return this.coreStore.getState()}getState(){return this.pluginStore.getState()}getCoreState(){return this.coreStore.getState()}dispatchCoreAction(e){return this.coreStore.dispatchToCore(e)}dispatchToAllPlugins(e){return this.coreStore.dispatch(e)}dispatch(e){return this.pluginStore.dispatch(e)}debouncedDispatch(e,t=100){const i=Date.now();return i-(this.debouncedActions[e.type]||0)>=t&&(this.debouncedActions[e.type]=i,this.dispatch(e),!0)}subscribe(e){return this.pluginStore.subscribeToState(e)}subscribeToCoreStore(e){return this.coreStore.subscribe(e)}onStoreUpdated(e,t){}onCoreStoreUpdated(e,t){}destroy(){this.unsubscribeFromState&&(this.unsubscribeFromState(),this.unsubscribeFromState=null),this.unsubscribeFromCoreStore&&(this.unsubscribeFromCoreStore(),this.unsubscribeFromCoreStore=null)}ready(){return this.readyPromise}markReady(){this.readyResolve()}resetReady(){this.readyPromise=new Promise(e=>{this.readyResolve=e})}};function jn(e,t,i){if(e===t)return!0;if(null==e||null==t)return e===t;const r=typeof e;if(r!==typeof t)return!1;if("object"===r){i||(i=new Set);const r=function(e,t){return`${Gn(e)}__${Gn(t)}`}(e,t);if(i.has(r))return!0;i.add(r);const o=Array.isArray(e),n=Array.isArray(t);return o&&n?function(e,t,i){if(e.length!==t.length)return!1;const r=new Array(t.length).fill(!1);e:for(let o=0;o<e.length;o++){const n=e[o];for(let e=0;e<t.length;e++)if(!r[e]&&jn(n,t[e],i)){r[e]=!0;continue e}return!1}return!0}(e,t,i):!o&&!n&&function(e,t,i){const r=Object.keys(e).sort(),o=Object.keys(t).sort();if(r.length!==o.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!==o[e])return!1;for(const o of r){if(!jn(e[o],t[o],i))return!1}return!0}(e,t,i)}return!1}var Un=0,Bn=new WeakMap;function Gn(e){return Bn.has(e)||Bn.set(e,++Un),Bn.get(e)}var Vn=class{constructor(e,t){this.children=[],this.updateCallbacks=[],this.hadUpdateBeforeListeners=!1,this.componentConfig=e;const i=e.props||{};if("function"==typeof i){const t=i(e.initialState);this.props={...t,id:e.id}}else this.props={...i,id:e.id};this.type=e.type,this.registry=t}addChild(e,t,i=0,r){this.children.push({id:e,component:t,priority:i,className:r}),this.sortChildren()}sortChildren(){this.children.sort((e,t)=>e.priority-t.priority)}removeChild(e){this.children=this.children.filter(t=>t.component!==e)}clearChildren(){this.children=[]}get getRenderType(){return this.componentConfig.render||this.type}getRenderer(){return this.registry[this.getRenderType]}getChildren(){return this.children}getChildContext(e){const t=this.componentConfig.getChildContext;return"function"==typeof t?{...e,...t(this.props)}:t&&"object"==typeof t?{...e,...t}:e}update(e){const{id:t,...i}=e;this.props={...this.props,...i},0===this.updateCallbacks.length&&(this.hadUpdateBeforeListeners=!0),this.notifyUpdate()}onUpdate(e){return this.updateCallbacks.push(e),this.hadUpdateBeforeListeners}offUpdate(e){this.updateCallbacks=this.updateCallbacks.filter(t=>t!==e)}notifyUpdate(){this.updateCallbacks.forEach(e=>e())}},Wn=e=>({type:"UI_HIDE_COMMAND_MENU",payload:e}),Zn={panel:{},header:{},groupedItems:{},divider:{},iconButton:{},tabButton:{},selectButton:{},custom:{},floating:{},commandMenu:{}};var qn=class e{constructor(e={},t){this.registry={},this.shortcutMap={},this.eventController=function(){const e=new Map;return{emit(t,i){const r=e.get(t);r&&r.forEach(e=>e(i))},on(t,i){return e.has(t)||e.set(t,new Set),e.get(t).add(i),()=>this.off(t,i)},off(t,i){const r=e.get(t);r&&(r.delete(i),0===r.size&&e.delete(t))}}}(),this.pluginRegistry=t,this.registerItems(e),this.setupKeyboardListeners()}get state(){return this.pluginRegistry.getStore().getState()}registerItem(e){this.registry[e.id]&&console.warn(`Menu item with ID ${e.id} already exists and will be overwritten`),this.registry[e.id]=e,"shortcut"in e&&e.shortcut&&(this.shortcutMap[this.normalizeShortcut(e.shortcut)]=e.id)}registerItems(e){Object.values(e).forEach(e=>{this.registerItem(e)})}resolve(e){return function(e,t){const i=e=>"function"==typeof e?e(t):e;return"group"===e.type?{...e,label:i(e.label)??""}:{...e,icon:i(e.icon)??"",label:i(e.label)??"",visible:i(e.visible)??!0,active:i(e.active)??!1,disabled:i(e.disabled)??!1}}(this.registry[e],this.state)}getMenuItem(e){const t=this.resolve(e);if(t)return{item:t,isGroup:"group"===t.type,isMenu:"menu"===t.type,isAction:"action"===t.type}}getAction(e){const t=this.getMenuItem(e);if(t&&t.isAction)return t.item}getMenuOrAction(e){const t=this.getMenuItem(e);if(t)return t.item}getAllItems(){return{...this.registry}}getItemsByIds(e){return e.map(e=>this.resolve(e)).filter(e=>void 0!==e)}getChildItems(e,t={}){const i=this.resolve(e);if(!i||!("children"in i)||!i.children?.length)return[];const r=this.getItemsByIds(i.children);if(!t.flatten)return r;const o=[];for(const e of r)if("group"===e.type)o.push(e);else if("menu"===e.type){const t=this.getChildItems(e.id,{flatten:!0});o.push(...t)}else o.push(e);return o}executeCommand(t,i={}){const r=this.getMenuItem(t);if(!r)return void console.warn(`Menu item '${t}' not found`);if("group"===r.item.type)return void console.warn(`Cannot execute group '${t}'`);const{item:o}=r;o.disabled?console.warn(`Menu item '${t}' is disabled`):r.isAction?(o.action(this.pluginRegistry,this.state),this.eventController.emit(e.EVENTS.COMMAND_EXECUTED,{command:o,source:i.source||"api"})):"children"in o&&o.children?.length&&this.handleSubmenu(o,i)}executeShortcut(t){const i=this.normalizeShortcut(t),r=this.shortcutMap[i];return!!r&&(this.executeCommand(r,{source:"shortcut"}),this.eventController.emit(e.EVENTS.SHORTCUT_EXECUTED,{shortcut:i,itemId:r}),!0)}on(e,t){return this.eventController.on(e,t)}off(e,t){this.eventController.off(e,t)}handleSubmenu(t,i){this.eventController.emit(e.EVENTS.MENU_REQUESTED,{menuId:t.id,triggerElement:i.triggerElement,position:i.position,flatten:i.flatten||!1})}setupKeyboardListeners(){if("undefined"==typeof window)return;document.addEventListener("keydown",e=>{const t=e.target;if("INPUT"===t.tagName||"TEXTAREA"===t.tagName||t.isContentEditable)return;const i=this.buildShortcutString(e);i&&this.executeShortcut(i)&&e.preventDefault()})}buildShortcutString(e){const t=[];e.ctrlKey&&t.push("Ctrl"),e.shiftKey&&t.push("Shift"),e.altKey&&t.push("Alt"),e.metaKey&&t.push("Meta");const i=e.key;if(!["Control","Shift","Alt","Meta"].includes(i)){const e=1===i.length?i.toUpperCase():i;return[...t,e].join("+")}return null}normalizeShortcut(e){return e.split("+").map(e=>e.trim()).join("+")}capabilities(){return{registerItem:this.registerItem.bind(this),registerItems:this.registerItems.bind(this),executeCommand:this.executeCommand.bind(this),getAction:this.getAction.bind(this),getMenuOrAction:this.getMenuOrAction.bind(this),getChildItems:this.getChildItems.bind(this),getItemsByIds:this.getItemsByIds.bind(this),getAllItems:this.getAllItems.bind(this)}}};qn.EVENTS={COMMAND_EXECUTED:"menu:command_executed",MENU_REQUESTED:"menu:requested",SHORTCUT_EXECUTED:"menu:shortcut_executed"};var Xn=qn,Kn=class{constructor(e){this.icons={},this.registerIcons(e)}registerIcon(e){this.icons[e.id]&&console.warn(`Icon with ID ${e.id} already exists and will be overwritten`),this.icons[e.id]=e}registerIcons(e){Array.isArray(e)?e.forEach(e=>this.registerIcon(e)):Object.entries(e).forEach(([e,t])=>this.registerIcon(t))}getAllIcons(){return{...this.icons}}getIcon(e){return this.icons[e]}isSvgString(e){return e.trim().startsWith("<svg")&&e.includes("</svg>")}isSvgDataUri(e){return e.startsWith("data:image/svg+xml;base64,")}getSvgString(e){return this.isSvgString(e)?e:this.isSvgDataUri(e)?this.dataUriToSvgString(e):this.getIcon(e)?.svg}dataUriToSvgString(e){const t=e.substring(26);return atob(t)}svgStringToDataUri(e){return`data:image/svg+xml;base64,${btoa(e)}`}capabilities(){return{registerIcon:this.registerIcon.bind(this),registerIcons:this.registerIcons.bind(this),getIcon:this.getIcon.bind(this),getAllIcons:this.getAllIcons.bind(this),getSvgString:this.getSvgString.bind(this),isSvgString:this.isSvgString.bind(this),isSvgDataUri:this.isSvgDataUri.bind(this),dataUriToSvgString:this.dataUriToSvgString.bind(this),svgStringToDataUri:this.svgStringToDataUri.bind(this)}}},Yn=class extends $n{constructor(e,t,i){super(e,t),this.componentRenderers={},this.components={},this.mapStateCallbacks={},this.globalStoreSubscription=()=>{},this.config=i,this.menuManager=new Xn(i.menuItems||{},this.registry),this.iconManager=new Kn(i.icons||[]),this.setupCommandEventHandlers(),this.globalStoreSubscription=this.registry.getStore().subscribe((e,t)=>{this.onGlobalStoreChange(t)})}async initialize(){this.buildComponents(),this.linkGroupedItems(),this.setInitialStateUIComponents()}setupCommandEventHandlers(){this.menuManager.on(Xn.EVENTS.MENU_REQUESTED,e=>{const{menuId:t,triggerElement:i,position:r,flatten:o}=e;if(this.state.commandMenu.commandMenu?.activeCommand===t)return this.dispatch(Wn({id:"commandMenu"}));this.dispatch({type:"UI_SHOW_COMMAND_MENU",payload:{id:"commandMenu",commandId:t,triggerElement:i,position:r,flatten:o}})}),this.menuManager.on(Xn.EVENTS.COMMAND_EXECUTED,e=>{console.log("Command executed:",e.command.id,"source:",e.source)})}addComponent(e,t){this.components[e]&&console.warn(`Component with ID ${e} already exists and will be overwritten`);const i=new Vn(t,this.componentRenderers);return this.components[e]=i,"function"==typeof t.mapStateToProps&&(this.mapStateCallbacks[e]=t.mapStateToProps),i}buildComponents(){Object.entries(this.config.components).forEach(([e,t])=>{this.addComponent(e,t)})}linkGroupedItems(){Object.values(this.components).forEach(e=>{if(Qn(e)){const t=e.componentConfig;t.slots?.forEach(i=>{const r=this.components[i.componentId];r?e.addChild(i.componentId,r,i.priority,i.className):console.warn(`Child component ${i.componentId} not found for GroupedItems ${t.id}`)})}})}setInitialStateUIComponents(){const e=Zn;Object.entries(this.config.components).forEach(([t,i])=>{i.initialState?e[i.type][t]=i.initialState:e[i.type][t]={}}),this.dispatch({type:"UI_INIT_COMPONENTS",payload:e})}onGlobalStoreChange(e){for(const[t,i]of Object.entries(this.components)){const r=this.mapStateCallbacks[t];if(!r)continue;const{id:o,...n}=i.props,s=r(e,n);jn(n,{...n,...s})||i.update(s)}}addSlot(e,t,i,r){const o=this.components[e];if(!o)return void console.error(`Parent component ${e} not found`);if(!Qn(o))return void console.error(`Parent component ${e} does not support slots`);const n=this.components[t];if(!n)return void console.error(`Child component ${t} not found`);const s=o.getChildren();let a=i;if(void 0===a){a=(s.length>0?Math.max(...s.map(e=>e.priority)):0)+10}o.addChild(t,n,a,r)}buildCapability(){return{registerComponentRenderer:(e,t)=>{this.componentRenderers[e]=t},getComponent:e=>this.components[e],registerComponent:this.addComponent.bind(this),getCommandMenu:()=>Object.values(this.components).find(e=>function(e){return"commandMenu"===e.type}(e)),hideCommandMenu:()=>this.debouncedDispatch(Wn({id:"commandMenu"}),100),getFloatingComponents:e=>Object.values(this.components).filter(e=>ts(e)).filter(t=>!e||t.props.scrollerPosition===e),getHeadersByPlacement:e=>Object.values(this.components).filter(e=>Jn(e)).filter(t=>t.props.placement===e),getPanelsByLocation:e=>Object.values(this.components).filter(e=>es(e)).filter(t=>t.props.location===e),addSlot:this.addSlot.bind(this),togglePanel:e=>{this.dispatch((e=>({type:"UI_TOGGLE_PANEL",payload:e}))(e))},setHeaderVisible:e=>{this.dispatch((e=>({type:"UI_SET_HEADER_VISIBLE",payload:e}))(e))},updateComponentState:e=>{this.dispatch((e=>({type:"UI_UPDATE_COMPONENT_STATE",payload:e}))(e))},...this.iconManager.capabilities(),...this.menuManager.capabilities()}}async destroy(){this.globalStoreSubscription(),this.components={},this.componentRenderers={},this.mapStateCallbacks={}}};function Qn(e){return function(e){return"groupedItems"===e.type}(e)||Jn(e)||es(e)||ts(e)||function(e){return"custom"===e.type}(e)}function Jn(e){return"header"===e.type}function es(e){return"panel"===e.type}function ts(e){return"floating"===e.type}Yn.id="ui";var is=()=>function(e){const{plugin:t,isLoading:i,ready:r}=Ln(e);if(!t)return{provides:null,isLoading:i,ready:r};if(!t.provides)throw new Error(`Plugin ${e} does not provide a capability`);return{provides:t.provides(),isLoading:i,ready:r}}(Yn.id);function rs({component:e,parentContext:t={}}){const[i,r]=ke({});Pe(()=>{const t=()=>r({});return e.onUpdate(t)&&r({}),()=>e.offUpdate(t)},[e]);const o=e.getChildContext(t),n=e.getRenderer();if(!n)throw new Error(`No renderer for type: ${e.getRenderType}`);return n(e.props,function(t){const i=t?.context?{...o,...t.context}:o;return e.getChildren().filter(({id:e})=>!t?.filter||t.filter(e)).map(({component:e,id:t,className:r})=>r?he("div",{className:r,children:he(rs,{component:e,parentContext:i},t)}):he(rs,{component:e,parentContext:i},t))},o)}function os({children:e}){const{provides:t}=is(),i=e=>e.map(e=>he(rs,{component:e},e.props.id));return e({headers:{top:i(t?.getHeadersByPlacement("top")||[]),bottom:i(t?.getHeadersByPlacement("bottom")||[]),left:i(t?.getHeadersByPlacement("left")||[]),right:i(t?.getHeadersByPlacement("right")||[])},panels:{left:i(t?.getPanelsByLocation("left")||[]),right:i(t?.getPanelsByLocation("right")||[])},floating:{insideScroller:i(t?.getFloatingComponents("inside")||[]),outsideScroller:i(t?.getFloatingComponents("outside")||[])},commandMenu:t?.getCommandMenu()?he(rs,{component:t.getCommandMenu()}):null})}function ns(e){var t=e.open,i=e.trigger,r=e.children,o=e.placement,n=void 0===o?"bottom-start":o,s=e.offsetSkidding,a=void 0===s?-2:s,l=e.offsetDistance,c=void 0===l?5:l,d=e.delay,u=void 0===d?0:d,h=e.onShow,g=e.onHide,f=e.className,m=Te(null),b=v(ke({x:0,y:0}),2),y=b[0],w=b[1],S=function(e){return e&&{top:"top-start",bottom:"bottom-start",left:"left-start",right:"right-start"}[e]||e||"bottom-start"}(n);return Pe(function(){var e=i,r=m.current;if(r&&(t?(r.style.display="block",null==h||h()):(u?setTimeout(function(){return r.style.display="none"},u):r.style.display="none",null==g||g()),e&&t)){var o=Qo(e,r,function(){on(e,r,{placement:S,strategy:"absolute",middleware:[Jo({mainAxis:c,crossAxis:a}),tn(),en({padding:8})]}).then(function(e){var t=e.x,i=e.y;w({x:t,y:i})})});return function(){return o()}}},[t,i,n,a,c,u]),Pe(function(){if(t){var e=m.current;if(e){var r=function(t){var r,o,n=null!==(r=null===(o=t.composedPath)||void 0===o?void 0:o.call(t))&&void 0!==r?r:[t.target];i&&n.includes(i)||n.includes(e)||null==g||g()};return window.addEventListener("pointerdown",r,!0),function(){return window.removeEventListener("pointerdown",r,!0)}}}},[t,i,g]),j("div",{ref:m,style:p({},i&&{display:"none",left:"".concat(y.x,"px"),top:"".concat(y.y,"px")}),className:"absolute z-50 min-w-[8rem] divide-y divide-gray-100 rounded-lg border border-[#cfd4da] bg-white shadow-sm transition-opacity duration-150 focus:outline-none ".concat(t?"opacity-100":"opacity-0"," ").concat(!i&&"bottom-0 left-0 right-0"," ").concat(f," ")},j("div",{className:"flex flex-col py-2"},r))}var ss=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${ss.join("")}]`,"g");var as=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);as.reduce((e,t)=>(e[t.id]=t,e),{}),as.reduce((e,t)=>(e[t.css]=t.id,e),{}),as.map(e=>({value:e.id,label:e.label}));var ls=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});Object.entries(ls).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var cs=class{constructor(e,t){if(this.id=e,this.registry=t,this.debouncedActions={},this.unsubscribeFromState=null,this.unsubscribeFromCoreStore=null,e!==this.constructor.id)throw new Error(`Plugin ID mismatch: ${e} !== ${this.constructor.id}`);this.coreStore=this.registry.getStore(),this.pluginStore=this.coreStore.getPluginStore(this.id),this.unsubscribeFromState=this.pluginStore.subscribeToState((e,t,i)=>{this.onStoreUpdated(i,t)}),this.unsubscribeFromCoreStore=this.coreStore.subscribe((e,t,i)=>{this.onCoreStoreUpdated(i,t)}),this.readyPromise=new Promise(e=>{this.readyResolve=e}),this.readyResolve()}provides(){if(!this._capability){const e=this.buildCapability();this._capability=Object.freeze(e)}return this._capability}get state(){return this.pluginStore.getState()}get coreState(){return this.coreStore.getState()}getState(){return this.pluginStore.getState()}getCoreState(){return this.coreStore.getState()}dispatchCoreAction(e){return this.coreStore.dispatchToCore(e)}dispatchToAllPlugins(e){return this.coreStore.dispatch(e)}dispatch(e){return this.pluginStore.dispatch(e)}debouncedDispatch(e,t=100){const i=Date.now();return i-(this.debouncedActions[e.type]||0)>=t&&(this.debouncedActions[e.type]=i,this.dispatch(e),!0)}subscribe(e){return this.pluginStore.subscribeToState(e)}subscribeToCoreStore(e){return this.coreStore.subscribe(e)}onStoreUpdated(e,t){}onCoreStoreUpdated(e,t){}destroy(){this.unsubscribeFromState&&(this.unsubscribeFromState(),this.unsubscribeFromState=null),this.unsubscribeFromCoreStore&&(this.unsubscribeFromCoreStore(),this.unsubscribeFromCoreStore=null)}ready(){return this.readyPromise}markReady(){this.readyResolve()}resetReady(){this.readyPromise=new Promise(e=>{this.readyResolve=e})}},ds=class{constructor(e,t){this.handler=e,this.options=t,this.lastRun=0,this.handle=e=>{"debounce"===this.options.mode?this.debounce(e):this.throttle(e)}}debounce(e){this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.timeoutId=void 0},this.options.wait)}throttle(e){if("debounce"===this.options.mode)return;const t=Date.now(),i=this.options.throttleMode||"leading-trailing";t-this.lastRun>=this.options.wait&&("leading-trailing"===i&&this.handler(e),this.lastRun=t),this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.lastRun=Date.now(),this.timeoutId=void 0},this.options.wait-(t-this.lastRun))}destroy(){this.timeoutId&&window.clearTimeout(this.timeoutId)}};function us(e,t,i){if(e===t)return!0;if(null==e||null==t)return e===t;const r=typeof e;if(r!==typeof t)return!1;if("object"===r){i||(i=new Set);const r=function(e,t){return`${gs(e)}__${gs(t)}`}(e,t);if(i.has(r))return!0;i.add(r);const o=Array.isArray(e),n=Array.isArray(t);return o&&n?function(e,t,i){if(e.length!==t.length)return!1;const r=new Array(t.length).fill(!1);e:for(let o=0;o<e.length;o++){const n=e[o];for(let e=0;e<t.length;e++)if(!r[e]&&us(n,t[e],i)){r[e]=!0;continue e}return!1}return!0}(e,t,i):!o&&!n&&function(e,t,i){const r=Object.keys(e).sort(),o=Object.keys(t).sort();if(r.length!==o.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!==o[e])return!1;for(const o of r){if(!us(e[o],t[o],i))return!1}return!0}(e,t,i)}return!1}var hs=0,ps=new WeakMap;function gs(e){return ps.has(e)||ps.set(e,++hs),ps.get(e)}function fs(){const e=new Set;return{emit:(t=void 0)=>e.forEach(e=>e(t)),on:t=>(e.add(t),()=>e.delete(t)),off:t=>e.delete(t),clear:()=>e.clear()}}function ms(e,t=us){const i=new Set,r=new Map;let o=e;const n=(e,t)=>{let n=e,s=()=>{};if(t){const i=new ds(e,t);n=i.handle,s=()=>i.destroy(),r.set(e,{wrapped:n,destroy:s})}return void 0!==o&&n(o),i.add(n),()=>{i.delete(n),s(),r.delete(e)}};return{get value(){return o},emit(e=void 0){(void 0===o||!t(o,e))&&(o=e,(e=>{i.forEach(t=>t(e))})(e))},on:n,off(e){const t=r.get(e);t?(i.delete(t.wrapped),t.destroy(),r.delete(e)):i.delete(e)},clear(){i.clear(),r.forEach(e=>e.destroy()),r.clear()},select:(e,t=us)=>(i,r)=>{let s;if(void 0!==o){const t=e(o);s=t,i(t)}return n(r=>{const o=e(r);(void 0===s||!t(s,o))&&(s=o,i(o))},r)}}}var bs=ce({registry:null,isInitializing:!0,pluginsReady:!1});function vs(e){const{registry:t}=function(){const e=Ne(bs);if(void 0===e)throw new Error("useCapability must be used within a PDFContext.Provider");const{registry:t,isInitializing:i}=e;if(i)return e;if(null===t)throw new Error("PDF registry failed to initialize properly");return e}();if(null===t)return{plugin:null,isLoading:!0,ready:new Promise(()=>{})};const i=t.getPlugin(e);if(!i)throw new Error(`Plugin ${e} not found`);return{plugin:i,isLoading:!1,ready:i.ready()}}function ys(e){const{plugin:t,isLoading:i,ready:r}=vs(e);if(!t)return{provides:null,isLoading:i,ready:r};if(!t.provides)throw new Error(`Plugin ${e} does not provide a capability`);return{provides:t.provides(),isLoading:i,ready:r}}function ws(e){const{width:t,height:i}=e;return{width:i,height:t}}var Ss=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${Ss.join("")}]`,"g");var Cs=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);Cs.reduce((e,t)=>(e[t.id]=t,e),{}),Cs.reduce((e,t)=>(e[t.css]=t.id,e),{}),Cs.map(e=>({value:e.id,label:e.label}));var xs=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});Object.entries(xs).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var Is=class{constructor(e,t){if(this.id=e,this.registry=t,this.debouncedActions={},this.unsubscribeFromState=null,this.unsubscribeFromCoreStore=null,e!==this.constructor.id)throw new Error(`Plugin ID mismatch: ${e} !== ${this.constructor.id}`);this.coreStore=this.registry.getStore(),this.pluginStore=this.coreStore.getPluginStore(this.id),this.unsubscribeFromState=this.pluginStore.subscribeToState((e,t,i)=>{this.onStoreUpdated(i,t)}),this.unsubscribeFromCoreStore=this.coreStore.subscribe((e,t,i)=>{this.onCoreStoreUpdated(i,t)}),this.readyPromise=new Promise(e=>{this.readyResolve=e}),this.readyResolve()}provides(){if(!this._capability){const e=this.buildCapability();this._capability=Object.freeze(e)}return this._capability}get state(){return this.pluginStore.getState()}get coreState(){return this.coreStore.getState()}getState(){return this.pluginStore.getState()}getCoreState(){return this.coreStore.getState()}dispatchCoreAction(e){return this.coreStore.dispatchToCore(e)}dispatchToAllPlugins(e){return this.coreStore.dispatch(e)}dispatch(e){return this.pluginStore.dispatch(e)}debouncedDispatch(e,t=100){const i=Date.now();return i-(this.debouncedActions[e.type]||0)>=t&&(this.debouncedActions[e.type]=i,this.dispatch(e),!0)}subscribe(e){return this.pluginStore.subscribeToState(e)}subscribeToCoreStore(e){return this.coreStore.subscribe(e)}onStoreUpdated(e,t){}onCoreStoreUpdated(e,t){}destroy(){this.unsubscribeFromState&&(this.unsubscribeFromState(),this.unsubscribeFromState=null),this.unsubscribeFromCoreStore&&(this.unsubscribeFromCoreStore(),this.unsubscribeFromCoreStore=null)}ready(){return this.readyPromise}markReady(){this.readyResolve()}resetReady(){this.readyPromise=new Promise(e=>{this.readyResolve=e})}},As=class{constructor(e,t){this.handler=e,this.options=t,this.lastRun=0,this.handle=e=>{"debounce"===this.options.mode?this.debounce(e):this.throttle(e)}}debounce(e){this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.timeoutId=void 0},this.options.wait)}throttle(e){if("debounce"===this.options.mode)return;const t=Date.now(),i=this.options.throttleMode||"leading-trailing";t-this.lastRun>=this.options.wait&&("leading-trailing"===i&&this.handler(e),this.lastRun=t),this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.lastRun=Date.now(),this.timeoutId=void 0},this.options.wait-(t-this.lastRun))}destroy(){this.timeoutId&&window.clearTimeout(this.timeoutId)}};function Es(e,t,i){return e<t?t:e>i?i:e}function ks(e,t,i){if(e===t)return!0;if(null==e||null==t)return e===t;const r=typeof e;if(r!==typeof t)return!1;if("object"===r){i||(i=new Set);const r=function(e,t){return`${Ts(e)}__${Ts(t)}`}(e,t);if(i.has(r))return!0;i.add(r);const o=Array.isArray(e),n=Array.isArray(t);return o&&n?function(e,t,i){if(e.length!==t.length)return!1;const r=new Array(t.length).fill(!1);e:for(let o=0;o<e.length;o++){const n=e[o];for(let e=0;e<t.length;e++)if(!r[e]&&ks(n,t[e],i)){r[e]=!0;continue e}return!1}return!0}(e,t,i):!o&&!n&&function(e,t,i){const r=Object.keys(e).sort(),o=Object.keys(t).sort();if(r.length!==o.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!==o[e])return!1;for(const o of r){if(!ks(e[o],t[o],i))return!1}return!0}(e,t,i)}return!1}var Ps=0,Ms=new WeakMap;function Ts(e){return Ms.has(e)||Ms.set(e,++Ps),Ms.get(e)}function Rs(e,t=ks){const i=new Set,r=new Map;let o=e;const n=(e,t)=>{let n=e,s=()=>{};if(t){const i=new As(e,t);n=i.handle,s=()=>i.destroy(),r.set(e,{wrapped:n,destroy:s})}return void 0!==o&&n(o),i.add(n),()=>{i.delete(n),s(),r.delete(e)}};return{get value(){return o},emit(e=void 0){(void 0===o||!t(o,e))&&(o=e,(e=>{i.forEach(t=>t(e))})(e))},on:n,off(e){const t=r.get(e);t?(i.delete(t.wrapped),t.destroy(),r.delete(e)):i.delete(e)},clear(){i.clear(),r.forEach(e=>e.destroy()),r.clear()},select:(e,t=ks)=>(i,r)=>{let s;if(void 0!==o){const t=e(o);s=t,i(t)}return n(r=>{const o=e(r);(void 0===s||!t(s,o))&&(s=o,i(o))},r)}}}var _s=class extends Is{constructor(e,t,i){super(e,t),this.zoom$=function(){const e=new Set;return{emit:(t=void 0)=>e.forEach(e=>e(t)),on:t=>(e.add(t),()=>e.delete(t)),off:t=>e.delete(t),clear:()=>e.clear()}}(),this.state$=Rs(),this.viewportPlugin=t.getPlugin("viewport"),this.viewport=this.viewportPlugin.provides(),this.scroll=t.getPlugin("scroll").provides();const r=t.getPlugin("interaction-manager");this.interactionManager=r?.provides()??null,this.minZoom=i.minZoom??.25,this.maxZoom=i.maxZoom??10,this.zoomStep=i.zoomStep??.1,this.presets=i.presets??[],this.zoomRanges=this.normalizeRanges(i.zoomRanges??[]),this.dispatch({type:"SET_INITIAL_ZOOM_LEVEL",payload:{zoomLevel:i.defaultZoomLevel}}),this.viewport.onViewportResize(()=>this.recalcAuto(1),{mode:"debounce",wait:150}),this.coreStore.onAction("SET_ROTATION",()=>this.recalcAuto(1)),this.coreStore.onAction("SET_PAGES",()=>this.recalcAuto(1)),this.coreStore.onAction("SET_DOCUMENT",()=>this.recalcAuto(1)),this.interactionManager?.registerMode({id:"marqueeZoom",scope:"page",exclusive:!0,cursor:"zoom-in"}),this.resetReady()}buildCapability(){return{onZoomChange:this.zoom$.on,onStateChange:this.state$.on,zoomIn:()=>{const e=this.state.currentZoomLevel;return this.handleRequest({level:e,delta:this.stepFor(e)})},zoomOut:()=>{const e=this.state.currentZoomLevel;return this.handleRequest({level:e,delta:-this.stepFor(e)})},zoomToArea:(e,t)=>this.handleZoomToArea(e,t),requestZoom:(e,t)=>this.handleRequest({level:e,center:t}),requestZoomBy:(e,t)=>{const i=this.state.currentZoomLevel,r=this.toZoom(i+e);return this.handleRequest({level:r,center:t})},enableMarqueeZoom:()=>{this.interactionManager?.activate("marqueeZoom")},disableMarqueeZoom:()=>{this.interactionManager?.activate("default")},toggleMarqueeZoom:()=>{"marqueeZoom"===this.interactionManager?.getActiveMode()?this.interactionManager?.activate("default"):this.interactionManager?.activate("marqueeZoom")},isMarqueeZoomActive:()=>"marqueeZoom"===this.interactionManager?.getActiveMode(),getState:()=>this.state,getPresets:()=>this.presets}}async initialize(){}async destroy(){this.zoom$.clear()}normalizeRanges(e){return[...e].filter(e=>e.step>0&&e.max>e.min).sort((e,t)=>e.min-t.min)}stepFor(e){const t=this.zoomRanges.find(t=>e>=t.min&&e<t.max);return t?t.step:this.zoomStep}toZoom(e){return parseFloat(Es(e,this.minZoom,this.maxZoom).toFixed(2))}handleRequest({level:e,delta:t=0,center:i,focus:r=0,align:o="keep"}){const n=this.viewport.getMetrics(),s=this.state.currentZoomLevel;if(0===n.clientWidth||0===n.clientHeight)return;const a="number"==typeof e?e:this.computeZoomForMode(e,n);if(!1===a)return;const l=Es(a+t,this.minZoom,this.maxZoom),c=Math.floor(100*l)/100,d=i??{vx:n.clientWidth/2,vy:1===r?0:n.clientHeight/2},{desiredScrollLeft:u,desiredScrollTop:h}=this.computeScrollForZoomChange(n,s,c,d,o);isNaN(u)||isNaN(h)||this.viewportPlugin.setViewportScrollMetrics({scrollLeft:u,scrollTop:h}),this.dispatch({type:"SET_ZOOM_LEVEL",payload:{zoomLevel:"number"==typeof e?c:e,currentZoomLevel:c}}),this.dispatchCoreAction((e=>({type:"SET_SCALE",payload:e}))(c)),this.markReady(),this.viewport.scrollTo({x:u,y:h,behavior:"instant"});const p={oldZoom:s,newZoom:c,level:e,center:d,desiredScrollLeft:u,desiredScrollTop:h,viewport:n};this.zoom$.emit(p)}computeZoomForMode(e,t){const i=(e=>e.pages.map(t=>t.map(t=>{return{...t,rotatedSize:(i=t.size,r=e.rotation,o=1,{width:(i=r%2==0?i:ws(i)).width*o,height:i.height*o})};var i,r,o})))(this.coreState.core);if(!i.length)return!1;const r=this.scroll.getPageGap(),o=this.viewport.getViewportGap();if(0===t.clientWidth||0===t.clientHeight)return!1;const n=t.clientWidth-2*o,s=t.clientHeight-2*o;if(n<=0||s<=0)return!1;let a=0,l=0;switch(i.forEach(e=>{const t=e.reduce((e,t,i)=>e+t.rotatedSize.width+(i?r:0),0),i=Math.max(...e.map(e=>e.rotatedSize.height));a=Math.max(a,t),l=Math.max(l,i)}),e){case"fit-width":return n/a;case"fit-page":return Math.min(n/a,s/l);case"automatic":return Math.min(n/a,1);default:return 1}}computeScrollForZoomChange(e,t,i,r,o="keep"){const n=this.scroll.getLayout(),s=this.viewport.getViewportGap(),a=n.totalContentSize.width,l=n.totalContentSize.height,c=e.clientWidth-2*s,d=e.clientHeight-2*s,u=(e,t,i)=>t*i<e?(e-t*i)/2:0,h=u(c,a,t),p=u(d,l,t),g=u(c,a,i),f=u(d,l,i),m=(e.scrollLeft+r.vx-s-h)/t*i+s+g,b=(e.scrollTop+r.vy-s-p)/t*i+s+f,v="center"===o?m-e.clientWidth/2:m-r.vx,y="center"===o?b-e.clientHeight/2:b-r.vy;return{desiredScrollLeft:Math.max(0,v),desiredScrollTop:Math.max(0,y)}}handleZoomToArea(e,t){const i=this.coreState.core.rotation,r=this.viewport.getMetrics(),o=this.viewport.getViewportGap(),n=this.state.currentZoomLevel,s=r.clientWidth-2*o,a=r.clientHeight-2*o,l=this.scroll.getLayout(),c=l.virtualItems.find(t=>t.pageLayouts.some(t=>t.pageIndex===e));if(!c)return;const d=c.pageLayouts.find(t=>t.pageIndex===e),u=function(e,t,i){let r=t.origin.x,o=t.origin.y,n=t.size;switch(i){case 0:break;case 1:r=e.height-t.origin.y-t.size.height,o=t.origin.x,n=ws(t.size);break;case 2:r=e.width-t.origin.x-t.size.width,o=e.height-t.origin.y-t.size.height;break;case 3:r=t.origin.y,o=e.width-t.origin.x-t.size.width,n=ws(t.size)}return{origin:{x:r,y:o},size:{width:n.width,height:n.height}}}({width:d.width,height:d.height},t,i),h=this.toZoom(Math.min(s/u.size.width,a/u.size.height)),p=c.x+d.x,g=c.y+d.y,f=p+u.origin.x+u.size.width/2,m=g+u.origin.y+u.size.height/2,b=(e,t,i)=>t*i<e?(e-t*i)/2:0,v=b(s,l.totalContentSize.width,n),y=b(a,l.totalContentSize.height,n),w=o+v+f*n-r.scrollLeft,S=o+y+m*n-r.scrollTop;this.handleRequest({level:h,center:{vx:w,vy:S},align:"center"})}recalcAuto(e){const t=this.state;"automatic"!==t.zoomLevel&&"fit-page"!==t.zoomLevel&&"fit-width"!==t.zoomLevel||this.handleRequest({level:t.zoomLevel,focus:e})}onStoreUpdated(e,t){this.state$.emit(t)}};_s.id="zoom";var Ns=()=>ys(_s.id);function Os(){const{provides:e}=ys("viewport"),{provides:t}=Ns(),i=Te(null);return Pe(()=>{const r=i.current;if(!r||!e||!t)return;if("undefined"==typeof window)return;let o,n=0,s={x:0,y:0};const a=()=>{r.style.transform="none",r.style.transformOrigin="0 0"},l=i=>{n=t.getState().currentZoomLevel;const o=e.getBoundingRect();s={x:i.center.x-o.origin.x,y:i.center.y-o.origin.y};const a=r.getBoundingClientRect();r.style.transformOrigin=`${i.center.x-a.left}px ${i.center.y-a.top}px`,i.srcEvent?.cancelable&&(i.srcEvent.preventDefault(),i.srcEvent.stopPropagation())},c=e=>{var t;t=e.scale,r.style.transform=`scale(${t})`,e.srcEvent?.cancelable&&(e.srcEvent.preventDefault(),e.srcEvent.stopPropagation())},d=e=>{const i=(e.scale-1)*n;t.requestZoomBy(i,{vx:s.x,vy:s.y}),a(),n=0};return(async()=>{try{const e=(await import("./hammer-90700eb1.js").then(function(e){return e.h})).default,t=(()=>{const t="ontouchstart"in window||navigator.maxTouchPoints>0;return t&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent)?e.TouchInput:t?e.TouchMouseInput:e.MouseInput})();o=new e(r,{touchAction:"pan-x pan-y",inputClass:t}),o.get("pinch").set({enable:!0,pointers:2,threshold:.1}),o.on("pinchstart",l),o.on("pinchmove",c),o.on("pinchend",d)}catch(e){console.warn("Failed to load HammerJS:",e)}})(),()=>{o?.destroy(),a()}},[e,t]),{elementRef:i}}function zs({children:e,style:t,...i}){const{elementRef:r}=Os();return he("div",{ref:r,...i,style:{...t,display:"block",width:"fit-content",overflow:"visible",boxSizing:"border-box",margin:"0px auto"},children:e})}var Ls=class extends cs{constructor(e,t){super(e,t),this.modes=new Map,this.cursorClaims=new Map,this.buckets=new Map,this.alwaysGlobal=new Set,this.alwaysPage=new Map,this.onModeChange$=fs(),this.onHandlerChange$=fs(),this.onCursorChange$=fs(),this.onStateChange$=ms(),this.registerMode({id:"default",scope:"page",exclusive:!1,cursor:"auto"})}async initialize(e){}buildCapability(){return{activate:e=>this.activate(e),onModeChange:this.onModeChange$.on,onCursorChange:this.onCursorChange$.on,onHandlerChange:this.onHandlerChange$.on,onStateChange:this.onStateChange$.on,getActiveMode:()=>this.state.activeMode,getActiveInteractionMode:()=>this.getActiveInteractionMode(),finish:()=>this.activate("default"),registerMode:e=>this.registerMode(e),registerHandlers:e=>this.registerHandlers(e),registerAlways:e=>this.registerAlways(e),setCursor:(e,t,i=0)=>this.setCursor(e,t,i),removeCursor:e=>this.removeCursor(e),getCurrentCursor:()=>this.state.cursor,getHandlersForScope:e=>this.getHandlersForScope(e),activeModeIsExclusive:()=>this.activeModeIsExclusive(),pause:()=>this.dispatch({type:"INTERACTION/PAUSE"}),resume:()=>this.dispatch({type:"INTERACTION/RESUME"}),isPaused:()=>this.state.paused}}activate(e){if(!this.modes.has(e))throw new Error(`[interaction] unknown mode '${e}'`);if(e===this.state.activeMode)return;const t=this.state.activeMode;this.cursorClaims.clear(),this.notifyHandlersInactive(t),this.dispatch((e=>({type:"INTERACTION/ACTIVATE_MODE",payload:{mode:e}}))(e)),this.emitCursor(),this.notifyHandlersActive(e),this.onModeChange$.emit({...this.state,activeMode:e})}notifyHandlersActive(e){this.alwaysGlobal.forEach(t=>{var i;null==(i=t.onHandlerActiveStart)||i.call(t,e)}),this.alwaysPage.forEach(t=>{t.forEach(t=>{var i;null==(i=t.onHandlerActiveStart)||i.call(t,e)})});const t=this.modes.get(e);if(!t)return;const i=this.buckets.get(e);i&&("global"===t.scope&&i.global.forEach(t=>{var i;null==(i=t.onHandlerActiveStart)||i.call(t,e)}),"page"===t.scope&&i.page.forEach((t,i)=>{t.forEach(t=>{var i;null==(i=t.onHandlerActiveStart)||i.call(t,e)})}))}notifyHandlersInactive(e){this.alwaysGlobal.forEach(t=>{var i;null==(i=t.onHandlerActiveEnd)||i.call(t,e)}),this.alwaysPage.forEach(t=>{t.forEach(t=>{var i;null==(i=t.onHandlerActiveEnd)||i.call(t,e)})});const t=this.modes.get(e);if(!t)return;const i=this.buckets.get(e);i&&("global"===t.scope&&i.global.forEach(t=>{var i;null==(i=t.onHandlerActiveEnd)||i.call(t,e)}),"page"===t.scope&&i.page.forEach((t,i)=>{t.forEach(t=>{var i;null==(i=t.onHandlerActiveEnd)||i.call(t,e)})}))}registerMode(e){this.modes.set(e.id,e),this.buckets.has(e.id)||this.buckets.set(e.id,{global:new Set,page:new Map})}registerHandlers({modeId:e,handlers:t,pageIndex:i}){const r=Array.isArray(e)?e:[e],o=[];for(const e of r){const r=this.buckets.get(e);if(!r)throw new Error(`unknown mode '${e}'`);if(null==i)r.global.add(t);else{const e=r.page.get(i)??new Set;e.add(t),r.page.set(i,e)}o.push(()=>{if(null==i)r.global.delete(t);else{const e=r.page.get(i);e&&(e.delete(t),0===e.size&&r.page.delete(i))}})}return this.onHandlerChange$.emit({...this.state}),()=>{o.forEach(e=>e()),this.onHandlerChange$.emit({...this.state})}}registerAlways({scope:e,handlers:t}){if("global"===e.type)return this.alwaysGlobal.add(t),this.onHandlerChange$.emit({...this.state}),()=>this.alwaysGlobal.delete(t);const i=this.alwaysPage.get(e.pageIndex)??new Set;return i.add(t),this.alwaysPage.set(e.pageIndex,i),this.onHandlerChange$.emit({...this.state}),()=>{i.delete(t),this.onHandlerChange$.emit({...this.state})}}getHandlersForScope(e){if(!this.state)return null;const t=this.modes.get(this.state.activeMode);if(!t)return null;const i=this.buckets.get(t.id);if(!i)return null;const r=(e,t)=>e.size||t.size?function(e){const t=["onPointerDown","onPointerUp","onPointerMove","onPointerEnter","onPointerLeave","onPointerCancel"],i={};for(const r of t)i[r]=(t,i,o)=>{var n;for(const s of e)null==(n=s[r])||n.call(s,t,i,o)};return i}([...e,...t]):null;if("global"===e.type){const e="global"===t.scope?i.global:new Set;return r(this.alwaysGlobal,e)}return r(this.alwaysPage.get(e.pageIndex)??new Set,"page"===t.scope?i.page.get(e.pageIndex)??new Set:new Set)}setCursor(e,t,i=0){this.cursorClaims.set(e,{cursor:t,priority:i}),this.emitCursor()}removeCursor(e){this.cursorClaims.delete(e),this.emitCursor()}emitCursor(){var e;const t=[...this.cursorClaims.values()].sort((e,t)=>t.priority-e.priority)[0]??{cursor:(null==(e=this.modes.get(this.state.activeMode))?void 0:e.cursor)??"auto"};t.cursor!==this.state.cursor&&(this.dispatch((e=>({type:"INTERACTION/SET_CURSOR",payload:{cursor:e}}))(t.cursor)),this.onCursorChange$.emit(t.cursor))}onStoreUpdated(e,t){this.onStateChange$.emit(t)}activeModeIsExclusive(){const e=this.modes.get(this.state.activeMode);return!(null==e||!e.exclusive)}getActiveInteractionMode(){return this.modes.get(this.state.activeMode)??null}async destroy(){this.onModeChange$.clear(),this.onCursorChange$.clear(),await super.destroy()}};Ls.id="interaction-manager";var Ds=Ls;function Fs({modeId:e,pageIndex:t}){const{provides:i}=ys(Ds.id);return{register:(r,o)=>{const n=(null==o?void 0:o.modeId)??e,s=(null==o?void 0:o.pageIndex)??t;return n?null==i?void 0:i.registerHandlers({modeId:n,handlers:r,pageIndex:s}):null==i?void 0:i.registerAlways({scope:void 0!==s?{type:"page",pageIndex:s}:{type:"global"},handlers:r})}}}var Hs=({pageIndex:e,scale:t,pageWidth:i,pageHeight:r,className:o,stroke:n="rgba(33,150,243,0.8)",fill:s="rgba(33,150,243,0.15)"})=>{const{provides:a}=Ns(),{register:l}=Fs({modeId:"marqueeZoom",pageIndex:e}),c=(e,t,i)=>Math.max(t,Math.min(i,e)),d=Te(null),[u,h]=ke(null),p=i/t,g=r/t,f=Re(()=>({onPointerDown:(e,t)=>{d.current=e,h({origin:{x:e.x,y:e.y},size:{width:0,height:0}}),t.target?.setPointerCapture?.(t.pointerId)},onPointerMove:e=>{if(!d.current)return;const t=c(e.x,0,p),i=c(e.y,0,g),{x:r,y:o}=d.current,n=Math.min(r,t),s=Math.min(o,i),a=Math.abs(t-r),l=Math.abs(i-o);h({origin:{x:n,y:s},size:{width:a,height:l}})},onPointerUp:(i,r)=>{if(u&&a){Math.max(u.size.width,u.size.height)*t>5?a.zoomToArea(e,u):a.zoomIn()}d.current=null,h(null),r.target?.releasePointerCapture?.(r.pointerId)},onPointerCancel:(e,t)=>{d.current=null,h(null),t.target?.releasePointerCapture?.(t.pointerId)}}),[p,p,a,t,u,e]);return Pe(()=>{if(l)return l(f)},[l,f]),u?he("div",{style:{position:"absolute",pointerEvents:"none",left:u.origin.x*t,top:u.origin.y*t,width:u.size.width*t,height:u.size.height*t,border:`1px solid ${n}`,background:s,boxSizing:"border-box"},className:o}):null},$s=["icon","title"];function js(e){var t,i=e.icon,r=e.title,o=g(e,$s),n=function(){const{provides:e}=is();if(!e)throw new Error("useIcon must be used within a UI context");const{registerIcon:t,registerIcons:i,getIcon:r,getAllIcons:o,getSvgString:n,isSvgString:s,isSvgDataUri:a,dataUriToSvgString:l,svgStringToDataUri:c}=e;return{registerIcon:t,registerIcons:i,getIcon:r,getAllIcons:o,getSvgString:n,isSvgString:s,isSvgDataUri:a,dataUriToSvgString:l,svgStringToDataUri:c}}();if(!(t=n.isSvgDataUri(i)?n.dataUriToSvgString(i):n.getSvgString(i)))return console.warn("Icon not found: ".concat(i)),null;var s=j("span",p(p({},o),{},{dangerouslySetInnerHTML:{__html:t}}));return r?j("span",p({title:r},o),s):s}var Us=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${Us.join("")}]`,"g");var Bs=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);Bs.reduce((e,t)=>(e[t.id]=t,e),{}),Bs.reduce((e,t)=>(e[t.css]=t.id,e),{}),Bs.map(e=>({value:e.id,label:e.label}));var Gs=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});Object.entries(Gs).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var Vs=ce({registry:null,isInitializing:!0,pluginsReady:!1});function Ws(e){const{registry:t}=function(){const e=Ne(Vs);if(void 0===e)throw new Error("useCapability must be used within a PDFContext.Provider");const{registry:t,isInitializing:i}=e;if(i)return e;if(null===t)throw new Error("PDF registry failed to initialize properly");return e}();if(null===t)return{plugin:null,isLoading:!0,ready:new Promise(()=>{})};const i=t.getPlugin(e);if(!i)throw new Error(`Plugin ${e} not found`);return{plugin:i,isLoading:!1,ready:i.ready()}}var Zs=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${Zs.join("")}]`,"g");var qs=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);qs.reduce((e,t)=>(e[t.id]=t,e),{}),qs.reduce((e,t)=>(e[t.css]=t.id,e),{}),qs.map(e=>({value:e.id,label:e.label}));var Xs=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});Object.entries(Xs).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var Ks=class{constructor(e,t){if(this.id=e,this.registry=t,this.debouncedActions={},this.unsubscribeFromState=null,this.unsubscribeFromCoreStore=null,e!==this.constructor.id)throw new Error(`Plugin ID mismatch: ${e} !== ${this.constructor.id}`);this.coreStore=this.registry.getStore(),this.pluginStore=this.coreStore.getPluginStore(this.id),this.unsubscribeFromState=this.pluginStore.subscribeToState((e,t,i)=>{this.onStoreUpdated(i,t)}),this.unsubscribeFromCoreStore=this.coreStore.subscribe((e,t,i)=>{this.onCoreStoreUpdated(i,t)}),this.readyPromise=new Promise(e=>{this.readyResolve=e}),this.readyResolve()}provides(){if(!this._capability){const e=this.buildCapability();this._capability=Object.freeze(e)}return this._capability}get state(){return this.pluginStore.getState()}get coreState(){return this.coreStore.getState()}getState(){return this.pluginStore.getState()}getCoreState(){return this.coreStore.getState()}dispatchCoreAction(e){return this.coreStore.dispatchToCore(e)}dispatchToAllPlugins(e){return this.coreStore.dispatch(e)}dispatch(e){return this.pluginStore.dispatch(e)}debouncedDispatch(e,t=100){const i=Date.now();return i-(this.debouncedActions[e.type]||0)>=t&&(this.debouncedActions[e.type]=i,this.dispatch(e),!0)}subscribe(e){return this.pluginStore.subscribeToState(e)}subscribeToCoreStore(e){return this.coreStore.subscribe(e)}onStoreUpdated(e,t){}onCoreStoreUpdated(e,t){}destroy(){this.unsubscribeFromState&&(this.unsubscribeFromState(),this.unsubscribeFromState=null),this.unsubscribeFromCoreStore&&(this.unsubscribeFromCoreStore(),this.unsubscribeFromCoreStore=null)}ready(){return this.readyPromise}markReady(){this.readyResolve()}resetReady(){this.readyPromise=new Promise(e=>{this.readyResolve=e})}},Ys=class{constructor(e,t){this.handler=e,this.options=t,this.lastRun=0,this.handle=e=>{"debounce"===this.options.mode?this.debounce(e):this.throttle(e)}}debounce(e){this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.timeoutId=void 0},this.options.wait)}throttle(e){if("debounce"===this.options.mode)return;const t=Date.now(),i=this.options.throttleMode||"leading-trailing";t-this.lastRun>=this.options.wait&&("leading-trailing"===i&&this.handler(e),this.lastRun=t),this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.lastRun=Date.now(),this.timeoutId=void 0},this.options.wait-(t-this.lastRun))}destroy(){this.timeoutId&&window.clearTimeout(this.timeoutId)}};function Qs(e,t,i){if(e===t)return!0;if(null==e||null==t)return e===t;const r=typeof e;if(r!==typeof t)return!1;if("object"===r){i||(i=new Set);const r=function(e,t){return`${ta(e)}__${ta(t)}`}(e,t);if(i.has(r))return!0;i.add(r);const o=Array.isArray(e),n=Array.isArray(t);return o&&n?function(e,t,i){if(e.length!==t.length)return!1;const r=new Array(t.length).fill(!1);e:for(let o=0;o<e.length;o++){const n=e[o];for(let e=0;e<t.length;e++)if(!r[e]&&Qs(n,t[e],i)){r[e]=!0;continue e}return!1}return!0}(e,t,i):!o&&!n&&function(e,t,i){const r=Object.keys(e).sort(),o=Object.keys(t).sort();if(r.length!==o.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!==o[e])return!1;for(const o of r){if(!Qs(e[o],t[o],i))return!1}return!0}(e,t,i)}return!1}var Js=0,ea=new WeakMap;function ta(e){return ea.has(e)||ea.set(e,++Js),ea.get(e)}function ia(e,t=Qs){const i=new Set,r=new Map;let o=e;const n=(e,t)=>{let n=e,s=()=>{};if(t){const i=new Ys(e,t);n=i.handle,s=()=>i.destroy(),r.set(e,{wrapped:n,destroy:s})}return void 0!==o&&n(o),i.add(n),()=>{i.delete(n),s(),r.delete(e)}};return{get value(){return o},emit(e=void 0){(void 0===o||!t(o,e))&&(o=e,(e=>{i.forEach(t=>t(e))})(e))},on:n,off(e){const t=r.get(e);t?(i.delete(t.wrapped),t.destroy(),r.delete(e)):i.delete(e)},clear(){i.clear(),r.forEach(e=>e.destroy()),r.clear()},select:(e,t=Qs)=>(i,r)=>{let s;if(void 0!==o){const t=e(o);s=t,i(t)}return n(r=>{const o=e(r);(void 0===s||!t(s,o))&&(s=o,i(o))},r)}}}function ra(e){return{type:"SET_SEARCH_FLAGS",payload:e}}function oa(e){return{type:"SET_SHOW_ALL_RESULTS",payload:e}}function na(e,t,i){return{type:"SET_SEARCH_RESULTS",payload:{results:e,total:t,activeResultIndex:i}}}var sa=class extends Ks{constructor(e,t,i){super(e,t),this.searchStop$=ia(),this.searchStart$=ia(),this.searchResult$=ia(),this.searchActiveResultChange$=ia(),this.searchResultState$=ia(),this.searchState$=ia(),this.engine=i,this.loader=this.registry.getPlugin("loader").provides(),this.loader.onDocumentLoaded(this.handleDocumentLoaded.bind(this)),this.loader.onLoaderEvent(this.handleLoaderEvent.bind(this))}handleDocumentLoaded(e){this.currentDocument=e,this.state.active&&this.startSearchSession()}handleLoaderEvent(e){("error"===e.type||"start"===e.type&&this.currentDocument)&&(this.state.active&&this.stopSearchSession(),this.currentDocument=void 0)}async initialize(e){this.dispatch(ra(e.flags||[])),this.dispatch(oa(void 0===e.showAllResults||e.showAllResults))}onStoreUpdated(e,t){this.searchResultState$.emit({results:t.results,activeResultIndex:t.activeResultIndex,showAllResults:t.showAllResults,active:t.active}),this.searchState$.emit(t)}buildCapability(){return{startSearch:this.startSearchSession.bind(this),stopSearch:this.stopSearchSession.bind(this),searchAllPages:this.searchAllPages.bind(this),nextResult:this.nextResult.bind(this),previousResult:this.previousResult.bind(this),goToResult:this.goToResult.bind(this),setShowAllResults:e=>this.dispatch(oa(e)),getShowAllResults:()=>this.state.showAllResults,onSearchResult:this.searchResult$.on,onSearchStart:this.searchStart$.on,onSearchStop:this.searchStop$.on,onActiveResultChange:this.searchActiveResultChange$.on,onSearchResultStateChange:this.searchResultState$.on,onStateChange:this.searchState$.on,getFlags:()=>this.state.flags,setFlags:e=>this.setFlags(e),getState:()=>this.state}}setFlags(e){this.dispatch(ra(e)),this.state.active&&this.searchAllPages(this.state.query,!0)}notifySearchStart(){this.searchStart$.emit()}notifySearchStop(){this.searchStop$.emit()}notifyActiveResultChange(e){this.searchActiveResultChange$.emit(e)}startSearchSession(){this.currentDocument&&(this.dispatch({type:"START_SEARCH_SESSION"}),this.notifySearchStart())}stopSearchSession(){this.currentDocument&&this.getState().active&&(this.dispatch({type:"STOP_SEARCH_SESSION"}),this.notifySearchStop())}async searchAllPages(e,t=!1){const i=e.trim();return this.state.query!==i||t?(this.dispatch({type:"START_SEARCH",payload:i}),i&&this.currentDocument?(this.state.active||this.startSearchSession(),new Promise(e=>{this.engine.searchAllPages(this.currentDocument,i,this.state.flags).wait(t=>{const i=t.total>0?0:-1;this.dispatch(na(t.results,t.total,i)),this.searchResult$.emit(t),t.total>0&&this.notifyActiveResultChange(0),e(t)},t=>{console.error("Error during search:",t),this.dispatch(na([],0,-1)),e({results:[],total:0})})})):(this.dispatch(na([],0,-1)),{results:[],total:0})):{results:this.state.results,total:this.state.total}}nextResult(){if(0===this.state.results.length)return-1;const e=this.state.activeResultIndex>=this.state.results.length-1?0:this.state.activeResultIndex+1;return this.goToResult(e)}previousResult(){if(0===this.state.results.length)return-1;const e=this.state.activeResultIndex<=0?this.state.results.length-1:this.state.activeResultIndex-1;return this.goToResult(e)}goToResult(e){return 0===this.state.results.length||e<0||e>=this.state.results.length?-1:(this.dispatch(function(e){return{type:"SET_ACTIVE_RESULT_INDEX",payload:e}}(e)),this.notifyActiveResultChange(e),e)}async destroy(){this.state.active&&this.currentDocument&&this.stopSearchSession(),this.searchResult$.clear(),this.searchStart$.clear(),this.searchStop$.clear(),this.searchActiveResultChange$.clear(),this.searchResultState$.clear(),this.searchState$.clear()}};sa.id="search";var aa=()=>function(e){const{plugin:t,isLoading:i,ready:r}=Ws(e);if(!t)return{provides:null,isLoading:i,ready:r};if(!t.provides)throw new Error(`Plugin ${e} does not provide a capability`);return{provides:t.provides(),isLoading:i,ready:r}}(sa.id);function la({pageIndex:e,scale:t,style:i,highlightColor:r="#FFFF00",activeHighlightColor:o="#FFBF00",...n}){const{provides:s}=aa(),[a,l]=ke(null);if(Pe(()=>s?.onSearchResultStateChange(e=>{l(e)}),[s]),!a)return null;return he("div",{style:{...i},...n,children:a.results.map((e,t)=>({result:e,originalIndex:t})).filter(({result:t})=>t.pageIndex===e).map(({result:e,originalIndex:i})=>e.rects.map(e=>he("div",{style:{position:"absolute",top:e.origin.y*t,left:e.origin.x*t,width:e.size.width*t,height:e.size.height*t,backgroundColor:i===a.activeResultIndex?o:r,mixBlendMode:"multiply",transform:"scale(1.02)",transformOrigin:"center",transition:"opacity .3s ease-in-out",opacity:1}})))})}var ca=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${ca.join("")}]`,"g");var da=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);da.reduce((e,t)=>(e[t.id]=t,e),{}),da.reduce((e,t)=>(e[t.css]=t.id,e),{}),da.map(e=>({value:e.id,label:e.label}));var ua=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});Object.entries(ua).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var ha=(e=>(e[e.Ok=0]="Ok",e[e.Unknown=1]="Unknown",e[e.NotFound=2]="NotFound",e[e.WrongFormat=3]="WrongFormat",e[e.Password=4]="Password",e[e.Security=5]="Security",e[e.PageError=6]="PageError",e[e.XFALoad=7]="XFALoad",e[e.XFALayout=8]="XFALayout",e[e.Cancelled=9]="Cancelled",e[e.Initialization=10]="Initialization",e[e.NotReady=11]="NotReady",e[e.NotSupport=12]="NotSupport",e[e.LoadDoc=13]="LoadDoc",e[e.DocNotOpen=14]="DocNotOpen",e[e.CantCloseDoc=15]="CantCloseDoc",e[e.CantCreateNewDoc=16]="CantCreateNewDoc",e[e.CantImportPages=17]="CantImportPages",e[e.CantCreateAnnot=18]="CantCreateAnnot",e[e.CantSetAnnotRect=19]="CantSetAnnotRect",e[e.CantSetAnnotContent=20]="CantSetAnnotContent",e[e.CantRemoveInkList=21]="CantRemoveInkList",e[e.CantAddInkStoke=22]="CantAddInkStoke",e[e.CantReadAttachmentSize=23]="CantReadAttachmentSize",e[e.CantReadAttachmentContent=24]="CantReadAttachmentContent",e[e.CantFocusAnnot=25]="CantFocusAnnot",e[e.CantSelectText=26]="CantSelectText",e[e.CantSelectOption=27]="CantSelectOption",e[e.CantCheckField=28]="CantCheckField",e))(ha||{});function pa(){}var ga=ce({registry:null,isInitializing:!0,pluginsReady:!1});function fa(e){const{registry:t}=function(){const e=Ne(ga);if(void 0===e)throw new Error("useCapability must be used within a PDFContext.Provider");const{registry:t,isInitializing:i}=e;if(i)return e;if(null===t)throw new Error("PDF registry failed to initialize properly");return e}();if(null===t)return{plugin:null,isLoading:!0,ready:new Promise(()=>{})};const i=t.getPlugin(e);if(!i)throw new Error(`Plugin ${e} not found`);return{plugin:i,isLoading:!1,ready:i.ready()}}var ma=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${ma.join("")}]`,"g");var ba=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);ba.reduce((e,t)=>(e[t.id]=t,e),{}),ba.reduce((e,t)=>(e[t.css]=t.id,e),{}),ba.map(e=>({value:e.id,label:e.label}));var va=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});function ya(){}Object.entries(va).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var wa=class{constructor(e,t){if(this.id=e,this.registry=t,this.debouncedActions={},this.unsubscribeFromState=null,this.unsubscribeFromCoreStore=null,e!==this.constructor.id)throw new Error(`Plugin ID mismatch: ${e} !== ${this.constructor.id}`);this.coreStore=this.registry.getStore(),this.pluginStore=this.coreStore.getPluginStore(this.id),this.unsubscribeFromState=this.pluginStore.subscribeToState((e,t,i)=>{this.onStoreUpdated(i,t)}),this.unsubscribeFromCoreStore=this.coreStore.subscribe((e,t,i)=>{this.onCoreStoreUpdated(i,t)}),this.readyPromise=new Promise(e=>{this.readyResolve=e}),this.readyResolve()}provides(){if(!this._capability){const e=this.buildCapability();this._capability=Object.freeze(e)}return this._capability}get state(){return this.pluginStore.getState()}get coreState(){return this.coreStore.getState()}getState(){return this.pluginStore.getState()}getCoreState(){return this.coreStore.getState()}dispatchCoreAction(e){return this.coreStore.dispatchToCore(e)}dispatchToAllPlugins(e){return this.coreStore.dispatch(e)}dispatch(e){return this.pluginStore.dispatch(e)}debouncedDispatch(e,t=100){const i=Date.now();return i-(this.debouncedActions[e.type]||0)>=t&&(this.debouncedActions[e.type]=i,this.dispatch(e),!0)}subscribe(e){return this.pluginStore.subscribeToState(e)}subscribeToCoreStore(e){return this.coreStore.subscribe(e)}onStoreUpdated(e,t){}onCoreStoreUpdated(e,t){}destroy(){this.unsubscribeFromState&&(this.unsubscribeFromState(),this.unsubscribeFromState=null),this.unsubscribeFromCoreStore&&(this.unsubscribeFromCoreStore(),this.unsubscribeFromCoreStore=null)}ready(){return this.readyPromise}markReady(){this.readyResolve()}resetReady(){this.readyPromise=new Promise(e=>{this.readyResolve=e})}},Sa=class{constructor(e,t){this.handler=e,this.options=t,this.lastRun=0,this.handle=e=>{"debounce"===this.options.mode?this.debounce(e):this.throttle(e)}}debounce(e){this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.timeoutId=void 0},this.options.wait)}throttle(e){if("debounce"===this.options.mode)return;const t=Date.now(),i=this.options.throttleMode||"leading-trailing";t-this.lastRun>=this.options.wait&&("leading-trailing"===i&&this.handler(e),this.lastRun=t),this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.lastRun=Date.now(),this.timeoutId=void 0},this.options.wait-(t-this.lastRun))}destroy(){this.timeoutId&&window.clearTimeout(this.timeoutId)}};function Ca(e,t,i){if(e===t)return!0;if(null==e||null==t)return e===t;const r=typeof e;if(r!==typeof t)return!1;if("object"===r){i||(i=new Set);const r=function(e,t){return`${Aa(e)}__${Aa(t)}`}(e,t);if(i.has(r))return!0;i.add(r);const o=Array.isArray(e),n=Array.isArray(t);return o&&n?function(e,t,i){if(e.length!==t.length)return!1;const r=new Array(t.length).fill(!1);e:for(let o=0;o<e.length;o++){const n=e[o];for(let e=0;e<t.length;e++)if(!r[e]&&Ca(n,t[e],i)){r[e]=!0;continue e}return!1}return!0}(e,t,i):!o&&!n&&function(e,t,i){const r=Object.keys(e).sort(),o=Object.keys(t).sort();if(r.length!==o.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!==o[e])return!1;for(const o of r){if(!Ca(e[o],t[o],i))return!1}return!0}(e,t,i)}return!1}var xa=0,Ia=new WeakMap;function Aa(e){return Ia.has(e)||Ia.set(e,++xa),Ia.get(e)}function Ea(e,t=Ca){const i=new Set,r=new Map;let o=e;const n=(e,t)=>{let n=e,s=()=>{};if(t){const i=new Sa(e,t);n=i.handle,s=()=>i.destroy(),r.set(e,{wrapped:n,destroy:s})}return void 0!==o&&n(o),i.add(n),()=>{i.delete(n),s(),r.delete(e)}};return{get value(){return o},emit(e=void 0){(void 0===o||!t(o,e))&&(o=e,(e=>{i.forEach(t=>t(e))})(e))},on:n,off(e){const t=r.get(e);t?(i.delete(t.wrapped),t.destroy(),r.delete(e)):i.delete(e)},clear(){i.clear(),r.forEach(e=>e.destroy()),r.clear()},select:(e,t=Ca)=>(i,r)=>{let s;if(void 0!==o){const t=e(o);s=t,i(t)}return n(r=>{const o=e(r);(void 0===s||!t(s,o))&&(s=o,i(o))},r)}}}var ka=class extends wa{constructor(e,t,i){super(e,t),this.cfg=i,this.thumbs=[],this.window=null,this.emitWindow=Ea(),this.taskCache=new Map,this.renderCapability=this.registry.getPlugin("render").provides(),this.coreStore.onAction("SET_DOCUMENT",(e,t)=>{this.taskCache.clear(),this.setWindowState(t)})}async initialize(){}setWindowState(e){const t=e.core;if(!t.document)return;const i=this.cfg.width??120,r=this.cfg.labelHeight??16,o=this.cfg.gap??8;let n=0;this.thumbs=t.document.pages.map(e=>{const t=e.size.height/e.size.width,s=Math.round(i*t),a=s+r,l={pageIndex:e.index,width:i,height:s,wrapperHeight:a,top:n,labelHeight:r};return n+=a+o,l}),this.window={start:-1,end:-1,items:[],totalHeight:n-o},this.emitWindow.emit(this.window)}buildCapability(){return{onWindow:this.emitWindow.on,setViewport:(e,t)=>this.updateWindow(e,t),renderThumb:(e,t)=>this.renderThumb(e,t)}}updateWindow(e,t){const i=this.cfg.buffer??3;let r=0,o=this.thumbs.length-1,n=0;for(;r<=o;){const t=r+o>>1,i=this.thumbs[t];i.top+i.wrapperHeight<e?r=t+1:(n=t,o=t-1)}let s=n;const a=e+t;for(;s+1<this.thumbs.length&&this.thumbs[s].top<a;)s++;s=Math.min(this.thumbs.length-1,s+i);const l=Math.max(0,n-i);this.window&&l===this.window.start&&s===this.window.end||(this.window={start:l,end:s,items:this.thumbs.slice(l,s+1),totalHeight:this.window.totalHeight},this.emitWindow.emit(this.window))}renderThumb(e,t){if(this.taskCache.has(e))return this.taskCache.get(e);const i=this.coreState.core.document.pages[e],r=(this.cfg.width??120)/i.size.width,o=this.renderCapability.renderPageRect({pageIndex:e,rect:{origin:{x:0,y:0},size:i.size},scaleFactor:r,dpr:t});return this.taskCache.set(e,o),o.wait(ya,()=>{this.taskCache.delete(e)}),o}};ka.id="thumbnail";var Pa=()=>function(e){const{plugin:t,isLoading:i,ready:r}=fa(e);if(!t)return{provides:null,isLoading:i,ready:r};if(!t.provides)throw new Error(`Plugin ${e} does not provide a capability`);return{provides:t.provides(),isLoading:i,ready:r}}(ka.id);function Ma({style:e,selectedPage:t,scrollOptions:i={behavior:"smooth",block:"nearest",inline:"nearest"},...r}){const{provides:o}=Pa(),n=Te(null),[s,a]=ke(null);return Pe(()=>o?.onWindow(a),[o]),Pe(()=>{const e=n.current;if(!e)return;const t=()=>o?.setViewport(e.scrollTop,e.clientHeight);return e.addEventListener("scroll",t),()=>e.removeEventListener("scroll",t)},[o]),Pe(()=>{const e=n.current;e&&o&&0===s?.items.length&&o.setViewport(e.scrollTop,e.clientHeight)},[s,o]),Pe(()=>{if(!t||!s)return;const e=s.items.find(e=>e.pageIndex+1===t);if(!e)return;const r=n.current;if(!r)return;e.top<r.scrollTop+8?r.scrollTo({top:e.top,...i}):e.top+e.wrapperHeight+e.labelHeight>r.scrollTop+r.clientHeight-8&&r.scrollTo({top:e.top+e.wrapperHeight+e.labelHeight-r.clientHeight,...i})},[t,s,i]),he("div",{ref:n,style:{overflowY:"auto",position:"relative",...e},...r,children:he("div",{style:{height:s?.totalHeight??0,position:"relative"},children:s?.items.map(e=>r.children(e))})})}function Ta({meta:e,style:t,...i}){const{provides:r}=Pa(),[o,n]=ke(),s=Te(null);Pe(()=>{const t=r?.renderThumb(e.pageIndex,window.devicePixelRatio);return t?.wait(e=>{const t=URL.createObjectURL(e);s.current=t,n(t)},pa),()=>{s.current?(URL.revokeObjectURL(s.current),s.current=null):t?.abort({code:ha.Cancelled,message:"canceled render task"})}},[e.pageIndex]);return o?he("img",{src:o,onLoad:()=>{s.current&&(URL.revokeObjectURL(s.current),s.current=null)},style:t,...i}):null}function Ra(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300,i=v(ke(e),2),r=i[0],o=i[1];return Pe(function(){var i=window.setTimeout(function(){return o(e)},t);return function(){return clearTimeout(i)}},[e,t]),r}var _a=function(e){var t=e.label,i=e.checked,r=e.onChange;return j("label",{className:"inline-flex cursor-pointer select-none items-center gap-2 text-xs font-medium text-gray-700"},j("input",{type:"checkbox",checked:i,onChange:function(e){return r(e.target.checked)},className:"peer h-4 w-4 shrink-0 appearance-none rounded-[3px] border border-gray-300 bg-white transition-all checked:border-blue-600 checked:bg-blue-600"}),j("svg",{viewBox:"0 0 24 24",className:"/* fine-tune centering */ pointer-events-none absolute h-3.5 w-3.5 translate-x-[1px] translate-y-[1px] text-white opacity-0 peer-checked:opacity-100",fill:"none",stroke:"currentColor",strokeWidth:3,strokeLinecap:"round",strokeLinejoin:"round"},j("polyline",{points:"20 6 9 17 4 12"})),t)};const Na="selection",Oa={id:Na,name:"Selection Plugin",version:"1.0.0",provides:["selection"],requires:["interaction-manager"],optional:[],defaultConfig:{enabled:!0}},za="CACHE_PAGE_GEOMETRY",La="SET_SELECTION",Da="START_SELECTION",Fa="END_SELECTION",Ha="CLEAR_SELECTION",$a="SET_RECTS",ja="SET_SLICES",Ua="RESET";function Ba(e,t){return e.rects[t]??[]}function Ga(e,t){return et(Ba(e,t))}function Va(e,t){for(const i of e.runs){if(!(t.y>=i.rect.y&&t.y<=i.rect.y+i.rect.height&&t.x>=i.rect.x&&t.x<=i.rect.x+i.rect.width))continue;const e=i.glyphs.findIndex(e=>t.x>=e.x&&t.x<=e.x+e.width&&t.y>=e.y&&t.y<=e.y+e.height);if(-1!==e)return i.charStart+e}return-1}function Wa(e,t,i){if(!e||!t||i<e.start.page||i>e.end.page)return null;const r=i===e.start.page?e.start.index:0,o=t.runs[t.runs.length-1],n=o.charStart+o.glyphs.length-1;return{from:r,to:i===e.end.page?e.end.index:n}}function Za(e,t,i,r=!0){const o=[];for(const r of e.runs){const e=r.charStart,n=e+r.glyphs.length-1;if(n<t||e>i)continue;const s=Math.max(t,e)-e,a=Math.min(i,n)-e;let l=1/0,c=-1/0,d=1/0,u=-1/0,h=0;for(let e=s;e<=a;e++){const t=r.glyphs[e];2!==t.flags&&(l=Math.min(l,t.x),c=Math.max(c,t.x+t.width),d=Math.min(d,t.y),u=Math.max(u,t.y+t.height),h++)}l!==1/0&&h>0&&o.push({rect:{origin:{x:l,y:d},size:{width:c-l,height:u-d}},charCount:h})}return r?function(e){const t=[];let i=null,r=null;for(const o of e)i&&r?Ya(i,o)?r=qa(r,o.rect):(t.push(r),r=o.rect):r=o.rect,i=o;return r&&!Xa(r)&&t.push(r),t}(o):o.map(e=>e.rect)}function qa(e,t){const i=Math.min(e.origin.x,t.origin.x),r=Math.min(e.origin.y,t.origin.y);return{origin:{x:i,y:r},size:{width:Math.max(e.origin.x+e.size.width,t.origin.x+t.size.width)-i,height:Math.max(e.origin.y+e.size.height,t.origin.y+t.size.height)-r}}}function Xa(e){return e.size.width<=0||e.size.height<=0}function Ka(e,t){if(Xa(e)||Xa(t))return 0;const i=qa(e,t);return i.size.height===e.size.height||i.size.height===t.size.height?1:function(e,t){const i=Math.max(e.origin.x,t.origin.x),r=Math.max(e.origin.y,t.origin.y),o=Math.min(e.origin.x+e.size.width,t.origin.x+t.size.width),n=Math.min(e.origin.y+e.size.height,t.origin.y+t.size.height);return{origin:{x:i,y:r},size:{width:Math.max(0,o-i),height:Math.max(0,n-r)}}}(e,t).size.height/i.size.height}function Ya(e,t){const i=e.rect,r=t.rect;if(Ka(i,r)<.8)return!1;const o=1*i.size.width/e.charCount,n=1*r.size.width/t.charCount,s=i.origin.x-o,a=i.origin.x+i.size.width+o,l=r.origin.x-n;return s<r.origin.x+r.size.width+n&&a>l}const Qa=class extends qt{constructor(e,t,i){super(e,t),this.engine=i,this.enabledModes=new Set(["default"]),this.selecting=!1,this.selChange$=ti(),this.textRetrieved$=ti(),this.copyToClipboard$=ei(),this.beginSelection$=ei(),this.endSelection$=ei(),this.coreStore.onAction(Dt,e=>{this.dispatch({type:Ua})})}async initialize(){}async destroy(){this.selChange$.clear()}buildCapability(){return{getGeometry:e=>this.getOrLoadGeometry(e),getFormattedSelection:()=>function(e){const t=[],i=Object.keys(e.rects).map(Number);for(const r of i){const i=e.rects[r]||[];if(0===i.length)continue;const o=Ga(e,r);o&&t.push({pageIndex:r,rect:o,segmentRects:i})}return t}(this.state),getFormattedSelectionForPage:e=>function(e,t){const i=e.rects[t]||[];if(0===i.length)return null;const r=Ga(e,t);return r?{pageIndex:t,rect:r,segmentRects:i}:null}(this.state,e),getHighlightRectsForPage:e=>Ba(this.state,e),getHighlightRects:()=>this.state.rects,getBoundingRectForPage:e=>Ga(this.state,e),getBoundingRects:()=>function(e){const t=[],i=e.rects;for(const e in i){const r=Number(e),o=et(i[r]);o&&t.push({page:r,rect:o})}return t}(this.state),begin:(e,t)=>this.beginSelection(e,t),update:(e,t)=>this.updateSelection(e,t),end:()=>this.endSelection(),clear:()=>this.clearSelection(),onCopyToClipboard:this.copyToClipboard$.on,onSelectionChange:this.selChange$.on,onTextRetrieved:this.textRetrieved$.on,onBeginSelection:this.beginSelection$.on,onEndSelection:this.endSelection$.on,getSelectedText:()=>this.getSelectedText(),copyToClipboard:()=>this.copyToClipboard(),enableForMode:e=>this.enabledModes.add(e),isEnabledForMode:e=>this.enabledModes.has(e),getState:()=>this.state}}getOrLoadGeometry(e){const t=this.state.geometry[e];if(t)return It.resolve(t);if(!this.coreState.core.document)return It.reject({code:xt.NotFound,message:"Doc Not Found"});const i=this.coreState.core.document.pages.find(t=>t.index===e),r=this.engine.getPageGeometry(this.coreState.core.document,i);return r.wait(t=>{this.dispatch(((e,t)=>({type:za,payload:{page:e,geo:t}}))(e,t))},Mt),r}beginSelection(e,t){this.selecting=!0,this.anchor={page:e,index:t},this.dispatch({type:Da}),this.beginSelection$.emit({page:e,index:t})}endSelection(){this.selecting=!1,this.anchor=void 0,this.dispatch({type:Fa}),this.endSelection$.emit()}clearSelection(){this.selecting=!1,this.anchor=void 0,this.dispatch({type:Ha}),this.selChange$.emit(null)}updateSelection(e,t){if(!this.selecting||!this.anchor)return;const i=this.anchor,r=e>i.page||e===i.page&&t>=i.index,o={start:r?i:{page:e,index:t},end:r?{page:e,index:t}:i};this.dispatch((e=>({type:La,payload:e}))(o)),this.updateRectsAndSlices(o),this.selChange$.emit(o)}updateRectsAndSlices(e){const t={},i={};for(let r=e.start.page;r<=e.end.page;r++){const o=this.state.geometry[r],n=Wa(e,o,r);n&&(t[r]=Za(o,n.from,n.to),i[r]={start:n.from,count:n.to-n.from+1})}this.dispatch((e=>({type:$a,payload:e}))(t)),this.dispatch((e=>({type:ja,payload:e}))(i))}getSelectedText(){if(!this.coreState.core.document||!this.state.selection)return It.reject({code:xt.NotFound,message:"Doc Not Found or No Selection"});const e=this.state.selection,t=[];for(let i=e.start.page;i<=e.end.page;i++){const e=this.state.slices[i];e&&t.push({pageIndex:i,charIndex:e.start,charCount:e.count})}if(0===t.length)return It.resolve([]);const i=this.engine.getTextSlices(this.coreState.core.document,t);return i.wait(e=>{this.textRetrieved$.emit(e)},Mt),i}copyToClipboard(){this.getSelectedText().wait(e=>{this.copyToClipboard$.emit(e.join("\n"))},Mt)}};Qa.id="selection";let Ja=Qa;const el={geometry:{},rects:{},slices:{},selection:null,active:!1,selecting:!1},tl={manifest:Oa,create:(e,t)=>new Ja(Na,e,t),reducer:(e=el,t)=>{switch(t.type){case za:{const{page:i,geo:r}=t.payload;return{...e,geometry:{...e.geometry,[i]:r}}}case La:return{...e,selection:t.payload,active:!0};case Da:return{...e,selecting:!0,selection:null,rects:{}};case Fa:return{...e,selecting:!1};case Ha:return{...e,selecting:!1,selection:null,rects:{},active:!1};case $a:return{...e,rects:t.payload};case ja:return{...e,slices:t.payload};case Ua:return el;default:return e}},initialState:el};function il(e,t,i,r){let o=e.getHandlersForScope(t);const n=e.onModeChange(()=>{if("global"===t.type){const t=e.getActiveInteractionMode();i.style.cursor="global"===(null==t?void 0:t.scope)?t.cursor??"auto":"auto"}o=e.getHandlersForScope(t)}),s=e.onHandlerChange(()=>{o=e.getHandlersForScope(t)}),a=e.getActiveInteractionMode(),l=e.getCurrentCursor();"global"===t.type?i.style.cursor="global"===(null==a?void 0:a.scope)?l:"auto":i.style.cursor=l;const c=e.onCursorChange(r=>{var o;"global"===t.type&&"global"!==(null==(o=e.getActiveInteractionMode())?void 0:o.scope)||(i.style.cursor=r)}),d={onPointerDown:"pointerdown",onPointerUp:"pointerup",onPointerMove:"pointermove",onPointerEnter:"pointerenter",onPointerLeave:"pointerleave",onPointerCancel:"pointercancel"},u={};return Object.keys(d).forEach(t=>{u[t]=n=>{var s;if(e.isPaused())return;const a=n,l=e.getActiveMode();null==(s=null==o?void 0:o[t])||s.call(o,((e,t)=>{if(r)return r(e,t);const i=t.getBoundingClientRect();return{x:e.clientX-i.left,y:e.clientY-i.top}})(a,i),a,l)},i.addEventListener(d[t],u[t])}),()=>{Object.keys(d).forEach(e=>i.removeEventListener(d[e],u[e])),n(),c(),s()}}const rl="INTERACTION/ACTIVATE_MODE",ol="INTERACTION/PAUSE",nl="INTERACTION/RESUME",sl="INTERACTION/SET_CURSOR";const al=class extends qt{constructor(e,t){super(e,t),this.modes=new Map,this.cursorClaims=new Map,this.buckets=new Map,this.alwaysGlobal=new Set,this.alwaysPage=new Map,this.onModeChange$=ei(),this.onHandlerChange$=ei(),this.onCursorChange$=ei(),this.onStateChange$=ti(),this.registerMode({id:"default",scope:"page",exclusive:!1,cursor:"auto"})}async initialize(e){}buildCapability(){return{activate:e=>this.activate(e),onModeChange:this.onModeChange$.on,onCursorChange:this.onCursorChange$.on,onHandlerChange:this.onHandlerChange$.on,onStateChange:this.onStateChange$.on,getActiveMode:()=>this.state.activeMode,getActiveInteractionMode:()=>this.getActiveInteractionMode(),finish:()=>this.activate("default"),registerMode:e=>this.registerMode(e),registerHandlers:e=>this.registerHandlers(e),registerAlways:e=>this.registerAlways(e),setCursor:(e,t,i=0)=>this.setCursor(e,t,i),removeCursor:e=>this.removeCursor(e),getCurrentCursor:()=>this.state.cursor,getHandlersForScope:e=>this.getHandlersForScope(e),activeModeIsExclusive:()=>this.activeModeIsExclusive(),pause:()=>this.dispatch({type:ol}),resume:()=>this.dispatch({type:nl}),isPaused:()=>this.state.paused}}activate(e){if(!this.modes.has(e))throw new Error(`[interaction] unknown mode '${e}'`);if(e===this.state.activeMode)return;const t=this.state.activeMode;this.cursorClaims.clear(),this.notifyHandlersInactive(t),this.dispatch((e=>({type:rl,payload:{mode:e}}))(e)),this.emitCursor(),this.notifyHandlersActive(e),this.onModeChange$.emit({...this.state,activeMode:e})}notifyHandlersActive(e){this.alwaysGlobal.forEach(t=>{var i;null==(i=t.onHandlerActiveStart)||i.call(t,e)}),this.alwaysPage.forEach(t=>{t.forEach(t=>{var i;null==(i=t.onHandlerActiveStart)||i.call(t,e)})});const t=this.modes.get(e);if(!t)return;const i=this.buckets.get(e);i&&("global"===t.scope&&i.global.forEach(t=>{var i;null==(i=t.onHandlerActiveStart)||i.call(t,e)}),"page"===t.scope&&i.page.forEach((t,i)=>{t.forEach(t=>{var i;null==(i=t.onHandlerActiveStart)||i.call(t,e)})}))}notifyHandlersInactive(e){this.alwaysGlobal.forEach(t=>{var i;null==(i=t.onHandlerActiveEnd)||i.call(t,e)}),this.alwaysPage.forEach(t=>{t.forEach(t=>{var i;null==(i=t.onHandlerActiveEnd)||i.call(t,e)})});const t=this.modes.get(e);if(!t)return;const i=this.buckets.get(e);i&&("global"===t.scope&&i.global.forEach(t=>{var i;null==(i=t.onHandlerActiveEnd)||i.call(t,e)}),"page"===t.scope&&i.page.forEach((t,i)=>{t.forEach(t=>{var i;null==(i=t.onHandlerActiveEnd)||i.call(t,e)})}))}registerMode(e){this.modes.set(e.id,e),this.buckets.has(e.id)||this.buckets.set(e.id,{global:new Set,page:new Map})}registerHandlers({modeId:e,handlers:t,pageIndex:i}){const r=Array.isArray(e)?e:[e],o=[];for(const e of r){const r=this.buckets.get(e);if(!r)throw new Error(`unknown mode '${e}'`);if(null==i)r.global.add(t);else{const e=r.page.get(i)??new Set;e.add(t),r.page.set(i,e)}o.push(()=>{if(null==i)r.global.delete(t);else{const e=r.page.get(i);e&&(e.delete(t),0===e.size&&r.page.delete(i))}})}return this.onHandlerChange$.emit({...this.state}),()=>{o.forEach(e=>e()),this.onHandlerChange$.emit({...this.state})}}registerAlways({scope:e,handlers:t}){if("global"===e.type)return this.alwaysGlobal.add(t),this.onHandlerChange$.emit({...this.state}),()=>this.alwaysGlobal.delete(t);const i=this.alwaysPage.get(e.pageIndex)??new Set;return i.add(t),this.alwaysPage.set(e.pageIndex,i),this.onHandlerChange$.emit({...this.state}),()=>{i.delete(t),this.onHandlerChange$.emit({...this.state})}}getHandlersForScope(e){if(!this.state)return null;const t=this.modes.get(this.state.activeMode);if(!t)return null;const i=this.buckets.get(t.id);if(!i)return null;const r=(e,t)=>e.size||t.size?function(e){const t=["onPointerDown","onPointerUp","onPointerMove","onPointerEnter","onPointerLeave","onPointerCancel"],i={};for(const r of t)i[r]=(t,i,o)=>{var n;for(const s of e)null==(n=s[r])||n.call(s,t,i,o)};return i}([...e,...t]):null;if("global"===e.type){const e="global"===t.scope?i.global:new Set;return r(this.alwaysGlobal,e)}return r(this.alwaysPage.get(e.pageIndex)??new Set,"page"===t.scope?i.page.get(e.pageIndex)??new Set:new Set)}setCursor(e,t,i=0){this.cursorClaims.set(e,{cursor:t,priority:i}),this.emitCursor()}removeCursor(e){this.cursorClaims.delete(e),this.emitCursor()}emitCursor(){var e;const t=[...this.cursorClaims.values()].sort((e,t)=>t.priority-e.priority)[0]??{cursor:(null==(e=this.modes.get(this.state.activeMode))?void 0:e.cursor)??"auto"};t.cursor!==this.state.cursor&&(this.dispatch((e=>({type:sl,payload:{cursor:e}}))(t.cursor)),this.onCursorChange$.emit(t.cursor))}onStoreUpdated(e,t){this.onStateChange$.emit(t)}activeModeIsExclusive(){const e=this.modes.get(this.state.activeMode);return!(null==e||!e.exclusive)}getActiveInteractionMode(){return this.modes.get(this.state.activeMode)??null}async destroy(){this.onModeChange$.clear(),this.onCursorChange$.clear(),await super.destroy()}};al.id="interaction-manager";let ll=al;const cl="interaction-manager",dl={activeMode:"default",cursor:"auto",paused:!1},ul={manifest:{id:cl,name:"Interaction Manager Plugin",version:"1.0.0",provides:["interaction-manager"],requires:[],optional:[],defaultConfig:{enabled:!0}},create:e=>new ll(cl,e),reducer:(e,t)=>{switch(t.type){case rl:return{...e,activeMode:t.payload.mode};case sl:return{...e,cursor:t.payload.cursor};case ol:return{...e,paused:!0};case nl:return{...e,paused:!1};default:return e}},initialState:dl},hl=()=>si(ll.id);const pl=({children:e,style:t,...i})=>{const r=Te(null),{provides:o}=hl();return Pe(()=>{if(o&&r.current)return il(o,{type:"global"},r.current)},[o]),he("div",{ref:r,style:{width:"100%",height:"100%",...t},...i,children:e})},gl=({pageIndex:e,children:t,pageWidth:i,pageHeight:r,rotation:o,scale:n,convertEventToPoint:s,style:a,...l})=>{const c=Te(null),{provides:d}=hl(),u=function(){const{provides:e}=hl(),[t,i]=ke(()=>{const t=null==e?void 0:e.getActiveInteractionMode();return"page"===(null==t?void 0:t.scope)&&!!t.exclusive});return Pe(()=>{if(e)return e.onModeChange(()=>{const t=e.getActiveInteractionMode();i("page"===(null==t?void 0:t.scope)&&!(null==t||!t.exclusive))})},[e]),t}(),h=_e((e,t)=>{const s=t.getBoundingClientRect(),a={x:e.clientX-s.left,y:e.clientY-s.top};return l=n,Ke(Xe({width:i,height:r},a,(4-o)%4),1/l);var l},[i,r,o,n]);return Pe(()=>{if(d&&c.current)return il(d,{type:"page",pageIndex:e},c.current,s||h)},[d,e,s,h]),he("div",{ref:c,style:{...a},...l,children:[t,u&&he("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,zIndex:10}})]})},fl=()=>si(Ja.id);function ml({pageIndex:e,scale:t,background:i="rgba(33,150,243)"}){const{provides:r}=fl(),{provides:o}=hl(),{register:n}=function({modeId:e,pageIndex:t}){const{provides:i}=hl();return{register:(r,o)=>{const n=(null==o?void 0:o.modeId)??e,s=(null==o?void 0:o.pageIndex)??t;return n?null==i?void 0:i.registerHandlers({modeId:n,handlers:r,pageIndex:s}):null==i?void 0:i.registerAlways({scope:void 0!==s?{type:"page",pageIndex:s}:{type:"global"},handlers:r})}}}({pageIndex:e}),[s,a]=ke([]),[l,c]=ke(null),{setCursor:d,removeCursor:u}=function(){const{provides:e}=hl();return{setCursor:(t,i,r=0)=>{null==e||e.setCursor(t,i,r)},removeCursor:t=>{null==e||e.removeCursor(t)}}}(),h=Te(null);Pe(()=>{if(r)return r.onSelectionChange(()=>{"default"===(null==o?void 0:o.getActiveMode())?(a(r.getHighlightRectsForPage(e)),c(r.getBoundingRectForPage(e))):(a([]),c(null))})},[r,e]);const p=_e(e=>{const t=h.current;return t?Va(t,e):-1},[]);Pe(()=>{if(!r)return;const t=r.getGeometry(e);return t.wait(e=>h.current=e,Mt),()=>{t.abort({code:xt.Cancelled,message:"Cancelled"}),h.current=null}},[r,e]);const g=Re(()=>({onPointerDown:(t,i,o)=>{r&&r.isEnabledForMode(o)&&(r.clear(),r.getGeometry(e).wait(i=>{const o=Va(i,t);-1!==o&&r.begin(e,o)},Mt))},onPointerMove:(t,i,o)=>{if(!r||!r.isEnabledForMode(o))return;const n=p(t);-1!==n?d("selection-text","text",10):u("selection-text"),-1!==n&&r.update(e,n)},onPointerUp:(e,t,i)=>{r&&r.isEnabledForMode(i)&&r.end()},onHandlerActiveEnd(e){r&&r.isEnabledForMode(e)&&r.clear()}}),[r,e,p]);return Pe(()=>{if(n)return n(g)},[n,g]),l?he("div",{style:{position:"absolute",left:l.origin.x*t,top:l.origin.y*t,width:l.size.width*t,height:l.size.height*t,mixBlendMode:"multiply",isolation:"isolate"},children:s.map((e,r)=>he("div",{style:{position:"absolute",left:(e.origin.x-l.origin.x)*t,top:(e.origin.y-l.origin.y)*t,width:e.size.width*t,height:e.size.height*t,background:i,pointerEvents:"none"}},r))}):null}function bl(){const{provides:e}=fl();return Pe(()=>{if(e)return e.onCopyToClipboard(e=>{navigator.clipboard.writeText(e)})},[e]),null}function vl(e,t,i,r,o,n){return n?e.origin.y+o>=i+r:e.origin.y+o+e.size.height+i+r<=t.scrollTop+t.clientHeight}function yl(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:40;if(!e.length)return null;var n=i.getMetrics(),s=i.getViewportGap(),a=1===e.length?{first:e[0],last:e[0]}:{first:e[0],last:e[e.length-1]},l=t.getRectPositionForPage(a.first.page,a.first.rect),c=t.getRectPositionForPage(a.last.page,a.last.rect);if(!l||!c)return null;var d=vl(c,n,o,r,s,!1),u=vl(l,n,o,r,s,!0);return d?{left:c.origin.x+c.size.width/2,top:c.origin.y+c.size.height+r}:u?{left:l.origin.x+l.size.width/2,top:l.origin.y-r-o}:null}function wl(e){var t=e.open,i=e.title,r=e.children,o=e.onClose,n=e.className,s=e.showCloseButton,a=void 0===s||s;e.maxWidth;var l=Te(null);Pe(function(){if(t){var e=function(e){"Escape"===e.key&&(null==o||o())};return document.addEventListener("keydown",e),function(){return document.removeEventListener("keydown",e)}}},[t,o]);return Pe(function(){return document.body.style.overflow=t?"hidden":"",function(){document.body.style.overflow=""}},[t]),t?he("div",{ref:l,className:"fixed inset-0 z-50 bg-black/50 md:flex md:items-center md:justify-center",onClick:function(e){e.target===l.current&&(null==o||o())},children:he("div",{className:"relative flex h-full w-full flex-col bg-white md:h-auto md:w-[28rem] md:max-w-[90vw] md:rounded-lg md:border md:border-gray-200 md:shadow-lg ".concat(n),onClick:function(e){return e.stopPropagation()},children:[(i||a)&&he("div",{className:"flex flex-shrink-0 items-center justify-between border-b border-gray-200 px-6 py-4",children:[i&&he("h2",{className:"text-lg font-semibold text-gray-900",children:i}),a&&he(_r,{onClick:o,className:"p-1 hover:bg-gray-100",children:he(js,{icon:"x",className:"h-5 w-5"})})]}),he("div",{className:"flex-1 overflow-y-auto px-6 py-4 md:max-h-[80vh] md:flex-none",children:r})]})}):null}var Sl=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${Sl.join("")}]`,"g");var Cl=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);Cl.reduce((e,t)=>(e[t.id]=t,e),{}),Cl.reduce((e,t)=>(e[t.css]=t.id,e),{}),Cl.map(e=>({value:e.id,label:e.label}));var xl=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});Object.entries(xl).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var Il=ce({registry:null,isInitializing:!0,pluginsReady:!1});function Al(e){const{registry:t}=function(){const e=Ne(Il);if(void 0===e)throw new Error("useCapability must be used within a PDFContext.Provider");const{registry:t,isInitializing:i}=e;if(i)return e;if(null===t)throw new Error("PDF registry failed to initialize properly");return e}();if(null===t)return{plugin:null,isLoading:!0,ready:new Promise(()=>{})};const i=t.getPlugin(e);if(!i)throw new Error(`Plugin ${e} not found`);return{plugin:i,isLoading:!1,ready:i.ready()}}var El=(e=>(e[e.Degree0=0]="Degree0",e[e.Degree90=1]="Degree90",e[e.Degree180=2]="Degree180",e[e.Degree270=3]="Degree270",e))(El||{}),kl=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${kl.join("")}]`,"g");var Pl=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);Pl.reduce((e,t)=>(e[t.id]=t,e),{}),Pl.reduce((e,t)=>(e[t.css]=t.id,e),{}),Pl.map(e=>({value:e.id,label:e.label}));var Ml=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});Object.entries(Ml).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var Tl=class{constructor(e,t){if(this.id=e,this.registry=t,this.debouncedActions={},this.unsubscribeFromState=null,this.unsubscribeFromCoreStore=null,e!==this.constructor.id)throw new Error(`Plugin ID mismatch: ${e} !== ${this.constructor.id}`);this.coreStore=this.registry.getStore(),this.pluginStore=this.coreStore.getPluginStore(this.id),this.unsubscribeFromState=this.pluginStore.subscribeToState((e,t,i)=>{this.onStoreUpdated(i,t)}),this.unsubscribeFromCoreStore=this.coreStore.subscribe((e,t,i)=>{this.onCoreStoreUpdated(i,t)}),this.readyPromise=new Promise(e=>{this.readyResolve=e}),this.readyResolve()}provides(){if(!this._capability){const e=this.buildCapability();this._capability=Object.freeze(e)}return this._capability}get state(){return this.pluginStore.getState()}get coreState(){return this.coreStore.getState()}getState(){return this.pluginStore.getState()}getCoreState(){return this.coreStore.getState()}dispatchCoreAction(e){return this.coreStore.dispatchToCore(e)}dispatchToAllPlugins(e){return this.coreStore.dispatch(e)}dispatch(e){return this.pluginStore.dispatch(e)}debouncedDispatch(e,t=100){const i=Date.now();return i-(this.debouncedActions[e.type]||0)>=t&&(this.debouncedActions[e.type]=i,this.dispatch(e),!0)}subscribe(e){return this.pluginStore.subscribeToState(e)}subscribeToCoreStore(e){return this.coreStore.subscribe(e)}onStoreUpdated(e,t){}onCoreStoreUpdated(e,t){}destroy(){this.unsubscribeFromState&&(this.unsubscribeFromState(),this.unsubscribeFromState=null),this.unsubscribeFromCoreStore&&(this.unsubscribeFromCoreStore(),this.unsubscribeFromCoreStore=null)}ready(){return this.readyPromise}markReady(){this.readyResolve()}resetReady(){this.readyPromise=new Promise(e=>{this.readyResolve=e})}},Rl=class extends Tl{constructor(e,t,i){super(e,t),this.engine=i}async initialize(e){}buildCapability(){return{renderPage:this.renderPage.bind(this),renderPageRect:this.renderPageRect.bind(this)}}renderPage({pageIndex:e,scaleFactor:t=1,dpr:i=1,rotation:r=El.Degree0,options:o={withAnnotations:!1},imageType:n="image/webp"}){const s=this.coreState.core;if(!s.document)throw new Error("document does not open");const a=s.document.pages.find(t=>t.index===e);if(!a)throw new Error("page does not exist");return this.engine.renderPage(s.document,a,t,r,i,o,n)}renderPageRect({pageIndex:e,scaleFactor:t=1,dpr:i=1,rect:r,rotation:o=El.Degree0,options:n={withAnnotations:!1},imageType:s="image/webp"}){const a=this.coreState.core;if(!a.document)throw new Error("document does not open");const l=a.document.pages.find(t=>t.index===e);if(!l)throw new Error("page does not exist");return this.engine.renderPageRect(a.document,l,t,o,i,r,n,s)}};Rl.id="render";var _l=Rl,Nl=class extends Tl{constructor(e,t,i){super(e,t),this.config=i,this.renderCapability=this.registry.getPlugin(_l.id)?.provides()}async initialize(e){}buildCapability(){return{preparePrint:this.preparePrint.bind(this),parsePageRange:this.parsePageRange.bind(this)}}async preparePrint(e,t,i){const r=this.coreState.core;if(!r.document)throw new Error("No document loaded");const o=this.getPagesToPrint(e,r.document.pages.length),n=o.length,s=this.config?.batchSize||3;t?.({current:0,total:n,status:"preparing",message:`Preparing to render ${n} page${1!==n?"s":""}...`});const a=this.getScaleFactor(e.quality);for(let r=0;r<o.length;r+=s){const l=Math.min(r+s,o.length),c=o.slice(r,l).map(async(o,s)=>{const l=r+s;t?.({current:l,total:n,status:"rendering",message:`Rendering page ${o+1}...`});const c=await this.renderPage(o,a,1,e.includeAnnotations);i?.({pageIndex:o,blob:c})});await Promise.all(c)}t?.({current:n,total:n,status:"complete",message:"All pages rendered successfully"})}async renderPage(e,t,i,r){return new Promise((o,n)=>{this.renderCapability.renderPage({pageIndex:e,scaleFactor:t,dpr:i,rotation:El.Degree0,options:{withAnnotations:r}}).wait(e=>o(e),t=>n(new Error(`Failed to render page ${e+1}: ${t.reason.message||"Unknown error"}`)))})}getScaleFactor(e){return"high"===e?1.5:1}getPagesToPrint(e,t){const{pageRange:i}=e;switch(i.type){case"current":return void 0!==i.currentPage?[i.currentPage]:[0];case"all":return Array.from({length:t},(e,t)=>t);case"custom":return i.pages?i.pages.filter(e=>e>=0&&e<t).sort((e,t)=>e-t):[0];default:return[0]}}parsePageRange(e){try{const t=this.coreState.core.document?.pages.length||0,i=[],r=e.split(",").map(e=>e.trim());for(const e of r)if(e.includes("-")){const[r,o]=e.split("-").map(e=>parseInt(e.trim()));if(isNaN(r)||isNaN(o))return{pages:[],isValid:!1,error:`Invalid range: ${e}`};if(r>o)return{pages:[],isValid:!1,error:`Invalid range: ${e} (start > end)`};for(let e=r;e<=o;e++)e>=1&&e<=t&&i.push(e-1)}else{const r=parseInt(e);if(isNaN(r))return{pages:[],isValid:!1,error:`Invalid page number: ${e}`};r>=1&&r<=t&&i.push(r-1)}const o=[...new Set(i)].sort((e,t)=>e-t);return{pages:o,isValid:!0}}catch(e){return{pages:[],isValid:!1,error:`Parsing error: ${e instanceof Error?e.message:"Unknown error"}`}}}};Nl.id="print";var Ol=()=>function(e){const{plugin:t,isLoading:i,ready:r}=Al(e);if(!t)return{provides:null,isLoading:i,ready:r};if(!t.provides)throw new Error(`Plugin ${e} does not provide a capability`);return{provides:t.provides(),isLoading:i,ready:r}}(Nl.id),zl=ce(null),Ll=({pageResult:e})=>{const[t,i]=ke("");Pe(()=>{const t=URL.createObjectURL(e.blob);return i(t),()=>{URL.revokeObjectURL(t)}},[e.blob]);return he("div",{style:{pageBreakAfter:"always",width:"210mm",minHeight:"297mm",margin:"0 auto",background:"white",position:"relative"},children:he("img",{src:t,onLoad:()=>{t&&URL.revokeObjectURL(t)},alt:`Page ${e.pageIndex+1}`,style:{width:"100%",height:"auto",display:"block",objectFit:"contain"}})})},Dl=({pages:e})=>he("div",{style:{fontFamily:"Arial, sans-serif",fontSize:"12px",lineHeight:"1.4",color:"#000",backgroundColor:"#fff"},children:[he("style",{children:"\n        @media print {\n          body { margin: 0; padding: 0; }\n        }\n      "}),e.map(e=>he("div",{children:he(Ll,{pageResult:e})},e.pageIndex))]});function Fl({children:e}){const{provides:t}=Ol(),i=Te(null),[r,o]=ke(null),[n,s]=ke(!1),[a,l]=ke(!1),[c,d]=ke([]);Pe(()=>{const e=i.current,t=e?.contentWindow?.document?.body;if(t&&c.length>0)return le(he(Dl,{pages:c}),t),s(!0),()=>{t&&le(null,t)}},[c]);const u={parsePageRange:t?.parsePageRange||(()=>({pages:[],isValid:!1})),executePrint:async e=>{if(!t)throw new Error("Print capability not available");if(!i.current?.contentWindow)throw new Error("Print iframe not ready");l(!0),o(null),d([]),s(!1);try{const n=[];await t.preparePrint(e,e=>{o(e)},e=>{n.push(e),d([...n])}),await new Promise(e=>setTimeout(e,500));const s=i.current.contentWindow;s.focus(),s.print(),o({current:r?.total||0,total:r?.total||0,status:"complete",message:"Print dialog opened"})}catch(e){throw o({current:0,total:0,status:"error",message:`Print failed: ${e instanceof Error?e.message:"Unknown error"}`}),e}finally{l(!1)}},progress:r,isReady:n,isPrinting:a};return he(zl.Provider,{value:u,children:[e,he("iframe",{ref:i,style:{display:"none",width:"210mm",height:"297mm"},title:"Print Preview"})]})}var Hl=()=>{const{executePrint:e,progress:t,isReady:i,isPrinting:r,parsePageRange:o}=function(){const e=Ne(zl);if(!e)throw new Error("usePrintContext must be used within a PrintProvider");return e}();return{executePrint:e,progress:t,isReady:i,isPrinting:r,parsePageRange:o}},$l="print",jl={id:$l,name:"Print Plugin",version:"1.0.0",provides:["print"],requires:["render"],optional:[],defaultConfig:{enabled:!0}},Ul=(e=>(e[e.Degree0=0]="Degree0",e[e.Degree90=1]="Degree90",e[e.Degree180=2]="Degree180",e[e.Degree270=3]="Degree270",e))(Ul||{}),Bl=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${Bl.join("")}]`,"g");var Gl=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);Gl.reduce((e,t)=>(e[t.id]=t,e),{}),Gl.reduce((e,t)=>(e[t.css]=t.id,e),{}),Gl.map(e=>({value:e.id,label:e.label}));var Vl=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});Object.entries(Vl).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var Wl=class{constructor(e,t){if(this.id=e,this.registry=t,this.debouncedActions={},this.unsubscribeFromState=null,this.unsubscribeFromCoreStore=null,e!==this.constructor.id)throw new Error(`Plugin ID mismatch: ${e} !== ${this.constructor.id}`);this.coreStore=this.registry.getStore(),this.pluginStore=this.coreStore.getPluginStore(this.id),this.unsubscribeFromState=this.pluginStore.subscribeToState((e,t,i)=>{this.onStoreUpdated(i,t)}),this.unsubscribeFromCoreStore=this.coreStore.subscribe((e,t,i)=>{this.onCoreStoreUpdated(i,t)}),this.readyPromise=new Promise(e=>{this.readyResolve=e}),this.readyResolve()}provides(){if(!this._capability){const e=this.buildCapability();this._capability=Object.freeze(e)}return this._capability}get state(){return this.pluginStore.getState()}get coreState(){return this.coreStore.getState()}getState(){return this.pluginStore.getState()}getCoreState(){return this.coreStore.getState()}dispatchCoreAction(e){return this.coreStore.dispatchToCore(e)}dispatchToAllPlugins(e){return this.coreStore.dispatch(e)}dispatch(e){return this.pluginStore.dispatch(e)}debouncedDispatch(e,t=100){const i=Date.now();return i-(this.debouncedActions[e.type]||0)>=t&&(this.debouncedActions[e.type]=i,this.dispatch(e),!0)}subscribe(e){return this.pluginStore.subscribeToState(e)}subscribeToCoreStore(e){return this.coreStore.subscribe(e)}onStoreUpdated(e,t){}onCoreStoreUpdated(e,t){}destroy(){this.unsubscribeFromState&&(this.unsubscribeFromState(),this.unsubscribeFromState=null),this.unsubscribeFromCoreStore&&(this.unsubscribeFromCoreStore(),this.unsubscribeFromCoreStore=null)}ready(){return this.readyPromise}markReady(){this.readyResolve()}resetReady(){this.readyPromise=new Promise(e=>{this.readyResolve=e})}},Zl=class extends Wl{constructor(e,t,i){super(e,t),this.engine=i}async initialize(e){}buildCapability(){return{renderPage:this.renderPage.bind(this),renderPageRect:this.renderPageRect.bind(this)}}renderPage({pageIndex:e,scaleFactor:t=1,dpr:i=1,rotation:r=Ul.Degree0,options:o={withAnnotations:!1},imageType:n="image/webp"}){const s=this.coreState.core;if(!s.document)throw new Error("document does not open");const a=s.document.pages.find(t=>t.index===e);if(!a)throw new Error("page does not exist");return this.engine.renderPage(s.document,a,t,r,i,o,n)}renderPageRect({pageIndex:e,scaleFactor:t=1,dpr:i=1,rect:r,rotation:o=Ul.Degree0,options:n={withAnnotations:!1},imageType:s="image/webp"}){const a=this.coreState.core;if(!a.document)throw new Error("document does not open");const l=a.document.pages.find(t=>t.index===e);if(!l)throw new Error("page does not exist");return this.engine.renderPageRect(a.document,l,t,o,i,r,n,s)}};Zl.id="render";var ql=Zl,Xl=(e=>(e.Normal="normal",e.High="high",e))(Xl||{}),Kl=(e=>(e.Current="current",e.All="all",e.Custom="custom",e))(Kl||{}),Yl=class extends Wl{constructor(e,t,i){super(e,t),this.config=i,this.renderCapability=this.registry.getPlugin(ql.id)?.provides()}async initialize(e){}buildCapability(){return{preparePrint:this.preparePrint.bind(this),parsePageRange:this.parsePageRange.bind(this)}}async preparePrint(e,t,i){const r=this.coreState.core;if(!r.document)throw new Error("No document loaded");const o=this.getPagesToPrint(e,r.document.pages.length),n=o.length,s=this.config?.batchSize||3;t?.({current:0,total:n,status:"preparing",message:`Preparing to render ${n} page${1!==n?"s":""}...`});const a=this.getScaleFactor(e.quality);for(let r=0;r<o.length;r+=s){const l=Math.min(r+s,o.length),c=o.slice(r,l).map(async(o,s)=>{const l=r+s;t?.({current:l,total:n,status:"rendering",message:`Rendering page ${o+1}...`});const c=await this.renderPage(o,a,1,e.includeAnnotations);i?.({pageIndex:o,blob:c})});await Promise.all(c)}t?.({current:n,total:n,status:"complete",message:"All pages rendered successfully"})}async renderPage(e,t,i,r){return new Promise((o,n)=>{this.renderCapability.renderPage({pageIndex:e,scaleFactor:t,dpr:i,rotation:Ul.Degree0,options:{withAnnotations:r}}).wait(e=>o(e),t=>n(new Error(`Failed to render page ${e+1}: ${t.reason.message||"Unknown error"}`)))})}getScaleFactor(e){return"high"===e?1.5:1}getPagesToPrint(e,t){const{pageRange:i}=e;switch(i.type){case"current":return void 0!==i.currentPage?[i.currentPage]:[0];case"all":return Array.from({length:t},(e,t)=>t);case"custom":return i.pages?i.pages.filter(e=>e>=0&&e<t).sort((e,t)=>e-t):[0];default:return[0]}}parsePageRange(e){try{const t=this.coreState.core.document?.pages.length||0,i=[],r=e.split(",").map(e=>e.trim());for(const e of r)if(e.includes("-")){const[r,o]=e.split("-").map(e=>parseInt(e.trim()));if(isNaN(r)||isNaN(o))return{pages:[],isValid:!1,error:`Invalid range: ${e}`};if(r>o)return{pages:[],isValid:!1,error:`Invalid range: ${e} (start > end)`};for(let e=r;e<=o;e++)e>=1&&e<=t&&i.push(e-1)}else{const r=parseInt(e);if(isNaN(r))return{pages:[],isValid:!1,error:`Invalid page number: ${e}`};r>=1&&r<=t&&i.push(r-1)}const o=[...new Set(i)].sort((e,t)=>e-t);return{pages:o,isValid:!0}}catch(e){return{pages:[],isValid:!1,error:`Parsing error: ${e instanceof Error?e.message:"Unknown error"}`}}}};Yl.id="print";var Ql={manifest:jl,create:(e,t,i)=>new Yl($l,e,i),reducer:()=>{},initialState:{}},Jl=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${Jl.join("")}]`,"g");var ec=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);ec.reduce((e,t)=>(e[t.id]=t,e),{}),ec.reduce((e,t)=>(e[t.css]=t.id,e),{}),ec.map(e=>({value:e.id,label:e.label}));var tc=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});Object.entries(tc).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var ic=ce({registry:null,isInitializing:!0,pluginsReady:!1});function rc(e){const{registry:t}=function(){const e=Ne(ic);if(void 0===e)throw new Error("useCapability must be used within a PDFContext.Provider");const{registry:t,isInitializing:i}=e;if(i)return e;if(null===t)throw new Error("PDF registry failed to initialize properly");return e}();if(null===t)return{plugin:null,isLoading:!0,ready:new Promise(()=>{})};const i=t.getPlugin(e);if(!i)throw new Error(`Plugin ${e} not found`);return{plugin:i,isLoading:!1,ready:i.ready()}}var oc=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${oc.join("")}]`,"g");var nc=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);nc.reduce((e,t)=>(e[t.id]=t,e),{}),nc.reduce((e,t)=>(e[t.css]=t.id,e),{}),nc.map(e=>({value:e.id,label:e.label}));var sc=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});Object.entries(sc).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var ac=class{constructor(e,t){if(this.id=e,this.registry=t,this.debouncedActions={},this.unsubscribeFromState=null,this.unsubscribeFromCoreStore=null,e!==this.constructor.id)throw new Error(`Plugin ID mismatch: ${e} !== ${this.constructor.id}`);this.coreStore=this.registry.getStore(),this.pluginStore=this.coreStore.getPluginStore(this.id),this.unsubscribeFromState=this.pluginStore.subscribeToState((e,t,i)=>{this.onStoreUpdated(i,t)}),this.unsubscribeFromCoreStore=this.coreStore.subscribe((e,t,i)=>{this.onCoreStoreUpdated(i,t)}),this.readyPromise=new Promise(e=>{this.readyResolve=e}),this.readyResolve()}provides(){if(!this._capability){const e=this.buildCapability();this._capability=Object.freeze(e)}return this._capability}get state(){return this.pluginStore.getState()}get coreState(){return this.coreStore.getState()}getState(){return this.pluginStore.getState()}getCoreState(){return this.coreStore.getState()}dispatchCoreAction(e){return this.coreStore.dispatchToCore(e)}dispatchToAllPlugins(e){return this.coreStore.dispatch(e)}dispatch(e){return this.pluginStore.dispatch(e)}debouncedDispatch(e,t=100){const i=Date.now();return i-(this.debouncedActions[e.type]||0)>=t&&(this.debouncedActions[e.type]=i,this.dispatch(e),!0)}subscribe(e){return this.pluginStore.subscribeToState(e)}subscribeToCoreStore(e){return this.coreStore.subscribe(e)}onStoreUpdated(e,t){}onCoreStoreUpdated(e,t){}destroy(){this.unsubscribeFromState&&(this.unsubscribeFromState(),this.unsubscribeFromState=null),this.unsubscribeFromCoreStore&&(this.unsubscribeFromCoreStore(),this.unsubscribeFromCoreStore=null)}ready(){return this.readyPromise}markReady(){this.readyResolve()}resetReady(){this.readyPromise=new Promise(e=>{this.readyResolve=e})}},lc=class extends ac{constructor(e,t,i){super(e,t),this.engine=i}async initialize(e){}buildCapability(){return{getBookmarks:this.getBookmarks.bind(this)}}getBookmarks(){const e=this.coreState.core.document;if(!e)throw new Error("Document not open");return this.engine.getBookmarks(e)}};lc.id="bookmark";var cc=()=>function(e){const{plugin:t,isLoading:i,ready:r}=rc(e);if(!t)return{provides:null,isLoading:i,ready:r};if(!t.provides)throw new Error(`Plugin ${e} does not provide a capability`);return{provides:t.provides(),isLoading:i,ready:r}}(lc.id);function dc(e){if(0===e.length)return null;let t=e[0].origin.x,i=e[0].origin.y,r=e[0].origin.x+e[0].size.width,o=e[0].origin.y+e[0].size.height;for(const n of e)t=Math.min(t,n.origin.x),i=Math.min(i,n.origin.y),r=Math.max(r,n.origin.x+n.size.width),o=Math.max(o,n.origin.y+n.size.height);return{origin:{x:t,y:i},size:{width:r-t,height:o-i}}}var uc=class extends Error{constructor(e){super(`Task aborted: ${JSON.stringify(e)}`),this.name="TaskAbortedError"}},hc=class extends Error{constructor(e){super(`Task rejected: ${JSON.stringify(e)}`),this.name="TaskRejectedError"}},pc=class e{constructor(){this.state={stage:0},this.resolvedCallbacks=[],this.rejectedCallbacks=[],this._promise=null}toPromise(){return this._promise||(this._promise=new Promise((e,t)=>{this.wait(t=>e(t),e=>{"abort"===e.type?t(new uc(e.reason)):t(new hc(e.reason))})})),this._promise}wait(e,t){switch(this.state.stage){case 0:this.resolvedCallbacks.push(e),this.rejectedCallbacks.push(t);break;case 1:e(this.state.result);break;case 2:t({type:"reject",reason:this.state.reason});break;case 3:t({type:"abort",reason:this.state.reason})}}resolve(e){if(0===this.state.stage){this.state={stage:1,result:e};for(const t of this.resolvedCallbacks)try{t(e)}catch(e){}this.resolvedCallbacks=[],this.rejectedCallbacks=[]}}reject(e){if(0===this.state.stage){this.state={stage:2,reason:e};for(const t of this.rejectedCallbacks)try{t({type:"reject",reason:e})}catch(e){}this.resolvedCallbacks=[],this.rejectedCallbacks=[]}}abort(e){if(0===this.state.stage){this.state={stage:3,reason:e};for(const t of this.rejectedCallbacks)try{t({type:"abort",reason:e})}catch(e){}this.resolvedCallbacks=[],this.rejectedCallbacks=[]}}fail(e){"abort"===e.type?this.abort(e.reason):this.reject(e.reason)}static all(t){const i=new e;if(0===t.length)return i.resolve([]),i;const r=new Array(t.length);let o=0,n=!1;return t.forEach((e,s)=>{e.wait(e=>{n||(r[s]=e,o++,o===t.length&&(n=!0,i.resolve(r)))},e=>{n||(n=!0,"abort"===e.type?i.abort(e.reason):i.reject(e.reason))})}),i}static allSettled(t){const i=new e;if(0===t.length)return i.resolve([]),i;const r=new Array(t.length);let o=0;return t.forEach((e,n)=>{e.wait(e=>{r[n]={status:"resolved",value:e},o++,o===t.length&&i.resolve(r)},e=>{r[n]={status:"abort"===e.type?"aborted":"rejected",reason:e.reason},o++,o===t.length&&i.resolve(r)})}),i}static race(t){const i=new e;if(0===t.length)return i.reject("No tasks provided"),i;let r=!1;return t.forEach(e=>{e.wait(e=>{r||(r=!0,i.resolve(e))},e=>{r||(r=!0,"abort"===e.type?i.abort(e.reason):i.reject(e.reason))})}),i}static withProgress(t,i){const r=e.all(t);if(i){let e=0;t.forEach(r=>{r.wait(()=>{e++,i(e,t.length)},()=>{e++,i(e,t.length)})})}return r}},gc=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${gc.join("")}]`,"g");var fc=(e=>(e[e.Normal=0]="Normal",e[e.Multiply=1]="Multiply",e[e.Screen=2]="Screen",e[e.Overlay=3]="Overlay",e[e.Darken=4]="Darken",e[e.Lighten=5]="Lighten",e[e.ColorDodge=6]="ColorDodge",e[e.ColorBurn=7]="ColorBurn",e[e.HardLight=8]="HardLight",e[e.SoftLight=9]="SoftLight",e[e.Difference=10]="Difference",e[e.Exclusion=11]="Exclusion",e[e.Hue=12]="Hue",e[e.Saturation=13]="Saturation",e[e.Color=14]="Color",e[e.Luminosity=15]="Luminosity",e))(fc||{}),mc=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]),bc=mc.reduce((e,t)=>(e[t.id]=t,e),{});function vc(e){return function(e){return bc[e]??bc[0]}(e).css}mc.reduce((e,t)=>(e[t.css]=t.id,e),{}),mc.map(e=>({value:e.id,label:e.label}));var yc=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.TEXT=1]="TEXT",e[e.LINK=2]="LINK",e[e.FREETEXT=3]="FREETEXT",e[e.LINE=4]="LINE",e[e.SQUARE=5]="SQUARE",e[e.CIRCLE=6]="CIRCLE",e[e.POLYGON=7]="POLYGON",e[e.POLYLINE=8]="POLYLINE",e[e.HIGHLIGHT=9]="HIGHLIGHT",e[e.UNDERLINE=10]="UNDERLINE",e[e.SQUIGGLY=11]="SQUIGGLY",e[e.STRIKEOUT=12]="STRIKEOUT",e[e.STAMP=13]="STAMP",e[e.CARET=14]="CARET",e[e.INK=15]="INK",e[e.POPUP=16]="POPUP",e[e.FILEATTACHMENT=17]="FILEATTACHMENT",e[e.SOUND=18]="SOUND",e[e.MOVIE=19]="MOVIE",e[e.WIDGET=20]="WIDGET",e[e.SCREEN=21]="SCREEN",e[e.PRINTERMARK=22]="PRINTERMARK",e[e.TRAPNET=23]="TRAPNET",e[e.WATERMARK=24]="WATERMARK",e[e.THREED=25]="THREED",e[e.RICHMEDIA=26]="RICHMEDIA",e[e.XFAWIDGET=27]="XFAWIDGET",e[e.REDACT=28]="REDACT",e))(yc||{}),wc=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});Object.entries(wc).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var Sc=(e=>(e[e.Ok=0]="Ok",e[e.Unknown=1]="Unknown",e[e.NotFound=2]="NotFound",e[e.WrongFormat=3]="WrongFormat",e[e.Password=4]="Password",e[e.Security=5]="Security",e[e.PageError=6]="PageError",e[e.XFALoad=7]="XFALoad",e[e.XFALayout=8]="XFALayout",e[e.Cancelled=9]="Cancelled",e[e.Initialization=10]="Initialization",e[e.NotReady=11]="NotReady",e[e.NotSupport=12]="NotSupport",e[e.LoadDoc=13]="LoadDoc",e[e.DocNotOpen=14]="DocNotOpen",e[e.CantCloseDoc=15]="CantCloseDoc",e[e.CantCreateNewDoc=16]="CantCreateNewDoc",e[e.CantImportPages=17]="CantImportPages",e[e.CantCreateAnnot=18]="CantCreateAnnot",e[e.CantSetAnnotRect=19]="CantSetAnnotRect",e[e.CantSetAnnotContent=20]="CantSetAnnotContent",e[e.CantRemoveInkList=21]="CantRemoveInkList",e[e.CantAddInkStoke=22]="CantAddInkStoke",e[e.CantReadAttachmentSize=23]="CantReadAttachmentSize",e[e.CantReadAttachmentContent=24]="CantReadAttachmentContent",e[e.CantFocusAnnot=25]="CantFocusAnnot",e[e.CantSelectText=26]="CantSelectText",e[e.CantSelectOption=27]="CantSelectOption",e[e.CantCheckField=28]="CantCheckField",e))(Sc||{}),Cc=class{static create(){return new pc}static resolve(e){const t=new pc;return t.resolve(e),t}static reject(e){const t=new pc;return t.reject(e),t}static abort(e){const t=new pc;return t.reject(e),t}};function xc(){}var Ic=class{constructor(e,t){if(this.id=e,this.registry=t,this.debouncedActions={},this.unsubscribeFromState=null,this.unsubscribeFromCoreStore=null,e!==this.constructor.id)throw new Error(`Plugin ID mismatch: ${e} !== ${this.constructor.id}`);this.coreStore=this.registry.getStore(),this.pluginStore=this.coreStore.getPluginStore(this.id),this.unsubscribeFromState=this.pluginStore.subscribeToState((e,t,i)=>{this.onStoreUpdated(i,t)}),this.unsubscribeFromCoreStore=this.coreStore.subscribe((e,t,i)=>{this.onCoreStoreUpdated(i,t)}),this.readyPromise=new Promise(e=>{this.readyResolve=e}),this.readyResolve()}provides(){if(!this._capability){const e=this.buildCapability();this._capability=Object.freeze(e)}return this._capability}get state(){return this.pluginStore.getState()}get coreState(){return this.coreStore.getState()}getState(){return this.pluginStore.getState()}getCoreState(){return this.coreStore.getState()}dispatchCoreAction(e){return this.coreStore.dispatchToCore(e)}dispatchToAllPlugins(e){return this.coreStore.dispatch(e)}dispatch(e){return this.pluginStore.dispatch(e)}debouncedDispatch(e,t=100){const i=Date.now();return i-(this.debouncedActions[e.type]||0)>=t&&(this.debouncedActions[e.type]=i,this.dispatch(e),!0)}subscribe(e){return this.pluginStore.subscribeToState(e)}subscribeToCoreStore(e){return this.coreStore.subscribe(e)}onStoreUpdated(e,t){}onCoreStoreUpdated(e,t){}destroy(){this.unsubscribeFromState&&(this.unsubscribeFromState(),this.unsubscribeFromState=null),this.unsubscribeFromCoreStore&&(this.unsubscribeFromCoreStore(),this.unsubscribeFromCoreStore=null)}ready(){return this.readyPromise}markReady(){this.readyResolve()}resetReady(){this.readyPromise=new Promise(e=>{this.readyResolve=e})}},Ac=class{constructor(e,t){this.handler=e,this.options=t,this.lastRun=0,this.handle=e=>{"debounce"===this.options.mode?this.debounce(e):this.throttle(e)}}debounce(e){this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.timeoutId=void 0},this.options.wait)}throttle(e){if("debounce"===this.options.mode)return;const t=Date.now(),i=this.options.throttleMode||"leading-trailing";t-this.lastRun>=this.options.wait&&("leading-trailing"===i&&this.handler(e),this.lastRun=t),this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.lastRun=Date.now(),this.timeoutId=void 0},this.options.wait-(t-this.lastRun))}destroy(){this.timeoutId&&window.clearTimeout(this.timeoutId)}};function Ec(e,t,i){if(e===t)return!0;if(null==e||null==t)return e===t;const r=typeof e;if(r!==typeof t)return!1;if("object"===r){i||(i=new Set);const r=function(e,t){return`${Mc(e)}__${Mc(t)}`}(e,t);if(i.has(r))return!0;i.add(r);const o=Array.isArray(e),n=Array.isArray(t);return o&&n?function(e,t,i){if(e.length!==t.length)return!1;const r=new Array(t.length).fill(!1);e:for(let o=0;o<e.length;o++){const n=e[o];for(let e=0;e<t.length;e++)if(!r[e]&&Ec(n,t[e],i)){r[e]=!0;continue e}return!1}return!0}(e,t,i):!o&&!n&&function(e,t,i){const r=Object.keys(e).sort(),o=Object.keys(t).sort();if(r.length!==o.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!==o[e])return!1;for(const o of r){if(!Ec(e[o],t[o],i))return!1}return!0}(e,t,i)}return!1}var kc=0,Pc=new WeakMap;function Mc(e){return Pc.has(e)||Pc.set(e,++kc),Pc.get(e)}function Tc(){const e=new Set;return{emit:(t=void 0)=>e.forEach(e=>e(t)),on:t=>(e.add(t),()=>e.delete(t)),off:t=>e.delete(t),clear:()=>e.clear()}}function Rc(e,t=Ec){const i=new Set,r=new Map;let o=e;const n=(e,t)=>{let n=e,s=()=>{};if(t){const i=new Ac(e,t);n=i.handle,s=()=>i.destroy(),r.set(e,{wrapped:n,destroy:s})}return void 0!==o&&n(o),i.add(n),()=>{i.delete(n),s(),r.delete(e)}};return{get value(){return o},emit(e=void 0){(void 0===o||!t(o,e))&&(o=e,(e=>{i.forEach(t=>t(e))})(e))},on:n,off(e){const t=r.get(e);t?(i.delete(t.wrapped),t.destroy(),r.delete(e)):i.delete(e)},clear(){i.clear(),r.forEach(e=>e.destroy()),r.clear()},select:(e,t=Ec)=>(i,r)=>{let s;if(void 0!==o){const t=e(o);s=t,i(t)}return n(r=>{const o=e(r);(void 0===s||!t(s,o))&&(s=o,i(o))},r)}}}var _c=ce({registry:null,isInitializing:!0,pluginsReady:!1});function Nc(e){const{registry:t}=function(){const e=Ne(_c);if(void 0===e)throw new Error("useCapability must be used within a PDFContext.Provider");const{registry:t,isInitializing:i}=e;if(i)return e;if(null===t)throw new Error("PDF registry failed to initialize properly");return e}();if(null===t)return{plugin:null,isLoading:!0,ready:new Promise(()=>{})};const i=t.getPlugin(e);if(!i)throw new Error(`Plugin ${e} not found`);return{plugin:i,isLoading:!1,ready:i.ready()}}function Oc(e){const{plugin:t,isLoading:i,ready:r}=Nc(e);if(!t)return{provides:null,isLoading:i,ready:r};if(!t.provides)throw new Error(`Plugin ${e} does not provide a capability`);return{provides:t.provides(),isLoading:i,ready:r}}var zc=(e=>(e[e.Degree0=0]="Degree0",e[e.Degree90=1]="Degree90",e[e.Degree180=2]="Degree180",e[e.Degree270=3]="Degree270",e))(zc||{}),Lc=class extends Error{constructor(e){super(`Task aborted: ${JSON.stringify(e)}`),this.name="TaskAbortedError"}},Dc=class extends Error{constructor(e){super(`Task rejected: ${JSON.stringify(e)}`),this.name="TaskRejectedError"}},Fc=class e{constructor(){this.state={stage:0},this.resolvedCallbacks=[],this.rejectedCallbacks=[],this._promise=null}toPromise(){return this._promise||(this._promise=new Promise((e,t)=>{this.wait(t=>e(t),e=>{"abort"===e.type?t(new Lc(e.reason)):t(new Dc(e.reason))})})),this._promise}wait(e,t){switch(this.state.stage){case 0:this.resolvedCallbacks.push(e),this.rejectedCallbacks.push(t);break;case 1:e(this.state.result);break;case 2:t({type:"reject",reason:this.state.reason});break;case 3:t({type:"abort",reason:this.state.reason})}}resolve(e){if(0===this.state.stage){this.state={stage:1,result:e};for(const t of this.resolvedCallbacks)try{t(e)}catch(e){}this.resolvedCallbacks=[],this.rejectedCallbacks=[]}}reject(e){if(0===this.state.stage){this.state={stage:2,reason:e};for(const t of this.rejectedCallbacks)try{t({type:"reject",reason:e})}catch(e){}this.resolvedCallbacks=[],this.rejectedCallbacks=[]}}abort(e){if(0===this.state.stage){this.state={stage:3,reason:e};for(const t of this.rejectedCallbacks)try{t({type:"abort",reason:e})}catch(e){}this.resolvedCallbacks=[],this.rejectedCallbacks=[]}}fail(e){"abort"===e.type?this.abort(e.reason):this.reject(e.reason)}static all(t){const i=new e;if(0===t.length)return i.resolve([]),i;const r=new Array(t.length);let o=0,n=!1;return t.forEach((e,s)=>{e.wait(e=>{n||(r[s]=e,o++,o===t.length&&(n=!0,i.resolve(r)))},e=>{n||(n=!0,"abort"===e.type?i.abort(e.reason):i.reject(e.reason))})}),i}static allSettled(t){const i=new e;if(0===t.length)return i.resolve([]),i;const r=new Array(t.length);let o=0;return t.forEach((e,n)=>{e.wait(e=>{r[n]={status:"resolved",value:e},o++,o===t.length&&i.resolve(r)},e=>{r[n]={status:"abort"===e.type?"aborted":"rejected",reason:e.reason},o++,o===t.length&&i.resolve(r)})}),i}static race(t){const i=new e;if(0===t.length)return i.reject("No tasks provided"),i;let r=!1;return t.forEach(e=>{e.wait(e=>{r||(r=!0,i.resolve(e))},e=>{r||(r=!0,"abort"===e.type?i.abort(e.reason):i.reject(e.reason))})}),i}static withProgress(t,i){const r=e.all(t);if(i){let e=0;t.forEach(r=>{r.wait(()=>{e++,i(e,t.length)},()=>{e++,i(e,t.length)})})}return r}},Hc=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${Hc.join("")}]`,"g");var $c=(e=>(e[e.Normal=0]="Normal",e[e.Multiply=1]="Multiply",e[e.Screen=2]="Screen",e[e.Overlay=3]="Overlay",e[e.Darken=4]="Darken",e[e.Lighten=5]="Lighten",e[e.ColorDodge=6]="ColorDodge",e[e.ColorBurn=7]="ColorBurn",e[e.HardLight=8]="HardLight",e[e.SoftLight=9]="SoftLight",e[e.Difference=10]="Difference",e[e.Exclusion=11]="Exclusion",e[e.Hue=12]="Hue",e[e.Saturation=13]="Saturation",e[e.Color=14]="Color",e[e.Luminosity=15]="Luminosity",e))($c||{}),jc=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);jc.reduce((e,t)=>(e[t.id]=t,e),{}),jc.reduce((e,t)=>(e[t.css]=t.id,e),{}),jc.map(e=>({value:e.id,label:e.label}));var Uc=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.TEXT=1]="TEXT",e[e.LINK=2]="LINK",e[e.FREETEXT=3]="FREETEXT",e[e.LINE=4]="LINE",e[e.SQUARE=5]="SQUARE",e[e.CIRCLE=6]="CIRCLE",e[e.POLYGON=7]="POLYGON",e[e.POLYLINE=8]="POLYLINE",e[e.HIGHLIGHT=9]="HIGHLIGHT",e[e.UNDERLINE=10]="UNDERLINE",e[e.SQUIGGLY=11]="SQUIGGLY",e[e.STRIKEOUT=12]="STRIKEOUT",e[e.STAMP=13]="STAMP",e[e.CARET=14]="CARET",e[e.INK=15]="INK",e[e.POPUP=16]="POPUP",e[e.FILEATTACHMENT=17]="FILEATTACHMENT",e[e.SOUND=18]="SOUND",e[e.MOVIE=19]="MOVIE",e[e.WIDGET=20]="WIDGET",e[e.SCREEN=21]="SCREEN",e[e.PRINTERMARK=22]="PRINTERMARK",e[e.TRAPNET=23]="TRAPNET",e[e.WATERMARK=24]="WATERMARK",e[e.THREED=25]="THREED",e[e.RICHMEDIA=26]="RICHMEDIA",e[e.XFAWIDGET=27]="XFAWIDGET",e[e.REDACT=28]="REDACT",e))(Uc||{}),Bc=(e=>(e[e.Normal=0]="Normal",e[e.Rollover=1]="Rollover",e[e.Down=2]="Down",e))(Bc||{}),Gc=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});Object.entries(Gc).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var Vc=(e=>(e[e.Ok=0]="Ok",e[e.Unknown=1]="Unknown",e[e.NotFound=2]="NotFound",e[e.WrongFormat=3]="WrongFormat",e[e.Password=4]="Password",e[e.Security=5]="Security",e[e.PageError=6]="PageError",e[e.XFALoad=7]="XFALoad",e[e.XFALayout=8]="XFALayout",e[e.Cancelled=9]="Cancelled",e[e.Initialization=10]="Initialization",e[e.NotReady=11]="NotReady",e[e.NotSupport=12]="NotSupport",e[e.LoadDoc=13]="LoadDoc",e[e.DocNotOpen=14]="DocNotOpen",e[e.CantCloseDoc=15]="CantCloseDoc",e[e.CantCreateNewDoc=16]="CantCreateNewDoc",e[e.CantImportPages=17]="CantImportPages",e[e.CantCreateAnnot=18]="CantCreateAnnot",e[e.CantSetAnnotRect=19]="CantSetAnnotRect",e[e.CantSetAnnotContent=20]="CantSetAnnotContent",e[e.CantRemoveInkList=21]="CantRemoveInkList",e[e.CantAddInkStoke=22]="CantAddInkStoke",e[e.CantReadAttachmentSize=23]="CantReadAttachmentSize",e[e.CantReadAttachmentContent=24]="CantReadAttachmentContent",e[e.CantFocusAnnot=25]="CantFocusAnnot",e[e.CantSelectText=26]="CantSelectText",e[e.CantSelectOption=27]="CantSelectOption",e[e.CantCheckField=28]="CantCheckField",e))(Vc||{}),Wc=class{static create(){return new Fc}static resolve(e){const t=new Fc;return t.resolve(e),t}static reject(e){const t=new Fc;return t.reject(e),t}static abort(e){const t=new Fc;return t.reject(e),t}};function Zc(){}var qc=class{constructor(e,t){if(this.id=e,this.registry=t,this.debouncedActions={},this.unsubscribeFromState=null,this.unsubscribeFromCoreStore=null,e!==this.constructor.id)throw new Error(`Plugin ID mismatch: ${e} !== ${this.constructor.id}`);this.coreStore=this.registry.getStore(),this.pluginStore=this.coreStore.getPluginStore(this.id),this.unsubscribeFromState=this.pluginStore.subscribeToState((e,t,i)=>{this.onStoreUpdated(i,t)}),this.unsubscribeFromCoreStore=this.coreStore.subscribe((e,t,i)=>{this.onCoreStoreUpdated(i,t)}),this.readyPromise=new Promise(e=>{this.readyResolve=e}),this.readyResolve()}provides(){if(!this._capability){const e=this.buildCapability();this._capability=Object.freeze(e)}return this._capability}get state(){return this.pluginStore.getState()}get coreState(){return this.coreStore.getState()}getState(){return this.pluginStore.getState()}getCoreState(){return this.coreStore.getState()}dispatchCoreAction(e){return this.coreStore.dispatchToCore(e)}dispatchToAllPlugins(e){return this.coreStore.dispatch(e)}dispatch(e){return this.pluginStore.dispatch(e)}debouncedDispatch(e,t=100){const i=Date.now();return i-(this.debouncedActions[e.type]||0)>=t&&(this.debouncedActions[e.type]=i,this.dispatch(e),!0)}subscribe(e){return this.pluginStore.subscribeToState(e)}subscribeToCoreStore(e){return this.coreStore.subscribe(e)}onStoreUpdated(e,t){}onCoreStoreUpdated(e,t){}destroy(){this.unsubscribeFromState&&(this.unsubscribeFromState(),this.unsubscribeFromState=null),this.unsubscribeFromCoreStore&&(this.unsubscribeFromCoreStore(),this.unsubscribeFromCoreStore=null)}ready(){return this.readyPromise}markReady(){this.readyResolve()}resetReady(){this.readyPromise=new Promise(e=>{this.readyResolve=e})}},Xc=class{constructor(e,t){this.handler=e,this.options=t,this.lastRun=0,this.handle=e=>{"debounce"===this.options.mode?this.debounce(e):this.throttle(e)}}debounce(e){this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.timeoutId=void 0},this.options.wait)}throttle(e){if("debounce"===this.options.mode)return;const t=Date.now(),i=this.options.throttleMode||"leading-trailing";t-this.lastRun>=this.options.wait&&("leading-trailing"===i&&this.handler(e),this.lastRun=t),this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.lastRun=Date.now(),this.timeoutId=void 0},this.options.wait-(t-this.lastRun))}destroy(){this.timeoutId&&window.clearTimeout(this.timeoutId)}};function Kc(e,t,i){if(e===t)return!0;if(null==e||null==t)return e===t;const r=typeof e;if(r!==typeof t)return!1;if("object"===r){i||(i=new Set);const r=function(e,t){return`${Jc(e)}__${Jc(t)}`}(e,t);if(i.has(r))return!0;i.add(r);const o=Array.isArray(e),n=Array.isArray(t);return o&&n?function(e,t,i){if(e.length!==t.length)return!1;const r=new Array(t.length).fill(!1);e:for(let o=0;o<e.length;o++){const n=e[o];for(let e=0;e<t.length;e++)if(!r[e]&&Kc(n,t[e],i)){r[e]=!0;continue e}return!1}return!0}(e,t,i):!o&&!n&&function(e,t,i){const r=Object.keys(e).sort(),o=Object.keys(t).sort();if(r.length!==o.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!==o[e])return!1;for(const o of r){if(!Kc(e[o],t[o],i))return!1}return!0}(e,t,i)}return!1}var Yc=0,Qc=new WeakMap;function Jc(e){return Qc.has(e)||Qc.set(e,++Yc),Qc.get(e)}function ed(e,t=Kc){const i=new Set,r=new Map;let o=e;const n=(e,t)=>{let n=e,s=()=>{};if(t){const i=new Xc(e,t);n=i.handle,s=()=>i.destroy(),r.set(e,{wrapped:n,destroy:s})}return void 0!==o&&n(o),i.add(n),()=>{i.delete(n),s(),r.delete(e)}};return{get value(){return o},emit(e=void 0){(void 0===o||!t(o,e))&&(o=e,(e=>{i.forEach(t=>t(e))})(e))},on:n,off(e){const t=r.get(e);t?(i.delete(t.wrapped),t.destroy(),r.delete(e)):i.delete(e)},clear(){i.clear(),r.forEach(e=>e.destroy()),r.clear()},select:(e,t=Kc)=>(i,r)=>{let s;if(void 0!==o){const t=e(o);s=t,i(t)}return n(r=>{const o=e(r);(void 0===s||!t(s,o))&&(s=o,i(o))},r)}}}var td=e=>({type:"ANNOTATION/REINDEX_PAGE",payload:{pageIndex:e}}),id=(e,t,i)=>({type:"ANNOTATION/CREATE_ANNOTATION",payload:{pageIndex:e,localId:t,annotation:i}}),rd=(e,t,i)=>({type:"ANNOTATION/PATCH_ANNOTATION",payload:{pageIndex:e,localId:t,patch:i}}),od=(e,t)=>({type:"ANNOTATION/DELETE_ANNOTATION",payload:{pageIndex:e,localId:t}}),nd=(e,t)=>({type:"ANNOTATION/STORE_PDF_ID",payload:{uid:e,pdfId:t}}),sd=e=>({type:"ANNOTATION/PURGE_ANNOTATION",payload:{uid:e}}),ad=(e,t)=>`p${e}#${t}`,ld=e=>{const[t,i]=e.slice(1).split("#");return{pageIndex:Number(t),localId:Number(i)}},cd=(e,t)=>t?`${e}#${t}`:`${e}`,dd=class extends qc{constructor(e,t,i,r){super(e,t),this.ANNOTATION_HISTORY_TOPIC="annotations",this.state$=ed(),this.modeByVariant=new Map,this.variantByMode=new Map,this.activeVariantChange$=ed(),this.activeTool$=ed({variantKey:null,defaults:null}),this.engine=i,this.config=r;const o=t.getPlugin("selection");this.selection=o?.provides()??null;const n=t.getPlugin("history");this.history=n?.provides()??null;const s=t.getPlugin("interaction-manager");this.interactionManager=s?.provides()??null,this.coreStore.onAction("SET_DOCUMENT",(e,t)=>{const i=t.core.document;i&&this.getAllAnnotations(i)})}async initialize(){for(const[e,t]of Object.entries(this.state.toolDefaults))this.registerTool(e,t);this.history?.onHistoryChange(e=>{e===this.ANNOTATION_HISTORY_TOPIC&&!1!==this.config.autoCommit&&this.commit()}),this.interactionManager?.onModeChange(e=>{const t=this.variantByMode.get(e.activeMode)??null;console.log(t,this.state.activeVariant),t!==this.state.activeVariant&&(this.dispatch({type:"ANNOTATION/SET_ACTIVE_VARIANT",payload:t}),this.activeVariantChange$.emit(t))}),this.selection?.onEndSelection(()=>{if(!this.state.activeVariant)return;if(this.state.activeVariant!==cd(Uc.HIGHLIGHT)&&this.state.activeVariant!==cd(Uc.UNDERLINE)&&this.state.activeVariant!==cd(Uc.STRIKEOUT)&&this.state.activeVariant!==cd(Uc.SQUIGGLY))return;const e=this.selection?.getFormattedSelection();if(e){for(const t of e){const e=t.rect,i=t.segmentRects,r=this.state.activeVariant,o=this.state.toolDefaults[r].subtype,n=this.state.toolDefaults[r].color,s=this.state.toolDefaults[r].opacity,a=this.state.toolDefaults[r].blendMode??$c.Normal;this.createAnnotation(t.pageIndex,{type:o,rect:e,segmentRects:i,color:n,opacity:s,blendMode:a,pageIndex:t.pageIndex,id:Date.now()+Math.random()})}this.selection?.clear()}})}registerTool(e,t){const i=t.interaction.mode,r={id:i,scope:"page",exclusive:t.interaction.exclusive,cursor:t.interaction.cursor};this.interactionManager?.registerMode(r),t.textSelection&&this.selection?.enableForMode(i),this.modeByVariant.set(e,i),this.variantByMode.set(i,e)}buildCapability(){return{getPageAnnotations:e=>this.getPageAnnotations(e),getSelectedAnnotation:()=>(e=>e.selectedUid?e.byUid[e.selectedUid]:null)(this.state),selectAnnotation:(e,t)=>{this.selectAnnotation(e,t)},deselectAnnotation:()=>{this.dispatch({type:"ANNOTATION/DESELECT_ANNOTATION"})},getActiveVariant:()=>this.state.activeVariant,setActiveVariant:e=>{if(e!==this.state.activeVariant)if(e){const t=this.modeByVariant.get(e);if(!t)throw new Error(`Mode missing for variant ${e}`);this.interactionManager?.activate(t)}else this.interactionManager?.activate("default")},getToolDefaults:e=>{const t=this.state.toolDefaults[e];if(!t)throw new Error(`No defaults found for variant: ${e}`);return t},getToolDefaultsBySubtypeAndIntent:(e,t)=>{const i=cd(e,t),r=this.state.toolDefaults[i];if(!r)throw new Error(`No defaults found for variant: ${i}`);return r},getToolDefaultsBySubtype:e=>{const t=this.state.toolDefaults[e];if(!t)throw new Error(`No defaults found for subtype: ${e}`);return t},setToolDefaults:(e,t)=>{this.dispatch(((e,t)=>({type:"ANNOTATION/UPDATE_TOOL_DEFAULTS",payload:{variantKey:e,patch:t}}))(e,t))},getColorPresets:()=>[...this.state.colorPresets],addColorPreset:e=>this.dispatch({type:"ANNOTATION/ADD_COLOR_PRESET",payload:e}),createAnnotation:(e,t)=>this.createAnnotation(e,t),updateAnnotation:(e,t,i)=>this.updateAnnotation(e,t,i),deleteAnnotation:(e,t)=>this.deleteAnnotation(e,t),renderAnnotation:e=>this.renderAnnotation(e),onStateChange:this.state$.on,onActiveVariantChange:this.activeVariantChange$.on,onActiveToolChange:this.activeTool$.on,commit:()=>this.commit()}}createActiveTool(e,t){return null===e?{variantKey:null,defaults:null}:{variantKey:e,defaults:t[e]}}emitActiveTool(e){const t=this.createActiveTool(e.activeVariant,e.toolDefaults);this.activeTool$.emit(t)}onStoreUpdated(e,t){this.state$.emit(t),e.activeVariant===t.activeVariant&&e.toolDefaults[e.activeVariant??Uc.HIGHLIGHT]===t.toolDefaults[t.activeVariant??Uc.HIGHLIGHT]||this.emitActiveTool(t)}getAllAnnotations(e){this.engine.getAllAnnotations(e).wait(e=>this.dispatch({type:"ANNOTATION/SET_ANNOTATIONS",payload:e}),Zc)}getPageAnnotations(e){const{pageIndex:t}=e,i=this.coreState.core.document;if(!i)return Wc.reject({code:Vc.NotFound,message:"Document not found"});const r=i.pages.find(e=>e.index===t);return r?this.engine.getPageAnnotations(i,r):Wc.reject({code:Vc.NotFound,message:"Page not found"})}renderAnnotation({pageIndex:e,annotation:t,scaleFactor:i=1,rotation:r=zc.Degree0,dpr:o=1,mode:n=Bc.Normal,imageType:s="image/webp"}){const a=this.coreState.core;if(!a.document)throw new Error("document does not open");const l=a.document.pages.find(t=>t.index===e);if(!l)throw new Error("page does not exist");return this.engine.renderAnnotation(a.document,l,t,i,r,o,n,s)}selectAnnotation(e,t){this.dispatch(((e,t)=>({type:"ANNOTATION/SELECT_ANNOTATION",payload:{pageIndex:e,localId:t}}))(e,t))}createAnnotation(e,t){const i=t.id,r=()=>this.dispatch(id(e,i,t));if(!this.history)return r(),void(this.config.autoCommit&&this.commit());const o={execute:r,undo:()=>{this.dispatch({type:"ANNOTATION/DESELECT_ANNOTATION"}),this.dispatch(od(e,i))}};this.history.register(o,this.ANNOTATION_HISTORY_TOPIC)}updateAnnotation(e,t,i){if(!this.history)return this.dispatch(rd(e,t,i)),void(!1!==this.config.autoCommit&&this.commit());const r=this.state.byUid[ad(e,t)].object,o=Object.fromEntries(Object.keys(i).map(e=>[e,r[e]])),n={execute:()=>this.dispatch(rd(e,t,i)),undo:()=>this.dispatch(rd(e,t,o))};this.history.register(n,this.ANNOTATION_HISTORY_TOPIC)}deleteAnnotation(e,t){if(!this.history)return this.dispatch({type:"ANNOTATION/DESELECT_ANNOTATION"}),this.dispatch(od(e,t)),void(!1!==this.config.autoCommit&&this.commit());const i=this.state.byUid[ad(e,t)].object,r={execute:()=>{this.dispatch({type:"ANNOTATION/DESELECT_ANNOTATION"}),this.dispatch(od(e,t))},undo:()=>this.dispatch(id(e,t,i))};this.history.register(r,this.ANNOTATION_HISTORY_TOPIC)}commit(){const e=new Fc;if(!this.state.hasPendingChanges)return Wc.resolve(!0);const t=this.coreState.core.document;if(!t)return Wc.reject({code:Vc.NotFound,message:"Document not found"});const i=[],r=[],o=new Map,n=new Set;for(const[e,s]of Object.entries(this.state.byUid)){if("synced"===s.commitState)continue;const{pageIndex:a}=ld(e),l=t.pages.find(e=>e.index===a);if(l)switch(n.add(a),s.commitState){case"new":const n=this.engine.createPageAnnotation(t,l,s.object);n.wait(t=>this.dispatch(nd(e,t)),Zc),i.push(n);break;case"dirty":r.push(this.engine.updatePageAnnotation(t,l,{...s.object,id:s.pdfId}));break;case"deleted":o.has(a)||o.set(a,[]),o.get(a).push({ta:s,uid:e})}}const s=[];for(const[e,i]of o.entries()){const r=t.pages.find(t=>t.index===e);i.sort((e,t)=>(t.ta.pdfId??-1)-(e.ta.pdfId??-1));for(const{ta:e,uid:o}of i)if(void 0!==e.pdfId){const i=new Fc;this.engine.removePageAnnotation(t,r,{...e.object,id:e.pdfId}).wait(()=>{this.dispatch(sd(o)),i.resolve(!0)},i.fail),s.push(i)}else this.dispatch(sd(o))}const a=[...i,...r,...s];return Fc.allSettled(a).wait(()=>{for(const e of n)this.dispatch(td(e));this.dispatch({type:"ANNOTATION/COMMIT"}),e.resolve(!0)},e.fail),e}};dd.id="annotation";var ud=()=>Oc(dd.id);var hd=class extends Ic{constructor(e,t){super(e,t),this.modes=new Map,this.cursorClaims=new Map,this.buckets=new Map,this.alwaysGlobal=new Set,this.alwaysPage=new Map,this.onModeChange$=Tc(),this.onHandlerChange$=Tc(),this.onCursorChange$=Tc(),this.onStateChange$=Rc(),this.registerMode({id:"default",scope:"page",exclusive:!1,cursor:"auto"})}async initialize(e){}buildCapability(){return{activate:e=>this.activate(e),onModeChange:this.onModeChange$.on,onCursorChange:this.onCursorChange$.on,onHandlerChange:this.onHandlerChange$.on,onStateChange:this.onStateChange$.on,getActiveMode:()=>this.state.activeMode,getActiveInteractionMode:()=>this.getActiveInteractionMode(),finish:()=>this.activate("default"),registerMode:e=>this.registerMode(e),registerHandlers:e=>this.registerHandlers(e),registerAlways:e=>this.registerAlways(e),setCursor:(e,t,i=0)=>this.setCursor(e,t,i),removeCursor:e=>this.removeCursor(e),getCurrentCursor:()=>this.state.cursor,getHandlersForScope:e=>this.getHandlersForScope(e),activeModeIsExclusive:()=>this.activeModeIsExclusive(),pause:()=>this.dispatch({type:"INTERACTION/PAUSE"}),resume:()=>this.dispatch({type:"INTERACTION/RESUME"}),isPaused:()=>this.state.paused}}activate(e){if(!this.modes.has(e))throw new Error(`[interaction] unknown mode '${e}'`);if(e===this.state.activeMode)return;const t=this.state.activeMode;this.cursorClaims.clear(),this.notifyHandlersInactive(t),this.dispatch((e=>({type:"INTERACTION/ACTIVATE_MODE",payload:{mode:e}}))(e)),this.emitCursor(),this.notifyHandlersActive(e),this.onModeChange$.emit({...this.state,activeMode:e})}notifyHandlersActive(e){this.alwaysGlobal.forEach(t=>{var i;null==(i=t.onHandlerActiveStart)||i.call(t,e)}),this.alwaysPage.forEach(t=>{t.forEach(t=>{var i;null==(i=t.onHandlerActiveStart)||i.call(t,e)})});const t=this.modes.get(e);if(!t)return;const i=this.buckets.get(e);i&&("global"===t.scope&&i.global.forEach(t=>{var i;null==(i=t.onHandlerActiveStart)||i.call(t,e)}),"page"===t.scope&&i.page.forEach((t,i)=>{t.forEach(t=>{var i;null==(i=t.onHandlerActiveStart)||i.call(t,e)})}))}notifyHandlersInactive(e){this.alwaysGlobal.forEach(t=>{var i;null==(i=t.onHandlerActiveEnd)||i.call(t,e)}),this.alwaysPage.forEach(t=>{t.forEach(t=>{var i;null==(i=t.onHandlerActiveEnd)||i.call(t,e)})});const t=this.modes.get(e);if(!t)return;const i=this.buckets.get(e);i&&("global"===t.scope&&i.global.forEach(t=>{var i;null==(i=t.onHandlerActiveEnd)||i.call(t,e)}),"page"===t.scope&&i.page.forEach((t,i)=>{t.forEach(t=>{var i;null==(i=t.onHandlerActiveEnd)||i.call(t,e)})}))}registerMode(e){this.modes.set(e.id,e),this.buckets.has(e.id)||this.buckets.set(e.id,{global:new Set,page:new Map})}registerHandlers({modeId:e,handlers:t,pageIndex:i}){const r=Array.isArray(e)?e:[e],o=[];for(const e of r){const r=this.buckets.get(e);if(!r)throw new Error(`unknown mode '${e}'`);if(null==i)r.global.add(t);else{const e=r.page.get(i)??new Set;e.add(t),r.page.set(i,e)}o.push(()=>{if(null==i)r.global.delete(t);else{const e=r.page.get(i);e&&(e.delete(t),0===e.size&&r.page.delete(i))}})}return this.onHandlerChange$.emit({...this.state}),()=>{o.forEach(e=>e()),this.onHandlerChange$.emit({...this.state})}}registerAlways({scope:e,handlers:t}){if("global"===e.type)return this.alwaysGlobal.add(t),this.onHandlerChange$.emit({...this.state}),()=>this.alwaysGlobal.delete(t);const i=this.alwaysPage.get(e.pageIndex)??new Set;return i.add(t),this.alwaysPage.set(e.pageIndex,i),this.onHandlerChange$.emit({...this.state}),()=>{i.delete(t),this.onHandlerChange$.emit({...this.state})}}getHandlersForScope(e){if(!this.state)return null;const t=this.modes.get(this.state.activeMode);if(!t)return null;const i=this.buckets.get(t.id);if(!i)return null;const r=(e,t)=>e.size||t.size?function(e){const t=["onPointerDown","onPointerUp","onPointerMove","onPointerEnter","onPointerLeave","onPointerCancel"],i={};for(const r of t)i[r]=(t,i,o)=>{var n;for(const s of e)null==(n=s[r])||n.call(s,t,i,o)};return i}([...e,...t]):null;if("global"===e.type){const e="global"===t.scope?i.global:new Set;return r(this.alwaysGlobal,e)}return r(this.alwaysPage.get(e.pageIndex)??new Set,"page"===t.scope?i.page.get(e.pageIndex)??new Set:new Set)}setCursor(e,t,i=0){this.cursorClaims.set(e,{cursor:t,priority:i}),this.emitCursor()}removeCursor(e){this.cursorClaims.delete(e),this.emitCursor()}emitCursor(){var e;const t=[...this.cursorClaims.values()].sort((e,t)=>t.priority-e.priority)[0]??{cursor:(null==(e=this.modes.get(this.state.activeMode))?void 0:e.cursor)??"auto"};t.cursor!==this.state.cursor&&(this.dispatch((e=>({type:"INTERACTION/SET_CURSOR",payload:{cursor:e}}))(t.cursor)),this.onCursorChange$.emit(t.cursor))}onStoreUpdated(e,t){this.onStateChange$.emit(t)}activeModeIsExclusive(){const e=this.modes.get(this.state.activeMode);return!(null==e||!e.exclusive)}getActiveInteractionMode(){return this.modes.get(this.state.activeMode)??null}async destroy(){this.onModeChange$.clear(),this.onCursorChange$.clear(),await super.destroy()}};hd.id="interaction-manager";var pd=hd;function gd({modeId:e,pageIndex:t}){const{provides:i}=Oc(pd.id);return{register:(r,o)=>{const n=(null==o?void 0:o.modeId)??e,s=(null==o?void 0:o.pageIndex)??t;return n?null==i?void 0:i.registerHandlers({modeId:n,handlers:r,pageIndex:s}):null==i?void 0:i.registerAlways({scope:void 0!==s?{type:"page",pageIndex:s}:{type:"global"},handlers:r})}}}function fd({scale:e,pageIndex:t,rotation:i,trackedAnnotation:r,children:o,style:n,outlineOffset:s=1,isSelected:a=!1,isDraggable:l=!0,isResizable:c=!0,computeResizePatch:d,...u}){const{provides:h}=ud(),p=Te(null),[g,f]=ke("idle"),[m,b]=ke(null),[v,y]=ke(null),[w,S]=ke(null),[C,x]=ke(r.object.rect),[I,A]=ke(null);Pe(()=>{x(r.object.rect),A(null)},[r]);const E=I?{...r.object,...I}:r.object;return he("div",{ref:p,onPointerDown:e=>{if(!a)return;e.stopPropagation(),e.preventDefault();const t=e.target;if(c&&t.classList.contains("resize-handle"))f("resizing"),b(t.dataset.direction);else{if(!l)return;f("dragging")}y({x:e.clientX,y:e.clientY}),S(C),p.current?.setPointerCapture(e.pointerId)},onPointerMove:t=>{if("idle"===g||!v||!w)return;const o={x:t.clientX-v.x,y:t.clientY-v.y},{x:n,y:s}=function(e,t,i){let r=e.x,o=e.y;switch(t){case 0:r=e.x/i,o=e.y/i;break;case 1:r=e.y/i,o=-e.x/i;break;case 2:r=-e.x/i,o=-e.y/i;break;case 3:r=-e.y/i,o=e.x/i}return{x:r,y:o}}(o,i,e);let a=w.origin.x,l=w.origin.y,c=w.size.width,u=w.size.height;if("dragging"===g)a+=n,l+=s;else if("resizing"===g&&m&&(m.includes("right")?c+=n:m.includes("left")&&(a+=n,c-=n),m.includes("bottom")?u+=s:m.includes("top")&&(l+=s,u-=s),c<1||u<1))return;const h={origin:{x:a,y:l},size:{width:c,height:u}};let p={rect:h};if(d){const e="resizing"===g?m:"bottom-right";e&&(p=d(r.object,h,e))}x(p.rect||h),A(p)},onPointerUp:e=>{if("idle"===g)return;const i=m||"bottom-right";if(f("idle"),b(null),p.current?.releasePointerCapture(e.pointerId),h&&r){let e={rect:C};d&&i&&(e=d(r.object,C,i)),h.updateAnnotation(t,r.localId,e)}y(null),S(null),A(null)},style:{position:"absolute",outline:a?"1px solid #007ACC":"none",outlineOffset:a?`${s}px`:"0px",left:C.origin.x*e+"px",top:C.origin.y*e+"px",width:C.size.width*e+"px",height:C.size.height*e+"px",pointerEvents:a?"auto":"none",cursor:a&&l?"move":"default",...n},...u,children:["function"==typeof o?o(E):o,a&&c&&he(B,{children:[he("div",{className:"resize-handle","data-direction":"top-left",style:{position:"absolute",top:-7-s,left:-7-s,width:13,height:13,background:"blue",borderRadius:"50%",cursor:i%2?"nesw-resize":"nwse-resize"}}),he("div",{className:"resize-handle","data-direction":"top-right",style:{position:"absolute",top:-7-s,right:-7-s,width:13,height:13,background:"blue",borderRadius:"50%",cursor:i%2?"nwse-resize":"nesw-resize"}}),he("div",{className:"resize-handle","data-direction":"bottom-left",style:{position:"absolute",bottom:-7-s,left:-7-s,width:13,height:13,background:"blue",borderRadius:"50%",cursor:i%2?"nwse-resize":"nesw-resize"}}),he("div",{className:"resize-handle","data-direction":"bottom-right",style:{position:"absolute",bottom:-7-s,right:-7-s,width:13,height:13,background:"blue",borderRadius:"50%",cursor:i%2?"nesw-resize":"nwse-resize"}})]})]})}function md({color:e="#FFFF00",opacity:t=.5,rects:i,rect:r,scale:o,onClick:n,style:s,...a}){return he(B,{children:i.map((i,l)=>he("div",{onMouseDown:n,style:{position:"absolute",left:(r?i.origin.x-r.origin.x:i.origin.x)*o,top:(r?i.origin.y-r.origin.y:i.origin.y)*o,width:i.size.width*o,height:i.size.height*o,background:e,opacity:t,pointerEvents:n?"auto":"none",cursor:n?"pointer":"default",zIndex:n?1:null,...s},...a},l))})}function bd({color:e="#FFFF00",opacity:t=.5,rects:i,rect:r,scale:o,onClick:n,style:s,...a}){const l=2*o;return he(B,{children:i.map((i,c)=>he("div",{onMouseDown:n,style:{position:"absolute",left:(r?i.origin.x-r.origin.x:i.origin.x)*o,top:(r?i.origin.y-r.origin.y:i.origin.y)*o,width:i.size.width*o,height:i.size.height*o,background:"transparent",pointerEvents:n?"auto":"none",cursor:n?"pointer":"default",zIndex:n?1:0,...s},...a,children:he("div",{style:{position:"absolute",left:0,bottom:0,width:"100%",height:l,background:e,opacity:t,pointerEvents:"none"}})},c))})}function vd({color:e="#FFFF00",opacity:t=.5,rects:i,rect:r,scale:o,onClick:n,style:s,...a}){const l=2*o;return he(B,{children:i.map((i,c)=>he("div",{onMouseDown:n,style:{position:"absolute",left:(r?i.origin.x-r.origin.x:i.origin.x)*o,top:(r?i.origin.y-r.origin.y:i.origin.y)*o,width:i.size.width*o,height:i.size.height*o,background:"transparent",pointerEvents:n?"auto":"none",cursor:n?"pointer":"default",zIndex:n?1:0,...s},...a,children:he("div",{style:{position:"absolute",left:0,top:"50%",width:"100%",height:l,background:e,opacity:t,transform:"translateY(-50%)",pointerEvents:"none"}})},c))})}function yd({color:e="#FFFF00",opacity:t=.5,rects:i,rect:r,scale:o,onClick:n,style:s,...a}){const l=2*o,c=6*o,d=`url("data:image/svg+xml;utf8,${encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" width="${c}" height="${2*l}" viewBox="0 0 ${c} ${2*l}">\n      <path d="M0 ${l} Q ${c/4} 0 ${c/2} ${l} T ${c} ${l}"\n            fill="none" stroke="${e}" stroke-width="${l}" stroke-linecap="round"/>\n    </svg>`)}")`;return he(B,{children:i.map((e,i)=>he("div",{onMouseDown:n,style:{position:"absolute",left:(r?e.origin.x-r.origin.x:e.origin.x)*o,top:(r?e.origin.y-r.origin.y:e.origin.y)*o,width:e.size.width*o,height:e.size.height*o,background:"transparent",pointerEvents:n?"auto":"none",cursor:n?"pointer":"default",zIndex:n?1:0,...s},...a,children:he("div",{style:{position:"absolute",left:0,bottom:0,width:"100%",height:2*l,backgroundImage:d,backgroundRepeat:"repeat-x",backgroundSize:`${c}px ${2*l}px`,opacity:t,pointerEvents:"none"}})},i))})}function wd({color:e="#000000",opacity:t=1,strokeWidth:i,inkList:r,rect:o,scale:n,onClick:s}){const a=Re(()=>r.map(({points:e})=>{let t="";return e.forEach(({x:e,y:i},r)=>{const n=e-o.origin.x,s=i-o.origin.y;t+=(0===r?"M":"L")+n+" "+s+" "}),t.trim()}),[r,o]),l=o.size.width*n,c=o.size.height*n;return he("svg",{style:{position:"absolute",width:l,height:c,pointerEvents:"none",zIndex:2},width:l,height:c,viewBox:`0 0 ${o.size.width} ${o.size.height}`,children:a.map((r,o)=>he("path",{d:r,fill:"none",stroke:e,strokeWidth:i,strokeLinecap:"round",strokeLinejoin:"round",opacity:t,pointerEvents:"visibleStroke",onMouseDown:s,style:{cursor:"pointer"}},o))})}function Sd(e,t){return e.rects[t]??[]}function Cd(e,t){return dc(Sd(e,t))}function xd(e,t,i){if(!e||!t||i<e.start.page||i>e.end.page)return null;const r=i===e.start.page?e.start.index:0,o=t.runs[t.runs.length-1],n=o.charStart+o.glyphs.length-1;return{from:r,to:i===e.end.page?e.end.index:n}}function Id(e,t,i,r=!0){const o=[];for(const r of e.runs){const e=r.charStart,n=e+r.glyphs.length-1;if(n<t||e>i)continue;const s=Math.max(t,e)-e,a=Math.min(i,n)-e;let l=1/0,c=-1/0,d=1/0,u=-1/0,h=0;for(let e=s;e<=a;e++){const t=r.glyphs[e];2!==t.flags&&(l=Math.min(l,t.x),c=Math.max(c,t.x+t.width),d=Math.min(d,t.y),u=Math.max(u,t.y+t.height),h++)}l!==1/0&&h>0&&o.push({rect:{origin:{x:l,y:d},size:{width:c-l,height:u-d}},charCount:h})}return r?function(e){const t=[];let i=null,r=null;for(const o of e)i&&r?Pd(i,o)?r=Ad(r,o.rect):(t.push(r),r=o.rect):r=o.rect,i=o;return r&&!Ed(r)&&t.push(r),t}(o):o.map(e=>e.rect)}function Ad(e,t){const i=Math.min(e.origin.x,t.origin.x),r=Math.min(e.origin.y,t.origin.y);return{origin:{x:i,y:r},size:{width:Math.max(e.origin.x+e.size.width,t.origin.x+t.size.width)-i,height:Math.max(e.origin.y+e.size.height,t.origin.y+t.size.height)-r}}}function Ed(e){return e.size.width<=0||e.size.height<=0}function kd(e,t){if(Ed(e)||Ed(t))return 0;const i=Ad(e,t);return i.size.height===e.size.height||i.size.height===t.size.height?1:function(e,t){const i=Math.max(e.origin.x,t.origin.x),r=Math.max(e.origin.y,t.origin.y),o=Math.min(e.origin.x+e.size.width,t.origin.x+t.size.width),n=Math.min(e.origin.y+e.size.height,t.origin.y+t.size.height);return{origin:{x:i,y:r},size:{width:Math.max(0,o-i),height:Math.max(0,n-r)}}}(e,t).size.height/i.size.height}function Pd(e,t){const i=e.rect,r=t.rect;if(kd(i,r)<.8)return!1;const o=1*i.size.width/e.charCount,n=1*r.size.width/t.charCount,s=i.origin.x-o,a=i.origin.x+i.size.width+o,l=r.origin.x-n;return s<r.origin.x+r.size.width+n&&a>l}var Md=class extends Ic{constructor(e,t,i){super(e,t),this.engine=i,this.enabledModes=new Set(["default"]),this.selecting=!1,this.selChange$=Rc(),this.textRetrieved$=Rc(),this.copyToClipboard$=Tc(),this.beginSelection$=Tc(),this.endSelection$=Tc(),this.coreStore.onAction("SET_DOCUMENT",e=>{this.dispatch({type:"RESET"})})}async initialize(){}async destroy(){this.selChange$.clear()}buildCapability(){return{getGeometry:e=>this.getOrLoadGeometry(e),getFormattedSelection:()=>function(e){const t=[],i=Object.keys(e.rects).map(Number);for(const r of i){const i=e.rects[r]||[];if(0===i.length)continue;const o=Cd(e,r);o&&t.push({pageIndex:r,rect:o,segmentRects:i})}return t}(this.state),getFormattedSelectionForPage:e=>function(e,t){const i=e.rects[t]||[];if(0===i.length)return null;const r=Cd(e,t);return r?{pageIndex:t,rect:r,segmentRects:i}:null}(this.state,e),getHighlightRectsForPage:e=>Sd(this.state,e),getHighlightRects:()=>this.state.rects,getBoundingRectForPage:e=>Cd(this.state,e),getBoundingRects:()=>function(e){const t=[],i=e.rects;for(const e in i){const r=Number(e),o=dc(i[r]);o&&t.push({page:r,rect:o})}return t}(this.state),begin:(e,t)=>this.beginSelection(e,t),update:(e,t)=>this.updateSelection(e,t),end:()=>this.endSelection(),clear:()=>this.clearSelection(),onCopyToClipboard:this.copyToClipboard$.on,onSelectionChange:this.selChange$.on,onTextRetrieved:this.textRetrieved$.on,onBeginSelection:this.beginSelection$.on,onEndSelection:this.endSelection$.on,getSelectedText:()=>this.getSelectedText(),copyToClipboard:()=>this.copyToClipboard(),enableForMode:e=>this.enabledModes.add(e),isEnabledForMode:e=>this.enabledModes.has(e),getState:()=>this.state}}getOrLoadGeometry(e){const t=this.state.geometry[e];if(t)return Cc.resolve(t);if(!this.coreState.core.document)return Cc.reject({code:Sc.NotFound,message:"Doc Not Found"});const i=this.coreState.core.document.pages.find(t=>t.index===e),r=this.engine.getPageGeometry(this.coreState.core.document,i);return r.wait(t=>{this.dispatch(((e,t)=>({type:"CACHE_PAGE_GEOMETRY",payload:{page:e,geo:t}}))(e,t))},xc),r}beginSelection(e,t){this.selecting=!0,this.anchor={page:e,index:t},this.dispatch({type:"START_SELECTION"}),this.beginSelection$.emit({page:e,index:t})}endSelection(){this.selecting=!1,this.anchor=void 0,this.dispatch({type:"END_SELECTION"}),this.endSelection$.emit()}clearSelection(){this.selecting=!1,this.anchor=void 0,this.dispatch({type:"CLEAR_SELECTION"}),this.selChange$.emit(null)}updateSelection(e,t){if(!this.selecting||!this.anchor)return;const i=this.anchor,r=e>i.page||e===i.page&&t>=i.index,o={start:r?i:{page:e,index:t},end:r?{page:e,index:t}:i};this.dispatch((e=>({type:"SET_SELECTION",payload:e}))(o)),this.updateRectsAndSlices(o),this.selChange$.emit(o)}updateRectsAndSlices(e){const t={},i={};for(let r=e.start.page;r<=e.end.page;r++){const o=this.state.geometry[r],n=xd(e,o,r);n&&(t[r]=Id(o,n.from,n.to),i[r]={start:n.from,count:n.to-n.from+1})}this.dispatch((e=>({type:"SET_RECTS",payload:e}))(t)),this.dispatch((e=>({type:"SET_SLICES",payload:e}))(i))}getSelectedText(){if(!this.coreState.core.document||!this.state.selection)return Cc.reject({code:Sc.NotFound,message:"Doc Not Found or No Selection"});const e=this.state.selection,t=[];for(let i=e.start.page;i<=e.end.page;i++){const e=this.state.slices[i];e&&t.push({pageIndex:i,charIndex:e.start,charCount:e.count})}if(0===t.length)return Cc.resolve([]);const i=this.engine.getTextSlices(this.coreState.core.document,t);return i.wait(e=>{this.textRetrieved$.emit(e)},xc),i}copyToClipboard(){this.getSelectedText().wait(e=>{this.copyToClipboard$.emit(e.join("\n"))},xc)}};Md.id="selection";var Td=Md,Rd=()=>Oc(Td.id);function _d(e,t,i,r=!1){if(e.type!==yc.INK)throw new Error("resizeInkAnnotation: original is not an ink annotation");const o=e.rect;let n=t.size.width/o.size.width,s=t.size.height/o.size.height;if((t.size.width<10||t.size.height<10)&&(n=Math.max(n,10/o.size.width),s=Math.max(s,10/o.size.height),t={origin:t.origin,size:{width:o.size.width*n,height:o.size.height*s}}),r){const e=Math.min(n,s);n=e,s=e,t.size={width:o.size.width*e,height:o.size.height*e}}const a=e.inkList.map(e=>({points:e.points.map(e=>({x:t.origin.x+(e.x-o.origin.x)*n,y:t.origin.y+(e.y-o.origin.y)*s}))})),l=(n+s)/2,c=e.strokeWidth*l;return{rect:t,inkList:a,strokeWidth:c}}function Nd(e){const{pageIndex:t,scale:i}=e,{provides:r}=ud(),{provides:o}=Rd(),[n,s]=ke([]),{register:a}=gd({pageIndex:t}),[l,c]=ke(null);Pe(()=>{r&&r.onStateChange(e=>{s(((e,t)=>(e.pages[t]??[]).map(t=>e.byUid[t]))(e,t)),c(((e,t)=>e.selectedUid&&(e.pages[t]??[]).includes(e.selectedUid)?e.byUid[e.selectedUid]:null)(e,t))})},[r]);const d=Re(()=>({onPointerDown:(e,t)=>{t.target===t.currentTarget&&r&&r.deselectAnnotation()}}),[r]),u=_e((e,i)=>{e.stopPropagation(),r&&o&&(r.selectAnnotation(t,i.localId),o.clear())},[r,o,t]);return Pe(()=>a(d),[a,d]),he(B,{children:n.map(t=>{const r=l?.localId===t.localId;switch(t.object.type){case yc.UNDERLINE:return he(fd,{trackedAnnotation:t,isSelected:r,isDraggable:!1,isResizable:!1,style:{mixBlendMode:vc(t.object.blendMode??fc.Normal)},...e,children:he(bd,{rect:t.object.rect,color:t.object.color,opacity:t.object.opacity,rects:t.object.segmentRects,scale:i,onClick:e=>u(e,t)})},t.localId);case yc.STRIKEOUT:return he(fd,{trackedAnnotation:t,isSelected:r,isDraggable:!1,isResizable:!1,style:{mixBlendMode:vc(t.object.blendMode??fc.Normal)},...e,children:he(vd,{rect:t.object.rect,color:t.object.color,opacity:t.object.opacity,rects:t.object.segmentRects,scale:i,onClick:e=>u(e,t)})},t.localId);case yc.SQUIGGLY:return he(fd,{trackedAnnotation:t,isSelected:r,isDraggable:!1,isResizable:!1,style:{mixBlendMode:vc(t.object.blendMode??fc.Normal)},...e,children:he(yd,{color:t.object.color,opacity:t.object.opacity,rects:t.object.segmentRects,rect:t.object.rect,scale:i,onClick:e=>u(e,t)})},t.localId);case yc.HIGHLIGHT:return he(fd,{trackedAnnotation:t,isSelected:r,isDraggable:!1,isResizable:!1,style:{mixBlendMode:vc(t.object.blendMode??fc.Multiply)},...e,children:he(md,{color:t.object.color,opacity:t.object.opacity,rects:t.object.segmentRects,scale:i,rect:t.object.rect,onClick:e=>u(e,t)})},t.localId);case yc.INK:return he(fd,{isSelected:r,trackedAnnotation:t,outlineOffset:6,computeResizePatch:_d,style:{mixBlendMode:vc(t.object.blendMode??fc.Normal)},...e,children:e=>he(wd,{color:e.color,opacity:e.opacity,strokeWidth:e.strokeWidth,inkList:e.inkList,rect:e.rect,scale:i,onClick:e=>u(e,t)})},t.localId);default:return null}})})}function Od({pageIndex:e,scale:t}){const{provides:i}=Rd(),{provides:r}=ud(),[o,n]=ke([]),[s,a]=ke(null),[l,c]=ke({variantKey:null,defaults:null});if(Pe(()=>{if(!i)return;return i.onSelectionChange(()=>{n(i.getHighlightRectsForPage(e)),a(i.getBoundingRectForPage(e))})},[i,e]),Pe(()=>{if(!r)return;return r.onActiveToolChange(c)},[r]),!s)return null;switch(l.variantKey){case cd(yc.UNDERLINE):return he("div",{style:{mixBlendMode:vc(l.defaults?.blendMode??fc.Normal),pointerEvents:"none",position:"absolute",inset:0},children:he(bd,{color:l.defaults?.color,opacity:l.defaults?.opacity,rects:o,scale:t})});case cd(yc.HIGHLIGHT):return he("div",{style:{mixBlendMode:vc(l.defaults?.blendMode??fc.Multiply),pointerEvents:"none",position:"absolute",inset:0},children:he(md,{color:l.defaults?.color,opacity:l.defaults?.opacity,rects:o,scale:t})});case cd(yc.STRIKEOUT):return he("div",{style:{mixBlendMode:vc(l.defaults?.blendMode??fc.Normal),pointerEvents:"none",position:"absolute",inset:0},children:he(vd,{color:l.defaults?.color,opacity:l.defaults?.opacity,rects:o,scale:t})});case cd(yc.SQUIGGLY):return he("div",{style:{mixBlendMode:vc(l.defaults?.blendMode??fc.Normal),pointerEvents:"none",position:"absolute",inset:0},children:he(yd,{color:l.defaults?.color,opacity:l.defaults?.opacity,rects:o,scale:t})});default:return null}}var zd=({pageIndex:e,scale:t,pageWidth:i,pageHeight:r})=>{const{provides:o}=ud(),[n,s]=ke({variantKey:null,defaults:null});if(Pe(()=>{if(!o)return;return o.onActiveToolChange(s)},[o]),!n.defaults)return null;if(n.defaults.subtype!==yc.INK)return null;const a=n.defaults?.color??"#000000",l=n.defaults?.opacity??1,c=n.defaults?.strokeWidth??2,{register:d}=gd({modeId:"ink",pageIndex:e}),u=(e,t,i)=>Math.max(t,Math.min(i,e)),[h,p]=ke([]),[g,f]=ke(!1),m=Te(null),b=i/t,v=r/t,y=Re(()=>({onPointerDown:(e,t)=>{const i=u(e.x,0,b),r=u(e.y,0,v);f(!0),m.current?(clearTimeout(m.current),m.current=null,p(e=>[...e,{points:[{x:i,y:r}]}])):p([{points:[{x:i,y:r}]}]),t.target?.setPointerCapture?.(t.pointerId)},onPointerMove:e=>{if(!g)return;const t=u(e.x,0,b),i=u(e.y,0,v);p(e=>{if(!e.length)return e;const r={points:[...e[e.length-1].points,{x:t,y:i}]};return[...e.slice(0,-1),r]})},onPointerUp:(t,i)=>{f(!1),i.target?.releasePointerCapture?.(i.pointerId),m.current&&clearTimeout(m.current),m.current=setTimeout(()=>{if(h.length&&o){const t=h.flatMap(e=>e.points);if(!t.length)return;const i=15,r=Math.min(...t.map(e=>e.x))-i,n=Math.min(...t.map(e=>e.y))-i,s=Math.max(...t.map(e=>e.x))+i,d=Math.max(...t.map(e=>e.y))+i;if(s-r<1||d-n<1)return;const u={origin:{x:r,y:n},size:{width:s-r,height:d-n}},p={type:yc.INK,rect:u,inkList:h,color:a,opacity:l,strokeWidth:c,pageIndex:e,id:Date.now()+Math.random()};o.createAnnotation(e,p),o.setActiveVariant(null),o.selectAnnotation(e,p.id)}p([]),m.current=null},3e3)},onPointerCancel:(e,t)=>{f(!1),t.target?.releasePointerCapture?.(t.pointerId),p([]),m.current&&(clearTimeout(m.current),m.current=null)}}),[b,v,h,o,e,a,l,c,g]);if(Pe(()=>{if(d)return d(y)},[d,y]),Pe(()=>()=>{m.current&&clearTimeout(m.current)},[]),!h.length)return null;const w=h.flatMap(e=>e.points);if(!w.length)return null;const S=Math.min(...w.map(e=>e.x)),C=Math.min(...w.map(e=>e.y)),x=Math.max(...w.map(e=>e.x)),I=Math.max(...w.map(e=>e.y)),A=S-15,E=C-15,k=x+15-A,P=I+15-E,M=h.map(({points:e})=>{let t="";return e.forEach(({x:e,y:i},r)=>{t+=(0===r?"M":"L")+(e-A)+" "+(i-E)+" "}),t.trim()});return he("svg",{style:{position:"absolute",left:A*t,top:E*t,width:k*t,height:P*t,pointerEvents:"none",zIndex:2},width:k*t,height:P*t,viewBox:`0 0 ${k} ${P}`,children:M.map((e,t)=>he("path",{d:e,fill:"none",stroke:a,strokeWidth:c,strokeLinecap:"round",strokeLinejoin:"round",opacity:l},t))})};function Ld({pageIndex:e,scale:t,pageWidth:i,pageHeight:r,rotation:o,style:n,...s}){return he("div",{style:{...n},...s,children:[he(Nd,{pageIndex:e,scale:t,rotation:o}),he(Od,{pageIndex:e,scale:t}),he(zd,{pageIndex:e,scale:t,pageWidth:i,pageHeight:r})]})}var Dd=["commandId","onClick","active","color","disabled"],Fd=["commandId","onClick","active"],Hd=function(e,t,i){var r=e.commandId,o=e.onClick,n=e.active,s=e.color,a=e.disabled,l=void 0!==a&&a,c=g(e,Dd),d=is().provides,u=r?null==d?void 0:d.getMenuOrAction(r):null,h=_e(function(e){if(e.preventDefault(),e.stopPropagation(),o)o();else if(r&&d&&u){var t=e.currentTarget;d.executeCommand(r,{source:"click",triggerElement:t,position:"horizontal"===(null==i?void 0:i.direction)?"bottom":"right"})}},[u,r,d,o]);return j(sn,{position:"horizontal"===(null==i?void 0:i.direction)?"bottom":"right",content:c.label||(null==u?void 0:u.label)||"",trigger:n?"none":"hover",delay:500},j(_r,{active:n,onClick:h,disabled:l,className:" ".concat("flyout"===(null==i?void 0:i.variant)?"w-full rounded-none px-2":""," ")},!(null!=u&&u.icon)&&c.img&&j("img",{src:c.img,alt:c.label,className:"h-5 w-5"}),(null==u?void 0:u.icon)&&j(js,{icon:u.icon,className:"h-5 w-5",style:{color:s}})))},$d=function(e,t){var i=e.commandId,r=e.onClick,o=e.active,n=g(e,Fd),s=is().provides,a=i?null==s?void 0:s.getMenuOrAction(i):null,l=_e(function(e){e.preventDefault(),e.stopPropagation(),r?r():i&&s&&a&&s.executeCommand(i,{source:"click"})},[a,i,s,r]);return j(_r,{key:n.id,className:"rounded-none px-2 py-1 text-sm hover:bg-transparent ".concat(o?"border-b-2 border-b-blue-500 text-blue-500":"border-b-2 border-b-transparent hover:border-b-gray-500"," hover:ring-transparent"),onClick:l},n.label)},jd=function(e,t,i){return j("div",{className:"horizontal"===(null==i?void 0:i.direction)?"h-6 w-[1px] bg-gray-300 self-center":"h-[1px] w-6 bg-gray-300 self-center"})},Ud=function(e,t,i){return j("div",{style:{display:"flex",flexDirection:"horizontal"===(null==i?void 0:i.direction)?"row":"column",justifyContent:e.justifyContent||"start",gap:"".concat(e.gap||0,"px")}},t())},Bd=function(e,t){var i=p(p(p({},"top"===e.placement?{borderBottom:"1px solid #cfd4da"}:"bottom"===e.placement?{borderTop:"1px solid #cfd4da"}:"left"===e.placement?{borderRight:"1px solid #cfd4da"}:{borderLeft:"1px solid #cfd4da"}),{},{width:"top"===e.placement||"bottom"===e.placement?"100%":"auto",height:"left"===e.placement||"right"===e.placement?"100%":"auto",zIndex:10,justifyContent:"space-between",display:"flex",flexDirection:"top"===e.placement||"bottom"===e.placement?"row":"column"},"top"===e.placement||"bottom"===e.placement?{paddingTop:"8px",paddingBottom:"8px",paddingLeft:"16px",paddingRight:"16px"}:{paddingLeft:"8px",paddingRight:"8px",paddingTop:"16px",paddingBottom:"16px"}),e.style);return void 0===e.visible||e.visible?j("div",{style:i,className:"header"},t(p({},e.visibleChild&&{filter:function(t){return t===e.visibleChild}}))):null},Gd=function(e,t){var i=is().provides,r=e.tabsCommandId?null==i?void 0:i.getMenuOrAction(e.tabsCommandId):null,o=r&&"menu"===r.type?null==i?void 0:i.getItemsByIds(r.children):null;return j(B,null,r&&o&&j("div",{role:"tablist",className:"mx-4 my-4 flex flex-shrink-0 overflow-hidden bg-white"},o.filter(function(e){return"action"===e.type}).map(function(e,t,r){var o=!!e.active,n=0===t,s=t===r.length-1;return j(sn,{key:e.id,content:e.label,trigger:"hover",position:"bottom"},j("button",{role:"tab","aria-selected":o,tabIndex:o?0:-1,onClick:function(t){return null==i?void 0:i.executeCommand(e.id,{source:"click",triggerElement:t.currentTarget,position:"bottom"})},className:"relative flex h-7 flex-1 cursor-pointer items-center justify-center border outline-none transition-colors ".concat(n?"rounded-l-md":""," ").concat(s?"rounded-r-md":""," ").concat(s?"":"border-r-0"," ").concat(o?"border-blue-600 bg-blue-600 text-white":"border-gray-300 text-gray-600 hover:bg-gray-50"," ")},e.icon&&j(js,{icon:e.icon,className:"pointer-events-none block h-5 w-5"})))})),t(p({},e.visibleChild&&{filter:function(t){return t===e.visibleChild}})))},Vd=function(e,t){var i=function(e){var t=v(ke(!1),2),i=t[0],r=t[1],o=Te(0),n=Te(0),s=Te(null),a=Te(!1);return Pe(function(){e||(r(!1),a.current=!1)},[e]),Pe(function(){if(e){var t=s.current;if(t){var l=function(e){a.current=!0,o.current="touches"in e?e.touches[0].clientY:e.clientY,n.current=o.current},c=function(e){if(a.current){n.current="touches"in e?e.touches[0].clientY:e.clientY;var t=n.current-o.current;t<-2&&!i?(r(!0),a.current=!1):t>2&&i&&(r(!1),a.current=!1)}},d=function(){a.current=!1};return t.addEventListener("touchstart",l),t.addEventListener("touchmove",c),t.addEventListener("touchend",d),t.addEventListener("touchcancel",d),t.addEventListener("mousedown",l),t.addEventListener("mousemove",c),t.addEventListener("mouseup",d),t.addEventListener("mouseleave",d),function(){t.removeEventListener("touchstart",l),t.removeEventListener("touchmove",c),t.removeEventListener("touchend",d),t.removeEventListener("touchcancel",d),t.removeEventListener("mousedown",l),t.removeEventListener("mousemove",c),t.removeEventListener("mouseup",d),t.removeEventListener("mouseleave",d)}}}},[e,i]),{elementRef:s,isFullscreen:i}}(e.open),r=i.elementRef,o=i.isFullscreen,n=is().provides;if(!e.open)return null;var s="left"===e.location?"md:border-r":"md:border-l";return j("div",{className:"flex w-full flex-none shrink-0 flex-col border-t bg-white md:w-[275px] md:min-w-[275px] md:border-t-0 ".concat(s," absolute bottom-0 left-0 right-0 z-10 touch-pan-y border-[#cfd4da] transition-all duration-300 ease-in-out md:static md:h-full ").concat(o?"h-full":"h-1/2")},j("div",{className:"flex h-6 w-full cursor-grab items-center justify-center active:cursor-grabbing md:hidden",ref:r},j("div",{className:"h-1 w-12 rounded-full bg-gray-300"})),j("div",{className:"flex flex-row justify-end md:hidden"},j(js,{icon:"x",className:"mr-5 h-5 w-5 cursor-pointer",onClick:function(){null==n||n.togglePanel({id:e.id,visibleChild:e.visibleChild||"leftPanelMain",open:!e.open})}})),j("div",{className:"flex min-h-0 flex-1 flex-col"},t(p({},e.visibleChild&&{filter:function(t){return t===e.visibleChild}}))))};function Wd(e){var t=e.hit,i=e.onClick,r=e.active,o=t.context,n=o.before,s=o.match,a=o.after,l=o.truncatedLeft,c=o.truncatedRight,d=Te(null);return Pe(function(){r&&d.current&&d.current.scrollIntoView({behavior:"smooth",block:"nearest"})},[r]),j("button",{ref:d,onClick:function(){return i(t)},className:"shadow-xs w-full cursor-pointer rounded border border-[#cfd4da] p-3 text-left text-xs leading-tight text-gray-600 ".concat(r?"border-blue-500 bg-blue-50":"hover:border-[#1a466b] hover:bg-gray-100")},l&&" ",n,j("span",{className:"font-bold text-blue-500"},s),a,c&&" ")}var Zd=function(e){var t=Te(null),i=v(ke(e.query||""),2),r=i[0],o=i[1],n=aa().provides,s=Ni().provides,a=Ra(r,400);Pe(function(){t.current&&t.current.focus()},[n]),Pe(function(){""===a?null==n||n.stopSearch():null==n||n.searchAllPages(a)},[a,n]),Pe(function(){void 0===e.activeResultIndex||e.loading||c(e.activeResultIndex)},[e.activeResultIndex,e.loading,e.query,e.flags]);var l=function(t,i){i?null==n||n.setFlags([].concat(y(e.flags),[t])):null==n||n.setFlags(e.flags.filter(function(e){return e!==t}))},c=function(t){var i=e.results[t];if(i){var r=i.rects.reduce(function(e,t){return{x:Math.min(e.x,t.origin.x),y:Math.min(e.y,t.origin.y)}},{x:1/0,y:1/0});null==s||s.scrollToPage({pageNumber:i.pageIndex+1,pageCoordinates:r,center:!0})}},d=e.results.reduce(function(e,t,i){var r,o;return(null!==(o=e[r=t.pageIndex])&&void 0!==o?o:e[r]=[]).push({hit:t,index:i}),e},{});return j("div",{className:"flex h-full flex-col bg-white"},j("div",{className:"p-4"},j("div",{className:"relative"},j("div",{className:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-2"},j("svg",{className:"h-4 w-4 text-gray-500",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},j("path",{fillRule:"evenodd",d:"M8 4a4 4 0 100 8 4 4 0 000-8zM2 8a6 6 0 1110.89 3.476l4.817 4.817a1 1 0 01-1.414 1.414l-4.816-4.816A6 6 0 012 8z",clipRule:"evenodd"}))),j("input",{ref:t,type:"text",placeholder:"Search",autoFocus:!0,value:r,onInput:function(e){var t=e.target;o(t.value)},className:"w-full rounded-md border border-gray-300 py-1 pl-8 pr-9 text-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500"}),r&&j("div",{className:"absolute inset-y-0 right-0 flex cursor-pointer items-center pr-3",onClick:function(){o(""),t.current&&t.current.focus()}},j("svg",{className:"h-4 w-4 text-gray-500 hover:text-gray-700",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},j("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})))),j("div",{className:"mt-3 flex flex-row gap-4"},j(_a,{label:"Case sensitive",checked:e.flags.includes(Ct.MatchCase),onChange:function(e){return l(Ct.MatchCase,e)}}),j(_a,{label:"Whole word",checked:e.flags.includes(Ct.MatchWholeWord),onChange:function(e){return l(Ct.MatchWholeWord,e)}})),j("hr",{className:"mb-2 mt-5 border-gray-200"}),e.active&&!e.loading&&j("div",{className:"flex h-[32px] flex-row items-center justify-between"},j("div",{className:"text-xs text-gray-500"},e.total," results found"),e.total>1&&j("div",{className:"flex flex-row"},j(_r,{onClick:function(){null==n||n.previousResult()}},j(js,{icon:"chevronLeft",className:"h-4 w-4"})),j(_r,{onClick:function(){null==n||n.nextResult()}},j(js,{icon:"chevronRight",className:"h-4 w-4"}))))),j("div",{className:"flex min-h-0 flex-1 flex-col gap-2 overflow-y-auto px-4"},e.loading&&j("div",{className:"flex h-full flex-row items-center justify-center"},j("div",{className:"text-xs text-gray-500"},"Loading...")),!e.loading&&Object.entries(d).map(function(t){var i=v(t,2),r=i[0],o=i[1];return j("div",{key:r,className:"mt-2 first:mt-0"},j("div",{className:"bg-white/80 py-2 text-xs text-gray-500 backdrop-blur"},"Page ",Number(r)+1),j("div",{className:"flex flex-col gap-2"},o.map(function(t){var i=t.hit,r=t.index;return j(Wd,{key:r,hit:i,active:r===e.activeResultIndex,onClick:function(){null==n||n.goToResult(r)}})})))}),j("div",null)))},qd=function(e,t,i){var r=Ns().provides,o=is().provides;if(!o)return null;var n=e.commandZoomMenu?o.getMenuOrAction(e.commandZoomMenu):null,s=e.commandZoomIn?o.getMenuOrAction(e.commandZoomIn):null,a=e.commandZoomOut?o.getMenuOrAction(e.commandZoomOut):null,l=v(ke(!1),2);l[0],l[1];var c=Te(null),d=Math.round(100*e.zoomLevel),u=function(e,t){t&&o.executeCommand(t.id,{source:"click",triggerElement:e.currentTarget,position:"horizontal"===(null==i?void 0:i.direction)?"bottom":"right",flatten:!0})};return Pe(function(){c.current&&console.log(c.current)},[c.current]),j("div",{className:"flex flex-row items-center rounded-md bg-[#f1f3f5]"},j("form",{onSubmit:function(e){e.preventDefault();var t=e.target,i=new FormData(t).get("zoom");null==r||r.requestZoom(parseFloat(i)/100)},className:"block"},j("input",{name:"zoom",type:"text",inputMode:"numeric",pattern:"\\d*",className:"h-6 w-8 border-0 bg-transparent p-0 text-right text-sm","aria-label":"Set zoom",autoFocus:!1,value:d,onInput:function(e){var t=e.target;t.value=t.value.replace(/[^0-9]/g,"")}}),j("span",{className:"text-sm"},"%")),j(sn,{position:"horizontal"===(null==i?void 0:i.direction)?"bottom":"right",content:"Zoom Options",trigger:e.zoomMenuActive?"none":"hover"},j(_r,{className:"p-1",onClick:function(e){return u(e,n)},active:e.zoomMenuActive},j("svg",{xmlns:"http://www.w3.org/2000/svg",width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",class:"icon icon-tabler icons-tabler-outline icon-tabler-chevron-down"},j("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),j("path",{d:"M6 9l6 6l6 -6"})))),j(sn,{position:"horizontal"===(null==i?void 0:i.direction)?"bottom":"right",content:"Zoom Out",trigger:"hover"},j(_r,{className:"p-1",onClick:function(e){return u(e,a)}},(null==a?void 0:a.icon)&&j(js,{icon:a.icon,className:"h-5 w-5"}))),j(sn,{position:"horizontal"===(null==i?void 0:i.direction)?"bottom":"right",content:"Zoom In",trigger:"hover"},j(_r,{className:"p-1",onClick:function(e){return u(e,s)}},(null==s?void 0:s.icon)&&j(js,{icon:s.icon,className:"h-5 w-5"}))))},Xd=function(e,t){var i=ud().provides,r=Ni().provides,o=vi().provides;if(!(e.open&&i&&r&&o))return null;var n=i.getSelectedAnnotation();if(!n)return null;var s=yl([{page:n.object.pageIndex,rect:n.object.rect}],r,o,10,42);return s?j("div",{style:{left:"".concat(s.left,"px"),top:"".concat(s.top,"px"),transform:"translate(-50%, 0%)",zIndex:2e3},className:"absolute rounded-md border border-[#cfd4da] bg-[#f8f9fa] p-1"},t()):null},Kd=function(e,t){var i=fl().provides,r=Ni().provides,o=vi().provides;if(!(e.open&&i&&r&&o))return null;var n=yl(i.getBoundingRects(),r,o,10,42);return n?j("div",{style:{left:"".concat(n.left,"px"),top:"".concat(n.top,"px"),transform:"translate(-50%, 0%)",zIndex:2e3},className:"absolute rounded-md border border-[#cfd4da] bg-[#f8f9fa] p-1"},t()):null},Yd=function(e,t){var i=vi().provides,r=v(ke(!1),2),o=r[0],n=r[1],s=v(ke(!1),2),a=s[0],l=s[1],c=Te(),d=_e(function(){c.current&&clearTimeout(c.current),c.current=setTimeout(function(){a||n(!1)},4e3)},[a]);Pe(function(){if(i)return i.onScrollChange(function(e){(e.scrollTop>0||e.scrollLeft>0)&&(n(!0),d())})},[i,d]),Pe(function(){return function(){c.current&&clearTimeout(c.current)}},[]);return j("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2",onMouseEnter:function(){l(!0),n(!0)},onMouseLeave:function(){l(!1),d()}},j("div",{className:"rounded-md border border-[#cfd4da] bg-[#f8f9fa] p-1 transition-opacity duration-200 ".concat(o?"opacity-100":"opacity-0")},t()))},Qd=function(e){var t=Ni().provides,i=is().provides,r=1===e.currentPage,o=e.currentPage===e.pageCount,n=e.nextPageCommandId?null==i?void 0:i.getMenuOrAction(e.nextPageCommandId):null,s=e.previousPageCommandId?null==i?void 0:i.getMenuOrAction(e.previousPageCommandId):null,a=function(e,t){t&&i&&i.executeCommand(t.id,{source:"click",triggerElement:e.currentTarget})};return j("div",{className:"flex flex-row items-center justify-between gap-3 rounded-md"},j(sn,{position:"top",content:"Previous Page",trigger:r?"none":"hover"},j(_r,{className:"p-1 ".concat(r?"cursor-not-allowed opacity-50 hover:ring-0":""),onClick:function(e){return a(e,s)},disabled:r},(null==s?void 0:s.icon)&&j(js,{icon:s.icon,className:"h-5 w-5"}))),j("form",{className:"flex flex-row items-center gap-3",onSubmit:function(e){e.preventDefault();var i=e.target,r=new FormData(i).get("page"),o=parseInt(r);!isNaN(o)&&o>=1&&(null==t||t.scrollToPage({pageNumber:o}))}},j("input",{name:"page",type:"text",inputMode:"numeric",pattern:"\\d*",className:"border-1 h-8 w-8 rounded-md border-gray-600 bg-white p-0 text-center text-sm","aria-label":"Set page",value:e.currentPage,onInput:function(e){var t=e.target;t.value=t.value.replace(/[^0-9]/g,"")}}),j("span",{className:"text-sm"},e.pageCount)),j(sn,{position:"top",content:"Next Page",trigger:o?"none":"hover"},j(_r,{className:"p-1 ".concat(o?"cursor-not-allowed opacity-50 hover:ring-0":""),onClick:function(e){return a(e,n)},disabled:o},(null==n?void 0:n.icon)&&j(js,{icon:n.icon,className:"h-5 w-5"}))))},Jd=function(e){var t=e.activeCommand,i=e.open,r=e.position,o=e.triggerElement,n=e.flatten,s=is().provides,a=v(ke([]),2),l=a[0],c=a[1],d=Te(null);if(Pe(function(){i||c([])},[i]),Pe(function(){t&&(d.current!==t?c([]):d.current=null)},[t]),!s)return null;var u=t?null==s?void 0:s.getChildItems(t,{flatten:n}):null,h=l.length>0&&t?s.getMenuOrAction(t):void 0,p=function(e){t&&c(function(e){return[].concat(y(e),[t])}),d.current=e,s.executeCommand(e,{triggerElement:o,position:r})},g=function(e,t){if("group"===e.type){var i=e,r=s.getItemsByIds(i.children);return j(B,{key:e.id},j("div",{className:"px-4 py-3 text-xs font-medium uppercase text-gray-600"},i.label),r.map(function(e,t){return j(B,{key:e.id},g(e,t))}),j("hr",{className:"my-2 border-gray-200"}))}var o=e.dividerBefore&&0!==t?j("hr",{className:"my-2 border-gray-200"}):null;return j(B,{key:e.id},o,j("button",{disabled:!!e.disabled,onClick:function(){return function(e){"action"===e.type?(s.hideCommandMenu(),s.executeCommand(e.id)):"menu"===e.type&&p(e.id)}(e)},className:"flex cursor-pointer flex-row items-center justify-between gap-2 px-4 py-1 ".concat("menu"===e.type?"menu-item":""," ").concat(e.active&&!e.disabled?"bg-blue-500 text-white":"text-gray-500 hover:bg-blue-900 hover:text-white"," ").concat(e.disabled?"pointer-events-none cursor-not-allowed opacity-50":""," ")},j("div",{className:"flex flex-row items-center gap-2"},j("div",{className:"flex h-6 w-6 items-center justify-center"},e.icon&&j(js,{icon:e.icon,className:"h-6 w-6"})),j("div",{className:"text-sm"},e.label)),j("div",{className:"flex items-center"},e.shortcutLabel&&j("div",{className:"mr-2 text-sm"},"(",e.shortcutLabel,")"),"menu"===e.type&&j(js,{icon:"chevronRight",className:"h-6 w-6"}))))},f=j(B,null,l.length>0&&j("div",{onClick:function(){if(0!==l.length){var e=l[l.length-1];c(function(e){return e.slice(0,-1)}),d.current=e,s.executeCommand(e,{triggerElement:o,position:r})}},className:"flex cursor-pointer flex-row items-center gap-2 px-4 py-1 pb-2 text-sm font-medium text-gray-500 hover:bg-gray-100"},j(js,{icon:"chevronLeft",className:"h-6 w-6 text-gray-500"})," ",null==h?void 0:h.label),null==u?void 0:u.map(function(e,t){return g(e,t)}));return i?j(ns,{trigger:o,open:i,placement:r||"bottom",className:"@max-[600px]:!bottom-0 @max-[600px]:!top-auto @max-[600px]:!left-0 @max-[600px]:!right-0",onShow:function(){},onHide:function(){s.hideCommandMenu()}},f):null},eu=function(e,t){return j("div",null,"Comments")},tu=function(e,t){var i=Ni().provides;return j(Ma,{className:"flex-1",selectedPage:e.currentPage},function(t){return j("div",{key:t.pageIndex,className:"absolute flex w-full cursor-pointer flex-col items-center",style:{height:t.wrapperHeight,top:t.top},onClick:function(){null==i||i.scrollToPage({pageNumber:t.pageIndex+1})}},j("div",{style:{width:t.width,height:t.height},className:"outline outline-2 -outline-offset-2 ".concat(e.currentPage===t.pageIndex+1?"outline-blue-500":"outline-gray-300")},j(Ta,{meta:t,className:"h-full w-full object-contain"})),j("div",{className:"flex items-center justify-center text-xs text-gray-500",style:{height:t.labelHeight}},t.pageIndex+1))})},iu=function(e,t){var i=cc().provides,r=Ni().provides,o=v(ke([]),2),n=o[0],s=o[1],a=v(ke(new Set),2),l=a[0],c=a[1];Pe(function(){if(i){var e=i.getBookmarks();return e.wait(function(e){var t=e.bookmarks;s(t);var i=t.map(function(e,t){return"bookmark-".concat(t)});c(new Set(i))},Mt),function(){e.abort({code:xt.Cancelled,message:"Bookmark task cancelled"})}}},[i,e.document]);var d=function(t,i){var o,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,s="bookmark-".concat(i),a=t.children&&t.children.length>0,u=l.has(s);return j("div",{key:s,className:"outline-item"},j("div",{className:"flex cursor-pointer items-center py-1 pr-4 text-sm text-gray-700 hover:bg-gray-100",style:{paddingLeft:"".concat(16*n+8,"px")},onClick:function(){return function(t){if(r&&t.target&&"action"===t.target.type){var i=t.target.action;if(1===i.type&&i.destination){var o=i.destination;if(o.zoom.mode===ct.XYZ){var n,s=null===(n=e.document)||void 0===n?void 0:n.pages.find(function(e){return e.index===o.pageIndex});if(!s)return;r.scrollToPage({pageNumber:o.pageIndex+1,pageCoordinates:o.zoom.params?{x:o.zoom.params.x,y:s.size.height-o.zoom.params.y}:void 0,behavior:"smooth"})}else o.zoom.mode===ct.FitPage&&r.scrollToPage({pageNumber:o.pageIndex+1,behavior:"smooth"})}}}(t)}},a&&j("button",{className:"mr-1 flex h-4 w-4 items-center justify-center rounded hover:bg-gray-200",onClick:function(e){e.stopPropagation(),function(e){c(function(t){var i=new Set(t);return i.has(e)?i.delete(e):i.add(e),i})}(s)}},j(js,{icon:u?"chevronDown":"chevronRight",className:"h-3 w-3 text-gray-500"})),!a&&j("div",{className:"mr-1 w-4"}),j("span",{className:"flex-1 truncate",title:t.title},t.title)),a&&u&&j("div",{className:"outline-children"},null===(o=t.children)||void 0===o?void 0:o.map(function(e,t){return d(e,"".concat(i,"-").concat(t),n+1)})))};return 0===n.length?j("div",{className:"flex h-full items-center justify-center p-6"},j("div",{className:"text-center text-gray-500"},j("div",{className:"text-sm"},"No outline available"),j("div",{className:"mt-1 text-xs"},"This document doesn't contain bookmarks"))):j("div",{className:"flex h-full flex-col bg-white"},j("div",{className:"flex-1 overflow-y-auto"},j("div",{className:"outline-tree"},n.map(function(e,t){return d(e,t)}))))},ru=function(e,t){return j("div",null,"Attachments")},ou=function(e,t){var i=e.activeCommandId,r=e.menuCommandId,o=e.active,n=is().provides;if(!n)return null;var s=n.getMenuOrAction(i),a=_e(function(e){if(e.preventDefault(),e.stopPropagation(),n&&r){var t=e.currentTarget;n.executeCommand(r,{source:"click",triggerElement:t})}},[r,n]);return j("div",{style:{maxWidth:"100px",width:"100px"}},j(_r,{className:"col-start-1 row-start-1 !w-full appearance-none rounded-md bg-white py-1.5 pl-3 pr-2 text-[13px] text-gray-900 ".concat(o?"text-blue-500 outline outline-2 -outline-offset-2 outline-blue-500":"outline outline-1 -outline-offset-1 outline-gray-300"," flex flex-row items-center justify-between gap-2 hover:ring-transparent"),onClick:a},j("span",{className:"min-w-0 flex-1 truncate text-left"},null==s?void 0:s.label),j(js,{icon:"chevronDown",className:"h-4 w-4 text-gray-500"})))},nu=function(e,t){var r,o=is().provides,n=Ni().provides,s=Hl(),a=s.executePrint,l=s.parsePageRange,c=s.progress,d=s.isPrinting,u=v(ke(Kl.All),2),h=u[0],p=u[1],g=v(ke(""),2),m=g[0],b=g[1],y=v(ke(!0),2),w=y[0],S=y[1],C=v(ke(Xl.Normal),2),x=C[0],I=C[1],A=v(ke(""),2),E=A[0],k=A[1];if(!o)return null;if(!e.open)return null;var P=null==n?void 0:n.getMetrics(),M=(null==P?void 0:P.currentPage)||1,T=(null==P||null===(r=P.pageVisibilityMetrics)||void 0===r?void 0:r.length)||0,R=function(){o.updateComponentState({componentType:"floating",componentId:"printModal",patch:{open:!1}})},_=function(e){p(e),k("")},N=function(){var e=i(f().m(function e(){var t,i,r,o,n;return f().w(function(e){for(;;)switch(e.p=e.n){case 0:o=h,e.n=o===Kl.Current?1:o===Kl.All?2:o===Kl.Custom?3:6;break;case 1:return t={type:Kl.Current,currentPage:M-1},e.a(3,7);case 2:return t={type:Kl.All},e.a(3,7);case 3:if(m.trim()){e.n=4;break}return k("Please enter page numbers"),e.a(2);case 4:if((i=l(m)).isValid){e.n=5;break}return k(i.error||"Invalid page range"),e.a(2);case 5:return t={type:Kl.Custom,pages:i.pages},e.a(3,7);case 6:return e.a(2);case 7:return r={pageRange:t,includeAnnotations:w,quality:x},e.p=8,e.n=9,a(r);case 9:R(),e.n=11;break;case 10:e.p=10,n=e.v,console.error("Print failed:",n);case 11:return e.a(2)}},e,null,[[8,10]])}));return function(){return e.apply(this,arguments)}}(),O=h!==Kl.Custom||m.trim()&&!E;return j(wl,{open:e.open,title:"Print Settings",onClose:R,maxWidth:"28rem"},j("div",{className:"space-y-6"},j("div",null,j("label",{className:"mb-3 block text-sm font-medium text-gray-700"},"Pages to print"),j("div",{className:"space-y-2"},j("label",{className:"flex items-center"},j("input",{type:"radio",name:"pageRange",value:"all",checked:h===Kl.All,onChange:function(){return _(Kl.All)},className:"mr-2"}),j("span",{className:"text-sm"},"All pages")),j("label",{className:"flex items-center"},j("input",{type:"radio",name:"pageRange",value:"current",checked:h===Kl.Current,onChange:function(){return _(Kl.Current)},className:"mr-2"}),j("span",{className:"text-sm"},"Current page (",M,")")),j("label",{className:"flex items-start"},j("input",{type:"radio",name:"pageRange",value:"custom",checked:h===Kl.Custom,onChange:function(){return _(Kl.Custom)},className:"mr-2 mt-0.5"}),j("div",{className:"flex-1"},j("span",{className:"mb-1 block text-sm"},"Specify pages"),j("input",{type:"text",placeholder:"e.g., 1-3, 5, 8-10",value:m,onInput:function(e){var t=e.target.value;if(b(t),t.trim()){var i=l(t);i.isValid?k(""):k(i.error||"Invalid page range")}else k("")},disabled:h!==Kl.Custom,className:"w-full rounded-md border px-3 py-1 text-sm ".concat(h!==Kl.Custom?"bg-gray-100 text-gray-500":E?"border-red-500 focus:border-red-500 focus:ring-red-500":"border-gray-300 focus:border-blue-500 focus:ring-blue-500"," focus:outline-none focus:ring-1")}),E&&j("p",{className:"mt-1 text-xs text-red-500"},E),h===Kl.Custom&&!E&&m.trim()&&j("p",{className:"mt-1 text-xs text-gray-500"},"Total pages: ",T))))),j("div",null,j("label",{className:"flex items-center"},j("input",{type:"checkbox",checked:w,onChange:function(e){return S(e.target.checked)},className:"mr-2"}),j("span",{className:"text-sm font-medium text-gray-700"},"Include annotations"))),j("div",null,j("label",{className:"mb-2 block text-sm font-medium text-gray-700"},"Print Quality"),j("div",{className:"relative"},j("select",{value:x,onChange:function(e){return I(e.target.value)},className:"w-full appearance-none rounded-md border border-gray-300 bg-white px-3 py-2 pr-8 text-sm focus:border-blue-500 focus:outline-none focus:ring-1 focus:ring-blue-500"},j("option",{value:Xl.Normal},"Normal"),j("option",{value:Xl.High},"High")),j("div",{className:"pointer-events-none absolute inset-y-0 right-3 flex items-center"},j("svg",{className:"h-4 w-4 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},j("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"}))))),d&&c&&j("div",{className:"rounded-md border border-blue-200 bg-blue-50 p-3"},j("div",{className:"mb-2 flex items-center justify-between"},j("span",{className:"text-sm font-medium text-blue-900"},"preparing"===c.status&&"Preparing...","rendering"===c.status&&"Rendering pages...","complete"===c.status&&"Complete!","error"===c.status&&"Error"),j("span",{className:"text-sm text-blue-700"},c.current,"/",c.total)),j("div",{className:"h-2 w-full rounded-full bg-blue-200"},j("div",{className:"h-2 rounded-full bg-blue-600 transition-all duration-300",style:{width:"".concat(c.current/c.total*100,"%")}})),c.message&&j("p",{className:"mt-2 text-sm text-blue-700"},c.message)),j("div",{className:"flex justify-end space-x-3 border-t border-gray-200 pt-4"},j(_r,{onClick:R,className:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",disabled:d},"Cancel"),j(_r,{onClick:N,disabled:d||!O,className:"rounded-md border border-transparent bg-blue-600 px-4 py-2 text-sm text-white hover:!bg-blue-700 disabled:cursor-not-allowed disabled:opacity-50"},d?"Printing...":"Print"))))},su="annotation",au={id:su,name:"Annotation Plugin",version:"1.0.0",provides:["annotation"],requires:["interaction-manager","selection"],optional:["history"],defaultConfig:{enabled:!0,autoCommit:!0}},lu=(e=>(e[e.Degree0=0]="Degree0",e[e.Degree90=1]="Degree90",e[e.Degree180=2]="Degree180",e[e.Degree270=3]="Degree270",e))(lu||{}),cu=class extends Error{constructor(e){super(`Task aborted: ${JSON.stringify(e)}`),this.name="TaskAbortedError"}},du=class extends Error{constructor(e){super(`Task rejected: ${JSON.stringify(e)}`),this.name="TaskRejectedError"}},uu=class e{constructor(){this.state={stage:0},this.resolvedCallbacks=[],this.rejectedCallbacks=[],this._promise=null}toPromise(){return this._promise||(this._promise=new Promise((e,t)=>{this.wait(t=>e(t),e=>{"abort"===e.type?t(new cu(e.reason)):t(new du(e.reason))})})),this._promise}wait(e,t){switch(this.state.stage){case 0:this.resolvedCallbacks.push(e),this.rejectedCallbacks.push(t);break;case 1:e(this.state.result);break;case 2:t({type:"reject",reason:this.state.reason});break;case 3:t({type:"abort",reason:this.state.reason})}}resolve(e){if(0===this.state.stage){this.state={stage:1,result:e};for(const t of this.resolvedCallbacks)try{t(e)}catch(e){}this.resolvedCallbacks=[],this.rejectedCallbacks=[]}}reject(e){if(0===this.state.stage){this.state={stage:2,reason:e};for(const t of this.rejectedCallbacks)try{t({type:"reject",reason:e})}catch(e){}this.resolvedCallbacks=[],this.rejectedCallbacks=[]}}abort(e){if(0===this.state.stage){this.state={stage:3,reason:e};for(const t of this.rejectedCallbacks)try{t({type:"abort",reason:e})}catch(e){}this.resolvedCallbacks=[],this.rejectedCallbacks=[]}}fail(e){"abort"===e.type?this.abort(e.reason):this.reject(e.reason)}static all(t){const i=new e;if(0===t.length)return i.resolve([]),i;const r=new Array(t.length);let o=0,n=!1;return t.forEach((e,s)=>{e.wait(e=>{n||(r[s]=e,o++,o===t.length&&(n=!0,i.resolve(r)))},e=>{n||(n=!0,"abort"===e.type?i.abort(e.reason):i.reject(e.reason))})}),i}static allSettled(t){const i=new e;if(0===t.length)return i.resolve([]),i;const r=new Array(t.length);let o=0;return t.forEach((e,n)=>{e.wait(e=>{r[n]={status:"resolved",value:e},o++,o===t.length&&i.resolve(r)},e=>{r[n]={status:"abort"===e.type?"aborted":"rejected",reason:e.reason},o++,o===t.length&&i.resolve(r)})}),i}static race(t){const i=new e;if(0===t.length)return i.reject("No tasks provided"),i;let r=!1;return t.forEach(e=>{e.wait(e=>{r||(r=!0,i.resolve(e))},e=>{r||(r=!0,"abort"===e.type?i.abort(e.reason):i.reject(e.reason))})}),i}static withProgress(t,i){const r=e.all(t);if(i){let e=0;t.forEach(r=>{r.wait(()=>{e++,i(e,t.length)},()=>{e++,i(e,t.length)})})}return r}},hu=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${hu.join("")}]`,"g");var pu=(e=>(e[e.Normal=0]="Normal",e[e.Multiply=1]="Multiply",e[e.Screen=2]="Screen",e[e.Overlay=3]="Overlay",e[e.Darken=4]="Darken",e[e.Lighten=5]="Lighten",e[e.ColorDodge=6]="ColorDodge",e[e.ColorBurn=7]="ColorBurn",e[e.HardLight=8]="HardLight",e[e.SoftLight=9]="SoftLight",e[e.Difference=10]="Difference",e[e.Exclusion=11]="Exclusion",e[e.Hue=12]="Hue",e[e.Saturation=13]="Saturation",e[e.Color=14]="Color",e[e.Luminosity=15]="Luminosity",e))(pu||{}),gu=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);gu.reduce((e,t)=>(e[t.id]=t,e),{}),gu.reduce((e,t)=>(e[t.css]=t.id,e),{}),gu.map(e=>({value:e.id,label:e.label}));var fu=(e=>(e[e.UNKNOWN=0]="UNKNOWN",e[e.TEXT=1]="TEXT",e[e.LINK=2]="LINK",e[e.FREETEXT=3]="FREETEXT",e[e.LINE=4]="LINE",e[e.SQUARE=5]="SQUARE",e[e.CIRCLE=6]="CIRCLE",e[e.POLYGON=7]="POLYGON",e[e.POLYLINE=8]="POLYLINE",e[e.HIGHLIGHT=9]="HIGHLIGHT",e[e.UNDERLINE=10]="UNDERLINE",e[e.SQUIGGLY=11]="SQUIGGLY",e[e.STRIKEOUT=12]="STRIKEOUT",e[e.STAMP=13]="STAMP",e[e.CARET=14]="CARET",e[e.INK=15]="INK",e[e.POPUP=16]="POPUP",e[e.FILEATTACHMENT=17]="FILEATTACHMENT",e[e.SOUND=18]="SOUND",e[e.MOVIE=19]="MOVIE",e[e.WIDGET=20]="WIDGET",e[e.SCREEN=21]="SCREEN",e[e.PRINTERMARK=22]="PRINTERMARK",e[e.TRAPNET=23]="TRAPNET",e[e.WATERMARK=24]="WATERMARK",e[e.THREED=25]="THREED",e[e.RICHMEDIA=26]="RICHMEDIA",e[e.XFAWIDGET=27]="XFAWIDGET",e[e.REDACT=28]="REDACT",e))(fu||{}),mu=(e=>(e[e.Normal=0]="Normal",e[e.Rollover=1]="Rollover",e[e.Down=2]="Down",e))(mu||{}),bu=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});Object.entries(bu).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var vu=(e=>(e[e.Ok=0]="Ok",e[e.Unknown=1]="Unknown",e[e.NotFound=2]="NotFound",e[e.WrongFormat=3]="WrongFormat",e[e.Password=4]="Password",e[e.Security=5]="Security",e[e.PageError=6]="PageError",e[e.XFALoad=7]="XFALoad",e[e.XFALayout=8]="XFALayout",e[e.Cancelled=9]="Cancelled",e[e.Initialization=10]="Initialization",e[e.NotReady=11]="NotReady",e[e.NotSupport=12]="NotSupport",e[e.LoadDoc=13]="LoadDoc",e[e.DocNotOpen=14]="DocNotOpen",e[e.CantCloseDoc=15]="CantCloseDoc",e[e.CantCreateNewDoc=16]="CantCreateNewDoc",e[e.CantImportPages=17]="CantImportPages",e[e.CantCreateAnnot=18]="CantCreateAnnot",e[e.CantSetAnnotRect=19]="CantSetAnnotRect",e[e.CantSetAnnotContent=20]="CantSetAnnotContent",e[e.CantRemoveInkList=21]="CantRemoveInkList",e[e.CantAddInkStoke=22]="CantAddInkStoke",e[e.CantReadAttachmentSize=23]="CantReadAttachmentSize",e[e.CantReadAttachmentContent=24]="CantReadAttachmentContent",e[e.CantFocusAnnot=25]="CantFocusAnnot",e[e.CantSelectText=26]="CantSelectText",e[e.CantSelectOption=27]="CantSelectOption",e[e.CantCheckField=28]="CantCheckField",e))(vu||{}),yu=class{static create(){return new uu}static resolve(e){const t=new uu;return t.resolve(e),t}static reject(e){const t=new uu;return t.reject(e),t}static abort(e){const t=new uu;return t.reject(e),t}};function wu(){}var Su=class{constructor(e,t){if(this.id=e,this.registry=t,this.debouncedActions={},this.unsubscribeFromState=null,this.unsubscribeFromCoreStore=null,e!==this.constructor.id)throw new Error(`Plugin ID mismatch: ${e} !== ${this.constructor.id}`);this.coreStore=this.registry.getStore(),this.pluginStore=this.coreStore.getPluginStore(this.id),this.unsubscribeFromState=this.pluginStore.subscribeToState((e,t,i)=>{this.onStoreUpdated(i,t)}),this.unsubscribeFromCoreStore=this.coreStore.subscribe((e,t,i)=>{this.onCoreStoreUpdated(i,t)}),this.readyPromise=new Promise(e=>{this.readyResolve=e}),this.readyResolve()}provides(){if(!this._capability){const e=this.buildCapability();this._capability=Object.freeze(e)}return this._capability}get state(){return this.pluginStore.getState()}get coreState(){return this.coreStore.getState()}getState(){return this.pluginStore.getState()}getCoreState(){return this.coreStore.getState()}dispatchCoreAction(e){return this.coreStore.dispatchToCore(e)}dispatchToAllPlugins(e){return this.coreStore.dispatch(e)}dispatch(e){return this.pluginStore.dispatch(e)}debouncedDispatch(e,t=100){const i=Date.now();return i-(this.debouncedActions[e.type]||0)>=t&&(this.debouncedActions[e.type]=i,this.dispatch(e),!0)}subscribe(e){return this.pluginStore.subscribeToState(e)}subscribeToCoreStore(e){return this.coreStore.subscribe(e)}onStoreUpdated(e,t){}onCoreStoreUpdated(e,t){}destroy(){this.unsubscribeFromState&&(this.unsubscribeFromState(),this.unsubscribeFromState=null),this.unsubscribeFromCoreStore&&(this.unsubscribeFromCoreStore(),this.unsubscribeFromCoreStore=null)}ready(){return this.readyPromise}markReady(){this.readyResolve()}resetReady(){this.readyPromise=new Promise(e=>{this.readyResolve=e})}},Cu=class{constructor(e,t){this.handler=e,this.options=t,this.lastRun=0,this.handle=e=>{"debounce"===this.options.mode?this.debounce(e):this.throttle(e)}}debounce(e){this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.timeoutId=void 0},this.options.wait)}throttle(e){if("debounce"===this.options.mode)return;const t=Date.now(),i=this.options.throttleMode||"leading-trailing";t-this.lastRun>=this.options.wait&&("leading-trailing"===i&&this.handler(e),this.lastRun=t),this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.lastRun=Date.now(),this.timeoutId=void 0},this.options.wait-(t-this.lastRun))}destroy(){this.timeoutId&&window.clearTimeout(this.timeoutId)}};function xu(e,t,i){if(e===t)return!0;if(null==e||null==t)return e===t;const r=typeof e;if(r!==typeof t)return!1;if("object"===r){i||(i=new Set);const r=function(e,t){return`${Eu(e)}__${Eu(t)}`}(e,t);if(i.has(r))return!0;i.add(r);const o=Array.isArray(e),n=Array.isArray(t);return o&&n?function(e,t,i){if(e.length!==t.length)return!1;const r=new Array(t.length).fill(!1);e:for(let o=0;o<e.length;o++){const n=e[o];for(let e=0;e<t.length;e++)if(!r[e]&&xu(n,t[e],i)){r[e]=!0;continue e}return!1}return!0}(e,t,i):!o&&!n&&function(e,t,i){const r=Object.keys(e).sort(),o=Object.keys(t).sort();if(r.length!==o.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!==o[e])return!1;for(const o of r){if(!xu(e[o],t[o],i))return!1}return!0}(e,t,i)}return!1}var Iu=0,Au=new WeakMap;function Eu(e){return Au.has(e)||Au.set(e,++Iu),Au.get(e)}function ku(e,t=xu){const i=new Set,r=new Map;let o=e;const n=(e,t)=>{let n=e,s=()=>{};if(t){const i=new Cu(e,t);n=i.handle,s=()=>i.destroy(),r.set(e,{wrapped:n,destroy:s})}return void 0!==o&&n(o),i.add(n),()=>{i.delete(n),s(),r.delete(e)}};return{get value(){return o},emit(e=void 0){(void 0===o||!t(o,e))&&(o=e,(e=>{i.forEach(t=>t(e))})(e))},on:n,off(e){const t=r.get(e);t?(i.delete(t.wrapped),t.destroy(),r.delete(e)):i.delete(e)},clear(){i.clear(),r.forEach(e=>e.destroy()),r.clear()},select:(e,t=xu)=>(i,r)=>{let s;if(void 0!==o){const t=e(o);s=t,i(t)}return n(r=>{const o=e(r);(void 0===s||!t(s,o))&&(s=o,i(o))},r)}}}var Pu="ANNOTATION/SET_ANNOTATIONS",Mu="ANNOTATION/REINDEX_PAGE",Tu="ANNOTATION/SELECT_ANNOTATION",Ru="ANNOTATION/DESELECT_ANNOTATION",_u="ANNOTATION/UPDATE_TOOL_DEFAULTS",Nu="ANNOTATION/ADD_COLOR_PRESET",Ou="ANNOTATION/CREATE_ANNOTATION",zu="ANNOTATION/PATCH_ANNOTATION",Lu="ANNOTATION/DELETE_ANNOTATION",Du="ANNOTATION/COMMIT",Fu="ANNOTATION/STORE_PDF_ID",Hu="ANNOTATION/PURGE_ANNOTATION",$u="ANNOTATION/SET_ACTIVE_VARIANT",ju=e=>({type:Mu,payload:{pageIndex:e}}),Uu=()=>({type:Ru}),Bu=(e,t,i)=>({type:Ou,payload:{pageIndex:e,localId:t,annotation:i}}),Gu=(e,t,i)=>({type:zu,payload:{pageIndex:e,localId:t,patch:i}}),Vu=(e,t)=>({type:Lu,payload:{pageIndex:e,localId:t}}),Wu=(e,t)=>({type:Fu,payload:{uid:e,pdfId:t}}),Zu=e=>({type:Hu,payload:{uid:e}}),qu=(e,t)=>`p${e}#${t}`,Xu=e=>{const[t,i]=e.slice(1).split("#");return{pageIndex:Number(t),localId:Number(i)}},Ku=e=>{if(!e.selectedUid)return null;const{pageIndex:t,localId:i}=Xu(e.selectedUid);return{pageIndex:t,localId:i,annotation:e.byUid[e.selectedUid].object}},Yu=(e,t)=>t?`${e}#${t}`:`${e}`,Qu=class extends Su{constructor(e,t,i,r){super(e,t),this.ANNOTATION_HISTORY_TOPIC="annotations",this.state$=ku(),this.modeByVariant=new Map,this.variantByMode=new Map,this.activeVariantChange$=ku(),this.activeTool$=ku({variantKey:null,defaults:null}),this.engine=i,this.config=r;const o=t.getPlugin("selection");this.selection=o?.provides()??null;const n=t.getPlugin("history");this.history=n?.provides()??null;const s=t.getPlugin("interaction-manager");this.interactionManager=s?.provides()??null,this.coreStore.onAction("SET_DOCUMENT",(e,t)=>{const i=t.core.document;i&&this.getAllAnnotations(i)})}async initialize(){for(const[e,t]of Object.entries(this.state.toolDefaults))this.registerTool(e,t);this.history?.onHistoryChange(e=>{e===this.ANNOTATION_HISTORY_TOPIC&&!1!==this.config.autoCommit&&this.commit()}),this.interactionManager?.onModeChange(e=>{const t=this.variantByMode.get(e.activeMode)??null;console.log(t,this.state.activeVariant),t!==this.state.activeVariant&&(this.dispatch((e=>({type:$u,payload:e}))(t)),this.activeVariantChange$.emit(t))}),this.selection?.onEndSelection(()=>{if(!this.state.activeVariant)return;if(this.state.activeVariant!==Yu(fu.HIGHLIGHT)&&this.state.activeVariant!==Yu(fu.UNDERLINE)&&this.state.activeVariant!==Yu(fu.STRIKEOUT)&&this.state.activeVariant!==Yu(fu.SQUIGGLY))return;const e=this.selection?.getFormattedSelection();if(e){for(const t of e){const e=t.rect,i=t.segmentRects,r=this.state.activeVariant,o=this.state.toolDefaults[r].subtype,n=this.state.toolDefaults[r].color,s=this.state.toolDefaults[r].opacity,a=this.state.toolDefaults[r].blendMode??pu.Normal;this.createAnnotation(t.pageIndex,{type:o,rect:e,segmentRects:i,color:n,opacity:s,blendMode:a,pageIndex:t.pageIndex,id:Date.now()+Math.random()})}this.selection?.clear()}})}registerTool(e,t){const i=t.interaction.mode,r={id:i,scope:"page",exclusive:t.interaction.exclusive,cursor:t.interaction.cursor};this.interactionManager?.registerMode(r),t.textSelection&&this.selection?.enableForMode(i),this.modeByVariant.set(e,i),this.variantByMode.set(i,e)}buildCapability(){return{getPageAnnotations:e=>this.getPageAnnotations(e),getSelectedAnnotation:()=>(e=>e.selectedUid?e.byUid[e.selectedUid]:null)(this.state),selectAnnotation:(e,t)=>{this.selectAnnotation(e,t)},deselectAnnotation:()=>{this.dispatch(Uu())},getActiveVariant:()=>this.state.activeVariant,setActiveVariant:e=>{if(e!==this.state.activeVariant)if(e){const t=this.modeByVariant.get(e);if(!t)throw new Error(`Mode missing for variant ${e}`);this.interactionManager?.activate(t)}else this.interactionManager?.activate("default")},getToolDefaults:e=>{const t=this.state.toolDefaults[e];if(!t)throw new Error(`No defaults found for variant: ${e}`);return t},getToolDefaultsBySubtypeAndIntent:(e,t)=>{const i=Yu(e,t),r=this.state.toolDefaults[i];if(!r)throw new Error(`No defaults found for variant: ${i}`);return r},getToolDefaultsBySubtype:e=>{const t=this.state.toolDefaults[e];if(!t)throw new Error(`No defaults found for subtype: ${e}`);return t},setToolDefaults:(e,t)=>{this.dispatch(((e,t)=>({type:_u,payload:{variantKey:e,patch:t}}))(e,t))},getColorPresets:()=>[...this.state.colorPresets],addColorPreset:e=>this.dispatch((e=>({type:Nu,payload:e}))(e)),createAnnotation:(e,t)=>this.createAnnotation(e,t),updateAnnotation:(e,t,i)=>this.updateAnnotation(e,t,i),deleteAnnotation:(e,t)=>this.deleteAnnotation(e,t),renderAnnotation:e=>this.renderAnnotation(e),onStateChange:this.state$.on,onActiveVariantChange:this.activeVariantChange$.on,onActiveToolChange:this.activeTool$.on,commit:()=>this.commit()}}createActiveTool(e,t){return null===e?{variantKey:null,defaults:null}:{variantKey:e,defaults:t[e]}}emitActiveTool(e){const t=this.createActiveTool(e.activeVariant,e.toolDefaults);this.activeTool$.emit(t)}onStoreUpdated(e,t){this.state$.emit(t),e.activeVariant===t.activeVariant&&e.toolDefaults[e.activeVariant??fu.HIGHLIGHT]===t.toolDefaults[t.activeVariant??fu.HIGHLIGHT]||this.emitActiveTool(t)}getAllAnnotations(e){this.engine.getAllAnnotations(e).wait(e=>this.dispatch((e=>({type:Pu,payload:e}))(e)),wu)}getPageAnnotations(e){const{pageIndex:t}=e,i=this.coreState.core.document;if(!i)return yu.reject({code:vu.NotFound,message:"Document not found"});const r=i.pages.find(e=>e.index===t);return r?this.engine.getPageAnnotations(i,r):yu.reject({code:vu.NotFound,message:"Page not found"})}renderAnnotation({pageIndex:e,annotation:t,scaleFactor:i=1,rotation:r=lu.Degree0,dpr:o=1,mode:n=mu.Normal,imageType:s="image/webp"}){const a=this.coreState.core;if(!a.document)throw new Error("document does not open");const l=a.document.pages.find(t=>t.index===e);if(!l)throw new Error("page does not exist");return this.engine.renderAnnotation(a.document,l,t,i,r,o,n,s)}selectAnnotation(e,t){this.dispatch(((e,t)=>({type:Tu,payload:{pageIndex:e,localId:t}}))(e,t))}createAnnotation(e,t){const i=t.id,r=()=>this.dispatch(Bu(e,i,t));if(!this.history)return r(),void(this.config.autoCommit&&this.commit());const o={execute:r,undo:()=>{this.dispatch(Uu()),this.dispatch(Vu(e,i))}};this.history.register(o,this.ANNOTATION_HISTORY_TOPIC)}updateAnnotation(e,t,i){if(!this.history)return this.dispatch(Gu(e,t,i)),void(!1!==this.config.autoCommit&&this.commit());const r=this.state.byUid[qu(e,t)].object,o=Object.fromEntries(Object.keys(i).map(e=>[e,r[e]])),n={execute:()=>this.dispatch(Gu(e,t,i)),undo:()=>this.dispatch(Gu(e,t,o))};this.history.register(n,this.ANNOTATION_HISTORY_TOPIC)}deleteAnnotation(e,t){if(!this.history)return this.dispatch(Uu()),this.dispatch(Vu(e,t)),void(!1!==this.config.autoCommit&&this.commit());const i=this.state.byUid[qu(e,t)].object,r={execute:()=>{this.dispatch(Uu()),this.dispatch(Vu(e,t))},undo:()=>this.dispatch(Bu(e,t,i))};this.history.register(r,this.ANNOTATION_HISTORY_TOPIC)}commit(){const e=new uu;if(!this.state.hasPendingChanges)return yu.resolve(!0);const t=this.coreState.core.document;if(!t)return yu.reject({code:vu.NotFound,message:"Document not found"});const i=[],r=[],o=new Map,n=new Set;for(const[e,s]of Object.entries(this.state.byUid)){if("synced"===s.commitState)continue;const{pageIndex:a}=Xu(e),l=t.pages.find(e=>e.index===a);if(l)switch(n.add(a),s.commitState){case"new":const n=this.engine.createPageAnnotation(t,l,s.object);n.wait(t=>this.dispatch(Wu(e,t)),wu),i.push(n);break;case"dirty":r.push(this.engine.updatePageAnnotation(t,l,{...s.object,id:s.pdfId}));break;case"deleted":o.has(a)||o.set(a,[]),o.get(a).push({ta:s,uid:e})}}const s=[];for(const[e,i]of o.entries()){const r=t.pages.find(t=>t.index===e);i.sort((e,t)=>(t.ta.pdfId??-1)-(e.ta.pdfId??-1));for(const{ta:e,uid:o}of i)if(void 0!==e.pdfId){const i=new uu;this.engine.removePageAnnotation(t,r,{...e.object,id:e.pdfId}).wait(()=>{this.dispatch(Zu(o)),i.resolve(!0)},i.fail),s.push(i)}else this.dispatch(Zu(o))}const a=[...i,...r,...s];return uu.allSettled(a).wait(()=>{for(const e of n)this.dispatch(ju(e));this.dispatch({type:Du}),e.resolve(!0)},e.fail),e}};Qu.id="annotation";var Ju=["#E44234","#FF8D00","#FFCD45","#5CC96E","#25D2D1","#597CE2","#C544CE","#7D2E25"],eh={manifest:au,create:(e,t,i)=>new Qu(su,e,t,i),reducer:(e,t)=>{switch(t.type){case Pu:{const i={...e.pages},r={...e.byUid};for(const[o,n]of Object.entries(t.payload)){const t=Number(o),s=e.pages[t]||[];for(const e of s)delete r[e];const a=n.map((e,i)=>{const o=Date.now()+Math.random()+i,n=qu(t,o);return r[n]={localId:o,pdfId:e.id,commitState:"synced",object:e},n});i[t]=a}return{...e,pages:i,byUid:r}}case $u:return{...e,activeVariant:t.payload};case Tu:return{...e,selectedUid:qu(t.payload.pageIndex,t.payload.localId)};case Ru:return{...e,selectedUid:null};case Nu:return e.colorPresets.includes(t.payload)?e:{...e,colorPresets:[...e.colorPresets,t.payload]};case _u:{const{variantKey:i,patch:r}=t.payload,o=e.toolDefaults[i];return o?{...e,toolDefaults:{...e.toolDefaults,[i]:{...o,...r}}}:e}case Ou:{const{pageIndex:i,localId:r,annotation:o}=t.payload,n=qu(i,r);return{...e,pages:{...e.pages,[i]:[...e.pages[i]??[],n]},byUid:{...e.byUid,[n]:{localId:r,pdfId:void 0,commitState:"new",object:o}},hasPendingChanges:!0}}case Lu:{const{pageIndex:i,localId:r}=t.payload,o=qu(i,r);return e.byUid[o]?{...e,pages:{...e.pages,[i]:(e.pages[i]??[]).filter(e=>e!==o)},byUid:{...e.byUid,[o]:{...e.byUid[o],commitState:"deleted"}},hasPendingChanges:!0}:e}case zu:{const i=qu(t.payload.pageIndex,t.payload.localId);return((e,t,i)=>{const r=e.byUid[t];return r?{...e,byUid:{...e.byUid,[t]:{...r,commitState:"synced"===r.commitState?"dirty":r.commitState,object:{...r.object,...i}}},hasPendingChanges:!0}:e})(e,i,t.payload.patch)}case Du:{const t={};for(const[i,r]of Object.entries(e.byUid))t[i]={...r,commitState:"dirty"===r.commitState||"new"===r.commitState?"synced":r.commitState};return{...e,byUid:t,hasPendingChanges:!1}}case Mu:{const{pageIndex:i}=t.payload,r={...e.byUid},o=(e.pages[i]||[]).map(t=>e.byUid[t]).filter(e=>e&&"deleted"!==e.commitState);return o.sort((e,t)=>(e.pdfId??1/0)-(t.pdfId??1/0)),o.forEach((e,t)=>{const o=qu(i,e.localId);r[o]={...r[o],pdfId:t}}),{...e,byUid:r}}case Fu:{const{uid:i,pdfId:r}=t.payload,o=e.byUid[i];return o?{...e,byUid:{...e.byUid,[i]:{...o,pdfId:r,commitState:"synced"}}}:e}case Hu:{const{uid:i}=t.payload,{[i]:r,...o}=e.byUid;return{...e,byUid:o}}default:return e}},initialState:(e,t)=>{return i=t,{pages:{},byUid:{},selectedUid:null,activeVariant:null,toolDefaults:{[Yu(fu.HIGHLIGHT)]:{name:"Highlight",subtype:fu.HIGHLIGHT,interaction:{mode:"highlight",exclusive:!1},textSelection:!0,color:"#FFCD45",opacity:1,blendMode:pu.Multiply},[Yu(fu.UNDERLINE)]:{name:"Underline",subtype:fu.UNDERLINE,interaction:{mode:"underline",exclusive:!1},textSelection:!0,color:"#E44234",opacity:1,blendMode:pu.Normal},[Yu(fu.STRIKEOUT)]:{name:"Strikeout",subtype:fu.STRIKEOUT,interaction:{mode:"strikeout",exclusive:!1},textSelection:!0,color:"#E44234",opacity:1,blendMode:pu.Normal},[Yu(fu.SQUIGGLY)]:{name:"Squiggly",subtype:fu.SQUIGGLY,interaction:{mode:"squiggly",exclusive:!1},textSelection:!0,color:"#E44234",opacity:1,blendMode:pu.Normal},[Yu(fu.INK)]:{name:"Ink",subtype:fu.INK,interaction:{mode:"ink",exclusive:!0,cursor:"crosshair"},color:"#E44234",opacity:1,strokeWidth:11,blendMode:pu.Normal},[Yu(fu.INK,"InkHighlight")]:{name:"Ink Highlight",subtype:fu.INK,interaction:{mode:"inkHighlight",exclusive:!0,cursor:"crosshair"},color:"#E44234",opacity:1,strokeWidth:11,blendMode:pu.Multiply},...i.toolDefaults},colorPresets:i.colorPresets??Ju,hasPendingChanges:!1};var i}},th=l(l(l(l(l(l({},Yu(gt.HIGHLIGHT),[{id:"color",label:"Color"},{id:"opacity",label:"Opacity",min:.1,max:1,step:.05},{id:"blendMode",label:"Blend Mode"}]),Yu(gt.UNDERLINE),[{id:"color",label:"Color"},{id:"opacity",label:"Opacity",min:.1,max:1,step:.05},{id:"blendMode",label:"Blend Mode"}]),Yu(gt.STRIKEOUT),[{id:"color",label:"Color"},{id:"opacity",label:"Opacity",min:.1,max:1,step:.05},{id:"blendMode",label:"Blend Mode"}]),Yu(gt.SQUIGGLY),[{id:"color",label:"Color"},{id:"opacity",label:"Opacity",min:.1,max:1,step:.05},{id:"blendMode",label:"Blend Mode"}]),Yu(gt.INK),[{id:"color",label:"Color"},{id:"opacity",label:"Opacity",min:.1,max:1,step:.05},{id:"strokeWidth",label:"Stroke width",min:1,max:30,step:1}]),Yu(gt.INK,"InkHighlight"),[{id:"color",label:"Color"},{id:"opacity",label:"Opacity",min:.1,max:1,step:.05},{id:"strokeWidth",label:"Stroke width",min:1,max:30,step:1}]),ih=function(e){var t=e.value,i=e.min,r=void 0===i?0:i,o=e.max,n=void 0===o?1:o,s=e.step,a=void 0===s?.1:s,l=e.onChange;return he("input",{type:"range",class:"range-sm mb-2 h-1 w-full cursor-pointer appearance-none rounded-lg bg-gray-200 dark:bg-gray-700",value:t,min:r,max:n,step:a,onInput:function(e){return l(parseFloat(e.target.value))}})},rh=function(e){var t=e.color,i=e.active,r=e.onSelect;return he("button",{title:t,class:"h-5 w-5 rounded-full border border-gray-400 ".concat(i?"outline outline-2 outline-offset-2 outline-blue-500":""),style:{backgroundColor:t},onClick:function(){return r(t)}})},oh=function(e){var t,i,r,o,n,s=e.selectedAnnotation,a=e.activeVariant,l=e.colorPresets,c=ud().provides;if(!c)return null;if(!s&&!a)return he("div",{class:"flex flex-col items-center gap-2 p-4 text-gray-500",children:[he(js,{icon:"palette",className:"h-18 w-18 text-gray-500"}),he("div",{className:"max-w-[150px] text-center text-sm text-gray-500",children:"Select an annotation to see styles"})]});var d=s?Yu(s.annotation.type,s.annotation.intent):a,u=null==c?void 0:c.getToolDefaults(d),h=null!==(t=null==u?void 0:u.subtype)&&void 0!==t?t:null,p=null!==(i=th[d])&&void 0!==i?i:[],g=s?function(e){switch(e.type){case gt.HIGHLIGHT:case gt.UNDERLINE:case gt.STRIKEOUT:case gt.SQUIGGLY:case gt.INK:return{color:e.color,opacity:e.opacity};default:return{color:"#FFFF00",opacity:1}}}(s.annotation):{color:u.color,opacity:u.opacity},f=v(ke(g.color),2),m=f[0],b=f[1];Pe(function(){return b(g.color)},[g.color]);var y=function(e){b(e),N({color:e})},w=v(ke(g.opacity),2),S=w[0],C=w[1];Pe(function(){return C(g.opacity)},[g.opacity]);var x=Ra(S,300);Pe(function(){return N({opacity:x})},[x]);var I=h!==gt.INK?1:(null==s?void 0:s.annotation.type)===gt.INK?s.annotation.strokeWidth:u.strokeWidth,A=v(ke(I),2),E=A[0],k=A[1];Pe(function(){return k(I)},[I]);var P=Ra(E,300);Pe(function(){h===gt.INK&&N({strokeWidth:P})},[P]);var M=null!==(r=null!==(o=null==s||null===(n=s.annotation)||void 0===n?void 0:n.blendMode)&&void 0!==o?o:h!==gt.INK&&"blendMode"in u?u.blendMode:void 0)&&void 0!==r?r:dt.Normal,T=v(ke(M),2),R=T[0],_=T[1];Pe(function(){return _(M)},[M]);function N(e){s?null==c||c.updateAnnotation(s.pageIndex,s.localId,e):a&&(null==c||c.setToolDefaults(a,e))}return he("div",{class:"p-4",children:[he("h2",{class:"text-md mb-4 font-medium",children:"".concat(u.name,s?" styles":" defaults")}),p.map(function(e){switch(e.id){case"color":return he("section",{class:"mb-6",children:[he("label",{class:"mb-2 block text-sm font-medium text-gray-900 dark:text-white",children:e.label}),he("div",{class:"flex justify-between gap-1",children:l.map(function(e){return he(rh,{color:e,active:e===m,onSelect:y},e)})})]},"color");case"opacity":return he("section",{class:"mb-6",children:[he("label",{class:"mb-1 block text-sm font-medium text-gray-900 dark:text-white",children:e.label}),he(ih,{value:S,min:e.min,max:e.max,step:e.step,onChange:C}),he("span",{class:"text-xs text-gray-500",children:[Math.round(100*S),"%"]})]},"opacity");case"strokeWidth":return he("section",{class:"mb-6",children:[he("label",{class:"mb-1 block text-sm font-medium text-gray-900 dark:text-white",children:e.label}),he(ih,{value:E,min:e.min,max:e.max,step:e.step,onChange:k}),he("span",{class:"text-xs text-gray-500",children:[E,"px"]})]},"strokeWidth");case"blendMode":return he("section",{class:"mb-6",children:[he("label",{class:"mb-1 block text-sm font-medium text-gray-900 dark:text-white",children:e.label}),he("select",{name:"blendMode",class:"w-full rounded border border-gray-300 bg-white px-2 py-1 text-sm dark:border-gray-600 dark:bg-gray-800 dark:text-gray-100",value:R,onChange:function(e){return t=parseInt(e.target.value,10),_(i=t),void N({blendMode:i});var t,i},children:ht.map(function(e){return he("option",{value:e.value,children:e.label},e.value)})})]},"blendMode");default:return null}})]})},nh=(e=>(e.Automatic="automatic",e.FitPage="fit-page",e.FitWidth="fit-width",e))(nh||{}),sh="zoom",ah={id:sh,name:"Zoom Plugin",version:"1.0.0",provides:["zoom"],requires:["viewport","scroll"],optional:["interaction-manager"],defaultConfig:{enabled:!0,defaultZoomLevel:"automatic",minZoom:.2,maxZoom:60,zoomStep:.1,zoomRanges:[{min:.2,max:.5,step:.05},{min:.5,max:1,step:.1},{min:1,max:2,step:.2},{min:2,max:4,step:.4},{min:4,max:10,step:.8},{min:10,max:20,step:1.6},{min:20,max:40,step:3.2},{min:40,max:60,step:6.4}],presets:[{name:"Fit Page",value:"fit-page"},{name:"Fit Width",value:"fit-width"},{name:"Automatic",value:"automatic"},{name:"25%",value:.25},{name:"50%",value:.5},{name:"100%",value:1},{name:"125%",value:1.25},{name:"150%",value:1.5},{name:"200%",value:2},{name:"400%",value:4},{name:"800%",value:8},{name:"1600%",value:16}]}},lh="SET_ZOOM_LEVEL",ch="SET_INITIAL_ZOOM_LEVEL";var dh={zoomLevel:"automatic",currentZoomLevel:1};function uh(e){const{width:t,height:i}=e;return{width:i,height:t}}var hh=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${hh.join("")}]`,"g");var ph=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);ph.reduce((e,t)=>(e[t.id]=t,e),{}),ph.reduce((e,t)=>(e[t.css]=t.id,e),{}),ph.map(e=>({value:e.id,label:e.label}));var gh=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});Object.entries(gh).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var fh=class{constructor(e,t){if(this.id=e,this.registry=t,this.debouncedActions={},this.unsubscribeFromState=null,this.unsubscribeFromCoreStore=null,e!==this.constructor.id)throw new Error(`Plugin ID mismatch: ${e} !== ${this.constructor.id}`);this.coreStore=this.registry.getStore(),this.pluginStore=this.coreStore.getPluginStore(this.id),this.unsubscribeFromState=this.pluginStore.subscribeToState((e,t,i)=>{this.onStoreUpdated(i,t)}),this.unsubscribeFromCoreStore=this.coreStore.subscribe((e,t,i)=>{this.onCoreStoreUpdated(i,t)}),this.readyPromise=new Promise(e=>{this.readyResolve=e}),this.readyResolve()}provides(){if(!this._capability){const e=this.buildCapability();this._capability=Object.freeze(e)}return this._capability}get state(){return this.pluginStore.getState()}get coreState(){return this.coreStore.getState()}getState(){return this.pluginStore.getState()}getCoreState(){return this.coreStore.getState()}dispatchCoreAction(e){return this.coreStore.dispatchToCore(e)}dispatchToAllPlugins(e){return this.coreStore.dispatch(e)}dispatch(e){return this.pluginStore.dispatch(e)}debouncedDispatch(e,t=100){const i=Date.now();return i-(this.debouncedActions[e.type]||0)>=t&&(this.debouncedActions[e.type]=i,this.dispatch(e),!0)}subscribe(e){return this.pluginStore.subscribeToState(e)}subscribeToCoreStore(e){return this.coreStore.subscribe(e)}onStoreUpdated(e,t){}onCoreStoreUpdated(e,t){}destroy(){this.unsubscribeFromState&&(this.unsubscribeFromState(),this.unsubscribeFromState=null),this.unsubscribeFromCoreStore&&(this.unsubscribeFromCoreStore(),this.unsubscribeFromCoreStore=null)}ready(){return this.readyPromise}markReady(){this.readyResolve()}resetReady(){this.readyPromise=new Promise(e=>{this.readyResolve=e})}},mh=class{constructor(e,t){this.handler=e,this.options=t,this.lastRun=0,this.handle=e=>{"debounce"===this.options.mode?this.debounce(e):this.throttle(e)}}debounce(e){this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.timeoutId=void 0},this.options.wait)}throttle(e){if("debounce"===this.options.mode)return;const t=Date.now(),i=this.options.throttleMode||"leading-trailing";t-this.lastRun>=this.options.wait&&("leading-trailing"===i&&this.handler(e),this.lastRun=t),this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.lastRun=Date.now(),this.timeoutId=void 0},this.options.wait-(t-this.lastRun))}destroy(){this.timeoutId&&window.clearTimeout(this.timeoutId)}};function bh(e,t,i){return e<t?t:e>i?i:e}function vh(e,t,i){if(e===t)return!0;if(null==e||null==t)return e===t;const r=typeof e;if(r!==typeof t)return!1;if("object"===r){i||(i=new Set);const r=function(e,t){return`${Sh(e)}__${Sh(t)}`}(e,t);if(i.has(r))return!0;i.add(r);const o=Array.isArray(e),n=Array.isArray(t);return o&&n?function(e,t,i){if(e.length!==t.length)return!1;const r=new Array(t.length).fill(!1);e:for(let o=0;o<e.length;o++){const n=e[o];for(let e=0;e<t.length;e++)if(!r[e]&&vh(n,t[e],i)){r[e]=!0;continue e}return!1}return!0}(e,t,i):!o&&!n&&function(e,t,i){const r=Object.keys(e).sort(),o=Object.keys(t).sort();if(r.length!==o.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!==o[e])return!1;for(const o of r){if(!vh(e[o],t[o],i))return!1}return!0}(e,t,i)}return!1}var yh=0,wh=new WeakMap;function Sh(e){return wh.has(e)||wh.set(e,++yh),wh.get(e)}function Ch(e,t=vh){const i=new Set,r=new Map;let o=e;const n=(e,t)=>{let n=e,s=()=>{};if(t){const i=new mh(e,t);n=i.handle,s=()=>i.destroy(),r.set(e,{wrapped:n,destroy:s})}return void 0!==o&&n(o),i.add(n),()=>{i.delete(n),s(),r.delete(e)}};return{get value(){return o},emit(e=void 0){(void 0===o||!t(o,e))&&(o=e,(e=>{i.forEach(t=>t(e))})(e))},on:n,off(e){const t=r.get(e);t?(i.delete(t.wrapped),t.destroy(),r.delete(e)):i.delete(e)},clear(){i.clear(),r.forEach(e=>e.destroy()),r.clear()},select:(e,t=vh)=>(i,r)=>{let s;if(void 0!==o){const t=e(o);s=t,i(t)}return n(r=>{const o=e(r);(void 0===s||!t(s,o))&&(s=o,i(o))},r)}}}var xh=class extends fh{constructor(e,t,i){super(e,t),this.zoom$=function(){const e=new Set;return{emit:(t=void 0)=>e.forEach(e=>e(t)),on:t=>(e.add(t),()=>e.delete(t)),off:t=>e.delete(t),clear:()=>e.clear()}}(),this.state$=Ch(),this.viewportPlugin=t.getPlugin("viewport"),this.viewport=this.viewportPlugin.provides(),this.scroll=t.getPlugin("scroll").provides();const r=t.getPlugin("interaction-manager");var o;this.interactionManager=r?.provides()??null,this.minZoom=i.minZoom??.25,this.maxZoom=i.maxZoom??10,this.zoomStep=i.zoomStep??.1,this.presets=i.presets??[],this.zoomRanges=this.normalizeRanges(i.zoomRanges??[]),this.dispatch((o=i.defaultZoomLevel,{type:ch,payload:{zoomLevel:o}})),this.viewport.onViewportResize(()=>this.recalcAuto(1),{mode:"debounce",wait:150}),this.coreStore.onAction("SET_ROTATION",()=>this.recalcAuto(1)),this.coreStore.onAction("SET_PAGES",()=>this.recalcAuto(1)),this.coreStore.onAction("SET_DOCUMENT",()=>this.recalcAuto(1)),this.interactionManager?.registerMode({id:"marqueeZoom",scope:"page",exclusive:!0,cursor:"zoom-in"}),this.resetReady()}buildCapability(){return{onZoomChange:this.zoom$.on,onStateChange:this.state$.on,zoomIn:()=>{const e=this.state.currentZoomLevel;return this.handleRequest({level:e,delta:this.stepFor(e)})},zoomOut:()=>{const e=this.state.currentZoomLevel;return this.handleRequest({level:e,delta:-this.stepFor(e)})},zoomToArea:(e,t)=>this.handleZoomToArea(e,t),requestZoom:(e,t)=>this.handleRequest({level:e,center:t}),requestZoomBy:(e,t)=>{const i=this.state.currentZoomLevel,r=this.toZoom(i+e);return this.handleRequest({level:r,center:t})},enableMarqueeZoom:()=>{this.interactionManager?.activate("marqueeZoom")},disableMarqueeZoom:()=>{this.interactionManager?.activate("default")},toggleMarqueeZoom:()=>{"marqueeZoom"===this.interactionManager?.getActiveMode()?this.interactionManager?.activate("default"):this.interactionManager?.activate("marqueeZoom")},isMarqueeZoomActive:()=>"marqueeZoom"===this.interactionManager?.getActiveMode(),getState:()=>this.state,getPresets:()=>this.presets}}async initialize(){}async destroy(){this.zoom$.clear()}normalizeRanges(e){return[...e].filter(e=>e.step>0&&e.max>e.min).sort((e,t)=>e.min-t.min)}stepFor(e){const t=this.zoomRanges.find(t=>e>=t.min&&e<t.max);return t?t.step:this.zoomStep}toZoom(e){return parseFloat(bh(e,this.minZoom,this.maxZoom).toFixed(2))}handleRequest({level:e,delta:t=0,center:i,focus:r=0,align:o="keep"}){const n=this.viewport.getMetrics(),s=this.state.currentZoomLevel;if(0===n.clientWidth||0===n.clientHeight)return;const a="number"==typeof e?e:this.computeZoomForMode(e,n);if(!1===a)return;const l=bh(a+t,this.minZoom,this.maxZoom),c=Math.floor(100*l)/100,d=i??{vx:n.clientWidth/2,vy:1===r?0:n.clientHeight/2},{desiredScrollLeft:u,desiredScrollTop:h}=this.computeScrollForZoomChange(n,s,c,d,o);isNaN(u)||isNaN(h)||this.viewportPlugin.setViewportScrollMetrics({scrollLeft:u,scrollTop:h}),this.dispatch({type:lh,payload:{zoomLevel:"number"==typeof e?c:e,currentZoomLevel:c}}),this.dispatchCoreAction((e=>({type:"SET_SCALE",payload:e}))(c)),this.markReady(),this.viewport.scrollTo({x:u,y:h,behavior:"instant"});const p={oldZoom:s,newZoom:c,level:e,center:d,desiredScrollLeft:u,desiredScrollTop:h,viewport:n};this.zoom$.emit(p)}computeZoomForMode(e,t){const i=(e=>e.pages.map(t=>t.map(t=>{return{...t,rotatedSize:(i=t.size,r=e.rotation,o=1,{width:(i=r%2==0?i:uh(i)).width*o,height:i.height*o})};var i,r,o})))(this.coreState.core);if(!i.length)return!1;const r=this.scroll.getPageGap(),o=this.viewport.getViewportGap();if(0===t.clientWidth||0===t.clientHeight)return!1;const n=t.clientWidth-2*o,s=t.clientHeight-2*o;if(n<=0||s<=0)return!1;let a=0,l=0;switch(i.forEach(e=>{const t=e.reduce((e,t,i)=>e+t.rotatedSize.width+(i?r:0),0),i=Math.max(...e.map(e=>e.rotatedSize.height));a=Math.max(a,t),l=Math.max(l,i)}),e){case"fit-width":return n/a;case"fit-page":return Math.min(n/a,s/l);case"automatic":return Math.min(n/a,1);default:return 1}}computeScrollForZoomChange(e,t,i,r,o="keep"){const n=this.scroll.getLayout(),s=this.viewport.getViewportGap(),a=n.totalContentSize.width,l=n.totalContentSize.height,c=e.clientWidth-2*s,d=e.clientHeight-2*s,u=(e,t,i)=>t*i<e?(e-t*i)/2:0,h=u(c,a,t),p=u(d,l,t),g=u(c,a,i),f=u(d,l,i),m=(e.scrollLeft+r.vx-s-h)/t*i+s+g,b=(e.scrollTop+r.vy-s-p)/t*i+s+f,v="center"===o?m-e.clientWidth/2:m-r.vx,y="center"===o?b-e.clientHeight/2:b-r.vy;return{desiredScrollLeft:Math.max(0,v),desiredScrollTop:Math.max(0,y)}}handleZoomToArea(e,t){const i=this.coreState.core.rotation,r=this.viewport.getMetrics(),o=this.viewport.getViewportGap(),n=this.state.currentZoomLevel,s=r.clientWidth-2*o,a=r.clientHeight-2*o,l=this.scroll.getLayout(),c=l.virtualItems.find(t=>t.pageLayouts.some(t=>t.pageIndex===e));if(!c)return;const d=c.pageLayouts.find(t=>t.pageIndex===e),u=function(e,t,i){let r=t.origin.x,o=t.origin.y,n=t.size;switch(i){case 0:break;case 1:r=e.height-t.origin.y-t.size.height,o=t.origin.x,n=uh(t.size);break;case 2:r=e.width-t.origin.x-t.size.width,o=e.height-t.origin.y-t.size.height;break;case 3:r=t.origin.y,o=e.width-t.origin.x-t.size.width,n=uh(t.size)}return{origin:{x:r,y:o},size:{width:n.width,height:n.height}}}({width:d.width,height:d.height},t,i),h=this.toZoom(Math.min(s/u.size.width,a/u.size.height)),p=c.x+d.x,g=c.y+d.y,f=p+u.origin.x+u.size.width/2,m=g+u.origin.y+u.size.height/2,b=(e,t,i)=>t*i<e?(e-t*i)/2:0,v=b(s,l.totalContentSize.width,n),y=b(a,l.totalContentSize.height,n),w=o+v+f*n-r.scrollLeft,S=o+y+m*n-r.scrollTop;this.handleRequest({level:h,center:{vx:w,vy:S},align:"center"})}recalcAuto(e){const t=this.state;"automatic"!==t.zoomLevel&&"fit-page"!==t.zoomLevel&&"fit-width"!==t.zoomLevel||this.handleRequest({level:t.zoomLevel,focus:e})}onStoreUpdated(e,t){this.state$.emit(t)}};xh.id="zoom";var Ih={manifest:ah,create:(e,t,i)=>new xh(sh,e,i),reducer:(e=dh,t)=>{switch(t.type){case lh:return{...e,zoomLevel:t.payload.zoomLevel,currentZoomLevel:t.payload.currentZoomLevel};case ch:return{...e,zoomLevel:t.payload.zoomLevel};default:return e}},initialState:dh};const Ah=class extends qt{constructor(e,t,i){super(e,t),this.engine=i}async initialize(e){}buildCapability(){return{renderPage:this.renderPage.bind(this),renderPageRect:this.renderPageRect.bind(this)}}renderPage({pageIndex:e,scaleFactor:t=1,dpr:i=1,rotation:r=je.Degree0,options:o={withAnnotations:!1},imageType:n="image/webp"}){const s=this.coreState.core;if(!s.document)throw new Error("document does not open");const a=s.document.pages.find(t=>t.index===e);if(!a)throw new Error("page does not exist");return this.engine.renderPage(s.document,a,t,r,i,o,n)}renderPageRect({pageIndex:e,scaleFactor:t=1,dpr:i=1,rect:r,rotation:o=je.Degree0,options:n={withAnnotations:!1},imageType:s="image/webp"}){const a=this.coreState.core;if(!a.document)throw new Error("document does not open");const l=a.document.pages.find(t=>t.index===e);if(!l)throw new Error("page does not exist");return this.engine.renderPageRect(a.document,l,t,o,i,r,n,s)}};Ah.id="render";let Eh=Ah;const kh="render",Ph={manifest:{id:kh,name:"Render Plugin",version:"1.0.0",provides:["render"],requires:[],optional:[],defaultConfig:{enabled:!0}},create:(e,t)=>new Eh(kh,e,t),reducer:()=>{},initialState:{}};function Mh({pageIndex:e,scaleFactor:t=1,dpr:i=1,style:r,...o}){const{provides:n}=si(Eh.id),[s,a]=ke(null),l=Te(null);return Pe(()=>{if(n){const r=n.renderPage({pageIndex:e,scaleFactor:t,dpr:i});return r.wait(e=>{const t=URL.createObjectURL(e);a(t),l.current=t},Mt),()=>{l.current?(URL.revokeObjectURL(l.current),l.current=null):r.abort({code:xt.Cancelled,message:"canceled render task"})}}},[e,t,i,n]),he(B,{children:s&&he("img",{src:s,onLoad:()=>{l.current&&(URL.revokeObjectURL(l.current),l.current=null)},...o,style:{width:"100%",height:"100%",...r||{}}})})}const Th="rotate",Rh={id:Th,name:"Rotate Plugin",version:"1.0.0",provides:["rotate"],requires:["loader"],optional:["spread"],defaultConfig:{enabled:!0}};const _h=class extends qt{constructor(e,t,i){super(e,t),this.rotate$=ti(),this.resetReady();const r=i.defaultRotation??this.coreState.core.rotation;this.setRotation(r),this.markReady()}async initialize(e){}setRotation(e){if(!this.coreState.core.pages)throw new Error("Pages not loaded");this.dispatchCoreAction((e=>({type:$t,payload:e}))(e))}rotateForward(){const e=function(e){return(e+1)%4}(this.coreState.core.rotation);this.setRotation(e)}rotateBackward(){const e=function(e){return(e+3)%4}(this.coreState.core.rotation);this.setRotation(e)}buildCapability(){return{onRotateChange:this.rotate$.on,setRotation:e=>this.setRotation(e),getRotation:()=>this.coreState.core.rotation,rotateForward:()=>this.rotateForward(),rotateBackward:()=>this.rotateBackward(),getMatrix:({w:e=0,h:t=0,asString:i=!0}={})=>function(e,t,i,r=!0){let o=1,n=0,s=0,a=1,l=0,c=0;switch(e){case 1:o=0,n=1,s=-1,a=0,l=i;break;case 2:o=-1,n=0,s=0,a=-1,l=t,c=i;break;case 3:o=0,n=-1,s=1,a=0,c=t}return r?`matrix(${o},${n},${s},${a},${l},${c})`:[o,n,s,a,l,c]}(this.coreState.core.rotation,e,t,i)}}async destroy(){this.rotate$.clear(),super.destroy()}};_h.id="rotate";let Nh=_h;const Oh={manifest:Rh,create:(e,t,i)=>new Nh(Th,e,i),reducer:()=>{},initialState:{}};function zh({children:e,pageSize:t,...i}){const{provides:r}=si(Nh.id);return he("div",{...i,style:{position:"absolute",transformOrigin:"0 0",transform:(null==r?void 0:r.getMatrix({w:t.width,h:t.height}))||"matrix(1, 0, 0, 1, 0, 0)"},children:e})}var Lh=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${Lh.join("")}]`,"g");var Dh=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);Dh.reduce((e,t)=>(e[t.id]=t,e),{}),Dh.reduce((e,t)=>(e[t.css]=t.id,e),{}),Dh.map(e=>({value:e.id,label:e.label}));var Fh=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});Object.entries(Fh).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var Hh=class{constructor(e,t){if(this.id=e,this.registry=t,this.debouncedActions={},this.unsubscribeFromState=null,this.unsubscribeFromCoreStore=null,e!==this.constructor.id)throw new Error(`Plugin ID mismatch: ${e} !== ${this.constructor.id}`);this.coreStore=this.registry.getStore(),this.pluginStore=this.coreStore.getPluginStore(this.id),this.unsubscribeFromState=this.pluginStore.subscribeToState((e,t,i)=>{this.onStoreUpdated(i,t)}),this.unsubscribeFromCoreStore=this.coreStore.subscribe((e,t,i)=>{this.onCoreStoreUpdated(i,t)}),this.readyPromise=new Promise(e=>{this.readyResolve=e}),this.readyResolve()}provides(){if(!this._capability){const e=this.buildCapability();this._capability=Object.freeze(e)}return this._capability}get state(){return this.pluginStore.getState()}get coreState(){return this.coreStore.getState()}getState(){return this.pluginStore.getState()}getCoreState(){return this.coreStore.getState()}dispatchCoreAction(e){return this.coreStore.dispatchToCore(e)}dispatchToAllPlugins(e){return this.coreStore.dispatch(e)}dispatch(e){return this.pluginStore.dispatch(e)}debouncedDispatch(e,t=100){const i=Date.now();return i-(this.debouncedActions[e.type]||0)>=t&&(this.debouncedActions[e.type]=i,this.dispatch(e),!0)}subscribe(e){return this.pluginStore.subscribeToState(e)}subscribeToCoreStore(e){return this.coreStore.subscribe(e)}onStoreUpdated(e,t){}onCoreStoreUpdated(e,t){}destroy(){this.unsubscribeFromState&&(this.unsubscribeFromState(),this.unsubscribeFromState=null),this.unsubscribeFromCoreStore&&(this.unsubscribeFromCoreStore(),this.unsubscribeFromCoreStore=null)}ready(){return this.readyPromise}markReady(){this.readyResolve()}resetReady(){this.readyPromise=new Promise(e=>{this.readyResolve=e})}},$h=class{constructor(e,t){this.handler=e,this.options=t,this.lastRun=0,this.handle=e=>{"debounce"===this.options.mode?this.debounce(e):this.throttle(e)}}debounce(e){this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.timeoutId=void 0},this.options.wait)}throttle(e){if("debounce"===this.options.mode)return;const t=Date.now(),i=this.options.throttleMode||"leading-trailing";t-this.lastRun>=this.options.wait&&("leading-trailing"===i&&this.handler(e),this.lastRun=t),this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.lastRun=Date.now(),this.timeoutId=void 0},this.options.wait-(t-this.lastRun))}destroy(){this.timeoutId&&window.clearTimeout(this.timeoutId)}};function jh(e,t,i){if(e===t)return!0;if(null==e||null==t)return e===t;const r=typeof e;if(r!==typeof t)return!1;if("object"===r){i||(i=new Set);const r=function(e,t){return`${Gh(e)}__${Gh(t)}`}(e,t);if(i.has(r))return!0;i.add(r);const o=Array.isArray(e),n=Array.isArray(t);return o&&n?function(e,t,i){if(e.length!==t.length)return!1;const r=new Array(t.length).fill(!1);e:for(let o=0;o<e.length;o++){const n=e[o];for(let e=0;e<t.length;e++)if(!r[e]&&jh(n,t[e],i)){r[e]=!0;continue e}return!1}return!0}(e,t,i):!o&&!n&&function(e,t,i){const r=Object.keys(e).sort(),o=Object.keys(t).sort();if(r.length!==o.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!==o[e])return!1;for(const o of r){if(!jh(e[o],t[o],i))return!1}return!0}(e,t,i)}return!1}var Uh=0,Bh=new WeakMap;function Gh(e){return Bh.has(e)||Bh.set(e,++Uh),Bh.get(e)}function Vh(e,t=jh){const i=new Set,r=new Map;let o=e;const n=(e,t)=>{let n=e,s=()=>{};if(t){const i=new $h(e,t);n=i.handle,s=()=>i.destroy(),r.set(e,{wrapped:n,destroy:s})}return void 0!==o&&n(o),i.add(n),()=>{i.delete(n),s(),r.delete(e)}};return{get value(){return o},emit(e=void 0){(void 0===o||!t(o,e))&&(o=e,(e=>{i.forEach(t=>t(e))})(e))},on:n,off(e){const t=r.get(e);t?(i.delete(t.wrapped),t.destroy(),r.delete(e)):i.delete(e)},clear(){i.clear(),r.forEach(e=>e.destroy()),r.clear()},select:(e,t=jh)=>(i,r)=>{let s;if(void 0!==o){const t=e(o);s=t,i(t)}return n(r=>{const o=e(r);(void 0===s||!t(s,o))&&(s=o,i(o))},r)}}}var Wh="START_SEARCH_SESSION",Zh="STOP_SEARCH_SESSION",qh="SET_SEARCH_FLAGS",Xh="SET_SHOW_ALL_RESULTS",Kh="START_SEARCH",Yh="SET_SEARCH_RESULTS",Qh="SET_ACTIVE_RESULT_INDEX";function Jh(e){return{type:qh,payload:e}}function ep(e){return{type:Xh,payload:e}}function tp(e,t,i){return{type:Yh,payload:{results:e,total:t,activeResultIndex:i}}}var ip=class extends Hh{constructor(e,t,i){super(e,t),this.searchStop$=Vh(),this.searchStart$=Vh(),this.searchResult$=Vh(),this.searchActiveResultChange$=Vh(),this.searchResultState$=Vh(),this.searchState$=Vh(),this.engine=i,this.loader=this.registry.getPlugin("loader").provides(),this.loader.onDocumentLoaded(this.handleDocumentLoaded.bind(this)),this.loader.onLoaderEvent(this.handleLoaderEvent.bind(this))}handleDocumentLoaded(e){this.currentDocument=e,this.state.active&&this.startSearchSession()}handleLoaderEvent(e){("error"===e.type||"start"===e.type&&this.currentDocument)&&(this.state.active&&this.stopSearchSession(),this.currentDocument=void 0)}async initialize(e){this.dispatch(Jh(e.flags||[])),this.dispatch(ep(void 0===e.showAllResults||e.showAllResults))}onStoreUpdated(e,t){this.searchResultState$.emit({results:t.results,activeResultIndex:t.activeResultIndex,showAllResults:t.showAllResults,active:t.active}),this.searchState$.emit(t)}buildCapability(){return{startSearch:this.startSearchSession.bind(this),stopSearch:this.stopSearchSession.bind(this),searchAllPages:this.searchAllPages.bind(this),nextResult:this.nextResult.bind(this),previousResult:this.previousResult.bind(this),goToResult:this.goToResult.bind(this),setShowAllResults:e=>this.dispatch(ep(e)),getShowAllResults:()=>this.state.showAllResults,onSearchResult:this.searchResult$.on,onSearchStart:this.searchStart$.on,onSearchStop:this.searchStop$.on,onActiveResultChange:this.searchActiveResultChange$.on,onSearchResultStateChange:this.searchResultState$.on,onStateChange:this.searchState$.on,getFlags:()=>this.state.flags,setFlags:e=>this.setFlags(e),getState:()=>this.state}}setFlags(e){this.dispatch(Jh(e)),this.state.active&&this.searchAllPages(this.state.query,!0)}notifySearchStart(){this.searchStart$.emit()}notifySearchStop(){this.searchStop$.emit()}notifyActiveResultChange(e){this.searchActiveResultChange$.emit(e)}startSearchSession(){this.currentDocument&&(this.dispatch({type:Wh}),this.notifySearchStart())}stopSearchSession(){this.currentDocument&&this.getState().active&&(this.dispatch({type:Zh}),this.notifySearchStop())}async searchAllPages(e,t=!1){const i=e.trim();return this.state.query!==i||t?(this.dispatch({type:Kh,payload:i}),i&&this.currentDocument?(this.state.active||this.startSearchSession(),new Promise(e=>{this.engine.searchAllPages(this.currentDocument,i,this.state.flags).wait(t=>{const i=t.total>0?0:-1;this.dispatch(tp(t.results,t.total,i)),this.searchResult$.emit(t),t.total>0&&this.notifyActiveResultChange(0),e(t)},t=>{console.error("Error during search:",t),this.dispatch(tp([],0,-1)),e({results:[],total:0})})})):(this.dispatch(tp([],0,-1)),{results:[],total:0})):{results:this.state.results,total:this.state.total}}nextResult(){if(0===this.state.results.length)return-1;const e=this.state.activeResultIndex>=this.state.results.length-1?0:this.state.activeResultIndex+1;return this.goToResult(e)}previousResult(){if(0===this.state.results.length)return-1;const e=this.state.activeResultIndex<=0?this.state.results.length-1:this.state.activeResultIndex-1;return this.goToResult(e)}goToResult(e){return 0===this.state.results.length||e<0||e>=this.state.results.length?-1:(this.dispatch(function(e){return{type:Qh,payload:e}}(e)),this.notifyActiveResultChange(e),e)}async destroy(){this.state.active&&this.currentDocument&&this.stopSearchSession(),this.searchResult$.clear(),this.searchStart$.clear(),this.searchStop$.clear(),this.searchActiveResultChange$.clear(),this.searchResultState$.clear(),this.searchState$.clear()}};ip.id="search";var rp="search",op={flags:[],results:[],total:0,activeResultIndex:-1,showAllResults:!0,query:"",loading:!1,active:!1},np={manifest:{id:rp,name:"Search Plugin",version:"1.0.0",provides:["search"],requires:["loader"],optional:[],defaultConfig:{enabled:!0,flags:[]}},create:(e,t)=>new ip(rp,e,t),reducer:(e=op,t)=>{switch(t.type){case Wh:return{...e,active:!0};case Zh:return{...e,results:[],total:0,activeResultIndex:-1,query:"",loading:!1,active:!1};case qh:return{...e,flags:t.payload};case Xh:return{...e,showAllResults:t.payload};case Kh:return{...e,loading:!0,query:t.payload};case Yh:return{...e,results:t.payload.results,total:t.payload.total,activeResultIndex:t.payload.activeResultIndex,loading:!1};case Qh:return{...e,activeResultIndex:t.payload};default:return e}},initialState:op};const sp="tiling",ap={id:sp,name:"Tiling Plugin",version:"1.0.0",provides:["tiling"],requires:["render","scroll","viewport"],optional:[],defaultConfig:{enabled:!0,tileSize:768,overlapPx:2.5,extraRings:0}},lp="UPDATE_VISIBLE_TILES",cp="MARK_TILE_STATUS",dp=e=>({type:lp,payload:e}),up=(e,t,i)=>({type:cp,payload:{pageIndex:e,tileId:t,status:i}});function hp({tileSize:e=768,overlapPx:t=2.5,extraRings:i=0,scale:r,rotation:o,page:n,metric:s}){const a=n.size.width*r,l=n.size.height*r,c=e-t,d=We(n.size,o,r),u={origin:{x:s.scaled.pageX,y:s.scaled.pageY},size:{width:s.scaled.visibleWidth,height:s.scaled.visibleHeight}},h=(I=1,Qe(Ye(d,u,(4-o)%4),1/I)),p=h.origin.x,g=h.origin.y,f=p+h.size.width,m=g+h.size.height,b=Math.floor((a-1)/c),v=Math.floor((l-1)/c),y=Math.max(0,Math.floor(p/c)-i),w=Math.min(b,Math.floor((f-1)/c)+i),S=Math.max(0,Math.floor(g/c)-i),C=Math.min(v,Math.floor((m-1)/c)+i),x=[];var I;for(let t=y;t<=w;t++){const i=t*c,o=Math.min(e,a-i),s=i/r,d=o/r;for(let a=S;a<=C;a++){const u=a*c,h=Math.min(e,l-u),p=u/r,g=h/r;x.push({id:`p${n.index}-${r}-x${i}-y${u}-w${o}-h${h}`,col:t,row:a,pageRect:{origin:{x:s,y:p},size:{width:d,height:g}},screenRect:{origin:{x:i,y:u},size:{width:o,height:h}},status:"queued",srcScale:r,isFallback:!1})}}return x}const pp=class extends qt{constructor(e,t,i){super(e,t),this.tileRendering$=ti(),this.config=i,this.renderCapability=this.registry.getPlugin("render").provides(),this.scrollCapability=this.registry.getPlugin("scroll").provides(),this.viewportCapability=this.registry.getPlugin("viewport").provides(),this.scrollCapability.onScroll(e=>this.calculateVisibleTiles(e),{mode:"throttle",wait:500,throttleMode:"trailing"})}async initialize(){}onCoreStoreUpdated(e,t){e.core.scale!==t.core.scale&&this.calculateVisibleTiles(this.scrollCapability.getMetrics(this.viewportCapability.getMetrics()))}calculateVisibleTiles(e){var t;if(!this.config.enabled)return void this.dispatch(dp([]));const i=this.coreState.core.scale,r=this.coreState.core.rotation,o={};for(const n of e.pageVisibilityMetrics){const e=n.pageNumber-1,s=null==(t=this.coreState.core.document)?void 0:t.pages[e];if(!s)continue;const a=hp({page:s,metric:n,scale:i,rotation:r,tileSize:this.config.tileSize,overlapPx:this.config.overlapPx,extraRings:this.config.extraRings});o[e]=a}this.dispatch(dp(o))}onStoreUpdated(e,t){this.tileRendering$.emit(t.visibleTiles)}buildCapability(){return{renderTile:this.renderTile.bind(this),onTileRendering:this.tileRendering$.on}}renderTile(e){if(!this.renderCapability)throw new Error("Render capability not available.");this.dispatch(up(e.pageIndex,e.tile.id,"rendering"));const t=this.renderCapability.renderPageRect({pageIndex:e.pageIndex,rect:e.tile.pageRect,scaleFactor:e.tile.srcScale,dpr:e.dpr});return t.wait(()=>{this.dispatch(up(e.pageIndex,e.tile.id,"ready"))},Mt),t}};pp.id="tiling";let gp=pp;const fp={manifest:ap,create:(e,t,i)=>new gp(sp,e,i),reducer:(e,t)=>((e,t)=>{var i,r;switch(t.type){case lp:{const r=t.payload,o={...e.visibleTiles};for(const e in r){const t=Number(e),n=r[t],s=o[t]??[],a=null==(i=s.find(e=>!e.isFallback))?void 0:i.srcScale,l=n[0].srcScale;if(void 0!==a&&a!==l){const e=s.filter(e=>!e.isFallback&&"ready"===e.status).map(e=>({...e,isFallback:!0})),i=e.length>0?[]:s.filter(e=>e.isFallback);o[t]=[...i,...e,...n]}else{const e=new Set(n.map(e=>e.id)),i=[],r=new Set;for(const t of s)(t.isFallback||e.has(t.id))&&(i.push(t),r.add(t.id));for(const e of n)r.has(e.id)||i.push(e);o[t]=i}}return{...e,visibleTiles:o}}case cp:{const{pageIndex:i,tileId:o,status:n}=t.payload,s=(null==(r=e.visibleTiles[i])?void 0:r.map(e=>e.id===o?{...e,status:n}:e))??[],a=s.filter(e=>!e.isFallback),l=a.every(e=>"ready"===e.status)?a:s;return{...e,visibleTiles:{...e.visibleTiles,[i]:l}}}default:return e}})(e,t),initialState:{visibleTiles:{}}},mp=()=>si(gp.id);function bp({pageIndex:e,tile:t,dpr:i,scale:r}){const{provides:o}=mp(),[n,s]=ke(),a=Te(null),l=r/t.srcScale;Pe(()=>{if("ready"===t.status&&a.current||!o)return;const r=o.renderTile({pageIndex:e,tile:t,dpr:i});return r.wait(e=>{const t=URL.createObjectURL(e);a.current=t,s(t)},Mt),()=>{a.current?(URL.revokeObjectURL(a.current),a.current=null):r.abort({code:xt.Cancelled,message:"canceled render task"})}},[e,t.id]);return n?he("img",{src:n,onLoad:()=>{a.current&&(URL.revokeObjectURL(a.current),a.current=null)},style:{position:"absolute",left:t.screenRect.origin.x*l,top:t.screenRect.origin.y*l,width:t.screenRect.size.width*l,height:t.screenRect.size.height*l,display:"block"}}):null}function vp({pageIndex:e,scale:t,style:i,...r}){const{provides:o}=mp(),[n,s]=ke([]);return Pe(()=>{if(o)return o.onTileRendering(t=>s(t[e]))},[o]),he("div",{style:{...i},...r,children:null==n?void 0:n.map(i=>he(bp,{pageIndex:e,tile:i,dpr:window.devicePixelRatio,scale:t},i.id))})}var yp="thumbnail",wp={id:yp,name:"Thumbnail Plugin",version:"1.0.0",provides:["thumbnail"],requires:["render"],optional:[],defaultConfig:{enabled:!0,width:150,gap:10,buffer:3,labelHeight:16}},Sp=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${Sp.join("")}]`,"g");var Cp=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);Cp.reduce((e,t)=>(e[t.id]=t,e),{}),Cp.reduce((e,t)=>(e[t.css]=t.id,e),{}),Cp.map(e=>({value:e.id,label:e.label}));var xp=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});function Ip(){}Object.entries(xp).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var Ap=class{constructor(e,t){if(this.id=e,this.registry=t,this.debouncedActions={},this.unsubscribeFromState=null,this.unsubscribeFromCoreStore=null,e!==this.constructor.id)throw new Error(`Plugin ID mismatch: ${e} !== ${this.constructor.id}`);this.coreStore=this.registry.getStore(),this.pluginStore=this.coreStore.getPluginStore(this.id),this.unsubscribeFromState=this.pluginStore.subscribeToState((e,t,i)=>{this.onStoreUpdated(i,t)}),this.unsubscribeFromCoreStore=this.coreStore.subscribe((e,t,i)=>{this.onCoreStoreUpdated(i,t)}),this.readyPromise=new Promise(e=>{this.readyResolve=e}),this.readyResolve()}provides(){if(!this._capability){const e=this.buildCapability();this._capability=Object.freeze(e)}return this._capability}get state(){return this.pluginStore.getState()}get coreState(){return this.coreStore.getState()}getState(){return this.pluginStore.getState()}getCoreState(){return this.coreStore.getState()}dispatchCoreAction(e){return this.coreStore.dispatchToCore(e)}dispatchToAllPlugins(e){return this.coreStore.dispatch(e)}dispatch(e){return this.pluginStore.dispatch(e)}debouncedDispatch(e,t=100){const i=Date.now();return i-(this.debouncedActions[e.type]||0)>=t&&(this.debouncedActions[e.type]=i,this.dispatch(e),!0)}subscribe(e){return this.pluginStore.subscribeToState(e)}subscribeToCoreStore(e){return this.coreStore.subscribe(e)}onStoreUpdated(e,t){}onCoreStoreUpdated(e,t){}destroy(){this.unsubscribeFromState&&(this.unsubscribeFromState(),this.unsubscribeFromState=null),this.unsubscribeFromCoreStore&&(this.unsubscribeFromCoreStore(),this.unsubscribeFromCoreStore=null)}ready(){return this.readyPromise}markReady(){this.readyResolve()}resetReady(){this.readyPromise=new Promise(e=>{this.readyResolve=e})}},Ep=class{constructor(e,t){this.handler=e,this.options=t,this.lastRun=0,this.handle=e=>{"debounce"===this.options.mode?this.debounce(e):this.throttle(e)}}debounce(e){this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.timeoutId=void 0},this.options.wait)}throttle(e){if("debounce"===this.options.mode)return;const t=Date.now(),i=this.options.throttleMode||"leading-trailing";t-this.lastRun>=this.options.wait&&("leading-trailing"===i&&this.handler(e),this.lastRun=t),this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.lastRun=Date.now(),this.timeoutId=void 0},this.options.wait-(t-this.lastRun))}destroy(){this.timeoutId&&window.clearTimeout(this.timeoutId)}};function kp(e,t,i){if(e===t)return!0;if(null==e||null==t)return e===t;const r=typeof e;if(r!==typeof t)return!1;if("object"===r){i||(i=new Set);const r=function(e,t){return`${Tp(e)}__${Tp(t)}`}(e,t);if(i.has(r))return!0;i.add(r);const o=Array.isArray(e),n=Array.isArray(t);return o&&n?function(e,t,i){if(e.length!==t.length)return!1;const r=new Array(t.length).fill(!1);e:for(let o=0;o<e.length;o++){const n=e[o];for(let e=0;e<t.length;e++)if(!r[e]&&kp(n,t[e],i)){r[e]=!0;continue e}return!1}return!0}(e,t,i):!o&&!n&&function(e,t,i){const r=Object.keys(e).sort(),o=Object.keys(t).sort();if(r.length!==o.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!==o[e])return!1;for(const o of r){if(!kp(e[o],t[o],i))return!1}return!0}(e,t,i)}return!1}var Pp=0,Mp=new WeakMap;function Tp(e){return Mp.has(e)||Mp.set(e,++Pp),Mp.get(e)}function Rp(e,t=kp){const i=new Set,r=new Map;let o=e;const n=(e,t)=>{let n=e,s=()=>{};if(t){const i=new Ep(e,t);n=i.handle,s=()=>i.destroy(),r.set(e,{wrapped:n,destroy:s})}return void 0!==o&&n(o),i.add(n),()=>{i.delete(n),s(),r.delete(e)}};return{get value(){return o},emit(e=void 0){(void 0===o||!t(o,e))&&(o=e,(e=>{i.forEach(t=>t(e))})(e))},on:n,off(e){const t=r.get(e);t?(i.delete(t.wrapped),t.destroy(),r.delete(e)):i.delete(e)},clear(){i.clear(),r.forEach(e=>e.destroy()),r.clear()},select:(e,t=kp)=>(i,r)=>{let s;if(void 0!==o){const t=e(o);s=t,i(t)}return n(r=>{const o=e(r);(void 0===s||!t(s,o))&&(s=o,i(o))},r)}}}var _p=class extends Ap{constructor(e,t,i){super(e,t),this.cfg=i,this.thumbs=[],this.window=null,this.emitWindow=Rp(),this.taskCache=new Map,this.renderCapability=this.registry.getPlugin("render").provides(),this.coreStore.onAction("SET_DOCUMENT",(e,t)=>{this.taskCache.clear(),this.setWindowState(t)})}async initialize(){}setWindowState(e){const t=e.core;if(!t.document)return;const i=this.cfg.width??120,r=this.cfg.labelHeight??16,o=this.cfg.gap??8;let n=0;this.thumbs=t.document.pages.map(e=>{const t=e.size.height/e.size.width,s=Math.round(i*t),a=s+r,l={pageIndex:e.index,width:i,height:s,wrapperHeight:a,top:n,labelHeight:r};return n+=a+o,l}),this.window={start:-1,end:-1,items:[],totalHeight:n-o},this.emitWindow.emit(this.window)}buildCapability(){return{onWindow:this.emitWindow.on,setViewport:(e,t)=>this.updateWindow(e,t),renderThumb:(e,t)=>this.renderThumb(e,t)}}updateWindow(e,t){const i=this.cfg.buffer??3;let r=0,o=this.thumbs.length-1,n=0;for(;r<=o;){const t=r+o>>1,i=this.thumbs[t];i.top+i.wrapperHeight<e?r=t+1:(n=t,o=t-1)}let s=n;const a=e+t;for(;s+1<this.thumbs.length&&this.thumbs[s].top<a;)s++;s=Math.min(this.thumbs.length-1,s+i);const l=Math.max(0,n-i);this.window&&l===this.window.start&&s===this.window.end||(this.window={start:l,end:s,items:this.thumbs.slice(l,s+1),totalHeight:this.window.totalHeight},this.emitWindow.emit(this.window))}renderThumb(e,t){if(this.taskCache.has(e))return this.taskCache.get(e);const i=this.coreState.core.document.pages[e],r=(this.cfg.width??120)/i.size.width,o=this.renderCapability.renderPageRect({pageIndex:e,rect:{origin:{x:0,y:0},size:i.size},scaleFactor:r,dpr:t});return this.taskCache.set(e,o),o.wait(Ip,()=>{this.taskCache.delete(e)}),o}};_p.id="thumbnail";var Np={manifest:wp,create:(e,t,i)=>new _p(yp,e,i),reducer:()=>{},initialState:{}};function Op(e){var t=e.size,i=void 0===t?"md":t,r=e.className,o=void 0===r?"":r,n=e.text,s=void 0===n?"Loading...":n,a={sm:"w-4 h-4",md:"w-8 h-8",lg:"w-12 h-12"};return j("div",{className:"flex flex-col items-center justify-center gap-3 ".concat(o)},j("div",{className:"relative"},j("div",{className:"".concat(a[i]," animate-spin rounded-full border-4 border-gray-200")}),j("div",{className:"".concat(a[i]," absolute left-0 top-0 animate-spin rounded-full border-4 border-transparent border-r-blue-500 border-t-blue-500")})),s&&j("p",{className:"".concat({sm:"text-sm",md:"text-base",lg:"text-lg"}[i]," animate-pulse font-medium text-gray-600")},s))}var zp="fullscreen",Lp={id:zp,name:"Fullscreen Plugin",version:"1.0.0",provides:["fullscreen"],requires:[],optional:[],defaultConfig:{enabled:!0}},Dp=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${Dp.join("")}]`,"g");var Fp=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);Fp.reduce((e,t)=>(e[t.id]=t,e),{}),Fp.reduce((e,t)=>(e[t.css]=t.id,e),{}),Fp.map(e=>({value:e.id,label:e.label}));var Hp=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});Object.entries(Hp).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var $p=class{constructor(e,t){if(this.id=e,this.registry=t,this.debouncedActions={},this.unsubscribeFromState=null,this.unsubscribeFromCoreStore=null,e!==this.constructor.id)throw new Error(`Plugin ID mismatch: ${e} !== ${this.constructor.id}`);this.coreStore=this.registry.getStore(),this.pluginStore=this.coreStore.getPluginStore(this.id),this.unsubscribeFromState=this.pluginStore.subscribeToState((e,t,i)=>{this.onStoreUpdated(i,t)}),this.unsubscribeFromCoreStore=this.coreStore.subscribe((e,t,i)=>{this.onCoreStoreUpdated(i,t)}),this.readyPromise=new Promise(e=>{this.readyResolve=e}),this.readyResolve()}provides(){if(!this._capability){const e=this.buildCapability();this._capability=Object.freeze(e)}return this._capability}get state(){return this.pluginStore.getState()}get coreState(){return this.coreStore.getState()}getState(){return this.pluginStore.getState()}getCoreState(){return this.coreStore.getState()}dispatchCoreAction(e){return this.coreStore.dispatchToCore(e)}dispatchToAllPlugins(e){return this.coreStore.dispatch(e)}dispatch(e){return this.pluginStore.dispatch(e)}debouncedDispatch(e,t=100){const i=Date.now();return i-(this.debouncedActions[e.type]||0)>=t&&(this.debouncedActions[e.type]=i,this.dispatch(e),!0)}subscribe(e){return this.pluginStore.subscribeToState(e)}subscribeToCoreStore(e){return this.coreStore.subscribe(e)}onStoreUpdated(e,t){}onCoreStoreUpdated(e,t){}destroy(){this.unsubscribeFromState&&(this.unsubscribeFromState(),this.unsubscribeFromState=null),this.unsubscribeFromCoreStore&&(this.unsubscribeFromCoreStore(),this.unsubscribeFromCoreStore=null)}ready(){return this.readyPromise}markReady(){this.readyResolve()}resetReady(){this.readyPromise=new Promise(e=>{this.readyResolve=e})}},jp=class{constructor(e,t){this.handler=e,this.options=t,this.lastRun=0,this.handle=e=>{"debounce"===this.options.mode?this.debounce(e):this.throttle(e)}}debounce(e){this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.timeoutId=void 0},this.options.wait)}throttle(e){if("debounce"===this.options.mode)return;const t=Date.now(),i=this.options.throttleMode||"leading-trailing";t-this.lastRun>=this.options.wait&&("leading-trailing"===i&&this.handler(e),this.lastRun=t),this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.lastRun=Date.now(),this.timeoutId=void 0},this.options.wait-(t-this.lastRun))}destroy(){this.timeoutId&&window.clearTimeout(this.timeoutId)}};function Up(e,t,i){if(e===t)return!0;if(null==e||null==t)return e===t;const r=typeof e;if(r!==typeof t)return!1;if("object"===r){i||(i=new Set);const r=function(e,t){return`${Vp(e)}__${Vp(t)}`}(e,t);if(i.has(r))return!0;i.add(r);const o=Array.isArray(e),n=Array.isArray(t);return o&&n?function(e,t,i){if(e.length!==t.length)return!1;const r=new Array(t.length).fill(!1);e:for(let o=0;o<e.length;o++){const n=e[o];for(let e=0;e<t.length;e++)if(!r[e]&&Up(n,t[e],i)){r[e]=!0;continue e}return!1}return!0}(e,t,i):!o&&!n&&function(e,t,i){const r=Object.keys(e).sort(),o=Object.keys(t).sort();if(r.length!==o.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!==o[e])return!1;for(const o of r){if(!Up(e[o],t[o],i))return!1}return!0}(e,t,i)}return!1}var Bp=0,Gp=new WeakMap;function Vp(e){return Gp.has(e)||Gp.set(e,++Bp),Gp.get(e)}function Wp(e,t=Up){const i=new Set,r=new Map;let o=e;const n=(e,t)=>{let n=e,s=()=>{};if(t){const i=new jp(e,t);n=i.handle,s=()=>i.destroy(),r.set(e,{wrapped:n,destroy:s})}return void 0!==o&&n(o),i.add(n),()=>{i.delete(n),s(),r.delete(e)}};return{get value(){return o},emit(e=void 0){(void 0===o||!t(o,e))&&(o=e,(e=>{i.forEach(t=>t(e))})(e))},on:n,off(e){const t=r.get(e);t?(i.delete(t.wrapped),t.destroy(),r.delete(e)):i.delete(e)},clear(){i.clear(),r.forEach(e=>e.destroy()),r.clear()},select:(e,t=Up)=>(i,r)=>{let s;if(void 0!==o){const t=e(o);s=t,i(t)}return n(r=>{const o=e(r);(void 0===s||!t(s,o))&&(s=o,i(o))},r)}}}var Zp="SET_FULLSCREEN";var qp=class extends $p{constructor(e,t){super(e,t),this.onStateChange$=Wp(),this.fullscreenRequest$=function(){const e=new Set;return{emit:(t=void 0)=>e.forEach(e=>e(t)),on:t=>(e.add(t),()=>e.delete(t)),off:t=>e.delete(t),clear:()=>e.clear()}}()}async initialize(e){}buildCapability(){return{isFullscreen:()=>this.state.isFullscreen,enableFullscreen:()=>this.enableFullscreen(),exitFullscreen:()=>this.exitFullscreen(),toggleFullscreen:()=>this.toggleFullscreen(),onRequest:this.fullscreenRequest$.on,onStateChange:this.onStateChange$.on}}toggleFullscreen(){this.state.isFullscreen?this.exitFullscreen():this.enableFullscreen()}enableFullscreen(){this.fullscreenRequest$.emit("enter")}exitFullscreen(){this.fullscreenRequest$.emit("exit")}onStoreUpdated(e,t){this.onStateChange$.emit(t)}setFullscreenState(e){this.dispatch({type:Zp,payload:e})}async destroy(){this.fullscreenRequest$.clear(),super.destroy()}};qp.id="fullscreen";var Xp={manifest:Lp,create:e=>new qp(zp,e),reducer:(e,t)=>t.type===Zp?{...e,isFullscreen:t.payload}:e,initialState:{isFullscreen:!1}},Kp=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${Kp.join("")}]`,"g");var Yp=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);Yp.reduce((e,t)=>(e[t.id]=t,e),{}),Yp.reduce((e,t)=>(e[t.css]=t.id,e),{}),Yp.map(e=>({value:e.id,label:e.label}));var Qp=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});Object.entries(Qp).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var Jp=ce({registry:null,isInitializing:!0,pluginsReady:!1});function eg(e){const{registry:t}=function(){const e=Ne(Jp);if(void 0===e)throw new Error("useCapability must be used within a PDFContext.Provider");const{registry:t,isInitializing:i}=e;if(i)return e;if(null===t)throw new Error("PDF registry failed to initialize properly");return e}();if(null===t)return{plugin:null,isLoading:!0,ready:new Promise(()=>{})};const i=t.getPlugin(e);if(!i)throw new Error(`Plugin ${e} not found`);return{plugin:i,isLoading:!1,ready:i.ready()}}var tg=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${tg.join("")}]`,"g");var ig=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);ig.reduce((e,t)=>(e[t.id]=t,e),{}),ig.reduce((e,t)=>(e[t.css]=t.id,e),{}),ig.map(e=>({value:e.id,label:e.label}));var rg=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});Object.entries(rg).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var og=class{constructor(e,t){if(this.id=e,this.registry=t,this.debouncedActions={},this.unsubscribeFromState=null,this.unsubscribeFromCoreStore=null,e!==this.constructor.id)throw new Error(`Plugin ID mismatch: ${e} !== ${this.constructor.id}`);this.coreStore=this.registry.getStore(),this.pluginStore=this.coreStore.getPluginStore(this.id),this.unsubscribeFromState=this.pluginStore.subscribeToState((e,t,i)=>{this.onStoreUpdated(i,t)}),this.unsubscribeFromCoreStore=this.coreStore.subscribe((e,t,i)=>{this.onCoreStoreUpdated(i,t)}),this.readyPromise=new Promise(e=>{this.readyResolve=e}),this.readyResolve()}provides(){if(!this._capability){const e=this.buildCapability();this._capability=Object.freeze(e)}return this._capability}get state(){return this.pluginStore.getState()}get coreState(){return this.coreStore.getState()}getState(){return this.pluginStore.getState()}getCoreState(){return this.coreStore.getState()}dispatchCoreAction(e){return this.coreStore.dispatchToCore(e)}dispatchToAllPlugins(e){return this.coreStore.dispatch(e)}dispatch(e){return this.pluginStore.dispatch(e)}debouncedDispatch(e,t=100){const i=Date.now();return i-(this.debouncedActions[e.type]||0)>=t&&(this.debouncedActions[e.type]=i,this.dispatch(e),!0)}subscribe(e){return this.pluginStore.subscribeToState(e)}subscribeToCoreStore(e){return this.coreStore.subscribe(e)}onStoreUpdated(e,t){}onCoreStoreUpdated(e,t){}destroy(){this.unsubscribeFromState&&(this.unsubscribeFromState(),this.unsubscribeFromState=null),this.unsubscribeFromCoreStore&&(this.unsubscribeFromCoreStore(),this.unsubscribeFromCoreStore=null)}ready(){return this.readyPromise}markReady(){this.readyResolve()}resetReady(){this.readyPromise=new Promise(e=>{this.readyResolve=e})}},ng=class{constructor(e,t){this.handler=e,this.options=t,this.lastRun=0,this.handle=e=>{"debounce"===this.options.mode?this.debounce(e):this.throttle(e)}}debounce(e){this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.timeoutId=void 0},this.options.wait)}throttle(e){if("debounce"===this.options.mode)return;const t=Date.now(),i=this.options.throttleMode||"leading-trailing";t-this.lastRun>=this.options.wait&&("leading-trailing"===i&&this.handler(e),this.lastRun=t),this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.lastRun=Date.now(),this.timeoutId=void 0},this.options.wait-(t-this.lastRun))}destroy(){this.timeoutId&&window.clearTimeout(this.timeoutId)}};function sg(e,t,i){if(e===t)return!0;if(null==e||null==t)return e===t;const r=typeof e;if(r!==typeof t)return!1;if("object"===r){i||(i=new Set);const r=function(e,t){return`${cg(e)}__${cg(t)}`}(e,t);if(i.has(r))return!0;i.add(r);const o=Array.isArray(e),n=Array.isArray(t);return o&&n?function(e,t,i){if(e.length!==t.length)return!1;const r=new Array(t.length).fill(!1);e:for(let o=0;o<e.length;o++){const n=e[o];for(let e=0;e<t.length;e++)if(!r[e]&&sg(n,t[e],i)){r[e]=!0;continue e}return!1}return!0}(e,t,i):!o&&!n&&function(e,t,i){const r=Object.keys(e).sort(),o=Object.keys(t).sort();if(r.length!==o.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!==o[e])return!1;for(const o of r){if(!sg(e[o],t[o],i))return!1}return!0}(e,t,i)}return!1}var ag=0,lg=new WeakMap;function cg(e){return lg.has(e)||lg.set(e,++ag),lg.get(e)}function dg(e,t=sg){const i=new Set,r=new Map;let o=e;const n=(e,t)=>{let n=e,s=()=>{};if(t){const i=new ng(e,t);n=i.handle,s=()=>i.destroy(),r.set(e,{wrapped:n,destroy:s})}return void 0!==o&&n(o),i.add(n),()=>{i.delete(n),s(),r.delete(e)}};return{get value(){return o},emit(e=void 0){(void 0===o||!t(o,e))&&(o=e,(e=>{i.forEach(t=>t(e))})(e))},on:n,off(e){const t=r.get(e);t?(i.delete(t.wrapped),t.destroy(),r.delete(e)):i.delete(e)},clear(){i.clear(),r.forEach(e=>e.destroy()),r.clear()},select:(e,t=sg)=>(i,r)=>{let s;if(void 0!==o){const t=e(o);s=t,i(t)}return n(r=>{const o=e(r);(void 0===s||!t(s,o))&&(s=o,i(o))},r)}}}var ug=class extends og{constructor(e,t){super(e,t),this.onStateChange$=dg(),this.fullscreenRequest$=function(){const e=new Set;return{emit:(t=void 0)=>e.forEach(e=>e(t)),on:t=>(e.add(t),()=>e.delete(t)),off:t=>e.delete(t),clear:()=>e.clear()}}()}async initialize(e){}buildCapability(){return{isFullscreen:()=>this.state.isFullscreen,enableFullscreen:()=>this.enableFullscreen(),exitFullscreen:()=>this.exitFullscreen(),toggleFullscreen:()=>this.toggleFullscreen(),onRequest:this.fullscreenRequest$.on,onStateChange:this.onStateChange$.on}}toggleFullscreen(){this.state.isFullscreen?this.exitFullscreen():this.enableFullscreen()}enableFullscreen(){this.fullscreenRequest$.emit("enter")}exitFullscreen(){this.fullscreenRequest$.emit("exit")}onStoreUpdated(e,t){this.onStateChange$.emit(t)}setFullscreenState(e){this.dispatch({type:"SET_FULLSCREEN",payload:e})}async destroy(){this.fullscreenRequest$.clear(),super.destroy()}};ug.id="fullscreen";var hg=()=>function(e){const{plugin:t,isLoading:i,ready:r}=eg(e);if(!t)return{provides:null,isLoading:i,ready:r};if(!t.provides)throw new Error(`Plugin ${e} does not provide a capability`);return{provides:t.provides(),isLoading:i,ready:r}}(ug.id);function pg({children:e,...t}){const{provides:i}=hg(),{plugin:r}=eg(ug.id),o=Te(null);return Pe(()=>{if(!i)return;return i.onRequest(async e=>{if("enter"===e){const e=o.current;e&&!document.fullscreenElement&&await e.requestFullscreen()}else document.fullscreenElement&&await document.exitFullscreen()})},[i]),Pe(()=>{if(!r)return;const e=()=>r.setFullscreenState(!!document.fullscreenElement);return document.addEventListener("fullscreenchange",e),()=>document.removeEventListener("fullscreenchange",e)},[r]),he("div",{...t,style:{position:"relative",width:"100%",height:"100%",...t.style},ref:o,children:e})}var gg="bookmark",fg={id:gg,name:"Bookmark Plugin",version:"1.0.0",provides:["bookmark"],requires:[],optional:[],defaultConfig:{enabled:!0}},mg=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${mg.join("")}]`,"g");var bg=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);bg.reduce((e,t)=>(e[t.id]=t,e),{}),bg.reduce((e,t)=>(e[t.css]=t.id,e),{}),bg.map(e=>({value:e.id,label:e.label}));var vg=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});Object.entries(vg).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var yg=class{constructor(e,t){if(this.id=e,this.registry=t,this.debouncedActions={},this.unsubscribeFromState=null,this.unsubscribeFromCoreStore=null,e!==this.constructor.id)throw new Error(`Plugin ID mismatch: ${e} !== ${this.constructor.id}`);this.coreStore=this.registry.getStore(),this.pluginStore=this.coreStore.getPluginStore(this.id),this.unsubscribeFromState=this.pluginStore.subscribeToState((e,t,i)=>{this.onStoreUpdated(i,t)}),this.unsubscribeFromCoreStore=this.coreStore.subscribe((e,t,i)=>{this.onCoreStoreUpdated(i,t)}),this.readyPromise=new Promise(e=>{this.readyResolve=e}),this.readyResolve()}provides(){if(!this._capability){const e=this.buildCapability();this._capability=Object.freeze(e)}return this._capability}get state(){return this.pluginStore.getState()}get coreState(){return this.coreStore.getState()}getState(){return this.pluginStore.getState()}getCoreState(){return this.coreStore.getState()}dispatchCoreAction(e){return this.coreStore.dispatchToCore(e)}dispatchToAllPlugins(e){return this.coreStore.dispatch(e)}dispatch(e){return this.pluginStore.dispatch(e)}debouncedDispatch(e,t=100){const i=Date.now();return i-(this.debouncedActions[e.type]||0)>=t&&(this.debouncedActions[e.type]=i,this.dispatch(e),!0)}subscribe(e){return this.pluginStore.subscribeToState(e)}subscribeToCoreStore(e){return this.coreStore.subscribe(e)}onStoreUpdated(e,t){}onCoreStoreUpdated(e,t){}destroy(){this.unsubscribeFromState&&(this.unsubscribeFromState(),this.unsubscribeFromState=null),this.unsubscribeFromCoreStore&&(this.unsubscribeFromCoreStore(),this.unsubscribeFromCoreStore=null)}ready(){return this.readyPromise}markReady(){this.readyResolve()}resetReady(){this.readyPromise=new Promise(e=>{this.readyResolve=e})}},wg=class extends yg{constructor(e,t,i){super(e,t),this.engine=i}async initialize(e){}buildCapability(){return{getBookmarks:this.getBookmarks.bind(this)}}getBookmarks(){const e=this.coreState.core.document;if(!e)throw new Error("Document not open");return this.engine.getBookmarks(e)}};wg.id="bookmark";var Sg={manifest:fg,create:(e,t)=>new wg(gg,e,t),reducer:()=>{},initialState:{}},Cg=class extends Error{constructor(e){super(`Task aborted: ${JSON.stringify(e)}`),this.name="TaskAbortedError"}},xg=class extends Error{constructor(e){super(`Task rejected: ${JSON.stringify(e)}`),this.name="TaskRejectedError"}},Ig=class e{constructor(){this.state={stage:0},this.resolvedCallbacks=[],this.rejectedCallbacks=[],this._promise=null}toPromise(){return this._promise||(this._promise=new Promise((e,t)=>{this.wait(t=>e(t),e=>{"abort"===e.type?t(new Cg(e.reason)):t(new xg(e.reason))})})),this._promise}wait(e,t){switch(this.state.stage){case 0:this.resolvedCallbacks.push(e),this.rejectedCallbacks.push(t);break;case 1:e(this.state.result);break;case 2:t({type:"reject",reason:this.state.reason});break;case 3:t({type:"abort",reason:this.state.reason})}}resolve(e){if(0===this.state.stage){this.state={stage:1,result:e};for(const t of this.resolvedCallbacks)try{t(e)}catch(e){}this.resolvedCallbacks=[],this.rejectedCallbacks=[]}}reject(e){if(0===this.state.stage){this.state={stage:2,reason:e};for(const t of this.rejectedCallbacks)try{t({type:"reject",reason:e})}catch(e){}this.resolvedCallbacks=[],this.rejectedCallbacks=[]}}abort(e){if(0===this.state.stage){this.state={stage:3,reason:e};for(const t of this.rejectedCallbacks)try{t({type:"abort",reason:e})}catch(e){}this.resolvedCallbacks=[],this.rejectedCallbacks=[]}}fail(e){"abort"===e.type?this.abort(e.reason):this.reject(e.reason)}static all(t){const i=new e;if(0===t.length)return i.resolve([]),i;const r=new Array(t.length);let o=0,n=!1;return t.forEach((e,s)=>{e.wait(e=>{n||(r[s]=e,o++,o===t.length&&(n=!0,i.resolve(r)))},e=>{n||(n=!0,"abort"===e.type?i.abort(e.reason):i.reject(e.reason))})}),i}static allSettled(t){const i=new e;if(0===t.length)return i.resolve([]),i;const r=new Array(t.length);let o=0;return t.forEach((e,n)=>{e.wait(e=>{r[n]={status:"resolved",value:e},o++,o===t.length&&i.resolve(r)},e=>{r[n]={status:"abort"===e.type?"aborted":"rejected",reason:e.reason},o++,o===t.length&&i.resolve(r)})}),i}static race(t){const i=new e;if(0===t.length)return i.reject("No tasks provided"),i;let r=!1;return t.forEach(e=>{e.wait(e=>{r||(r=!0,i.resolve(e))},e=>{r||(r=!0,"abort"===e.type?i.abort(e.reason):i.reject(e.reason))})}),i}static withProgress(t,i){const r=e.all(t);if(i){let e=0;t.forEach(r=>{r.wait(()=>{e++,i(e,t.length)},()=>{e++,i(e,t.length)})})}return r}},Ag=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${Ag.join("")}]`,"g");var Eg=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);Eg.reduce((e,t)=>(e[t.id]=t,e),{}),Eg.reduce((e,t)=>(e[t.css]=t.id,e),{}),Eg.map(e=>({value:e.id,label:e.label}));var kg=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});Object.entries(kg).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var Pg=(e=>(e[e.Ok=0]="Ok",e[e.Unknown=1]="Unknown",e[e.NotFound=2]="NotFound",e[e.WrongFormat=3]="WrongFormat",e[e.Password=4]="Password",e[e.Security=5]="Security",e[e.PageError=6]="PageError",e[e.XFALoad=7]="XFALoad",e[e.XFALayout=8]="XFALayout",e[e.Cancelled=9]="Cancelled",e[e.Initialization=10]="Initialization",e[e.NotReady=11]="NotReady",e[e.NotSupport=12]="NotSupport",e[e.LoadDoc=13]="LoadDoc",e[e.DocNotOpen=14]="DocNotOpen",e[e.CantCloseDoc=15]="CantCloseDoc",e[e.CantCreateNewDoc=16]="CantCreateNewDoc",e[e.CantImportPages=17]="CantImportPages",e[e.CantCreateAnnot=18]="CantCreateAnnot",e[e.CantSetAnnotRect=19]="CantSetAnnotRect",e[e.CantSetAnnotContent=20]="CantSetAnnotContent",e[e.CantRemoveInkList=21]="CantRemoveInkList",e[e.CantAddInkStoke=22]="CantAddInkStoke",e[e.CantReadAttachmentSize=23]="CantReadAttachmentSize",e[e.CantReadAttachmentContent=24]="CantReadAttachmentContent",e[e.CantFocusAnnot=25]="CantFocusAnnot",e[e.CantSelectText=26]="CantSelectText",e[e.CantSelectOption=27]="CantSelectOption",e[e.CantCheckField=28]="CantCheckField",e))(Pg||{}),Mg=class{static create(){return new Ig}static resolve(e){const t=new Ig;return t.resolve(e),t}static reject(e){const t=new Ig;return t.reject(e),t}static abort(e){const t=new Ig;return t.reject(e),t}},Tg=class{constructor(e,t){if(this.id=e,this.registry=t,this.debouncedActions={},this.unsubscribeFromState=null,this.unsubscribeFromCoreStore=null,e!==this.constructor.id)throw new Error(`Plugin ID mismatch: ${e} !== ${this.constructor.id}`);this.coreStore=this.registry.getStore(),this.pluginStore=this.coreStore.getPluginStore(this.id),this.unsubscribeFromState=this.pluginStore.subscribeToState((e,t,i)=>{this.onStoreUpdated(i,t)}),this.unsubscribeFromCoreStore=this.coreStore.subscribe((e,t,i)=>{this.onCoreStoreUpdated(i,t)}),this.readyPromise=new Promise(e=>{this.readyResolve=e}),this.readyResolve()}provides(){if(!this._capability){const e=this.buildCapability();this._capability=Object.freeze(e)}return this._capability}get state(){return this.pluginStore.getState()}get coreState(){return this.coreStore.getState()}getState(){return this.pluginStore.getState()}getCoreState(){return this.coreStore.getState()}dispatchCoreAction(e){return this.coreStore.dispatchToCore(e)}dispatchToAllPlugins(e){return this.coreStore.dispatch(e)}dispatch(e){return this.pluginStore.dispatch(e)}debouncedDispatch(e,t=100){const i=Date.now();return i-(this.debouncedActions[e.type]||0)>=t&&(this.debouncedActions[e.type]=i,this.dispatch(e),!0)}subscribe(e){return this.pluginStore.subscribeToState(e)}subscribeToCoreStore(e){return this.coreStore.subscribe(e)}onStoreUpdated(e,t){}onCoreStoreUpdated(e,t){}destroy(){this.unsubscribeFromState&&(this.unsubscribeFromState(),this.unsubscribeFromState=null),this.unsubscribeFromCoreStore&&(this.unsubscribeFromCoreStore(),this.unsubscribeFromCoreStore=null)}ready(){return this.readyPromise}markReady(){this.readyResolve()}resetReady(){this.readyPromise=new Promise(e=>{this.readyResolve=e})}};var Rg=class extends Tg{constructor(e,t,i){super(e,t),this.downloadRequest$=function(){const e=new Set;return{emit:(t=void 0)=>e.forEach(e=>e(t)),on:t=>(e.add(t),()=>e.delete(t)),off:t=>e.delete(t),clear:()=>e.clear()}}(),this.engine=i}async initialize(e){}buildCapability(){return{saveAsCopy:this.saveAsCopy.bind(this),download:this.download.bind(this),onRequest:this.downloadRequest$.on}}download(){this.downloadRequest$.emit("download")}saveAsCopy(){const e=this.coreState.core.document;return e?this.engine.saveAsCopy(e):Mg.reject({code:Pg.DocNotOpen,message:"Document not found"})}};Rg.id="export";var _g="export",Ng={manifest:{id:_g,name:"Export Plugin",version:"1.0.0",provides:["export"],requires:[],optional:[],defaultConfig:{enabled:!0}},create:(e,t)=>new Rg(_g,e,t),reducer:()=>{},initialState:{}},Og=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${Og.join("")}]`,"g");var zg=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);zg.reduce((e,t)=>(e[t.id]=t,e),{}),zg.reduce((e,t)=>(e[t.css]=t.id,e),{}),zg.map(e=>({value:e.id,label:e.label}));var Lg=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});function Dg(){}Object.entries(Lg).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var Fg=ce({registry:null,isInitializing:!0,pluginsReady:!1});function Hg(e){const{registry:t}=function(){const e=Ne(Fg);if(void 0===e)throw new Error("useCapability must be used within a PDFContext.Provider");const{registry:t,isInitializing:i}=e;if(i)return e;if(null===t)throw new Error("PDF registry failed to initialize properly");return e}();if(null===t)return{plugin:null,isLoading:!0,ready:new Promise(()=>{})};const i=t.getPlugin(e);if(!i)throw new Error(`Plugin ${e} not found`);return{plugin:i,isLoading:!1,ready:i.ready()}}var $g=class extends Error{constructor(e){super(`Task aborted: ${JSON.stringify(e)}`),this.name="TaskAbortedError"}},jg=class extends Error{constructor(e){super(`Task rejected: ${JSON.stringify(e)}`),this.name="TaskRejectedError"}},Ug=class e{constructor(){this.state={stage:0},this.resolvedCallbacks=[],this.rejectedCallbacks=[],this._promise=null}toPromise(){return this._promise||(this._promise=new Promise((e,t)=>{this.wait(t=>e(t),e=>{"abort"===e.type?t(new $g(e.reason)):t(new jg(e.reason))})})),this._promise}wait(e,t){switch(this.state.stage){case 0:this.resolvedCallbacks.push(e),this.rejectedCallbacks.push(t);break;case 1:e(this.state.result);break;case 2:t({type:"reject",reason:this.state.reason});break;case 3:t({type:"abort",reason:this.state.reason})}}resolve(e){if(0===this.state.stage){this.state={stage:1,result:e};for(const t of this.resolvedCallbacks)try{t(e)}catch(e){}this.resolvedCallbacks=[],this.rejectedCallbacks=[]}}reject(e){if(0===this.state.stage){this.state={stage:2,reason:e};for(const t of this.rejectedCallbacks)try{t({type:"reject",reason:e})}catch(e){}this.resolvedCallbacks=[],this.rejectedCallbacks=[]}}abort(e){if(0===this.state.stage){this.state={stage:3,reason:e};for(const t of this.rejectedCallbacks)try{t({type:"abort",reason:e})}catch(e){}this.resolvedCallbacks=[],this.rejectedCallbacks=[]}}fail(e){"abort"===e.type?this.abort(e.reason):this.reject(e.reason)}static all(t){const i=new e;if(0===t.length)return i.resolve([]),i;const r=new Array(t.length);let o=0,n=!1;return t.forEach((e,s)=>{e.wait(e=>{n||(r[s]=e,o++,o===t.length&&(n=!0,i.resolve(r)))},e=>{n||(n=!0,"abort"===e.type?i.abort(e.reason):i.reject(e.reason))})}),i}static allSettled(t){const i=new e;if(0===t.length)return i.resolve([]),i;const r=new Array(t.length);let o=0;return t.forEach((e,n)=>{e.wait(e=>{r[n]={status:"resolved",value:e},o++,o===t.length&&i.resolve(r)},e=>{r[n]={status:"abort"===e.type?"aborted":"rejected",reason:e.reason},o++,o===t.length&&i.resolve(r)})}),i}static race(t){const i=new e;if(0===t.length)return i.reject("No tasks provided"),i;let r=!1;return t.forEach(e=>{e.wait(e=>{r||(r=!0,i.resolve(e))},e=>{r||(r=!0,"abort"===e.type?i.abort(e.reason):i.reject(e.reason))})}),i}static withProgress(t,i){const r=e.all(t);if(i){let e=0;t.forEach(r=>{r.wait(()=>{e++,i(e,t.length)},()=>{e++,i(e,t.length)})})}return r}},Bg=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${Bg.join("")}]`,"g");var Gg=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);Gg.reduce((e,t)=>(e[t.id]=t,e),{}),Gg.reduce((e,t)=>(e[t.css]=t.id,e),{}),Gg.map(e=>({value:e.id,label:e.label}));var Vg=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});Object.entries(Vg).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var Wg=(e=>(e[e.Ok=0]="Ok",e[e.Unknown=1]="Unknown",e[e.NotFound=2]="NotFound",e[e.WrongFormat=3]="WrongFormat",e[e.Password=4]="Password",e[e.Security=5]="Security",e[e.PageError=6]="PageError",e[e.XFALoad=7]="XFALoad",e[e.XFALayout=8]="XFALayout",e[e.Cancelled=9]="Cancelled",e[e.Initialization=10]="Initialization",e[e.NotReady=11]="NotReady",e[e.NotSupport=12]="NotSupport",e[e.LoadDoc=13]="LoadDoc",e[e.DocNotOpen=14]="DocNotOpen",e[e.CantCloseDoc=15]="CantCloseDoc",e[e.CantCreateNewDoc=16]="CantCreateNewDoc",e[e.CantImportPages=17]="CantImportPages",e[e.CantCreateAnnot=18]="CantCreateAnnot",e[e.CantSetAnnotRect=19]="CantSetAnnotRect",e[e.CantSetAnnotContent=20]="CantSetAnnotContent",e[e.CantRemoveInkList=21]="CantRemoveInkList",e[e.CantAddInkStoke=22]="CantAddInkStoke",e[e.CantReadAttachmentSize=23]="CantReadAttachmentSize",e[e.CantReadAttachmentContent=24]="CantReadAttachmentContent",e[e.CantFocusAnnot=25]="CantFocusAnnot",e[e.CantSelectText=26]="CantSelectText",e[e.CantSelectOption=27]="CantSelectOption",e[e.CantCheckField=28]="CantCheckField",e))(Wg||{}),Zg=class{static create(){return new Ug}static resolve(e){const t=new Ug;return t.resolve(e),t}static reject(e){const t=new Ug;return t.reject(e),t}static abort(e){const t=new Ug;return t.reject(e),t}},qg=class{constructor(e,t){if(this.id=e,this.registry=t,this.debouncedActions={},this.unsubscribeFromState=null,this.unsubscribeFromCoreStore=null,e!==this.constructor.id)throw new Error(`Plugin ID mismatch: ${e} !== ${this.constructor.id}`);this.coreStore=this.registry.getStore(),this.pluginStore=this.coreStore.getPluginStore(this.id),this.unsubscribeFromState=this.pluginStore.subscribeToState((e,t,i)=>{this.onStoreUpdated(i,t)}),this.unsubscribeFromCoreStore=this.coreStore.subscribe((e,t,i)=>{this.onCoreStoreUpdated(i,t)}),this.readyPromise=new Promise(e=>{this.readyResolve=e}),this.readyResolve()}provides(){if(!this._capability){const e=this.buildCapability();this._capability=Object.freeze(e)}return this._capability}get state(){return this.pluginStore.getState()}get coreState(){return this.coreStore.getState()}getState(){return this.pluginStore.getState()}getCoreState(){return this.coreStore.getState()}dispatchCoreAction(e){return this.coreStore.dispatchToCore(e)}dispatchToAllPlugins(e){return this.coreStore.dispatch(e)}dispatch(e){return this.pluginStore.dispatch(e)}debouncedDispatch(e,t=100){const i=Date.now();return i-(this.debouncedActions[e.type]||0)>=t&&(this.debouncedActions[e.type]=i,this.dispatch(e),!0)}subscribe(e){return this.pluginStore.subscribeToState(e)}subscribeToCoreStore(e){return this.coreStore.subscribe(e)}onStoreUpdated(e,t){}onCoreStoreUpdated(e,t){}destroy(){this.unsubscribeFromState&&(this.unsubscribeFromState(),this.unsubscribeFromState=null),this.unsubscribeFromCoreStore&&(this.unsubscribeFromCoreStore(),this.unsubscribeFromCoreStore=null)}ready(){return this.readyPromise}markReady(){this.readyResolve()}resetReady(){this.readyPromise=new Promise(e=>{this.readyResolve=e})}};var Xg=class extends qg{constructor(e,t,i){super(e,t),this.downloadRequest$=function(){const e=new Set;return{emit:(t=void 0)=>e.forEach(e=>e(t)),on:t=>(e.add(t),()=>e.delete(t)),off:t=>e.delete(t),clear:()=>e.clear()}}(),this.engine=i}async initialize(e){}buildCapability(){return{saveAsCopy:this.saveAsCopy.bind(this),download:this.download.bind(this),onRequest:this.downloadRequest$.on}}download(){this.downloadRequest$.emit("download")}saveAsCopy(){const e=this.coreState.core.document;return e?this.engine.saveAsCopy(e):Zg.reject({code:Wg.DocNotOpen,message:"Document not found"})}};Xg.id="export";var Kg=()=>function(e){const{plugin:t,isLoading:i,ready:r}=Hg(e);if(!t)return{provides:null,isLoading:i,ready:r};if(!t.provides)throw new Error(`Plugin ${e} does not provide a capability`);return{provides:t.provides(),isLoading:i,ready:r}}(Xg.id);function Yg(){const{provides:e}=Kg(),t=Te(null);return Pe(()=>{if(!e)return;return e.onRequest(async i=>{if("download"===i){const i=t.current;if(!i)return;e.saveAsCopy().wait(e=>{const t=URL.createObjectURL(new Blob([e]));i.href=t,i.download="document.pdf",i.click(),URL.revokeObjectURL(t)},Dg)}})},[e]),he("a",{style:{display:"none"},ref:t})}var Qg=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${Qg.join("")}]`,"g");var Jg=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);Jg.reduce((e,t)=>(e[t.id]=t,e),{}),Jg.reduce((e,t)=>(e[t.css]=t.id,e),{}),Jg.map(e=>({value:e.id,label:e.label}));var ef=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});Object.entries(ef).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var tf=class{constructor(e,t){if(this.id=e,this.registry=t,this.debouncedActions={},this.unsubscribeFromState=null,this.unsubscribeFromCoreStore=null,e!==this.constructor.id)throw new Error(`Plugin ID mismatch: ${e} !== ${this.constructor.id}`);this.coreStore=this.registry.getStore(),this.pluginStore=this.coreStore.getPluginStore(this.id),this.unsubscribeFromState=this.pluginStore.subscribeToState((e,t,i)=>{this.onStoreUpdated(i,t)}),this.unsubscribeFromCoreStore=this.coreStore.subscribe((e,t,i)=>{this.onCoreStoreUpdated(i,t)}),this.readyPromise=new Promise(e=>{this.readyResolve=e}),this.readyResolve()}provides(){if(!this._capability){const e=this.buildCapability();this._capability=Object.freeze(e)}return this._capability}get state(){return this.pluginStore.getState()}get coreState(){return this.coreStore.getState()}getState(){return this.pluginStore.getState()}getCoreState(){return this.coreStore.getState()}dispatchCoreAction(e){return this.coreStore.dispatchToCore(e)}dispatchToAllPlugins(e){return this.coreStore.dispatch(e)}dispatch(e){return this.pluginStore.dispatch(e)}debouncedDispatch(e,t=100){const i=Date.now();return i-(this.debouncedActions[e.type]||0)>=t&&(this.debouncedActions[e.type]=i,this.dispatch(e),!0)}subscribe(e){return this.pluginStore.subscribeToState(e)}subscribeToCoreStore(e){return this.coreStore.subscribe(e)}onStoreUpdated(e,t){}onCoreStoreUpdated(e,t){}destroy(){this.unsubscribeFromState&&(this.unsubscribeFromState(),this.unsubscribeFromState=null),this.unsubscribeFromCoreStore&&(this.unsubscribeFromCoreStore(),this.unsubscribeFromCoreStore=null)}ready(){return this.readyPromise}markReady(){this.readyResolve()}resetReady(){this.readyPromise=new Promise(e=>{this.readyResolve=e})}},rf=class{constructor(e,t){this.handler=e,this.options=t,this.lastRun=0,this.handle=e=>{"debounce"===this.options.mode?this.debounce(e):this.throttle(e)}}debounce(e){this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.timeoutId=void 0},this.options.wait)}throttle(e){if("debounce"===this.options.mode)return;const t=Date.now(),i=this.options.throttleMode||"leading-trailing";t-this.lastRun>=this.options.wait&&("leading-trailing"===i&&this.handler(e),this.lastRun=t),this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.lastRun=Date.now(),this.timeoutId=void 0},this.options.wait-(t-this.lastRun))}destroy(){this.timeoutId&&window.clearTimeout(this.timeoutId)}};function of(e,t,i){if(e===t)return!0;if(null==e||null==t)return e===t;const r=typeof e;if(r!==typeof t)return!1;if("object"===r){i||(i=new Set);const r=function(e,t){return`${af(e)}__${af(t)}`}(e,t);if(i.has(r))return!0;i.add(r);const o=Array.isArray(e),n=Array.isArray(t);return o&&n?function(e,t,i){if(e.length!==t.length)return!1;const r=new Array(t.length).fill(!1);e:for(let o=0;o<e.length;o++){const n=e[o];for(let e=0;e<t.length;e++)if(!r[e]&&of(n,t[e],i)){r[e]=!0;continue e}return!1}return!0}(e,t,i):!o&&!n&&function(e,t,i){const r=Object.keys(e).sort(),o=Object.keys(t).sort();if(r.length!==o.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!==o[e])return!1;for(const o of r){if(!of(e[o],t[o],i))return!1}return!0}(e,t,i)}return!1}var nf=0,sf=new WeakMap;function af(e){return sf.has(e)||sf.set(e,++nf),sf.get(e)}function lf(){const e=new Set;return{emit:(t=void 0)=>e.forEach(e=>e(t)),on:t=>(e.add(t),()=>e.delete(t)),off:t=>e.delete(t),clear:()=>e.clear()}}function cf(e,t=of){const i=new Set,r=new Map;let o=e;const n=(e,t)=>{let n=e,s=()=>{};if(t){const i=new rf(e,t);n=i.handle,s=()=>i.destroy(),r.set(e,{wrapped:n,destroy:s})}return void 0!==o&&n(o),i.add(n),()=>{i.delete(n),s(),r.delete(e)}};return{get value(){return o},emit(e=void 0){(void 0===o||!t(o,e))&&(o=e,(e=>{i.forEach(t=>t(e))})(e))},on:n,off(e){const t=r.get(e);t?(i.delete(t.wrapped),t.destroy(),r.delete(e)):i.delete(e)},clear(){i.clear(),r.forEach(e=>e.destroy()),r.clear()},select:(e,t=of)=>(i,r)=>{let s;if(void 0!==o){const t=e(o);s=t,i(t)}return n(r=>{const o=e(r);(void 0===s||!t(s,o))&&(s=o,i(o))},r)}}}var df=ce({registry:null,isInitializing:!0,pluginsReady:!1});function uf(e){const{registry:t}=function(){const e=Ne(df);if(void 0===e)throw new Error("useCapability must be used within a PDFContext.Provider");const{registry:t,isInitializing:i}=e;if(i)return e;if(null===t)throw new Error("PDF registry failed to initialize properly");return e}();if(null===t)return{plugin:null,isLoading:!0,ready:new Promise(()=>{})};const i=t.getPlugin(e);if(!i)throw new Error(`Plugin ${e} not found`);return{plugin:i,isLoading:!1,ready:i.ready()}}function hf(e){const{plugin:t,isLoading:i,ready:r}=uf(e);if(!t)return{provides:null,isLoading:i,ready:r};if(!t.provides)throw new Error(`Plugin ${e} does not provide a capability`);return{provides:t.provides(),isLoading:i,ready:r}}var pf=class extends tf{constructor(e,t){super(e,t),this.modes=new Map,this.cursorClaims=new Map,this.buckets=new Map,this.alwaysGlobal=new Set,this.alwaysPage=new Map,this.onModeChange$=lf(),this.onHandlerChange$=lf(),this.onCursorChange$=lf(),this.onStateChange$=cf(),this.registerMode({id:"default",scope:"page",exclusive:!1,cursor:"auto"})}async initialize(e){}buildCapability(){return{activate:e=>this.activate(e),onModeChange:this.onModeChange$.on,onCursorChange:this.onCursorChange$.on,onHandlerChange:this.onHandlerChange$.on,onStateChange:this.onStateChange$.on,getActiveMode:()=>this.state.activeMode,getActiveInteractionMode:()=>this.getActiveInteractionMode(),finish:()=>this.activate("default"),registerMode:e=>this.registerMode(e),registerHandlers:e=>this.registerHandlers(e),registerAlways:e=>this.registerAlways(e),setCursor:(e,t,i=0)=>this.setCursor(e,t,i),removeCursor:e=>this.removeCursor(e),getCurrentCursor:()=>this.state.cursor,getHandlersForScope:e=>this.getHandlersForScope(e),activeModeIsExclusive:()=>this.activeModeIsExclusive(),pause:()=>this.dispatch({type:"INTERACTION/PAUSE"}),resume:()=>this.dispatch({type:"INTERACTION/RESUME"}),isPaused:()=>this.state.paused}}activate(e){if(!this.modes.has(e))throw new Error(`[interaction] unknown mode '${e}'`);if(e===this.state.activeMode)return;const t=this.state.activeMode;this.cursorClaims.clear(),this.notifyHandlersInactive(t),this.dispatch({type:"INTERACTION/ACTIVATE_MODE",payload:{mode:e}}),this.emitCursor(),this.notifyHandlersActive(e),this.onModeChange$.emit({...this.state,activeMode:e})}notifyHandlersActive(e){this.alwaysGlobal.forEach(t=>{var i;null==(i=t.onHandlerActiveStart)||i.call(t,e)}),this.alwaysPage.forEach(t=>{t.forEach(t=>{var i;null==(i=t.onHandlerActiveStart)||i.call(t,e)})});const t=this.modes.get(e);if(!t)return;const i=this.buckets.get(e);i&&("global"===t.scope&&i.global.forEach(t=>{var i;null==(i=t.onHandlerActiveStart)||i.call(t,e)}),"page"===t.scope&&i.page.forEach((t,i)=>{t.forEach(t=>{var i;null==(i=t.onHandlerActiveStart)||i.call(t,e)})}))}notifyHandlersInactive(e){this.alwaysGlobal.forEach(t=>{var i;null==(i=t.onHandlerActiveEnd)||i.call(t,e)}),this.alwaysPage.forEach(t=>{t.forEach(t=>{var i;null==(i=t.onHandlerActiveEnd)||i.call(t,e)})});const t=this.modes.get(e);if(!t)return;const i=this.buckets.get(e);i&&("global"===t.scope&&i.global.forEach(t=>{var i;null==(i=t.onHandlerActiveEnd)||i.call(t,e)}),"page"===t.scope&&i.page.forEach((t,i)=>{t.forEach(t=>{var i;null==(i=t.onHandlerActiveEnd)||i.call(t,e)})}))}registerMode(e){this.modes.set(e.id,e),this.buckets.has(e.id)||this.buckets.set(e.id,{global:new Set,page:new Map})}registerHandlers({modeId:e,handlers:t,pageIndex:i}){const r=Array.isArray(e)?e:[e],o=[];for(const e of r){const r=this.buckets.get(e);if(!r)throw new Error(`unknown mode '${e}'`);if(null==i)r.global.add(t);else{const e=r.page.get(i)??new Set;e.add(t),r.page.set(i,e)}o.push(()=>{if(null==i)r.global.delete(t);else{const e=r.page.get(i);e&&(e.delete(t),0===e.size&&r.page.delete(i))}})}return this.onHandlerChange$.emit({...this.state}),()=>{o.forEach(e=>e()),this.onHandlerChange$.emit({...this.state})}}registerAlways({scope:e,handlers:t}){if("global"===e.type)return this.alwaysGlobal.add(t),this.onHandlerChange$.emit({...this.state}),()=>this.alwaysGlobal.delete(t);const i=this.alwaysPage.get(e.pageIndex)??new Set;return i.add(t),this.alwaysPage.set(e.pageIndex,i),this.onHandlerChange$.emit({...this.state}),()=>{i.delete(t),this.onHandlerChange$.emit({...this.state})}}getHandlersForScope(e){if(!this.state)return null;const t=this.modes.get(this.state.activeMode);if(!t)return null;const i=this.buckets.get(t.id);if(!i)return null;const r=(e,t)=>e.size||t.size?function(e){const t=["onPointerDown","onPointerUp","onPointerMove","onPointerEnter","onPointerLeave","onPointerCancel"],i={};for(const r of t)i[r]=(t,i,o)=>{var n;for(const s of e)null==(n=s[r])||n.call(s,t,i,o)};return i}([...e,...t]):null;if("global"===e.type){const e="global"===t.scope?i.global:new Set;return r(this.alwaysGlobal,e)}return r(this.alwaysPage.get(e.pageIndex)??new Set,"page"===t.scope?i.page.get(e.pageIndex)??new Set:new Set)}setCursor(e,t,i=0){this.cursorClaims.set(e,{cursor:t,priority:i}),this.emitCursor()}removeCursor(e){this.cursorClaims.delete(e),this.emitCursor()}emitCursor(){var e;const t=[...this.cursorClaims.values()].sort((e,t)=>t.priority-e.priority)[0]??{cursor:(null==(e=this.modes.get(this.state.activeMode))?void 0:e.cursor)??"auto"};t.cursor!==this.state.cursor&&(this.dispatch({type:"INTERACTION/SET_CURSOR",payload:{cursor:t.cursor}}),this.onCursorChange$.emit(t.cursor))}onStoreUpdated(e,t){this.onStateChange$.emit(t)}activeModeIsExclusive(){const e=this.modes.get(this.state.activeMode);return!(null==e||!e.exclusive)}getActiveInteractionMode(){return this.modes.get(this.state.activeMode)??null}async destroy(){this.onModeChange$.clear(),this.onCursorChange$.clear(),await super.destroy()}};pf.id="interaction-manager";var gf=pf,ff=()=>hf(gf.id);var mf=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${mf.join("")}]`,"g");var bf=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);bf.reduce((e,t)=>(e[t.id]=t,e),{}),bf.reduce((e,t)=>(e[t.css]=t.id,e),{}),bf.map(e=>({value:e.id,label:e.label}));var vf=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});Object.entries(vf).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var yf=class extends tf{constructor(e,t,i){super(e,t),this.id=e,this.viewportResize$=cf(),this.viewportMetrics$=cf(),this.scrollMetrics$=cf(),this.scrollReq$=lf(),this.scrollActivity$=cf(),this.rectProvider=null,i.viewportGap&&this.dispatch(function(e){return{type:"SET_VIEWPORT_GAP",payload:e}}(i.viewportGap)),this.scrollEndDelay=i.scrollEndDelay||300}buildCapability(){return{getViewportGap:()=>this.state.viewportGap,getMetrics:()=>this.state.viewportMetrics,getBoundingRect:()=>{var e;return(null==(e=this.rectProvider)?void 0:e.call(this))??{origin:{x:0,y:0},size:{width:0,height:0}}},scrollTo:e=>this.scrollTo(e),isScrolling:()=>this.state.isScrolling,onScrollChange:this.scrollMetrics$.on,onViewportChange:this.viewportMetrics$.on,onViewportResize:this.viewportResize$.on,onScrollActivity:this.scrollActivity$.on}}setViewportResizeMetrics(e){this.dispatch(function(e){return{type:"SET_VIEWPORT_METRICS",payload:e}}(e)),this.viewportResize$.emit(this.state.viewportMetrics)}setViewportScrollMetrics(e){(e.scrollTop!==this.state.viewportMetrics.scrollTop||e.scrollLeft!==this.state.viewportMetrics.scrollLeft)&&(this.dispatch(function(e){return{type:"SET_VIEWPORT_SCROLL_METRICS",payload:e}}(e)),this.bumpScrollActivity(),this.scrollMetrics$.emit({scrollTop:e.scrollTop,scrollLeft:e.scrollLeft}))}onScrollRequest(e){return this.scrollReq$.on(e)}registerBoundingRectProvider(e){this.rectProvider=e}bumpScrollActivity(){this.debouncedDispatch(function(e){return{type:"SET_SCROLL_ACTIVITY",payload:e}}(!1),this.scrollEndDelay)}scrollTo(e){const{x:t,y:i,center:r,behavior:o="auto"}=e;if(r){const e=this.state.viewportMetrics,r=t-e.clientWidth/2,n=i-e.clientHeight/2;this.scrollReq$.emit({x:r,y:n,behavior:o})}else this.scrollReq$.emit({x:t,y:i,behavior:o})}onStoreUpdated(e,t){e!==t&&(this.viewportMetrics$.emit(t.viewportMetrics),e.isScrolling!==t.isScrolling&&this.scrollActivity$.emit(t.isScrolling))}async initialize(e){}async destroy(){super.destroy(),this.viewportMetrics$.clear(),this.viewportResize$.clear(),this.scrollMetrics$.clear(),this.scrollReq$.clear(),this.scrollActivity$.clear(),this.rectProvider=null,this.scrollEndTimer&&clearTimeout(this.scrollEndTimer)}};yf.id="viewport";var wf=yf,Sf=()=>{const{register:e}=function({modeId:e,pageIndex:t}){const{provides:i}=ff();return{register:(r,o)=>{const n=(null==o?void 0:o.modeId)??e,s=(null==o?void 0:o.pageIndex)??t;return n?null==i?void 0:i.registerHandlers({modeId:n,handlers:r,pageIndex:s}):null==i?void 0:i.registerAlways({scope:void 0!==s?{type:"page",pageIndex:s}:{type:"global"},handlers:r})}}}({modeId:"panMode"}),{setCursor:t,removeCursor:i}=function(){const{provides:e}=ff();return{setCursor:(t,i,r=0)=>{null==e||e.setCursor(t,i,r)},removeCursor:t=>{null==e||e.removeCursor(t)}}}(),{provides:r}=hf(wf.id),o=Te(null),n=Re(()=>({onPointerDown:(e,i)=>{if(!r)return;const n=r.getMetrics();o.current={startX:i.clientX,startY:i.clientY,startLeft:n.scrollLeft,startTop:n.scrollTop},t("panMode","grabbing",10)},onPointerMove:(e,t)=>{const i=o.current;if(!i||!r)return;const n=t.clientX-i.startX,s=t.clientY-i.startY;r.scrollTo({x:i.startLeft-n,y:i.startTop-s})},onPointerUp:()=>{o.current&&(o.current=null,i("panMode"))},onPointerLeave:()=>{o.current&&(o.current=null,i("panMode"))},onPointerCancel:()=>{o.current&&(o.current=null,i("panMode"))}}),[r,t,i]);return Pe(()=>{if(e)return e(n)},[e,n]),he(B,{})},Cf=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${Cf.join("")}]`,"g");var xf=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);xf.reduce((e,t)=>(e[t.id]=t,e),{}),xf.reduce((e,t)=>(e[t.css]=t.id,e),{}),xf.map(e=>({value:e.id,label:e.label}));var If=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});Object.entries(If).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var Af=class{constructor(e,t){if(this.id=e,this.registry=t,this.debouncedActions={},this.unsubscribeFromState=null,this.unsubscribeFromCoreStore=null,e!==this.constructor.id)throw new Error(`Plugin ID mismatch: ${e} !== ${this.constructor.id}`);this.coreStore=this.registry.getStore(),this.pluginStore=this.coreStore.getPluginStore(this.id),this.unsubscribeFromState=this.pluginStore.subscribeToState((e,t,i)=>{this.onStoreUpdated(i,t)}),this.unsubscribeFromCoreStore=this.coreStore.subscribe((e,t,i)=>{this.onCoreStoreUpdated(i,t)}),this.readyPromise=new Promise(e=>{this.readyResolve=e}),this.readyResolve()}provides(){if(!this._capability){const e=this.buildCapability();this._capability=Object.freeze(e)}return this._capability}get state(){return this.pluginStore.getState()}get coreState(){return this.coreStore.getState()}getState(){return this.pluginStore.getState()}getCoreState(){return this.coreStore.getState()}dispatchCoreAction(e){return this.coreStore.dispatchToCore(e)}dispatchToAllPlugins(e){return this.coreStore.dispatch(e)}dispatch(e){return this.pluginStore.dispatch(e)}debouncedDispatch(e,t=100){const i=Date.now();return i-(this.debouncedActions[e.type]||0)>=t&&(this.debouncedActions[e.type]=i,this.dispatch(e),!0)}subscribe(e){return this.pluginStore.subscribeToState(e)}subscribeToCoreStore(e){return this.coreStore.subscribe(e)}onStoreUpdated(e,t){}onCoreStoreUpdated(e,t){}destroy(){this.unsubscribeFromState&&(this.unsubscribeFromState(),this.unsubscribeFromState=null),this.unsubscribeFromCoreStore&&(this.unsubscribeFromCoreStore(),this.unsubscribeFromCoreStore=null)}ready(){return this.readyPromise}markReady(){this.readyResolve()}resetReady(){this.readyPromise=new Promise(e=>{this.readyResolve=e})}},Ef=class{constructor(e,t){this.handler=e,this.options=t,this.lastRun=0,this.handle=e=>{"debounce"===this.options.mode?this.debounce(e):this.throttle(e)}}debounce(e){this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.timeoutId=void 0},this.options.wait)}throttle(e){if("debounce"===this.options.mode)return;const t=Date.now(),i=this.options.throttleMode||"leading-trailing";t-this.lastRun>=this.options.wait&&("leading-trailing"===i&&this.handler(e),this.lastRun=t),this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.lastRun=Date.now(),this.timeoutId=void 0},this.options.wait-(t-this.lastRun))}destroy(){this.timeoutId&&window.clearTimeout(this.timeoutId)}};function kf(e,t,i){if(e===t)return!0;if(null==e||null==t)return e===t;const r=typeof e;if(r!==typeof t)return!1;if("object"===r){i||(i=new Set);const r=function(e,t){return`${Tf(e)}__${Tf(t)}`}(e,t);if(i.has(r))return!0;i.add(r);const o=Array.isArray(e),n=Array.isArray(t);return o&&n?function(e,t,i){if(e.length!==t.length)return!1;const r=new Array(t.length).fill(!1);e:for(let o=0;o<e.length;o++){const n=e[o];for(let e=0;e<t.length;e++)if(!r[e]&&kf(n,t[e],i)){r[e]=!0;continue e}return!1}return!0}(e,t,i):!o&&!n&&function(e,t,i){const r=Object.keys(e).sort(),o=Object.keys(t).sort();if(r.length!==o.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!==o[e])return!1;for(const o of r){if(!kf(e[o],t[o],i))return!1}return!0}(e,t,i)}return!1}var Pf=0,Mf=new WeakMap;function Tf(e){return Mf.has(e)||Mf.set(e,++Pf),Mf.get(e)}function Rf(){const e=new Set;return{emit:(t=void 0)=>e.forEach(e=>e(t)),on:t=>(e.add(t),()=>e.delete(t)),off:t=>e.delete(t),clear:()=>e.clear()}}function _f(e,t=kf){const i=new Set,r=new Map;let o=e;const n=(e,t)=>{let n=e,s=()=>{};if(t){const i=new Ef(e,t);n=i.handle,s=()=>i.destroy(),r.set(e,{wrapped:n,destroy:s})}return void 0!==o&&n(o),i.add(n),()=>{i.delete(n),s(),r.delete(e)}};return{get value(){return o},emit(e=void 0){(void 0===o||!t(o,e))&&(o=e,(e=>{i.forEach(t=>t(e))})(e))},on:n,off(e){const t=r.get(e);t?(i.delete(t.wrapped),t.destroy(),r.delete(e)):i.delete(e)},clear(){i.clear(),r.forEach(e=>e.destroy()),r.clear()},select:(e,t=kf)=>(i,r)=>{let s;if(void 0!==o){const t=e(o);s=t,i(t)}return n(r=>{const o=e(r);(void 0===s||!t(s,o))&&(s=o,i(o))},r)}}}var Nf=class extends Af{constructor(e,t){super(e,t),this.modes=new Map,this.cursorClaims=new Map,this.buckets=new Map,this.alwaysGlobal=new Set,this.alwaysPage=new Map,this.onModeChange$=Rf(),this.onHandlerChange$=Rf(),this.onCursorChange$=Rf(),this.onStateChange$=_f(),this.registerMode({id:"default",scope:"page",exclusive:!1,cursor:"auto"})}async initialize(e){}buildCapability(){return{activate:e=>this.activate(e),onModeChange:this.onModeChange$.on,onCursorChange:this.onCursorChange$.on,onHandlerChange:this.onHandlerChange$.on,onStateChange:this.onStateChange$.on,getActiveMode:()=>this.state.activeMode,getActiveInteractionMode:()=>this.getActiveInteractionMode(),finish:()=>this.activate("default"),registerMode:e=>this.registerMode(e),registerHandlers:e=>this.registerHandlers(e),registerAlways:e=>this.registerAlways(e),setCursor:(e,t,i=0)=>this.setCursor(e,t,i),removeCursor:e=>this.removeCursor(e),getCurrentCursor:()=>this.state.cursor,getHandlersForScope:e=>this.getHandlersForScope(e),activeModeIsExclusive:()=>this.activeModeIsExclusive(),pause:()=>this.dispatch({type:"INTERACTION/PAUSE"}),resume:()=>this.dispatch({type:"INTERACTION/RESUME"}),isPaused:()=>this.state.paused}}activate(e){if(!this.modes.has(e))throw new Error(`[interaction] unknown mode '${e}'`);if(e===this.state.activeMode)return;const t=this.state.activeMode;this.cursorClaims.clear(),this.notifyHandlersInactive(t),this.dispatch((e=>({type:"INTERACTION/ACTIVATE_MODE",payload:{mode:e}}))(e)),this.emitCursor(),this.notifyHandlersActive(e),this.onModeChange$.emit({...this.state,activeMode:e})}notifyHandlersActive(e){this.alwaysGlobal.forEach(t=>{var i;null==(i=t.onHandlerActiveStart)||i.call(t,e)}),this.alwaysPage.forEach(t=>{t.forEach(t=>{var i;null==(i=t.onHandlerActiveStart)||i.call(t,e)})});const t=this.modes.get(e);if(!t)return;const i=this.buckets.get(e);i&&("global"===t.scope&&i.global.forEach(t=>{var i;null==(i=t.onHandlerActiveStart)||i.call(t,e)}),"page"===t.scope&&i.page.forEach((t,i)=>{t.forEach(t=>{var i;null==(i=t.onHandlerActiveStart)||i.call(t,e)})}))}notifyHandlersInactive(e){this.alwaysGlobal.forEach(t=>{var i;null==(i=t.onHandlerActiveEnd)||i.call(t,e)}),this.alwaysPage.forEach(t=>{t.forEach(t=>{var i;null==(i=t.onHandlerActiveEnd)||i.call(t,e)})});const t=this.modes.get(e);if(!t)return;const i=this.buckets.get(e);i&&("global"===t.scope&&i.global.forEach(t=>{var i;null==(i=t.onHandlerActiveEnd)||i.call(t,e)}),"page"===t.scope&&i.page.forEach((t,i)=>{t.forEach(t=>{var i;null==(i=t.onHandlerActiveEnd)||i.call(t,e)})}))}registerMode(e){this.modes.set(e.id,e),this.buckets.has(e.id)||this.buckets.set(e.id,{global:new Set,page:new Map})}registerHandlers({modeId:e,handlers:t,pageIndex:i}){const r=Array.isArray(e)?e:[e],o=[];for(const e of r){const r=this.buckets.get(e);if(!r)throw new Error(`unknown mode '${e}'`);if(null==i)r.global.add(t);else{const e=r.page.get(i)??new Set;e.add(t),r.page.set(i,e)}o.push(()=>{if(null==i)r.global.delete(t);else{const e=r.page.get(i);e&&(e.delete(t),0===e.size&&r.page.delete(i))}})}return this.onHandlerChange$.emit({...this.state}),()=>{o.forEach(e=>e()),this.onHandlerChange$.emit({...this.state})}}registerAlways({scope:e,handlers:t}){if("global"===e.type)return this.alwaysGlobal.add(t),this.onHandlerChange$.emit({...this.state}),()=>this.alwaysGlobal.delete(t);const i=this.alwaysPage.get(e.pageIndex)??new Set;return i.add(t),this.alwaysPage.set(e.pageIndex,i),this.onHandlerChange$.emit({...this.state}),()=>{i.delete(t),this.onHandlerChange$.emit({...this.state})}}getHandlersForScope(e){if(!this.state)return null;const t=this.modes.get(this.state.activeMode);if(!t)return null;const i=this.buckets.get(t.id);if(!i)return null;const r=(e,t)=>e.size||t.size?function(e){const t=["onPointerDown","onPointerUp","onPointerMove","onPointerEnter","onPointerLeave","onPointerCancel"],i={};for(const r of t)i[r]=(t,i,o)=>{var n;for(const s of e)null==(n=s[r])||n.call(s,t,i,o)};return i}([...e,...t]):null;if("global"===e.type){const e="global"===t.scope?i.global:new Set;return r(this.alwaysGlobal,e)}return r(this.alwaysPage.get(e.pageIndex)??new Set,"page"===t.scope?i.page.get(e.pageIndex)??new Set:new Set)}setCursor(e,t,i=0){this.cursorClaims.set(e,{cursor:t,priority:i}),this.emitCursor()}removeCursor(e){this.cursorClaims.delete(e),this.emitCursor()}emitCursor(){var e;const t=[...this.cursorClaims.values()].sort((e,t)=>t.priority-e.priority)[0]??{cursor:(null==(e=this.modes.get(this.state.activeMode))?void 0:e.cursor)??"auto"};t.cursor!==this.state.cursor&&(this.dispatch((e=>({type:"INTERACTION/SET_CURSOR",payload:{cursor:e}}))(t.cursor)),this.onCursorChange$.emit(t.cursor))}onStoreUpdated(e,t){this.onStateChange$.emit(t)}activeModeIsExclusive(){const e=this.modes.get(this.state.activeMode);return!(null==e||!e.exclusive)}getActiveInteractionMode(){return this.modes.get(this.state.activeMode)??null}async destroy(){this.onModeChange$.clear(),this.onCursorChange$.clear(),await super.destroy()}};Nf.id="interaction-manager";var Of=Nf,zf=class extends Af{constructor(e,t){super(e,t),this.interactionManager=t.getPlugin(Of.id)?.provides(),this.interactionManager.registerMode({id:"panMode",scope:"global",exclusive:!1,cursor:"grab"})}async initialize(e){}buildCapability(){return{enablePan:()=>this.interactionManager.activate("panMode"),disablePan:()=>this.interactionManager.activate("default"),togglePan:()=>{"panMode"===this.interactionManager.getActiveMode()?this.interactionManager.activate("default"):this.interactionManager.activate("panMode")}}}};zf.id="pan";var Lf={manifest:{id:"pan",name:"Pan Plugin",version:"1.0.0",provides:["pan"],requires:["interaction-manager"],optional:[],defaultConfig:{enabled:!0}},create:e=>new zf("pan",e),reducer:()=>{},initialState:{}},Df="capture",Ff={id:Df,name:"Capture Plugin",version:"1.0.0",provides:["capture"],requires:["render","interaction-manager"],optional:[],defaultConfig:{enabled:!0,scale:1,imageType:"image/png",withAnnotations:!1}},Hf=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${Hf.join("")}]`,"g");var $f=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);$f.reduce((e,t)=>(e[t.id]=t,e),{}),$f.reduce((e,t)=>(e[t.css]=t.id,e),{}),$f.map(e=>({value:e.id,label:e.label}));var jf=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});function Uf(){}Object.entries(jf).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var Bf=class{constructor(e,t){if(this.id=e,this.registry=t,this.debouncedActions={},this.unsubscribeFromState=null,this.unsubscribeFromCoreStore=null,e!==this.constructor.id)throw new Error(`Plugin ID mismatch: ${e} !== ${this.constructor.id}`);this.coreStore=this.registry.getStore(),this.pluginStore=this.coreStore.getPluginStore(this.id),this.unsubscribeFromState=this.pluginStore.subscribeToState((e,t,i)=>{this.onStoreUpdated(i,t)}),this.unsubscribeFromCoreStore=this.coreStore.subscribe((e,t,i)=>{this.onCoreStoreUpdated(i,t)}),this.readyPromise=new Promise(e=>{this.readyResolve=e}),this.readyResolve()}provides(){if(!this._capability){const e=this.buildCapability();this._capability=Object.freeze(e)}return this._capability}get state(){return this.pluginStore.getState()}get coreState(){return this.coreStore.getState()}getState(){return this.pluginStore.getState()}getCoreState(){return this.coreStore.getState()}dispatchCoreAction(e){return this.coreStore.dispatchToCore(e)}dispatchToAllPlugins(e){return this.coreStore.dispatch(e)}dispatch(e){return this.pluginStore.dispatch(e)}debouncedDispatch(e,t=100){const i=Date.now();return i-(this.debouncedActions[e.type]||0)>=t&&(this.debouncedActions[e.type]=i,this.dispatch(e),!0)}subscribe(e){return this.pluginStore.subscribeToState(e)}subscribeToCoreStore(e){return this.coreStore.subscribe(e)}onStoreUpdated(e,t){}onCoreStoreUpdated(e,t){}destroy(){this.unsubscribeFromState&&(this.unsubscribeFromState(),this.unsubscribeFromState=null),this.unsubscribeFromCoreStore&&(this.unsubscribeFromCoreStore(),this.unsubscribeFromCoreStore=null)}ready(){return this.readyPromise}markReady(){this.readyResolve()}resetReady(){this.readyPromise=new Promise(e=>{this.readyResolve=e})}};var Gf=class extends Bf{constructor(e,t,i){super(e,t),this.captureArea$=function(){const e=new Set;return{emit:(t=void 0)=>e.forEach(e=>e(t)),on:t=>(e.add(t),()=>e.delete(t)),off:t=>e.delete(t),clear:()=>e.clear()}}(),this.config=i,this.renderCapability=this.registry.getPlugin("render").provides(),this.interactionManagerCapability=this.registry.getPlugin("interaction-manager").provides(),this.interactionManagerCapability.registerMode({id:"marqueeCapture",scope:"page",exclusive:!0,cursor:"crosshair"})}async initialize(e){}buildCapability(){return{onCaptureArea:this.captureArea$.on,captureArea:this.captureArea.bind(this),enableMarqueeCapture:this.enableMarqueeCapture.bind(this),disableMarqueeCapture:this.disableMarqueeCapture.bind(this),toggleMarqueeCapture:this.toggleMarqueeCapture.bind(this),isMarqueeCaptureActive:()=>"marqueeCapture"===this.interactionManagerCapability?.getActiveMode()}}captureArea(e,t){this.disableMarqueeCapture();this.renderCapability.renderPageRect({pageIndex:e,rect:t,imageType:this.config.imageType,scaleFactor:this.config.scale,options:{withAnnotations:this.config.withAnnotations||!1}}).wait(i=>{this.captureArea$.emit({pageIndex:e,rect:t,blob:i,imageType:this.config.imageType||"image/png",scale:this.config.scale||1,withAnnotations:this.config.withAnnotations||!1})},Uf)}enableMarqueeCapture(){this.interactionManagerCapability?.activate("marqueeCapture")}disableMarqueeCapture(){this.interactionManagerCapability?.activate("default")}toggleMarqueeCapture(){"marqueeCapture"===this.interactionManagerCapability?.getActiveMode()?this.interactionManagerCapability?.activate("default"):this.interactionManagerCapability?.activate("marqueeCapture")}};Gf.id="capture";var Vf={manifest:Ff,create:(e,t,i)=>new Gf(Df,e,i),reducer:()=>{},initialState:{}},Wf=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${Wf.join("")}]`,"g");var Zf=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);Zf.reduce((e,t)=>(e[t.id]=t,e),{}),Zf.reduce((e,t)=>(e[t.css]=t.id,e),{}),Zf.map(e=>({value:e.id,label:e.label}));var qf=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});Object.entries(qf).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var Xf=class{constructor(e,t){if(this.id=e,this.registry=t,this.debouncedActions={},this.unsubscribeFromState=null,this.unsubscribeFromCoreStore=null,e!==this.constructor.id)throw new Error(`Plugin ID mismatch: ${e} !== ${this.constructor.id}`);this.coreStore=this.registry.getStore(),this.pluginStore=this.coreStore.getPluginStore(this.id),this.unsubscribeFromState=this.pluginStore.subscribeToState((e,t,i)=>{this.onStoreUpdated(i,t)}),this.unsubscribeFromCoreStore=this.coreStore.subscribe((e,t,i)=>{this.onCoreStoreUpdated(i,t)}),this.readyPromise=new Promise(e=>{this.readyResolve=e}),this.readyResolve()}provides(){if(!this._capability){const e=this.buildCapability();this._capability=Object.freeze(e)}return this._capability}get state(){return this.pluginStore.getState()}get coreState(){return this.coreStore.getState()}getState(){return this.pluginStore.getState()}getCoreState(){return this.coreStore.getState()}dispatchCoreAction(e){return this.coreStore.dispatchToCore(e)}dispatchToAllPlugins(e){return this.coreStore.dispatch(e)}dispatch(e){return this.pluginStore.dispatch(e)}debouncedDispatch(e,t=100){const i=Date.now();return i-(this.debouncedActions[e.type]||0)>=t&&(this.debouncedActions[e.type]=i,this.dispatch(e),!0)}subscribe(e){return this.pluginStore.subscribeToState(e)}subscribeToCoreStore(e){return this.coreStore.subscribe(e)}onStoreUpdated(e,t){}onCoreStoreUpdated(e,t){}destroy(){this.unsubscribeFromState&&(this.unsubscribeFromState(),this.unsubscribeFromState=null),this.unsubscribeFromCoreStore&&(this.unsubscribeFromCoreStore(),this.unsubscribeFromCoreStore=null)}ready(){return this.readyPromise}markReady(){this.readyResolve()}resetReady(){this.readyPromise=new Promise(e=>{this.readyResolve=e})}},Kf=class{constructor(e,t){this.handler=e,this.options=t,this.lastRun=0,this.handle=e=>{"debounce"===this.options.mode?this.debounce(e):this.throttle(e)}}debounce(e){this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.timeoutId=void 0},this.options.wait)}throttle(e){if("debounce"===this.options.mode)return;const t=Date.now(),i=this.options.throttleMode||"leading-trailing";t-this.lastRun>=this.options.wait&&("leading-trailing"===i&&this.handler(e),this.lastRun=t),this.timeoutId&&window.clearTimeout(this.timeoutId),this.timeoutId=window.setTimeout(()=>{this.handler(e),this.lastRun=Date.now(),this.timeoutId=void 0},this.options.wait-(t-this.lastRun))}destroy(){this.timeoutId&&window.clearTimeout(this.timeoutId)}};function Yf(e,t,i){if(e===t)return!0;if(null==e||null==t)return e===t;const r=typeof e;if(r!==typeof t)return!1;if("object"===r){i||(i=new Set);const r=function(e,t){return`${em(e)}__${em(t)}`}(e,t);if(i.has(r))return!0;i.add(r);const o=Array.isArray(e),n=Array.isArray(t);return o&&n?function(e,t,i){if(e.length!==t.length)return!1;const r=new Array(t.length).fill(!1);e:for(let o=0;o<e.length;o++){const n=e[o];for(let e=0;e<t.length;e++)if(!r[e]&&Yf(n,t[e],i)){r[e]=!0;continue e}return!1}return!0}(e,t,i):!o&&!n&&function(e,t,i){const r=Object.keys(e).sort(),o=Object.keys(t).sort();if(r.length!==o.length)return!1;for(let e=0;e<r.length;e++)if(r[e]!==o[e])return!1;for(const o of r){if(!Yf(e[o],t[o],i))return!1}return!0}(e,t,i)}return!1}var Qf=0,Jf=new WeakMap;function em(e){return Jf.has(e)||Jf.set(e,++Qf),Jf.get(e)}function tm(){const e=new Set;return{emit:(t=void 0)=>e.forEach(e=>e(t)),on:t=>(e.add(t),()=>e.delete(t)),off:t=>e.delete(t),clear:()=>e.clear()}}function im(e,t=Yf){const i=new Set,r=new Map;let o=e;const n=(e,t)=>{let n=e,s=()=>{};if(t){const i=new Kf(e,t);n=i.handle,s=()=>i.destroy(),r.set(e,{wrapped:n,destroy:s})}return void 0!==o&&n(o),i.add(n),()=>{i.delete(n),s(),r.delete(e)}};return{get value(){return o},emit(e=void 0){(void 0===o||!t(o,e))&&(o=e,(e=>{i.forEach(t=>t(e))})(e))},on:n,off(e){const t=r.get(e);t?(i.delete(t.wrapped),t.destroy(),r.delete(e)):i.delete(e)},clear(){i.clear(),r.forEach(e=>e.destroy()),r.clear()},select:(e,t=Yf)=>(i,r)=>{let s;if(void 0!==o){const t=e(o);s=t,i(t)}return n(r=>{const o=e(r);(void 0===s||!t(s,o))&&(s=o,i(o))},r)}}}var rm=ce({registry:null,isInitializing:!0,pluginsReady:!1});function om(e){const{registry:t}=function(){const e=Ne(rm);if(void 0===e)throw new Error("useCapability must be used within a PDFContext.Provider");const{registry:t,isInitializing:i}=e;if(i)return e;if(null===t)throw new Error("PDF registry failed to initialize properly");return e}();if(null===t)return{plugin:null,isLoading:!0,ready:new Promise(()=>{})};const i=t.getPlugin(e);if(!i)throw new Error(`Plugin ${e} not found`);return{plugin:i,isLoading:!1,ready:i.ready()}}function nm(e){const{plugin:t,isLoading:i,ready:r}=om(e);if(!t)return{provides:null,isLoading:i,ready:r};if(!t.provides)throw new Error(`Plugin ${e} does not provide a capability`);return{provides:t.provides(),isLoading:i,ready:r}}var sm=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${sm.join("")}]`,"g");var am=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);am.reduce((e,t)=>(e[t.id]=t,e),{}),am.reduce((e,t)=>(e[t.css]=t.id,e),{}),am.map(e=>({value:e.id,label:e.label}));var lm=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});function cm(){}Object.entries(lm).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var dm=class{constructor(e,t){if(this.id=e,this.registry=t,this.debouncedActions={},this.unsubscribeFromState=null,this.unsubscribeFromCoreStore=null,e!==this.constructor.id)throw new Error(`Plugin ID mismatch: ${e} !== ${this.constructor.id}`);this.coreStore=this.registry.getStore(),this.pluginStore=this.coreStore.getPluginStore(this.id),this.unsubscribeFromState=this.pluginStore.subscribeToState((e,t,i)=>{this.onStoreUpdated(i,t)}),this.unsubscribeFromCoreStore=this.coreStore.subscribe((e,t,i)=>{this.onCoreStoreUpdated(i,t)}),this.readyPromise=new Promise(e=>{this.readyResolve=e}),this.readyResolve()}provides(){if(!this._capability){const e=this.buildCapability();this._capability=Object.freeze(e)}return this._capability}get state(){return this.pluginStore.getState()}get coreState(){return this.coreStore.getState()}getState(){return this.pluginStore.getState()}getCoreState(){return this.coreStore.getState()}dispatchCoreAction(e){return this.coreStore.dispatchToCore(e)}dispatchToAllPlugins(e){return this.coreStore.dispatch(e)}dispatch(e){return this.pluginStore.dispatch(e)}debouncedDispatch(e,t=100){const i=Date.now();return i-(this.debouncedActions[e.type]||0)>=t&&(this.debouncedActions[e.type]=i,this.dispatch(e),!0)}subscribe(e){return this.pluginStore.subscribeToState(e)}subscribeToCoreStore(e){return this.coreStore.subscribe(e)}onStoreUpdated(e,t){}onCoreStoreUpdated(e,t){}destroy(){this.unsubscribeFromState&&(this.unsubscribeFromState(),this.unsubscribeFromState=null),this.unsubscribeFromCoreStore&&(this.unsubscribeFromCoreStore(),this.unsubscribeFromCoreStore=null)}ready(){return this.readyPromise}markReady(){this.readyResolve()}resetReady(){this.readyPromise=new Promise(e=>{this.readyResolve=e})}};var um=class extends dm{constructor(e,t,i){super(e,t),this.captureArea$=function(){const e=new Set;return{emit:(t=void 0)=>e.forEach(e=>e(t)),on:t=>(e.add(t),()=>e.delete(t)),off:t=>e.delete(t),clear:()=>e.clear()}}(),this.config=i,this.renderCapability=this.registry.getPlugin("render").provides(),this.interactionManagerCapability=this.registry.getPlugin("interaction-manager").provides(),this.interactionManagerCapability.registerMode({id:"marqueeCapture",scope:"page",exclusive:!0,cursor:"crosshair"})}async initialize(e){}buildCapability(){return{onCaptureArea:this.captureArea$.on,captureArea:this.captureArea.bind(this),enableMarqueeCapture:this.enableMarqueeCapture.bind(this),disableMarqueeCapture:this.disableMarqueeCapture.bind(this),toggleMarqueeCapture:this.toggleMarqueeCapture.bind(this),isMarqueeCaptureActive:()=>"marqueeCapture"===this.interactionManagerCapability?.getActiveMode()}}captureArea(e,t){this.disableMarqueeCapture();this.renderCapability.renderPageRect({pageIndex:e,rect:t,imageType:this.config.imageType,scaleFactor:this.config.scale,options:{withAnnotations:this.config.withAnnotations||!1}}).wait(i=>{this.captureArea$.emit({pageIndex:e,rect:t,blob:i,imageType:this.config.imageType||"image/png",scale:this.config.scale||1,withAnnotations:this.config.withAnnotations||!1})},cm)}enableMarqueeCapture(){this.interactionManagerCapability?.activate("marqueeCapture")}disableMarqueeCapture(){this.interactionManagerCapability?.activate("default")}toggleMarqueeCapture(){"marqueeCapture"===this.interactionManagerCapability?.getActiveMode()?this.interactionManagerCapability?.activate("default"):this.interactionManagerCapability?.activate("marqueeCapture")}};um.id="capture";var hm=()=>nm(um.id);var pm=class extends Xf{constructor(e,t){super(e,t),this.modes=new Map,this.cursorClaims=new Map,this.buckets=new Map,this.alwaysGlobal=new Set,this.alwaysPage=new Map,this.onModeChange$=tm(),this.onHandlerChange$=tm(),this.onCursorChange$=tm(),this.onStateChange$=im(),this.registerMode({id:"default",scope:"page",exclusive:!1,cursor:"auto"})}async initialize(e){}buildCapability(){return{activate:e=>this.activate(e),onModeChange:this.onModeChange$.on,onCursorChange:this.onCursorChange$.on,onHandlerChange:this.onHandlerChange$.on,onStateChange:this.onStateChange$.on,getActiveMode:()=>this.state.activeMode,getActiveInteractionMode:()=>this.getActiveInteractionMode(),finish:()=>this.activate("default"),registerMode:e=>this.registerMode(e),registerHandlers:e=>this.registerHandlers(e),registerAlways:e=>this.registerAlways(e),setCursor:(e,t,i=0)=>this.setCursor(e,t,i),removeCursor:e=>this.removeCursor(e),getCurrentCursor:()=>this.state.cursor,getHandlersForScope:e=>this.getHandlersForScope(e),activeModeIsExclusive:()=>this.activeModeIsExclusive(),pause:()=>this.dispatch({type:"INTERACTION/PAUSE"}),resume:()=>this.dispatch({type:"INTERACTION/RESUME"}),isPaused:()=>this.state.paused}}activate(e){if(!this.modes.has(e))throw new Error(`[interaction] unknown mode '${e}'`);if(e===this.state.activeMode)return;const t=this.state.activeMode;this.cursorClaims.clear(),this.notifyHandlersInactive(t),this.dispatch((e=>({type:"INTERACTION/ACTIVATE_MODE",payload:{mode:e}}))(e)),this.emitCursor(),this.notifyHandlersActive(e),this.onModeChange$.emit({...this.state,activeMode:e})}notifyHandlersActive(e){this.alwaysGlobal.forEach(t=>{var i;null==(i=t.onHandlerActiveStart)||i.call(t,e)}),this.alwaysPage.forEach(t=>{t.forEach(t=>{var i;null==(i=t.onHandlerActiveStart)||i.call(t,e)})});const t=this.modes.get(e);if(!t)return;const i=this.buckets.get(e);i&&("global"===t.scope&&i.global.forEach(t=>{var i;null==(i=t.onHandlerActiveStart)||i.call(t,e)}),"page"===t.scope&&i.page.forEach((t,i)=>{t.forEach(t=>{var i;null==(i=t.onHandlerActiveStart)||i.call(t,e)})}))}notifyHandlersInactive(e){this.alwaysGlobal.forEach(t=>{var i;null==(i=t.onHandlerActiveEnd)||i.call(t,e)}),this.alwaysPage.forEach(t=>{t.forEach(t=>{var i;null==(i=t.onHandlerActiveEnd)||i.call(t,e)})});const t=this.modes.get(e);if(!t)return;const i=this.buckets.get(e);i&&("global"===t.scope&&i.global.forEach(t=>{var i;null==(i=t.onHandlerActiveEnd)||i.call(t,e)}),"page"===t.scope&&i.page.forEach((t,i)=>{t.forEach(t=>{var i;null==(i=t.onHandlerActiveEnd)||i.call(t,e)})}))}registerMode(e){this.modes.set(e.id,e),this.buckets.has(e.id)||this.buckets.set(e.id,{global:new Set,page:new Map})}registerHandlers({modeId:e,handlers:t,pageIndex:i}){const r=Array.isArray(e)?e:[e],o=[];for(const e of r){const r=this.buckets.get(e);if(!r)throw new Error(`unknown mode '${e}'`);if(null==i)r.global.add(t);else{const e=r.page.get(i)??new Set;e.add(t),r.page.set(i,e)}o.push(()=>{if(null==i)r.global.delete(t);else{const e=r.page.get(i);e&&(e.delete(t),0===e.size&&r.page.delete(i))}})}return this.onHandlerChange$.emit({...this.state}),()=>{o.forEach(e=>e()),this.onHandlerChange$.emit({...this.state})}}registerAlways({scope:e,handlers:t}){if("global"===e.type)return this.alwaysGlobal.add(t),this.onHandlerChange$.emit({...this.state}),()=>this.alwaysGlobal.delete(t);const i=this.alwaysPage.get(e.pageIndex)??new Set;return i.add(t),this.alwaysPage.set(e.pageIndex,i),this.onHandlerChange$.emit({...this.state}),()=>{i.delete(t),this.onHandlerChange$.emit({...this.state})}}getHandlersForScope(e){if(!this.state)return null;const t=this.modes.get(this.state.activeMode);if(!t)return null;const i=this.buckets.get(t.id);if(!i)return null;const r=(e,t)=>e.size||t.size?function(e){const t=["onPointerDown","onPointerUp","onPointerMove","onPointerEnter","onPointerLeave","onPointerCancel"],i={};for(const r of t)i[r]=(t,i,o)=>{var n;for(const s of e)null==(n=s[r])||n.call(s,t,i,o)};return i}([...e,...t]):null;if("global"===e.type){const e="global"===t.scope?i.global:new Set;return r(this.alwaysGlobal,e)}return r(this.alwaysPage.get(e.pageIndex)??new Set,"page"===t.scope?i.page.get(e.pageIndex)??new Set:new Set)}setCursor(e,t,i=0){this.cursorClaims.set(e,{cursor:t,priority:i}),this.emitCursor()}removeCursor(e){this.cursorClaims.delete(e),this.emitCursor()}emitCursor(){var e;const t=[...this.cursorClaims.values()].sort((e,t)=>t.priority-e.priority)[0]??{cursor:(null==(e=this.modes.get(this.state.activeMode))?void 0:e.cursor)??"auto"};t.cursor!==this.state.cursor&&(this.dispatch((e=>({type:"INTERACTION/SET_CURSOR",payload:{cursor:e}}))(t.cursor)),this.onCursorChange$.emit(t.cursor))}onStoreUpdated(e,t){this.onStateChange$.emit(t)}activeModeIsExclusive(){const e=this.modes.get(this.state.activeMode);return!(null==e||!e.exclusive)}getActiveInteractionMode(){return this.modes.get(this.state.activeMode)??null}async destroy(){this.onModeChange$.clear(),this.onCursorChange$.clear(),await super.destroy()}};pm.id="interaction-manager";var gm=pm;function fm({modeId:e,pageIndex:t}){const{provides:i}=nm(gm.id);return{register:(r,o)=>{const n=(null==o?void 0:o.modeId)??e,s=(null==o?void 0:o.pageIndex)??t;return n?null==i?void 0:i.registerHandlers({modeId:n,handlers:r,pageIndex:s}):null==i?void 0:i.registerAlways({scope:void 0!==s?{type:"page",pageIndex:s}:{type:"global"},handlers:r})}}}var mm=({pageIndex:e,scale:t,pageWidth:i,pageHeight:r,className:o,stroke:n="rgba(33,150,243,0.8)",fill:s="rgba(33,150,243,0.15)"})=>{const{provides:a}=hm(),{register:l}=fm({modeId:"marqueeCapture",pageIndex:e}),c=(e,t,i)=>Math.max(t,Math.min(i,e)),d=Te(null),[u,h]=ke(null),p=i/t,g=r/t,f=Re(()=>({onPointerDown:(e,t)=>{d.current=e,h({origin:{x:e.x,y:e.y},size:{width:0,height:0}}),t.target?.setPointerCapture?.(t.pointerId)},onPointerMove:e=>{if(!d.current)return;const t=c(e.x,0,p),i=c(e.y,0,g),{x:r,y:o}=d.current,n=Math.min(r,t),s=Math.min(o,i),a=Math.abs(t-r),l=Math.abs(i-o);h({origin:{x:n,y:s},size:{width:a,height:l}})},onPointerUp:(i,r)=>{if(u&&a){Math.max(u.size.width,u.size.height)*t>5&&a.captureArea(e,u)}d.current=null,h(null),r.target?.releasePointerCapture?.(r.pointerId)},onPointerCancel:(e,t)=>{d.current=null,h(null),t.target?.releasePointerCapture?.(t.pointerId)}}),[p,p,a,t,u,e]);return Pe(()=>{if(l)return l(f)},[l,f]),u?he("div",{style:{position:"absolute",pointerEvents:"none",left:u.origin.x*t,top:u.origin.y*t,width:u.size.width*t,height:u.size.height*t,border:`1px solid ${n}`,background:s,boxSizing:"border-box"},className:o}):null},bm="history",vm={id:bm,name:"History Plugin",version:"1.0.0",provides:["history"],requires:[],optional:[],defaultConfig:{enabled:!0}},ym=Object.freeze(["","","","\ufeff","",""]);new RegExp(`[${ym.join("")}]`,"g");var wm=Object.freeze([{id:0,label:"Normal",css:"normal"},{id:1,label:"Multiply",css:"multiply"},{id:2,label:"Screen",css:"screen"},{id:3,label:"Overlay",css:"overlay"},{id:4,label:"Darken",css:"darken"},{id:5,label:"Lighten",css:"lighten"},{id:6,label:"Color Dodge",css:"color-dodge"},{id:7,label:"Color Burn",css:"color-burn"},{id:8,label:"Hard Light",css:"hard-light"},{id:9,label:"Soft Light",css:"soft-light"},{id:10,label:"Difference",css:"difference"},{id:11,label:"Exclusion",css:"exclusion"},{id:12,label:"Hue",css:"hue"},{id:13,label:"Saturation",css:"saturation"},{id:14,label:"Color",css:"color"},{id:15,label:"Luminosity",css:"luminosity"}]);wm.reduce((e,t)=>(e[t.id]=t,e),{}),wm.reduce((e,t)=>(e[t.css]=t.id,e),{}),wm.map(e=>({value:e.id,label:e.label}));var Sm=Object.freeze({1:"invisible",2:"hidden",4:"print",8:"noZoom",16:"noRotate",32:"noView",64:"readOnly",128:"locked",256:"toggleNoView"});Object.entries(Sm).reduce((e,[t,i])=>(e[i]=Number(t),e),{});var Cm=class{constructor(e,t){if(this.id=e,this.registry=t,this.debouncedActions={},this.unsubscribeFromState=null,this.unsubscribeFromCoreStore=null,e!==this.constructor.id)throw new Error(`Plugin ID mismatch: ${e} !== ${this.constructor.id}`);this.coreStore=this.registry.getStore(),this.pluginStore=this.coreStore.getPluginStore(this.id),this.unsubscribeFromState=this.pluginStore.subscribeToState((e,t,i)=>{this.onStoreUpdated(i,t)}),this.unsubscribeFromCoreStore=this.coreStore.subscribe((e,t,i)=>{this.onCoreStoreUpdated(i,t)}),this.readyPromise=new Promise(e=>{this.readyResolve=e}),this.readyResolve()}provides(){if(!this._capability){const e=this.buildCapability();this._capability=Object.freeze(e)}return this._capability}get state(){return this.pluginStore.getState()}get coreState(){return this.coreStore.getState()}getState(){return this.pluginStore.getState()}getCoreState(){return this.coreStore.getState()}dispatchCoreAction(e){return this.coreStore.dispatchToCore(e)}dispatchToAllPlugins(e){return this.coreStore.dispatch(e)}dispatch(e){return this.pluginStore.dispatch(e)}debouncedDispatch(e,t=100){const i=Date.now();return i-(this.debouncedActions[e.type]||0)>=t&&(this.debouncedActions[e.type]=i,this.dispatch(e),!0)}subscribe(e){return this.pluginStore.subscribeToState(e)}subscribeToCoreStore(e){return this.coreStore.subscribe(e)}onStoreUpdated(e,t){}onCoreStoreUpdated(e,t){}destroy(){this.unsubscribeFromState&&(this.unsubscribeFromState(),this.unsubscribeFromState=null),this.unsubscribeFromCoreStore&&(this.unsubscribeFromCoreStore(),this.unsubscribeFromCoreStore=null)}ready(){return this.readyPromise}markReady(){this.readyResolve()}resetReady(){this.readyPromise=new Promise(e=>{this.readyResolve=e})}};var xm="HISTORY/SET_STATE",Im=class extends Cm{constructor(e,t){super(e,t),this.topicHistories=new Map,this.globalTimeline=[],this.globalIndex=-1,this.historyChange$=function(){const e=new Set;return{emit:(t=void 0)=>e.forEach(e=>e(t)),on:t=>(e.add(t),()=>e.delete(t)),off:t=>e.delete(t),clear:()=>e.clear()}}()}async initialize(e){}getHistoryState(){const e={};return Array.from(this.topicHistories.entries()).forEach(([t,i])=>{e[t]={canUndo:i.currentIndex>-1,canRedo:i.currentIndex<i.commands.length-1}}),{global:{canUndo:this.globalIndex>-1,canRedo:this.globalIndex<this.globalTimeline.length-1},topics:e}}emitHistoryChange(e){var t;this.dispatch((t=this.getHistoryState(),{type:xm,payload:t})),this.historyChange$.emit(e)}buildCapability(){return{getHistoryState:()=>this.state,onHistoryChange:this.historyChange$.on,register:(e,t)=>{this.topicHistories.has(t)||this.topicHistories.set(t,{commands:[],currentIndex:-1});const i=this.topicHistories.get(t);i.commands.splice(i.currentIndex+1),i.commands.push(e),i.currentIndex++;const r={command:e,topic:t};this.globalTimeline.splice(this.globalIndex+1),this.globalTimeline.push(r),this.globalIndex++,e.execute(),this.emitHistoryChange(t)},undo:e=>{let t;if(e){const i=this.topicHistories.get(e);i&&i.currentIndex>-1&&(i.commands[i.currentIndex].undo(),i.currentIndex--,t=e)}else if(this.globalIndex>-1){const e=this.globalTimeline[this.globalIndex];e.command.undo(),this.topicHistories.get(e.topic).currentIndex--,this.globalIndex--,t=e.topic}t&&this.emitHistoryChange(t)},redo:e=>{let t;if(e){const i=this.topicHistories.get(e);i&&i.currentIndex<i.commands.length-1&&(i.currentIndex++,i.commands[i.currentIndex].execute(),t=e)}else if(this.globalIndex<this.globalTimeline.length-1){this.globalIndex++;const e=this.globalTimeline[this.globalIndex];e.command.execute(),this.topicHistories.get(e.topic).currentIndex++,t=e.topic}t&&this.emitHistoryChange(t)},canUndo:e=>{if(e){const t=this.topicHistories.get(e);return!!t&&t.currentIndex>-1}return this.globalIndex>-1},canRedo:e=>{if(e){const t=this.topicHistories.get(e);return!!t&&t.currentIndex<t.commands.length-1}return this.globalIndex<this.globalTimeline.length-1}}}};Im.id="history";var Am={global:{canUndo:!1,canRedo:!1},topics:{}},Em={manifest:vm,create:(e,t)=>new Im(bm,e),reducer:(e=Am,t)=>t.type===xm?{...e,...t.payload}:e,initialState:Am};function km(){var e=hm().provides,t=v(ke(!1),2),i=t[0],r=t[1],o=v(ke(null),2),n=o[0],s=o[1],a=v(ke(null),2),l=a[0],c=a[1],d=v(ke(null),2),u=d[0],h=d[1],p=Te(null),g=Te(null),f=function(){p.current&&(URL.revokeObjectURL(p.current),p.current=null),u&&(URL.revokeObjectURL(u),h(null)),r(!1),s(null),c(null)};Pe(function(){if(e)return e.onCaptureArea(function(e){var t=e.pageIndex,i=e.rect,o=e.blob;s({pageIndex:t,rect:i,blob:o});var n=URL.createObjectURL(o);p.current=n,c(n),r(!0)})},[e]);return j(B,null,j(wl,{open:i,onClose:f,title:"Capture PDF Area"},j("div",{className:"space-y-6"},j("div",{className:"flex justify-center"},l&&j("img",{src:l,onLoad:function(){p.current&&(URL.revokeObjectURL(p.current),p.current=null)},alt:"Captured PDF area",style:{maxWidth:"100%",maxHeight:"400px",border:"1px solid #e5e7eb",borderRadius:"4px",display:"block"}})),j("div",{className:"flex justify-end space-x-3 border-t border-gray-200 pt-4"},j(_r,{onClick:f,className:"rounded-md border border-gray-300 bg-white px-4 py-2 text-sm text-gray-700 hover:bg-gray-50"},"Cancel"),j(_r,{onClick:function(){if(n&&g.current){var e=URL.createObjectURL(n.blob);h(e),g.current.href=e,g.current.download="pdf-capture-page-".concat(n.pageIndex+1,".png"),g.current.click(),f()}},disabled:!n,className:"rounded-md border border-transparent bg-blue-600 px-4 py-2 text-sm text-white hover:!bg-blue-700 disabled:cursor-not-allowed disabled:opacity-50"},"Download")))),j("a",{ref:g,style:{display:"none"},href:"",download:""}))}var Pm=function(){var e=function(){const{provides:e}=hl(),[t,i]=ke(dl);return Pe(()=>{if(e)return e.onStateChange(e=>{i(e)})},[e]),{provides:e,state:t}}(),t=e.provides,i=v(ke({show:!1,mode:null,isAnimating:!1}),2),r=i[0],o=i[1];Pe(function(){if(t)return t.onModeChange(function(e){var t=e.activeMode;if("marqueeZoom"===t||"marqueeCapture"===t){o({show:!0,mode:t,isAnimating:!0});var i=setTimeout(function(){o(function(e){return p(p({},e),{},{show:!1})})},3e3);return function(){return clearTimeout(i)}}o({show:!1,mode:null,isAnimating:!1})})},[t]);if(!r.show&&!r.isAnimating)return null;var n="marqueeZoom"===r.mode?"Drag to select area to zoom":"Drag to select area to capture",s="marqueeZoom"===r.mode?"rgba(33,150,243,0.8)":"rgba(76,175,80,0.8)";return j("div",{className:"hint-overlay ".concat(r.show?"hint-show":"hint-hide"),onAnimationEnd:function(){r.show||o(function(e){return p(p({},e),{},{isAnimating:!1,mode:null})})},style:{position:"absolute",top:0,left:0,right:0,bottom:0,pointerEvents:"none",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",gap:"20px"}},j("div",{className:"hint-text",style:{background:"rgba(0, 0, 0, 0.8)",color:"white",padding:"12px 20px",borderRadius:"8px",fontSize:"14px",fontWeight:"500",textAlign:"center",maxWidth:"250px"}},n),j("div",{className:"drag-demo",style:{position:"relative",width:"150px",height:"100px"}},j("div",{style:{position:"absolute",top:"20px",left:"20px",width:"110px",height:"60px",border:"2px dashed ".concat(s),borderRadius:"4px",opacity:.6}}),j("div",{className:"animated-rect",style:{position:"absolute",top:"20px",left:"20px",border:"2px solid ".concat(s),backgroundColor:"".concat(s.replace("0.8","0.15")),borderRadius:"4px"}}),j("div",{className:"cursor-demo",style:{position:"absolute",width:"20px",height:"20px"}},j("svg",{width:"20",height:"20",viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg"},j("path",{d:"M3.5 2.5L16.5 10L10 11.5L7.5 16.5L3.5 2.5Z",fill:"rgba(0,0,0,0.3)",transform:"translate(1,1)"}),j("path",{d:"M3 2L16 10L10 11.5L7.5 16L3 2Z",fill:"white",stroke:"black",strokeWidth:"1"}),j("path",{d:"M4 3.5L13.5 9.5L9.5 10.5L7.5 14L4 3.5Z",fill:"rgba(255,255,255,0.8)"})))),j("style",{jsx:!0},"\n        .hint-overlay {\n          animation-duration: 0.3s;\n          animation-fill-mode: both;\n        }\n\n        .hint-show {\n          animation-name: hintFadeIn;\n        }\n\n        .hint-hide {\n          animation-name: hintFadeOut;\n        }\n\n        @keyframes hintFadeIn {\n          from {\n            opacity: 0;\n            transform: translateY(10px);\n          }\n          to {\n            opacity: 1;\n            transform: translateY(0);\n          }\n        }\n\n        @keyframes hintFadeOut {\n          from {\n            opacity: 1;\n            transform: translateY(0);\n          }\n          to {\n            opacity: 0;\n            transform: translateY(-10px);\n          }\n        }\n\n        .animated-rect {\n          animation: rectGrow 2s ease-in-out infinite;\n        }\n\n        @keyframes rectGrow {\n          0% {\n            width: 0;\n            height: 0;\n          }\n          50% {\n            width: 110px;\n            height: 60px;\n          }\n          100% {\n            width: 110px;\n            height: 60px;\n            opacity: 0.7;\n          }\n        }\n\n        .cursor-demo {\n          animation: cursorMove 2s ease-in-out infinite;\n        }\n\n        @keyframes cursorMove {\n          0% {\n            top: 20px;\n            left: 20px;\n          }\n          50% {\n            top: 50px;\n            left: 80px;\n          }\n          100% {\n            top: 80px;\n            left: 130px;\n          }\n        }\n\n        .hint-text {\n          animation: textPulse 0.6s ease-in-out;\n        }\n\n        @keyframes textPulse {\n          0% {\n            transform: scale(0.9);\n          }\n          50% {\n            transform: scale(1.05);\n          }\n          100% {\n            transform: scale(1);\n          }\n        }\n      "))},Mm={viewport:{viewportGap:10},scroll:{strategy:Si.Vertical},zoom:{defaultZoomLevel:nh.FitPage},spread:{defaultSpreadMode:$i.None},rotate:{defaultRotation:je.Degree0},tiling:{tileSize:768,overlapPx:2.5,extraRings:0},thumbnail:{width:150,gap:10,buffer:3,labelHeight:30},print:{batchSize:3}};var Tm={menuCtr:{id:"menuCtr",icon:"menu",label:"Menu",type:"menu",children:["openFile","download","enterFS","screenshot","print"],active:function(e){return"menuCtr"===e.plugins.ui.commandMenu.commandMenu.activeCommand}},download:{id:"download",icon:"download",label:"Download",type:"action",action:function(e){var t,i=null===(t=e.getPlugin(_g))||void 0===t?void 0:t.provides();i&&i.download()}},openFile:{id:"openFile",icon:"fileImport",label:"Open PDF",type:"action",action:function(e){var t,i=null===(t=e.getPlugin(Qi))||void 0===t?void 0:t.provides();i&&i.openFileDialog()}},enterFS:{id:"enterFS",icon:function(e){return e.plugins.fullscreen.isFullscreen?"fullscreenExit":"fullscreen"},label:function(e){return e.plugins.fullscreen.isFullscreen?"Exit full screen":"Enter full screen"},type:"action",action:function(e){var t,i=null===(t=e.getPlugin(zp))||void 0===t?void 0:t.provides();i&&(i.isFullscreen()?i.exitFullscreen():i.enableFullscreen())}},screenshot:{id:"screenshot",icon:"screenshot",label:"Screenshot",type:"action",action:function(e){var t,i=null===(t=e.getPlugin(Df))||void 0===t?void 0:t.provides();i&&(i.isMarqueeCaptureActive()?i.disableMarqueeCapture():i.enableMarqueeCapture())},active:function(e){return"marqueeCapture"===e.plugins[cl].activeMode}},save:{id:"save",icon:"save",label:"Save",type:"action",action:function(){console.log("save")}},print:{id:"print",icon:"print",label:"Print",type:"action",action:function(e,t){var i,r=null===(i=e.getPlugin(Mr))||void 0===i?void 0:i.provides();r&&r.updateComponentState({componentType:"floating",componentId:"printModal",patch:{open:!0}})}},settings:{id:"settings",icon:"settings",label:"Settings",dividerBefore:!0,type:"action",action:function(){console.log("settings")}},viewCtr:{id:"viewCtr",icon:"viewSettings",label:"View controls",type:"menu",children:["pageOrientation","scrollLayout","pageLayout","enterFS"],active:function(e){return"viewCtr"===e.plugins.ui.commandMenu.commandMenu.activeCommand}},pageOrientation:{id:"pageOrientation",label:"Page orientation",type:"group",children:["rotateClockwise","rotateCounterClockwise"]},rotateClockwise:{id:"rotateClockwise",label:"Rotate clockwise",icon:"rotateClockwise",type:"action",action:function(e){var t,i=null===(t=e.getPlugin(Th))||void 0===t?void 0:t.provides();i&&i.rotateForward()}},rotateCounterClockwise:{id:"rotateCounterClockwise",label:"Rotate counter clockwise",icon:"rotateCounterClockwise",type:"action",action:function(e){var t,i=null===(t=e.getPlugin(Th))||void 0===t?void 0:t.provides();i&&i.rotateBackward()}},scrollLayout:{id:"scrollLayout",label:"Scroll layout",type:"group",children:["vertical","horizontal"]},vertical:{id:"vertical",label:"Vertical",icon:"vertical",type:"action",active:function(e){return e.plugins.scroll.strategy===Si.Vertical},action:function(e){var t,i=null===(t=e.getPlugin(Ti))||void 0===t?void 0:t.provides();i&&i.setScrollStrategy(Si.Vertical)}},horizontal:{id:"horizontal",label:"Horizontal",icon:"horizontal",type:"action",active:function(e){return e.plugins.scroll.strategy===Si.Horizontal},action:function(e){var t,i=null===(t=e.getPlugin(Ti))||void 0===t?void 0:t.provides();i&&i.setScrollStrategy(Si.Horizontal)}},pageLayout:{id:"pageLayout",label:"Page layout",type:"group",children:["singlePage","doublePage","coverFacingPage"]},singlePage:{id:"singlePage",label:"Single page",icon:"singlePage",type:"action",disabled:function(e){return e.plugins.scroll.strategy===Si.Horizontal},active:function(e){return e.plugins.spread.spreadMode===$i.None},action:function(e){var t,i=null===(t=e.getPlugin(Gi))||void 0===t?void 0:t.provides();i&&i.setSpreadMode($i.None)}},doublePage:{id:"doublePage",label:"Double page",icon:"book",type:"action",disabled:function(e){return e.plugins.scroll.strategy===Si.Horizontal},active:function(e){return e.plugins.spread.spreadMode===$i.Odd},action:function(e){var t,i=null===(t=e.getPlugin(Gi))||void 0===t?void 0:t.provides();i&&i.setSpreadMode($i.Odd)}},coverFacingPage:{id:"coverFacingPage",label:"Cover facing page",icon:"book2",type:"action",disabled:function(e){return e.plugins.scroll.strategy===Si.Horizontal},active:function(e){return e.plugins.spread.spreadMode===$i.Even},action:function(e){var t,i=null===(t=e.getPlugin(Gi))||void 0===t?void 0:t.provides();i&&i.setSpreadMode($i.Even)}},leftAction:{id:"leftAction",label:"Left action",type:"menu",icon:"dots",children:["viewCtr","zoom"],active:function(e){return"leftAction"===e.plugins.ui.commandMenu.commandMenu.activeCommand||"zoom"===e.plugins.ui.commandMenu.commandMenu.activeCommand||"changeZoomLevel"===e.plugins.ui.commandMenu.commandMenu.activeCommand||"viewCtr"===e.plugins.ui.commandMenu.commandMenu.activeCommand}},zoom:{id:"zoom",icon:"zoomIn",label:"Zoom Controls",type:"menu",children:["changeZoomLevel","zoomIn","zoomOut","fitToWidth","fitToPage","zoomInArea"],active:function(e){return"zoom"===e.plugins.ui.commandMenu.commandMenu.activeCommand}},zoomInArea:{id:"zoomInArea",label:"Zoom in area",icon:"zoomInArea",type:"action",dividerBefore:!0,action:function(e){var t,i=null===(t=e.getPlugin(sh))||void 0===t?void 0:t.provides();i&&(i.isMarqueeZoomActive()?i.disableMarqueeZoom():i.enableMarqueeZoom())},active:function(e){return"marqueeZoom"===e.plugins[cl].activeMode}},changeZoomLevel:{id:"changeZoomLevel",label:function(e){return"Zoom level (".concat((100*e.plugins.zoom.currentZoomLevel).toFixed(0),"%)")},type:"menu",children:["zoom25","zoom50","zoom100","zoom125","zoom150","zoom200","zoom400","zoom800","zoom1600"],active:function(e){return"changeZoomLevel"===e.plugins.ui.commandMenu.commandMenu.activeCommand}},zoom25:{id:"zoom25",label:"25%",type:"action",active:function(e){return.25===e.plugins.zoom.currentZoomLevel},action:function(e){var t,i=null===(t=e.getPlugin(sh))||void 0===t?void 0:t.provides();i&&i.requestZoom(.25)}},zoom50:{id:"zoom50",label:"50%",type:"action",active:function(e){return.5===e.plugins.zoom.currentZoomLevel},action:function(e){var t,i=null===(t=e.getPlugin(sh))||void 0===t?void 0:t.provides();i&&i.requestZoom(.5)}},zoom100:{id:"zoom100",label:"100%",type:"action",active:function(e){return 1===e.plugins.zoom.currentZoomLevel},action:function(e){var t,i=null===(t=e.getPlugin(sh))||void 0===t?void 0:t.provides();i&&i.requestZoom(1)}},zoom125:{id:"zoom125",label:"125%",type:"action",active:function(e){return 1.25===e.plugins.zoom.currentZoomLevel},action:function(e){var t,i=null===(t=e.getPlugin(sh))||void 0===t?void 0:t.provides();i&&i.requestZoom(1.25)}},zoom150:{id:"zoom150",label:"150%",type:"action",active:function(e){return 1.5===e.plugins.zoom.currentZoomLevel},action:function(e){var t,i=null===(t=e.getPlugin(sh))||void 0===t?void 0:t.provides();i&&i.requestZoom(1.5)}},zoom200:{id:"zoom200",label:"200%",type:"action",active:function(e){return 2===e.plugins.zoom.currentZoomLevel},action:function(e){var t,i=null===(t=e.getPlugin(sh))||void 0===t?void 0:t.provides();i&&i.requestZoom(2)}},zoom400:{id:"zoom400",label:"400%",type:"action",active:function(e){return 4===e.plugins.zoom.currentZoomLevel},action:function(e){var t,i=null===(t=e.getPlugin(sh))||void 0===t?void 0:t.provides();i&&i.requestZoom(4)}},zoom800:{id:"zoom800",label:"800%",type:"action",active:function(e){return 8===e.plugins.zoom.currentZoomLevel},action:function(e){var t,i=null===(t=e.getPlugin(sh))||void 0===t?void 0:t.provides();i&&i.requestZoom(8)}},zoom1600:{id:"zoom1600",label:"1600%",type:"action",active:function(e){return 16===e.plugins.zoom.currentZoomLevel},action:function(e){var t,i=null===(t=e.getPlugin(sh))||void 0===t?void 0:t.provides();i&&i.requestZoom(16)}},zoomIn:{id:"zoomIn",label:"Zoom in",icon:"zoomIn",type:"action",action:function(e){var t,i=null===(t=e.getPlugin(sh))||void 0===t?void 0:t.provides();i&&i.zoomIn()}},zoomOut:{id:"zoomOut",label:"Zoom out",icon:"zoomOut",type:"action",action:function(e){var t,i=null===(t=e.getPlugin(sh))||void 0===t?void 0:t.provides();i&&i.zoomOut()}},search:{id:"search",label:"Search",icon:"search",type:"action",action:function(e){var t,i=null===(t=e.getPlugin(Mr))||void 0===t?void 0:t.provides();i&&i.togglePanel({id:"rightPanel",visibleChild:"search"})},active:function(e){return!0===e.plugins.ui.panel.rightPanel.open&&"search"===e.plugins.ui.panel.rightPanel.visibleChild}},comment:{id:"comment",label:"Comment",icon:"comment",type:"action",action:function(e){var t,i=null===(t=e.getPlugin(Mr))||void 0===t?void 0:t.provides();i&&i.togglePanel({id:"rightPanel",visibleChild:"comment"})},active:function(e){return!0===e.plugins.ui.panel.rightPanel.open&&"comment"===e.plugins.ui.panel.rightPanel.visibleChild}},fitToWidth:{id:"fitToWidth",label:"Fit to width",icon:"fitToWidth",type:"action",active:function(e){return e.plugins.zoom.zoomLevel===nh.FitWidth},action:function(e){var t,i=null===(t=e.getPlugin(sh))||void 0===t?void 0:t.provides();i&&i.requestZoom(nh.FitWidth)}},fitToPage:{id:"fitToPage",label:"Fit to page",icon:"fitToPage",type:"action",active:function(e){return e.plugins.zoom.zoomLevel===nh.FitPage},action:function(e){var t,i=null===(t=e.getPlugin(sh))||void 0===t?void 0:t.provides();i&&i.requestZoom(nh.FitPage)}},sidebar:{id:"sidebar",label:"Sidebar",icon:"sidebar",type:"action",action:function(e,t){var i,r=null===(i=e.getPlugin(Mr))||void 0===i?void 0:i.provides();r&&r.togglePanel({id:"leftPanel",visibleChild:"leftPanelMain",open:!0!==t.plugins.ui.panel.leftPanel.open||"leftPanelMain"!==t.plugins.ui.panel.leftPanel.visibleChild})},active:function(e){return!0===e.plugins.ui.panel.leftPanel.open&&"leftPanelMain"===e.plugins.ui.panel.leftPanel.visibleChild}},sidebarMenu:{id:"sidebarMenu",label:"Sidebar Menu",type:"menu",children:["thumbnails","outline"]},thumbnails:{id:"thumbnails",label:"Thumbnails",icon:"squares",type:"action",action:function(e){var t,i=null===(t=e.getPlugin(Mr))||void 0===t?void 0:t.provides();i&&(i.togglePanel({id:"leftPanel",visibleChild:"leftPanelMain",open:!0}),i.updateComponentState({componentType:"custom",componentId:"leftPanelMain",patch:{visibleChild:"thumbnails"}}))},active:function(e){return"thumbnails"===e.plugins.ui.custom.leftPanelMain.visibleChild}},outline:{id:"outline",label:"Outline",icon:"listTree",type:"action",action:function(e){var t,i=null===(t=e.getPlugin(Mr))||void 0===t?void 0:t.provides();i&&(i.togglePanel({id:"leftPanel",visibleChild:"leftPanelMain",open:!0}),i.updateComponentState({componentType:"custom",componentId:"leftPanelMain",patch:{visibleChild:"outline"}}))},active:function(e){return"outline"===e.plugins.ui.custom.leftPanelMain.visibleChild}},attachments:{id:"attachments",label:"Attachments",icon:"paperclip",type:"action",action:function(e){var t,i=null===(t=e.getPlugin(Mr))||void 0===t?void 0:t.provides();i&&(i.togglePanel({id:"leftPanel",visibleChild:"leftPanelMain",open:!0}),i.updateComponentState({componentType:"custom",componentId:"leftPanelMain",patch:{visibleChild:"attachments"}}))},active:function(e){return"attachments"===e.plugins.ui.custom.leftPanelMain.visibleChild}},view:{id:"view",label:"View",type:"action",action:function(e){var t,i,r=null===(t=e.getPlugin(Mr))||void 0===t?void 0:t.provides(),o=null===(i=e.getPlugin(su))||void 0===i?void 0:i.provides();r&&(r.setHeaderVisible({id:"toolsHeader",visible:!1}),null==o||o.setActiveVariant(null))},active:function(e){return!1===e.plugins.ui.header.toolsHeader.visible}},annotate:{id:"annotate",label:"Annotate",type:"action",action:function(e){var t,i=null===(t=e.getPlugin(Mr))||void 0===t?void 0:t.provides();i&&i.setHeaderVisible({id:"toolsHeader",visible:!0,visibleChild:"annotationTools"})},active:function(e){return!0===e.plugins.ui.header.toolsHeader.visible&&"annotationTools"===e.plugins.ui.header.toolsHeader.visibleChild}},shapes:{id:"shapes",label:"Shapes",type:"action",action:function(e){var t,i=null===(t=e.getPlugin(Mr))||void 0===t?void 0:t.provides();i&&i.setHeaderVisible({id:"toolsHeader",visible:!0,visibleChild:"shapeTools"})},active:function(e){return!0===e.plugins.ui.header.toolsHeader.visible&&"shapeTools"===e.plugins.ui.header.toolsHeader.visibleChild}},fillAndSign:{id:"fillAndSign",label:"Fill and Sign",type:"action",action:function(e){var t,i=null===(t=e.getPlugin(Mr))||void 0===t?void 0:t.provides();i&&i.setHeaderVisible({id:"toolsHeader",visible:!0,visibleChild:"fillAndSignTools"})},active:function(e){return!0===e.plugins.ui.header.toolsHeader.visible&&"fillAndSignTools"===e.plugins.ui.header.toolsHeader.visibleChild}},form:{id:"form",label:"Form",type:"action",action:function(e){var t,i=null===(t=e.getPlugin(Mr))||void 0===t?void 0:t.provides();i&&i.setHeaderVisible({id:"toolsHeader",visible:!0,visibleChild:"formTools"})},active:function(e){return!0===e.plugins.ui.header.toolsHeader.visible&&"formTools"===e.plugins.ui.header.toolsHeader.visibleChild}},tabOverflow:{id:"tabOverflow",label:"More",icon:"dots",type:"menu",children:["view","annotate"],active:function(e){return"tabOverflow"===e.plugins.ui.commandMenu.commandMenu.activeCommand}},nextPage:{id:"nextPage",label:"Next page",icon:"chevronRight",shortcut:"ArrowRight",shortcutLabel:"Arrow Right",type:"action",action:function(e){var t,i=null===(t=e.getPlugin(Ti))||void 0===t?void 0:t.provides();i&&i.scrollToNextPage()}},previousPage:{id:"previousPage",label:"Previous page",icon:"chevronLeft",type:"action",shortcut:"ArrowLeft",shortcutLabel:"Arrow Left",action:function(e){var t,i=null===(t=e.getPlugin(Ti))||void 0===t?void 0:t.provides();i&&i.scrollToPreviousPage()}},copy:{id:"copy",label:"Copy",icon:"copy",type:"action",shortcut:"Meta+C",shortcutLabel:"Cmd+C",action:function(e){var t,i=null===(t=e.getPlugin(Na))||void 0===t?void 0:t.provides();i&&(i.copyToClipboard(),i.clear())}},underline:{id:"underline",label:"Underline",type:"action",icon:"underline",action:function(e,t){var i,r=null===(i=e.getPlugin(su))||void 0===i?void 0:i.provides();r&&(t.plugins.annotation.activeVariant===Yu(gt.UNDERLINE)?r.setActiveVariant(null):r.setActiveVariant(Yu(gt.UNDERLINE)))},active:function(e){return e.plugins.annotation.activeVariant===Yu(gt.UNDERLINE)}},squiggly:{id:"squiggly",label:"Squiggly",type:"action",icon:"squiggly",action:function(e,t){var i,r=null===(i=e.getPlugin(su))||void 0===i?void 0:i.provides();r&&(t.plugins.annotation.activeVariant===Yu(gt.SQUIGGLY)?r.setActiveVariant(null):r.setActiveVariant(Yu(gt.SQUIGGLY)))},active:function(e){return e.plugins.annotation.activeVariant===Yu(gt.SQUIGGLY)}},strikethrough:{id:"strikethrough",label:"Strikethrough",type:"action",icon:"strikethrough",action:function(e,t){var i,r=null===(i=e.getPlugin(su))||void 0===i?void 0:i.provides();r&&(t.plugins.annotation.activeVariant===Yu(gt.STRIKEOUT)?r.setActiveVariant(null):r.setActiveVariant(Yu(gt.STRIKEOUT)))},active:function(e){return e.plugins.annotation.activeVariant===Yu(gt.STRIKEOUT)}},highlight:{id:"highlight",label:"Highlight",type:"action",icon:"highlight",action:function(e,t){var i,r=null===(i=e.getPlugin(su))||void 0===i?void 0:i.provides();r&&(t.plugins.annotation.activeVariant===Yu(gt.HIGHLIGHT)?r.setActiveVariant(null):r.setActiveVariant(Yu(gt.HIGHLIGHT)))},active:function(e){return e.plugins.annotation.activeVariant===Yu(gt.HIGHLIGHT)}},freehand:{id:"freehand",label:"Freehand",type:"action",icon:"pencilMarker",action:function(e,t){var i,r=null===(i=e.getPlugin(su))||void 0===i?void 0:i.provides();r&&(console.log(t.plugins.annotation.activeVariant),t.plugins.annotation.activeVariant===Yu(gt.INK)?r.setActiveVariant(null):(r.deselectAnnotation(),r.setActiveVariant(Yu(gt.INK))))},active:function(e){return e.plugins.annotation.activeVariant===Yu(gt.INK)}},squigglySelection:{id:"squigglySelection",label:"Squiggly Selection",type:"action",icon:"squiggly",action:function(e){var t,i,r=null===(t=e.getPlugin(su))||void 0===t?void 0:t.provides(),o=null===(i=e.getPlugin(Na))||void 0===i?void 0:i.provides();if(o&&r){var n,s=r.getToolDefaults(Yu(gt.SQUIGGLY)),l=a(o.getFormattedSelection());try{for(l.s();!(n=l.n()).done;){var c=n.value;r.createAnnotation(c.pageIndex,{id:Date.now()+Math.random(),type:gt.SQUIGGLY,color:s.color,opacity:s.opacity,pageIndex:c.pageIndex,rect:c.rect,segmentRects:c.segmentRects})}}catch(e){l.e(e)}finally{l.f()}o.clear()}}},underlineSelection:{id:"underlineSelection",label:"Underline Selection",type:"action",icon:"underline",action:function(e){var t,i,r=null===(t=e.getPlugin(su))||void 0===t?void 0:t.provides(),o=null===(i=e.getPlugin(Na))||void 0===i?void 0:i.provides();if(o&&r){var n,s=r.getToolDefaults(Yu(gt.UNDERLINE)),l=a(o.getFormattedSelection());try{for(l.s();!(n=l.n()).done;){var c=n.value;r.createAnnotation(c.pageIndex,{id:Date.now()+Math.random(),type:gt.UNDERLINE,color:s.color,opacity:s.opacity,pageIndex:c.pageIndex,rect:c.rect,segmentRects:c.segmentRects})}}catch(e){l.e(e)}finally{l.f()}o.clear()}}},strikethroughSelection:{id:"strikethroughSelection",label:"Strikethrough Selection",type:"action",icon:"strikethrough",action:function(e){var t,i,r=null===(t=e.getPlugin(su))||void 0===t?void 0:t.provides(),o=null===(i=e.getPlugin(Na))||void 0===i?void 0:i.provides();if(o&&r){var n,s=r.getToolDefaults(Yu(gt.STRIKEOUT)),l=a(o.getFormattedSelection());try{for(l.s();!(n=l.n()).done;){var c=n.value;r.createAnnotation(c.pageIndex,{id:Date.now()+Math.random(),type:gt.STRIKEOUT,color:s.color,opacity:s.opacity,pageIndex:c.pageIndex,rect:c.rect,segmentRects:c.segmentRects})}}catch(e){l.e(e)}finally{l.f()}o.clear()}}},highlightSelection:{id:"highlightSelection",label:"Highlight Selection",type:"action",icon:"highlight",action:function(e){var t,i,r=null===(t=e.getPlugin(su))||void 0===t?void 0:t.provides(),o=null===(i=e.getPlugin(Na))||void 0===i?void 0:i.provides();if(o&&r){var n,s=r.getToolDefaults(Yu(gt.HIGHLIGHT)),l=a(o.getFormattedSelection());try{for(l.s();!(n=l.n()).done;){var c=n.value;r.createAnnotation(c.pageIndex,{id:Date.now()+Math.random(),type:gt.HIGHLIGHT,color:s.color,opacity:s.opacity,pageIndex:c.pageIndex,rect:c.rect,segmentRects:c.segmentRects})}}catch(e){l.e(e)}finally{l.f()}o.clear()}}},styleAnnotation:{id:"styleAnnotation",label:"Style",type:"action",icon:"palette",action:function(e,t){var i,r=null===(i=e.getPlugin(Mr))||void 0===i?void 0:i.provides();r&&r.togglePanel({id:"leftPanel",visibleChild:"leftPanelAnnotationStyle",open:!0!==t.plugins.ui.panel.leftPanel.open||"leftPanelAnnotationStyle"!==t.plugins.ui.panel.leftPanel.visibleChild})},active:function(e){return!0===e.plugins.ui.panel.leftPanel.open&&"leftPanelAnnotationStyle"===e.plugins.ui.panel.leftPanel.visibleChild}},deleteAnnotation:{id:"deleteAnnotation",label:"Delete",type:"action",icon:"trash",action:function(e){var t,i=null===(t=e.getPlugin(su))||void 0===t?void 0:t.provides();if(i){var r=i.getSelectedAnnotation();r&&i.deleteAnnotation(r.object.pageIndex,r.localId)}}},panMode:{id:"panMode",label:"Pan",type:"action",icon:"hand",action:function(e){var t,i=null===(t=e.getPlugin(cl))||void 0===t?void 0:t.provides();i&&("panMode"===i.getActiveMode()?i.activate("default"):i.activate("panMode"))},active:function(e){return"panMode"===e.plugins[cl].activeMode}},undo:{id:"undo",label:"Undo",type:"action",icon:"arrowBackUp",action:function(e){var t,i=null===(t=e.getPlugin(bm))||void 0===t?void 0:t.provides();i&&i.undo()},disabled:function(e){return!e.plugins[bm].global.canUndo}},redo:{id:"redo",label:"Redo",type:"action",icon:"arrowForwardUp",action:function(e){var t,i=null===(t=e.getPlugin(bm))||void 0===t?void 0:t.provides();i&&i.redo()},disabled:function(e){return!e.plugins[bm].global.canRedo}},commitAnnotations:{id:"commitAnnotations",label:"Commit",type:"action",icon:"deviceFloppy",action:function(e){var t,i=null===(t=e.getPlugin(su))||void 0===t?void 0:t.provides();i&&i.commit()}}},Rm={menuButton:{type:"iconButton",id:"menuButton",props:{commandId:"menuCtr",active:!1,label:"Menu"},mapStateToProps:function(e,t){return p(p({},t),{},{active:yr(Tm.menuCtr,e)})}},deleteAnnotationButton:{type:"iconButton",id:"deleteAnnotationButton",props:{commandId:"deleteAnnotation",active:!1,label:"Delete"}},styleButton:{type:"iconButton",id:"styleButton",props:{commandId:"styleAnnotation",active:!1,label:"Style"},mapStateToProps:function(e,t){return p(p({},t),{},{active:yr(Tm.styleAnnotation,e)})}},undoButton:{type:"iconButton",id:"undoButton",props:{commandId:"undo",disabled:!1,label:"Undo"},mapStateToProps:function(e,t){return p(p({},t),{},{disabled:wr(Tm.undo,e)})}},redoButton:{type:"iconButton",id:"redoButton",props:{commandId:"redo",disabled:!1,label:"Redo"},mapStateToProps:function(e,t){return p(p({},t),{},{disabled:wr(Tm.redo,e)})}},commitAnnotationsButton:{type:"iconButton",id:"commitAnnotationsButton",props:{commandId:"commitAnnotations",active:!1,label:"Commit"}},copyButton:{type:"iconButton",id:"copyButton",props:{commandId:"copy",active:!1,label:"Copy"},mapStateToProps:function(e,t){return p(p({},t),{},{active:yr(Tm.copy,e)})}},panModeButton:{type:"iconButton",id:"panModeButton",props:{commandId:"panMode",active:!1,label:"Pan"},mapStateToProps:function(e,t){return p(p({},t),{},{active:yr(Tm.panMode,e)})}},underlineButton:{type:"iconButton",id:"underlineButton",props:{commandId:"underline",active:!1,label:"Underline",color:"#e44234"},mapStateToProps:function(e,t){return p(p({},t),{},{active:yr(Tm.underline,e),color:e.plugins.annotation.toolDefaults[Yu(gt.UNDERLINE)].color})}},squigglyButton:{type:"iconButton",id:"squigglyButton",props:{commandId:"squiggly",active:!1,label:"Squiggly",color:"#e44234"},mapStateToProps:function(e,t){return p(p({},t),{},{active:yr(Tm.squiggly,e),color:e.plugins.annotation.toolDefaults[Yu(gt.SQUIGGLY)].color})}},strikethroughButton:{type:"iconButton",id:"strikethroughButton",props:{commandId:"strikethrough",active:!1,label:"Strikethrough",color:"#e44234"},mapStateToProps:function(e,t){return p(p({},t),{},{active:yr(Tm.strikethrough,e),color:e.plugins.annotation.toolDefaults[Yu(gt.STRIKEOUT)].color})}},highlightButton:{type:"iconButton",id:"highlightButton",props:{commandId:"highlight",active:!1,label:"Highlight",color:"#ffcd45"},mapStateToProps:function(e,t){return p(p({},t),{},{active:yr(Tm.highlight,e),color:e.plugins.annotation.toolDefaults[Yu(gt.HIGHLIGHT)].color})}},freehandButton:{type:"iconButton",id:"freehandButton",props:{commandId:"freehand",active:!1,label:"Freehand",color:"#e44234"},mapStateToProps:function(e,t){return p(p({},t),{},{active:yr(Tm.freehand,e),color:e.plugins.annotation.toolDefaults[Yu(gt.INK)].color})}},highlightSelectionButton:{type:"iconButton",id:"highlightSelectionButton",props:{commandId:"highlightSelection",color:"#ffcd45"},mapStateToProps:function(e,t){return p(p({},t),{},{color:e.plugins.annotation.toolDefaults[Yu(gt.HIGHLIGHT)].color})}},underlineSelectionButton:{type:"iconButton",id:"underlineSelectionButton",props:{commandId:"underlineSelection",color:"#e44234"},mapStateToProps:function(e,t){return p(p({},t),{},{color:e.plugins.annotation.toolDefaults[Yu(gt.UNDERLINE)].color})}},strikethroughSelectionButton:{type:"iconButton",id:"strikethroughSelectionButton",props:{commandId:"strikethroughSelection",color:"#e44234"},mapStateToProps:function(e,t){return p(p({},t),{},{color:e.plugins.annotation.toolDefaults[Yu(gt.STRIKEOUT)].color})}},squigglySelectionButton:{type:"iconButton",id:"squigglySelectionButton",props:{commandId:"squigglySelection",color:"#e44234"},mapStateToProps:function(e,t){return p(p({},t),{},{color:e.plugins.annotation.toolDefaults[Yu(gt.SQUIGGLY)].color})}},viewCtrButton:{type:"iconButton",id:"viewCtrButton",props:{commandId:"viewCtr",active:!1,label:"View settings"},mapStateToProps:function(e,t){return p(p({},t),{},{active:yr(Tm.viewCtr,e)})}},commentButton:{type:"iconButton",id:"commentButton",props:{active:!1,commandId:"comment",label:"Comment"},mapStateToProps:function(e,t){return p(p({},t),{},{active:yr(Tm.comment,e)})}},searchButton:{type:"iconButton",id:"searchButton",props:{active:!1,commandId:"search",label:"Search"},mapStateToProps:function(e,t){return p(p({},t),{},{active:yr(Tm.search,e)})}},filePickerButton:{type:"iconButton",id:"filePickerButton",props:{label:"Open File",img:"data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiAgd2lkdGg9IjI0IiAgaGVpZ2h0PSIyNCIgIHZpZXdCb3g9IjAgMCAyNCAyNCIgIGZpbGw9Im5vbmUiICBzdHJva2U9IiMzNDNhNDAiICBzdHJva2Utd2lkdGg9IjIiICBzdHJva2UtbGluZWNhcD0icm91bmQiICBzdHJva2UtbGluZWpvaW49InJvdW5kIiAgY2xhc3M9Imljb24gaWNvbi10YWJsZXIgaWNvbi10YWJsZXItb3V0bGluZSBpY29uLXRhYmxlci1maWxlLWltcG9ydCI+PHBhdGggc3Ryb2tlPSJub25lIiBkPSJNIDAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPjxwYXRoIGQ9Ik0xNCAzdjRhMSAxIDAgMCAwIDEgMWg0IiAvPjxwYXRoIGQ9Ik01IDEzdi04YTIgMiAwIDAgMSAyIC0yaDdsNSA1djExYTIgMiAwIDAgMSAtMiAyaC01LjVtLTkuNSAtMmg3bS0zIC0zbDMgM2wtMyAzIiAvPjwvc3ZnPg=="}},downloadButton:{type:"iconButton",id:"downloadButton",props:{label:"Download",img:"data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiAgd2lkdGg9IjI0IiAgaGVpZ2h0PSIyNCIgIHZpZXdCb3g9IjAgMCAyNCAyNCIgIGZpbGw9Im5vbmUiICBzdHJva2U9IiMzNDNhNDAiICBzdHJva2Utd2lkdGg9IjIiICBzdHJva2UtbGluZWNhcD0icm91bmQiICBzdHJva2UtbGluZWpvaW49InJvdW5kIiAgY2xhc3M9Imljb24gaWNvbi10YWJsZXIgaWNvbnMtdGFibGVyLW91dGxpbmUgaWNvbi10YWJsZXItZG93bmxvYWQiPjxwYXRoIHN0cm9rZT0ibm9uZSIgZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPjxwYXRoIGQ9Ik00IDE3djJhMiAyIDAgMCAwIDIgMmgxMmEyIDIgMCAwIDAgMiAtMnYtMiIgLz48cGF0aCBkPSJNNyAxMWw1IDVsNSAtNSIgLz48cGF0aCBkPSJNMTIgNGwwIDEyIiAvPjwvc3ZnPg=="}},zoomButton:{type:"iconButton",id:"zoomButton",props:{commandId:"zoom",label:"Zoom",img:"data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiAgd2lkdGg9IjI0IiAgaGVpZ2h0PSIyNCIgIHZpZXdCb3g9IjAgMCAyNCAyNCIgIGZpbGw9Im5vbmUiICBzdHJva2U9IiMzNDNhNDAiICBzdHJva2Utd2lkdGg9IjIiICBzdHJva2UtbGluZWNhcD0icm91bmQiICBzdHJva2UtbGluZWpvaW49InJvdW5kIiAgY2xhc3M9Imljb24gaWNvbi10YWJsZXIgaWNvbnMtdGFibGVyLW91dGxpbmUgaWNvbi10YWJsZXItY2lyY2xlLXBsdXMiPjxwYXRoIHN0cm9rZT0ibm9uZSIgZD0iTTAgMGgyNHYyNEgweiIgZmlsbD0ibm9uZSIvPjxwYXRoIGQ9Ik0zIDEyYTkgOSAwIDEgMCAxOCAwYTkgOSAwIDAgMCAtMTggMCIgLz48cGF0aCBkPSJNOSAxMmg2IiAvPjxwYXRoIGQ9Ik0xMiA5djYiIC8+PC9zdmc+"},mapStateToProps:function(e,t){return p(p({},t),{},{active:yr(Tm.zoom,e)||yr(Tm.changeZoomLevel,e)})}},sidebarButton:{type:"iconButton",id:"sidebarButton",props:{commandId:"sidebar",label:"Sidebar",active:!1},mapStateToProps:function(e,t){return p(p({},t),{},{active:yr(Tm.sidebar,e)})}},divider1:{type:"divider",id:"divider1"},expandLeftActionsButton:{type:"iconButton",id:"expandLeftActionsButton",props:{commandId:"leftAction",label:"Left Panel Actions"},mapStateToProps:function(e,t){return p(p({},t),{},{active:yr(Tm.leftAction,e)})}},headerStart:{id:"headerStart",type:"groupedItems",slots:[{componentId:"menuButton",priority:0},{componentId:"divider1",priority:1,className:"flex"},{componentId:"sidebarButton",priority:2},{componentId:"expandLeftActionsButton",priority:3,className:"@min-[400px]:hidden"},{componentId:"viewCtrButton",priority:4,className:"hidden @min-[400px]:block"},{componentId:"divider1",priority:6,className:"hidden @min-[400px]:flex"},{componentId:"zoomButton",priority:7,className:"hidden @min-[400px]:block @min-[600px]:hidden"},{componentId:"zoom",priority:8,className:"hidden @min-[600px]:block"},{componentId:"divider1",priority:9,className:"hidden @min-[600px]:flex"},{componentId:"panModeButton",priority:10,className:"hidden @min-[600px]:block"}],props:{gap:10}},viewTab:{type:"tabButton",id:"viewTab",props:{label:"View",commandId:"view",active:!1},mapStateToProps:function(e,t){return p(p({},t),{},{active:yr(Tm.view,e)})}},annotateTab:{type:"tabButton",id:"annotateTab",props:{label:"Annotate",commandId:"annotate",active:!1},mapStateToProps:function(e,t){return p(p({},t),{},{active:yr(Tm.annotate,e)})}},shapesTab:{type:"tabButton",id:"shapesTab",props:{label:"Shapes",commandId:"shapes",active:!1},mapStateToProps:function(e,t){return p(p({},t),{},{active:yr(Tm.shapes,e)})}},fillAndSignTab:{type:"tabButton",id:"fillAndSignTab",props:{label:"Fill and Sign",commandId:"fillAndSign",active:!1},mapStateToProps:function(e,t){return p(p({},t),{},{active:yr(Tm.fillAndSign,e)})}},formTab:{type:"tabButton",id:"formTab",props:{label:"Form",commandId:"form",active:!1},mapStateToProps:function(e,t){return p(p({},t),{},{active:yr(Tm.form,e)})}},tabOverflowButton:{type:"iconButton",id:"tabOverflowButton",props:{label:"More",commandId:"tabOverflow",active:!1},mapStateToProps:function(e,t){return p(p({},t),{},{active:yr(Tm.tabOverflow,e)})}},selectButton:{type:"selectButton",id:"selectButton",props:{menuCommandId:"tabOverflow",commandIds:["view","annotate"],activeCommandId:"view",active:!1},mapStateToProps:function(e,t){var i;return p(p({},t),{},{activeCommandId:null!==(i=t.commandIds.find(function(t){return yr(Tm[t],e)}))&&void 0!==i?i:t.commandIds[0],active:yr(Tm.tabOverflow,e)})}},headerCenter:{id:"headerCenter",type:"groupedItems",slots:[{componentId:"selectButton",priority:0,className:"block @min-[500px]:hidden"},{componentId:"viewTab",priority:1,className:"hidden @min-[500px]:block"},{componentId:"annotateTab",priority:2,className:"hidden @min-[500px]:block"}],props:{gap:10}},headerEnd:{id:"headerEnd",type:"groupedItems",slots:[{componentId:"searchButton",priority:1}],props:{gap:10}},pageControls:{id:"pageControls",type:"custom",render:"pageControls",initialState:{currentPage:1,pageCount:1},props:function(e){return{currentPage:e.currentPage,pageCount:e.pageCount,nextPageCommandId:"nextPage",previousPageCommandId:"previousPage"}},mapStateToProps:function(e,t){var i,r;return p(p({},t),{},{currentPage:e.plugins.scroll.currentPage,pageCount:null!==(i=null===(r=e.core.document)||void 0===r?void 0:r.pageCount)&&void 0!==i?i:1})}},pageControlsContainer:{id:"pageControlsContainer",type:"floating",props:{scrollerPosition:"outside"},render:"pageControlsContainer",slots:[{componentId:"pageControls",priority:0}]},textSelectionMenuButtons:{id:"textSelectionMenuButtons",type:"groupedItems",slots:[{componentId:"copyButton",priority:0},{componentId:"highlightSelectionButton",priority:1},{componentId:"underlineSelectionButton",priority:2},{componentId:"strikethroughSelectionButton",priority:3},{componentId:"squigglySelectionButton",priority:4}],props:{gap:10}},printModal:{id:"printModal",type:"floating",render:"printModal",initialState:{open:!1},props:function(e){return{open:e.open,scrollerPosition:"outside"}},mapStateToProps:function(e,t){return p(p({},t),{},{open:e.plugins.ui.floating.printModal.open})}},textSelectionMenu:{id:"textSelectionMenu",type:"floating",render:"textSelectionMenu",props:{open:!1,scrollerPosition:"inside"},mapStateToProps:function(e,t){return p(p({},t),{},{isScolling:e.plugins.viewport.isScrolling,scale:e.core.scale,rotation:e.core.rotation,spread:e.plugins[Gi].spreadMode,open:e.plugins[Na].active&&!e.plugins[Na].selecting})},slots:[{componentId:"textSelectionMenuButtons",priority:0}],getChildContext:{direction:"horizontal"}},annotationSelectionMenuButtons:{id:"annotationSelectionMenuButtons",type:"groupedItems",slots:[{componentId:"deleteAnnotationButton",priority:0},{componentId:"styleButton",priority:1}],props:{gap:10}},annotationSelectionMenu:{id:"annotationSelectionMenu",type:"floating",render:"annotationSelectionMenu",props:{open:!1,scrollerPosition:"inside"},mapStateToProps:function(e,t){return p(p({},t),{},{isScolling:e.plugins.viewport.isScrolling,scale:e.core.scale,rotation:e.core.rotation,selectedUid:e.plugins[su].selectedUid,open:null!==e.plugins[su].selectedUid})},slots:[{componentId:"annotationSelectionMenuButtons",priority:0}],getChildContext:{direction:"horizontal"}},topHeader:{type:"header",id:"topHeader",slots:[{componentId:"headerStart",priority:0},{componentId:"headerCenter",priority:1},{componentId:"headerEnd",priority:2}],getChildContext:function(e){return{direction:"top"===e.placement||"bottom"===e.placement?"horizontal":"vertical"}},props:{placement:"top",style:{backgroundColor:"#ffffff",gap:"10px"}}},annotationTools:{id:"annotationTools",type:"groupedItems",slots:[{componentId:"highlightButton",priority:1},{componentId:"underlineButton",priority:2},{componentId:"strikethroughButton",priority:3},{componentId:"squigglyButton",priority:4},{componentId:"freehandButton",priority:5},{componentId:"divider1",priority:7},{componentId:"styleButton",priority:8},{componentId:"divider1",priority:9},{componentId:"undoButton",priority:10},{componentId:"redoButton",priority:11}],props:{gap:10}},toolsHeader:{type:"header",id:"toolsHeader",initialState:{visible:!1,visibleChild:null},props:function(e){return{placement:"top",visible:e.visible,visibleChild:e.visibleChild,style:{backgroundColor:"#f1f3f5",justifyContent:"center"}}},mapStateToProps:function(e,t){return p(p({},t),{},{visible:e.plugins.ui.header.toolsHeader.visible,visibleChild:e.plugins.ui.header.toolsHeader.visibleChild})},slots:[{componentId:"annotationTools",priority:0}],getChildContext:function(e){return{direction:"top"===e.placement||"bottom"===e.placement?"horizontal":"vertical"}}},leftPanelAnnotationStyle:{id:"leftPanelAnnotationStyle",type:"custom",render:"leftPanelAnnotationStyle",mapStateToProps:function(e,t){return p(p({},t),{},{selectedAnnotation:Ku(e.plugins[su]),activeVariant:e.plugins[su].activeVariant,colorPresets:e.plugins[su].colorPresets,toolDefaults:e.plugins[su].toolDefaults})}},leftPanelMain:{id:"leftPanelMain",type:"custom",render:"leftPanelMain",initialState:{visibleChild:"thumbnails"},props:function(e){return{visibleChild:e.visibleChild,tabsCommandId:"sidebarMenu"}},mapStateToProps:function(e,t){return p(p({},t),{},{visibleChild:e.plugins.ui.custom.leftPanelMain.visibleChild})},slots:[{componentId:"thumbnails",priority:0},{componentId:"outline",priority:1},{componentId:"attachments",priority:2}]},leftPanel:{id:"leftPanel",type:"panel",initialState:{open:!1,visibleChild:"leftPanelMain"},props:function(e){return{open:e.open,visibleChild:e.visibleChild,location:"left"}},mapStateToProps:function(e,t){return p(p({},t),{},{open:e.plugins.ui.panel.leftPanel.open,visibleChild:e.plugins.ui.panel.leftPanel.visibleChild})},slots:[{componentId:"leftPanelMain",priority:0},{componentId:"leftPanelAnnotationStyle",priority:1}]},thumbnails:{id:"thumbnails",type:"custom",render:"thumbnails",mapStateToProps:function(e,t){return p(p({},t),{},{currentPage:e.plugins.scroll.currentPage})}},outline:{id:"outline",type:"custom",render:"outline",props:{document:null},mapStateToProps:function(e,t){return p(p({},t),{},{document:e.core.document})}},attachments:{id:"attachments",type:"custom",render:"attachments"},search:{id:"search",type:"custom",render:"search",mapStateToProps:function(e,t){return p(p({},t),{},{flags:e.plugins.search.flags,results:e.plugins.search.results,total:e.plugins.search.total,activeResultIndex:e.plugins.search.activeResultIndex,active:e.plugins.search.active,query:e.plugins.search.query,loading:e.plugins.search.loading})}},comment:{id:"comment",type:"custom",render:"comment"},commandMenu:{id:"commandMenu",type:"commandMenu",initialState:{open:!1,activeCommand:null,triggerElement:void 0,position:void 0,flatten:!1},props:function(e){return{open:e.open,activeCommand:e.activeCommand,triggerElement:e.triggerElement,position:e.position,flatten:e.flatten}},mapStateToProps:function(e,t){return p(p({},t),{},{open:e.plugins.ui.commandMenu.commandMenu.open,activeCommand:e.plugins.ui.commandMenu.commandMenu.activeCommand,triggerElement:e.plugins.ui.commandMenu.commandMenu.triggerElement,position:e.plugins.ui.commandMenu.commandMenu.position,flatten:e.plugins.ui.commandMenu.commandMenu.flatten})}},zoom:{id:"zoom",type:"custom",render:"zoom",initialState:{zoomLevel:1},props:function(e){return{zoomLevel:e.zoomLevel,commandZoomIn:Tm.zoomIn.id,commandZoomOut:Tm.zoomOut.id,commandZoomMenu:Tm.zoom.id,zoomMenuActive:!1}},mapStateToProps:function(e,t){return p(p({},t),{},{zoomLevel:e.plugins.zoom.currentZoomLevel,zoomMenuActive:yr(Tm.zoom,e)||yr(Tm.changeZoomLevel,e)})}},rightPanel:{id:"rightPanel",type:"panel",initialState:{open:!1,visibleChild:null},props:function(e){return{open:e.open,visibleChild:e.visibleChild,location:"right"}},mapStateToProps:function(e,t){return p(p({},t),{},{open:e.plugins.ui.panel.rightPanel.open,visibleChild:e.plugins.ui.panel.rightPanel.visibleChild})},slots:[{componentId:"search",priority:0},{componentId:"comment",priority:1}]}},_m={enabled:!0,components:Rm,menuItems:Tm,icons:{menu:{id:"menu",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-menu"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 8l16 0" /><path d="M4 16l16 0" /></svg>'},download:{id:"download",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-download"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-2" /><path d="M7 11l5 5l5 -5" /><path d="M12 4l0 12" /></svg>'},fullscreen:{id:"fullscreen",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-maximize"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 8v-2a2 2 0 0 1 2 -2h2" /><path d="M4 16v2a2 2 0 0 0 2 2h2" /><path d="M16 4h2a2 2 0 0 1 2 2v2" /><path d="M16 20h2a2 2 0 0 0 2 -2v-2" /></svg>'},fullscreenExit:{id:"fullscreenExit",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-maximize-off"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 8v-2c0 -.551 .223 -1.05 .584 -1.412" /><path d="M4 16v2a2 2 0 0 0 2 2h2" /><path d="M16 4h2a2 2 0 0 1 2 2v2" /><path d="M16 20h2c.545 0 1.04 -.218 1.4 -.572" /><path d="M3 3l18 18" /></svg>'},save:{id:"save",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-device-floppy"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2" /><path d="M12 14m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" /><path d="M14 4l0 4l-6 0l0 -4" /></svg>'},print:{id:"print",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-printer"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M17 17h2a2 2 0 0 0 2 -2v-4a2 2 0 0 0 -2 -2h-14a2 2 0 0 0 -2 2v4a2 2 0 0 0 2 2h2" /><path d="M17 9v-4a2 2 0 0 0 -2 -2h-6a2 2 0 0 0 -2 2v4" /><path d="M7 13m0 2a2 2 0 0 1 2 -2h6a2 2 0 0 1 2 2v4a2 2 0 0 1 -2 2h-6a2 2 0 0 1 -2 -2z" /></svg>'},settings:{id:"settings",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-settings"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10.325 4.317c.426 -1.756 2.924 -1.756 3.35 0a1.724 1.724 0 0 0 2.573 1.066c1.543 -.94 3.31 .826 2.37 2.37a1.724 1.724 0 0 0 1.065 2.572c1.756 .426 1.756 2.924 0 3.35a1.724 1.724 0 0 0 -1.066 2.573c.94 1.543 -.826 3.31 -2.37 2.37a1.724 1.724 0 0 0 -2.572 1.065c-.426 1.756 -2.924 1.756 -3.35 0a1.724 1.724 0 0 0 -2.573 -1.066c-1.543 .94 -3.31 -.826 -2.37 -2.37a1.724 1.724 0 0 0 -1.065 -2.572c-1.756 -.426 -1.756 -2.924 0 -3.35a1.724 1.724 0 0 0 1.066 -2.573c-.94 -1.543 .826 -3.31 2.37 -2.37c1 .608 2.296 .07 2.572 -1.065z" /><path d="M9 12a3 3 0 1 0 6 0a3 3 0 0 0 -6 0" /></svg>'},viewSettings:{id:"viewSettings",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-file-settings"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 14m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" /><path d="M12 10.5v1.5" /><path d="M12 16v1.5" /><path d="M15.031 12.25l-1.299 .75" /><path d="M10.268 15l-1.3 .75" /><path d="M15 15.803l-1.285 -.773" /><path d="M10.285 12.97l-1.285 -.773" /><path d="M14 3v4a1 1 0 0 0 1 1h4" /><path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z" /></svg>'},rotateClockwise:{id:"rotateClockwise",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-rotate-clockwise"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4.05 11a8 8 0 1 1 .5 4m-.5 5v-5h5" /></svg>'},rotateCounterClockwise:{id:"rotateCounterClockwise",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-rotate"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M19.95 11a8 8 0 1 0 -.5 4m.5 5v-5h-5" /></svg>'},singlePage:{id:"singlePage",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-columns-1"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 3m0 1a1 1 0 0 1 1 -1h12a1 1 0 0 1 1 1v16a1 1 0 0 1 -1 1h-12a1 1 0 0 1 -1 -1z" /></svg>'},doublePage:{id:"doublePage",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-columns-2"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 3m0 1a1 1 0 0 1 1 -1h16a1 1 0 0 1 1 1v16a1 1 0 0 1 -1 1h-16a1 1 0 0 1 -1 -1zm9 -1v18" /></svg>'},zoomIn:{id:"zoomIn",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-circle-plus"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0" /><path d="M9 12h6" /><path d="M12 9v6" /></svg>'},zoomOut:{id:"zoomOut",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-circle-minus"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0" /><path d="M9 12l6 0" /></svg>'},fitToWidth:{id:"fitToWidth",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-arrow-autofit-width"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 12v-6a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v6" /><path d="M10 18h-7" /><path d="M21 18h-7" /><path d="M6 15l-3 3l3 3" /><path d="M18 15l3 3l-3 3" /></svg>'},fitToPage:{id:"fitToPage",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-arrow-autofit-height"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 20h-6a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h6" /><path d="M18 14v7" /><path d="M18 3v7" /><path d="M15 18l3 3l3 -3" /><path d="M15 6l3 -3l3 3" /></svg>'},chevronRight:{id:"chevronRight",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-chevron-right"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 6l6 6l-6 6" /></svg>'},chevronLeft:{id:"chevronLeft",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-chevron-left"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M15 6l-6 6l6 6" /></svg>'},chevronDown:{id:"chevronDown",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-chevron-down"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 9l6 6l6 -6" /></svg>'},search:{id:"search",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-search"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 10m-7 0a7 7 0 1 0 14 0a7 7 0 1 0 -14 0" /><path d="M21 21l-6 -6" /></svg>'},comment:{id:"comment",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-message-dots"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 11v.01" /><path d="M8 11v.01" /><path d="M16 11v.01" /><path d="M18 4a3 3 0 0 1 3 3v8a3 3 0 0 1 -3 3h-5l-5 3v-3h-2a3 3 0 0 1 -3 -3v-8a3 3 0 0 1 3 -3z" /></svg>'},sidebar:{id:"sidebar",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-sidebar-left"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 18v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v12a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2z" /><path d="M14 18v-12a2 2 0 0 0 -2 -2h-6a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h6a2 2 0 0 0 2 -2z" /></svg>'},dots:{id:"dots",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-dots"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M12 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M19 12m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /></svg>'},vertical:{id:"vertical",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-arrows-vertical"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M8 7l4 -4l4 4" /><path d="M8 17l4 4l4 -4" /><path d="M12 3l0 18" /></svg>'},horizontal:{id:"horizontal",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-arrows-horizontal"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 8l-4 4l4 4" /><path d="M17 8l4 4l-4 4" /><path d="M3 12l18 0" /></svg>'},book:{id:"book",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-book"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 19a9 9 0 0 1 9 0a9 9 0 0 1 9 0" /><path d="M3 6a9 9 0 0 1 9 0a9 9 0 0 1 9 0" /><path d="M3 6l0 13" /><path d="M12 6l0 13" /><path d="M21 6l0 13" /></svg>'},book2:{id:"book2",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-book-2"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M19 4v16h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12z" /><path d="M19 16h-12a2 2 0 0 0 -2 2" /><path d="M9 8h6" /></svg>'},squares:{id:"squares",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-squares"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M8 10a2 2 0 0 1 2 -2h9a2 2 0 0 1 2 2v9a2 2 0 0 1 -2 2h-9a2 2 0 0 1 -2 -2z" /><path d="M16 8v-3a2 2 0 0 0 -2 -2h-9a2 2 0 0 0 -2 2v9a2 2 0 0 0 2 2h3" /></svg>'},listTree:{id:"listTree",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-list-tree"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 6h11" /><path d="M12 12h8" /><path d="M15 18h5" /><path d="M5 6v.01" /><path d="M8 12v.01" /><path d="M11 18v.01" /></svg>'},paperclip:{id:"paperclip",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-paperclip"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M15 7l-6.5 6.5a1.5 1.5 0 0 0 3 3l6.5 -6.5a3 3 0 0 0 -6 -6l-6.5 6.5a4.5 4.5 0 0 0 9 9l6.5 -6.5" /></svg>'},copy:{id:"copy",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-copy"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg>'},underline:{id:"underline",svg:'<svg xmlns="http://www.w3.org/2000/svg" width="100%"  height="100%" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-baseline"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 20h16" stroke="currentColor" /><path d="M8 16v-8a4 4 0 1 1 8 0v8" stroke="#000000" /><path d="M8 10h8" stroke="#000000" /></svg>'},squiggly:{id:"squiggly",svg:'<svg xmlns="http://www.w3.org/2000/svg" width="100%"  height="100%" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-baseline-wavy"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M8 16v-8a4 4 0 1 1 8 0v8" stroke="#000000" /><path d="M8 10h8" stroke="#000000" /><path d="M4 20c1.5 -1.5 3.5 -1.5 5 0s3.5 1.5 5 0 3.5 -1.5 5 0" stroke="currentColor" /></svg>'},strikethrough:{id:"strikethrough",svg:'<svg xmlns="http://www.w3.org/2000/svg" width="100%"  height="100%" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-baseline"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M8 16v-8a4 4 0 1 1 8 0v8" stroke="#000000" /><path d="M4 10h16" stroke="currentColor" /></svg>'},highlight:{id:"highlight",svg:'<svg xmlns="http://www.w3.org/2000/svg" width="100%"  height="100%" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tabler icons-tabler-outline icon-tabler-baseline-highlight"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><rect x="2" y="6" width="20" height="16" rx="2" fill="currentColor" stroke="none" /><path d="M8 16v-8a4 4 0 1 1 8 0v8" stroke="#000000"/><path d="M8 10h8" stroke="#000000"/></svg>'},palette:{id:"palette",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-palette"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 21a9 9 0 0 1 0 -18c4.97 0 9 3.582 9 8c0 1.06 -.474 2.078 -1.318 2.828c-.844 .75 -1.989 1.172 -3.182 1.172h-2.5a2 2 0 0 0 -1 3.75a1.3 1.3 0 0 1 -1 2.25" /><path d="M8.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M12.5 7.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /><path d="M16.5 10.5m-1 0a1 1 0 1 0 2 0a1 1 0 1 0 -2 0" /></svg>'},x:{id:"x",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-x"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M18 6l-12 12" /><path d="M6 6l12 12" /></svg>'},fileImport:{id:"fileImport",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-file-import"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M14 3v4a1 1 0 0 0 1 1h4" /><path d="M5 13v-8a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2h-5.5m-9.5 -2h7m-3 -3l3 3l-3 3" /></svg>'},hand:{id:"hand",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-hand-stop"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M8 13v-7.5a1.5 1.5 0 0 1 3 0v6.5" /><path d="M11 5.5v-2a1.5 1.5 0 1 1 3 0v8.5" /><path d="M14 5.5a1.5 1.5 0 0 1 3 0v6.5" /><path d="M17 7.5a1.5 1.5 0 0 1 3 0v8.5a6 6 0 0 1 -6 6h-2h.208a6 6 0 0 1 -5.012 -2.7a69.74 69.74 0 0 1 -.196 -.3c-.312 -.479 -1.407 -2.388 -3.286 -5.728a1.5 1.5 0 0 1 .536 -2.022a1.867 1.867 0 0 1 2.28 .28l1.47 1.47" /></svg>'},zoomInArea:{id:"zoomInArea",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-zoom-in-area"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M15 13v4" /><path d="M13 15h4" /><path d="M15 15m-5 0a5 5 0 1 0 10 0a5 5 0 1 0 -10 0" /><path d="M22 22l-3 -3" /><path d="M6 18h-1a2 2 0 0 1 -2 -2v-1" /><path d="M3 11v-1" /><path d="M3 6v-1a2 2 0 0 1 2 -2h1" /><path d="M10 3h1" /><path d="M15 3h1a2 2 0 0 1 2 2v1" /></svg>'},screenshot:{id:"screenshot",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-screenshot"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M7 19a2 2 0 0 1 -2 -2" /><path d="M5 13v-2" /><path d="M5 7a2 2 0 0 1 2 -2" /><path d="M11 5h2" /><path d="M17 5a2 2 0 0 1 2 2" /><path d="M19 11v2" /><path d="M19 17v4" /><path d="M21 19h-4" /><path d="M13 19h-2" /></svg>'},arrowBackUp:{id:"arrowBackUp",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-arrow-back-up"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M9 14l-4 -4l4 -4" /><path d="M5 10h11a4 4 0 1 1 0 8h-1" /></svg>'},arrowForwardUp:{id:"arrowForwardUp",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-arrow-forward-up"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M15 14l4 -4l-4 -4" /><path d="M19 10h-11a4 4 0 1 0 0 8h1" /></svg>'},trash:{id:"trash",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-trash"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 7l16 0" /><path d="M10 11l0 6" /><path d="M14 11l0 6" /><path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12" /><path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3" /></svg>'},deviceFloppy:{id:"deviceFloppy",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-device-floppy"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M6 4h10l4 4v10a2 2 0 0 1 -2 2h-12a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2" /><path d="M12 14m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" /><path d="M14 4l0 4l-6 0l0 -4" /></svg>'},pencilMarker:{id:"pencilMarker",svg:'<svg  xmlns="http://www.w3.org/2000/svg"  width="100%"  height="100%"  viewBox="0 0 24 24" class="icon icon-tabler icons-tabler-outline icon-tabler-writing-draw" stroke-linejoin="round" stroke-linecap="round" stroke-width="2" fill="none"><g transform="rotate(47.565 12.1875 10.75)"><path stroke="#000000" d="m14.18752,16.75l0,-12c0,-1.1 -0.9,-2 -2,-2s-2,0.9 -2,2l0,12l2,2l2,-2z"/><path stroke="#000000" d="m10.18752,6.75l4,0"/></g><path stroke="currentColor" d="m19.37499,20.125c0.56874,0.0625 -4.04999,-0.5625 -6.41249,-0.4375c-2.3625,0.125 -4.75833,1.22916 -6.85624,1.625c-1.76458,0.6875 -3.40416,-0.9375 -1.98125,-2.49999"/></svg>'}}},Nm=new class{constructor(e){this.loggers=e}debug(e,t,...i){for(const r of this.loggers)r.debug(e,t,...i)}info(e,t,...i){for(const r of this.loggers)r.info(e,t,...i)}warn(e,t,...i){for(const r of this.loggers)r.warn(e,t,...i)}error(e,t,...i){for(const r of this.loggers)r.error(e,t,...i)}perf(e,t,i,r,...o){for(const n of this.loggers)n.perf(e,t,i,r,...o)}}([new class{debug(e,t,...i){console.debug(`${e}.${t}`,...i)}info(e,t,...i){console.info(`${e}.${t}`,...i)}warn(e,t,...i){console.warn(`${e}.${t}`,...i)}error(e,t,...i){console.error(`${e}.${t}`,...i)}perf(e,t,i,r,...o){console.info(`${e}.${t}.${i}.${r}`,...o)}},new class{constructor(){}debug(e,t,...i){}info(e,t,...i){}warn(e,t,...i){}error(e,t,...i){}perf(e,t,i,r,o,...n){switch(r){case"Begin":window.performance.mark(`${e}.${t}.${i}.${r}.${o}`,{detail:n});break;case"End":window.performance.mark(`${e}.${t}.${i}.${r}.${o}`,{detail:n}),window.performance.measure(`${e}.${t}.${i}.Measure.${o}`,`${e}.${t}.${i}.Begin.${o}`,`${e}.${t}.${i}.End.${o}`)}}}]);function Om(e){var t,r=e.config,o=function(e){const{wasmUrl:t=ai,worker:i=!0,logger:r}=e??{},[o,n]=ke(null),[s,a]=ke(!0),[l,c]=ke(null),d=Te(null);return Pe(()=>{let e=!1;return(async()=>{try{const{createPdfiumEngine:e}=i?await import("./pdfium-worker-engine-b006f769.js"):await import("./pdfium-direct-engine-20a10bee.js"),o=await e(t,r);d.current=o,n(o),a(!1)}catch(t){e||(c(t),a(!1))}})(),()=>{e=!0,d.current?.destroy(),d.current=null}},[t,i,r]),{engine:o,isLoading:s,error:l}}(p(p({},r.wasmUrl&&{wasmUrl:r.wasmUrl}),{},{worker:r.worker,logger:r.log?Nm:void 0})),n=o.engine,s=o.isLoading,a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return{viewport:p(p({},Mm.viewport),e.viewport),scroll:p(p({},Mm.scroll),e.scroll),zoom:p(p({},Mm.zoom),e.zoom),spread:p(p({},Mm.spread),e.spread),rotate:p(p({},Mm.rotate),e.rotate),tiling:p(p({},Mm.tiling),e.tiling),thumbnail:p(p({},Mm.thumbnail),e.thumbnail),print:p(p({},Mm.print),e.print)}}(r.plugins);return j(B,null,j("style",null,de),!n||s?j("div",{className:"flex h-full w-full items-center justify-center"},j(Op,{size:"lg",text:"Initializing PDF engine..."})):j(ri,{engine:n,onInitialized:(t=i(f().m(function e(t){var i,r;return f().w(function(e){for(;;)switch(e.n){case 0:(r=null===(i=t.getPlugin("ui"))||void 0===i?void 0:i.provides())&&(r.registerComponentRenderer("groupedItems",Ud),r.registerComponentRenderer("iconButton",Hd),r.registerComponentRenderer("tabButton",$d),r.registerComponentRenderer("header",Bd),r.registerComponentRenderer("divider",jd),r.registerComponentRenderer("panel",Vd),r.registerComponentRenderer("search",Zd),r.registerComponentRenderer("zoom",qd),r.registerComponentRenderer("pageControlsContainer",Yd),r.registerComponentRenderer("pageControls",Qd),r.registerComponentRenderer("commandMenu",Jd),r.registerComponentRenderer("comment",eu),r.registerComponentRenderer("thumbnails",tu),r.registerComponentRenderer("outline",iu),r.registerComponentRenderer("attachments",ru),r.registerComponentRenderer("selectButton",ou),r.registerComponentRenderer("textSelectionMenu",Kd),r.registerComponentRenderer("annotationSelectionMenu",Xd),r.registerComponentRenderer("leftPanelMain",Gd),r.registerComponentRenderer("printModal",nu),r.registerComponentRenderer("leftPanelAnnotationStyle",oh));case 1:return e.a(2)}},e)})),function(e){return t.apply(this,arguments)}),plugins:[Zt(Tr,_m),Zt(Ji,{loadingOptions:{type:"url",pdfFile:{id:"pdf",url:r.src},options:{mode:"full-fetch"}}}),Zt(bi,a.viewport),Zt(_i,a.scroll),Zt(Ih,a.zoom),Zt(Wi,a.spread),Zt(Ph,{}),Zt(Oh,a.rotate),Zt(np,{}),Zt(tl,{}),Zt(fp,a.tiling),Zt(Np,a.thumbnail),Zt(eh,{}),Zt(Ql,a.print),Zt(Xp,{}),Zt(Sg,{}),Zt(Ng,{}),Zt(ul,{}),Zt(Lf,{}),Zt(Vf,{scale:2,imageType:"image/png"}),Zt(Em,{})]},function(e){var t=e.pluginsReady;return j(os,null,function(e){var i=e.headers,r=e.panels,o=e.floating,n=e.commandMenu;return j(pg,null,j(Fl,null,j("div",{className:"@container relative flex h-full w-full select-none flex-col"},i.top.length>0&&j("div",null,i.top),j("div",{className:"flex flex-1 flex-row overflow-hidden"},j("div",{className:"flex flex-col"},i.left),j("div",{className:"flex flex-1 flex-col overflow-hidden md:flex-row"},r.left.length>0&&j(B,null,r.left),j("div",{className:"relative flex w-full flex-1 overflow-hidden"},j(pl,null,j(Sf,null),j(wi,{style:{width:"100%",height:"100%",flexGrow:1,backgroundColor:"#f1f3f5",overflow:"auto"}},!t&&j("div",{className:"flex h-full w-full items-center justify-center"},j(Op,{size:"lg",text:"Loading PDF document..."})),t&&j(zs,null,j(Oi,{renderPage:function(e){var t=e.pageIndex,i=e.scale,r=e.rotation,o=e.width,n=e.height,s=e.rotatedHeight,a=e.rotatedWidth,l=e.document;return j(zh,{key:null==l?void 0:l.id,pageSize:{width:o,height:n}},j(gl,{rotation:r,scale:i,pageWidth:a,pageHeight:s,pageIndex:t,style:{width:o,height:n}},j(Mh,{pageIndex:t,className:"pointer-events-none"}),j(vp,{pageIndex:t,scale:i,className:"pointer-events-none"}),j(la,{pageIndex:t,scale:i,className:"pointer-events-none"}),j(Pm,null),j(Ld,{pageIndex:t,scale:i,pageWidth:o,pageHeight:n,rotation:r}),j(Hs,{pageIndex:t,scale:i,pageWidth:o,pageHeight:n}),j(mm,{pageIndex:t,scale:i,pageWidth:o,pageHeight:n}),j(ml,{pageIndex:t,scale:i})))},overlayElements:o.insideScroller})),o.outsideScroller))),r.right.length>0&&j(B,null,r.right)),j("div",{className:"flex flex-col"},i.right)),i.bottom.length>0&&j("div",null,i.bottom),n),j(er,null),j(Yg,null),j(km,null),j(bl,null)))})}))}var zm=function(){function e(){var t;return o(this,e),(t=r(this,e)).root=t.attachShadow({mode:"open"}),t}return d(e,C(HTMLElement)),s(e,[{key:"connectedCallback",value:function(){this._config||(this._config={src:this.getAttribute("src")||"/demo.pdf",worker:"false"!==this.getAttribute("worker")}),this.renderViewer()}},{key:"config",get:function(){return this._config},set:function(e){this._config=e,this.isConnected&&this.renderViewer()}},{key:"renderViewer",value:function(){this._config&&le(j(Om,{config:this._config}),this.root)}}])}(),Lm=["type","target"];customElements.define("embedpdf-container",zm);var Dm={init:function(e){if("container"===e.type)return function(e){e.type,e.target;var t=g(e,Lm),i=document.createElement("embedpdf-container");return i.config=t,e.target.appendChild(i),i}(e)}};export{ft as A,Ct as M,it as N,xt as P,je as R,nt as T,It as a,gt as b,vt as c,Pt as d,bt as e,yt as f,kt as g,St as h,mt as i,Je as j,Be as k,We as l,tt as m,pt as n,ct as o,At as p,Ze as q,qe as r,lt as s,Ge as t,Dm as u,Et as w};
//# sourceMappingURL=embedpdf-de22fdf4.js.map
