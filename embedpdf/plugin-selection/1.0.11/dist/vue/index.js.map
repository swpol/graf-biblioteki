{"version":3,"file":"index.js","sources":["../../../core/dist/vue/index.js","../../src/vue/hooks/use-selection.ts","../../../plugin-interaction-manager/dist/vue/index.js","../../src/vue/components/selection-layer.vue","../../src/vue/components/copy-to-clipboard.vue"],"sourcesContent":["import { inject as p, ref as u, onMounted as a, onBeforeUnmount as l, shallowRef as d, watch as v, computed as y, defineComponent as m, provide as P, renderSlot as w } from \"vue\";\nimport { a as h, P as S } from \"../math-ChSRQF3r.js\";\nconst f = Symbol(\"pdfKey\");\nfunction c() {\n  const r = p(f);\n  if (!r) throw new Error(\"useRegistry must be used inside <EmbedPDF>\");\n  return r;\n}\nfunction b() {\n  const { registry: r } = c(), e = u();\n  return a(() => {\n    const o = r.value.getStore();\n    e.value = o.getState().core;\n    const t = o.subscribe((s, n, i) => {\n      o.isCoreAction(s) && !h(n.core, i.core) && (e.value = n.core);\n    });\n    l(t);\n  }), e;\n}\nfunction R(r) {\n  const { registry: e } = c(), o = d(null), t = u(!0), s = u(new Promise(() => {\n  })), n = () => {\n    var g;\n    if (!e.value) return;\n    const i = e.value.getPlugin(r);\n    if (!i) throw new Error(`Plugin ${r} not found`);\n    o.value = i, t.value = !1, s.value = ((g = i.ready) == null ? void 0 : g.call(i)) ?? Promise.resolve();\n  };\n  return a(n), v(e, n), { plugin: o, isLoading: t, ready: s };\n}\nfunction z(r) {\n  const { plugin: e, isLoading: o, ready: t } = R(r);\n  return { provides: y(() => {\n    if (!e.value) return null;\n    if (!e.value.provides)\n      throw new Error(`Plugin ${r} does not implement provides()`);\n    return e.value.provides();\n  }), isLoading: o, ready: t };\n}\nfunction C() {\n  const { registry: r } = c(), e = u();\n  function o() {\n    return r.value ? (e.value = r.value.getStore().getState(), r.value.getStore().subscribe((s, n) => e.value = n)) : () => {\n    };\n  }\n  let t = o();\n  return v(r, () => {\n    t == null || t(), t = o();\n  }), l(() => t == null ? void 0 : t()), e;\n}\nconst F = /* @__PURE__ */ m({\n  __name: \"embed-pdf\",\n  props: {\n    engine: {},\n    plugins: {},\n    onInitialized: { type: Function }\n  },\n  setup(r) {\n    const e = r, o = d(null), t = u(!0), s = u(!1);\n    return P(f, { registry: o, isInitializing: t, pluginsReady: s }), a(async () => {\n      var i;\n      const n = new S(e.engine);\n      n.registerPluginBatch(e.plugins), await n.initialize(), await ((i = e.onInitialized) == null ? void 0 : i.call(e, n)), o.value = n, t.value = !1, n.pluginsReady().then(() => s.value = !0);\n    }), l(() => {\n      var n;\n      return (n = o.value) == null ? void 0 : n.destroy();\n    }), (n, i) => w(n.$slots, \"default\", {\n      registry: o.value,\n      isInitializing: t.value,\n      pluginsReady: s.value\n    });\n  }\n});\nexport {\n  F as EmbedPDF,\n  z as useCapability,\n  b as useCoreState,\n  R as usePlugin,\n  c as useRegistry,\n  C as useStoreState\n};\n//# sourceMappingURL=index.js.map\n","import { useCapability, usePlugin } from '@embedpdf/core/vue';\nimport { SelectionPlugin } from '@embedpdf/plugin-selection';\n\n/**\n * Hook to get the selection plugin's capability API.\n * This provides methods for controlling and listening to selection events.\n */\nexport const useSelectionCapability = () => useCapability<SelectionPlugin>(SelectionPlugin.id);\n\n/**\n * Hook to get the raw selection plugin instance.\n * Useful for accessing plugin-specific properties or methods not exposed in the capability.\n */\nexport const useSelectionPlugin = () => usePlugin<SelectionPlugin>(SelectionPlugin.id);\n","import { computed as g, shallowRef as x, ref as u, onMounted as b, watch as C, inject as E, watchEffect as c, readonly as f, defineComponent as P, createElementBlock as v, openBlock as d, renderSlot as m, createCommentVNode as w, unref as R } from \"vue\";\nimport { c as y, r as M } from \"../index-Q-vI1_iw.js\";\nimport { I as h, i as k } from \"../reducer-Dda407Go.js\";\nconst $ = Symbol(\"pdfKey\");\nfunction H() {\n  const t = E($);\n  if (!t) throw new Error(\"useRegistry must be used inside <EmbedPDF>\");\n  return t;\n}\nfunction I(t) {\n  const { registry: e } = H(), r = x(null), n = u(!0), o = u(new Promise(() => {\n  })), a = () => {\n    var i;\n    if (!e.value) return;\n    const s = e.value.getPlugin(t);\n    if (!s) throw new Error(`Plugin ${t} not found`);\n    r.value = s, n.value = !1, o.value = ((i = s.ready) == null ? void 0 : i.call(s)) ?? Promise.resolve();\n  };\n  return b(a), C(e, a), { plugin: r, isLoading: n, ready: o };\n}\nfunction S(t) {\n  const { plugin: e, isLoading: r, ready: n } = I(t);\n  return { provides: g(() => {\n    if (!e.value) return null;\n    if (!e.value.provides)\n      throw new Error(`Plugin ${t} does not implement provides()`);\n    return e.value.provides();\n  }), isLoading: r, ready: n };\n}\nconst F = () => I(h.id), l = () => S(h.id);\nfunction W() {\n  const { provides: t } = l(), e = u(k);\n  return c((r) => {\n    if (t.value) {\n      const n = t.value.onStateChange((o) => {\n        e.value = o;\n      });\n      r(n);\n    }\n  }), {\n    provides: t,\n    state: f(e)\n  };\n}\nfunction j() {\n  const { provides: t } = l();\n  return {\n    setCursor: (e, r, n = 0) => {\n      var o;\n      (o = t.value) == null || o.setCursor(e, r, n);\n    },\n    removeCursor: (e) => {\n      var r;\n      (r = t.value) == null || r.removeCursor(e);\n    }\n  };\n}\nfunction D({ modeId: t, pageIndex: e }) {\n  const { provides: r } = l();\n  return {\n    register: (n, o) => {\n      const a = (o == null ? void 0 : o.modeId) ?? t, i = (o == null ? void 0 : o.pageIndex) ?? e;\n      if (r.value)\n        return a ? r.value.registerHandlers({\n          modeId: a,\n          handlers: n,\n          pageIndex: i\n        }) : r.value.registerAlways({\n          scope: i !== void 0 ? { type: \"page\", pageIndex: i } : { type: \"global\" },\n          handlers: n\n        });\n    }\n  };\n}\nfunction A() {\n  const { provides: t } = l(), e = u(!1);\n  return c((r) => {\n    if (t.value) {\n      const n = t.value.getActiveInteractionMode();\n      e.value = (n == null ? void 0 : n.scope) === \"page\" && !!(n != null && n.exclusive);\n      const o = t.value.onModeChange(() => {\n        if (!t.value) return;\n        const a = t.value.getActiveInteractionMode();\n        e.value = (a == null ? void 0 : a.scope) === \"page\" && !!(a != null && a.exclusive);\n      });\n      r(o);\n    }\n  }), f(e);\n}\nconst G = /* @__PURE__ */ P({\n  __name: \"global-pointer-provider\",\n  setup(t) {\n    const e = u(null), { provides: r } = l();\n    return c((n) => {\n      if (r.value && e.value) {\n        const o = y(r.value, { type: \"global\" }, e.value);\n        n(o);\n      }\n    }), (n, o) => (d(), v(\"div\", {\n      ref_key: \"divRef\",\n      ref: e,\n      style: {\n        width: \"100%\",\n        height: \"100%\"\n      }\n    }, [\n      m(n.$slots, \"default\")\n    ], 512));\n  }\n}), B = {\n  key: 0,\n  style: { position: \"absolute\", top: 0, left: 0, right: 0, bottom: 0, zIndex: 10 }\n}, K = /* @__PURE__ */ P({\n  __name: \"page-pointer-provider\",\n  props: {\n    pageIndex: {},\n    pageWidth: {},\n    pageHeight: {},\n    rotation: {},\n    scale: {},\n    convertEventToPoint: { type: Function }\n  },\n  setup(t) {\n    const e = t, r = u(null), { provides: n } = l(), o = A(), a = g(() => (i, s) => {\n      const p = s.getBoundingClientRect(), _ = {\n        x: i.clientX - p.left,\n        y: i.clientY - p.top\n      };\n      return M(\n        { width: e.pageWidth, height: e.pageHeight },\n        _,\n        e.rotation,\n        e.scale\n      );\n    });\n    return c((i) => {\n      if (n.value && r.value) {\n        const s = y(\n          n.value,\n          { type: \"page\", pageIndex: e.pageIndex },\n          r.value,\n          e.convertEventToPoint || a.value\n        );\n        i(s);\n      }\n    }), (i, s) => (d(), v(\"div\", {\n      ref_key: \"divRef\",\n      ref: r\n    }, [\n      m(i.$slots, \"default\"),\n      R(o) ? (d(), v(\"div\", B)) : w(\"\", !0)\n    ], 512));\n  }\n});\nexport {\n  G as GlobalPointerProvider,\n  K as PagePointerProvider,\n  j as useCursor,\n  W as useInteractionManager,\n  l as useInteractionManagerCapability,\n  F as useInteractionManagerPlugin,\n  A as useIsPageExclusive,\n  D as usePointerHandlers\n};\n//# sourceMappingURL=index.js.map\n","<script setup lang=\"ts\">\nimport { ref, watchEffect, computed } from 'vue';\nimport { ignore, PdfErrorCode, PdfPageGeometry, Rect } from '@embedpdf/models';\nimport {\n  useCursor,\n  useInteractionManagerCapability,\n  usePointerHandlers,\n} from '@embedpdf/plugin-interaction-manager/vue';\nimport { PointerEventHandlersWithLifecycle } from '@embedpdf/plugin-interaction-manager';\nimport { glyphAt } from '@embedpdf/plugin-selection';\nimport { useSelectionCapability } from '../hooks';\n\ninterface Props {\n  pageIndex: number;\n  scale: number;\n  background?: string;\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  background: 'rgba(33, 150, 243)', // Default selection color\n});\n\nconst { provides: sel } = useSelectionCapability();\nconst { provides: im } = useInteractionManagerCapability();\nconst { register } = usePointerHandlers({ pageIndex: props.pageIndex });\nconst { setCursor, removeCursor } = useCursor();\n\nconst rects = ref<Rect[]>([]);\nconst boundingRect = ref<Rect | null>(null);\n\n// Subscribe to selection changes and update the rendered rectangles\nwatchEffect((onCleanup) => {\n  if (sel.value) {\n    const unsubscribe = sel.value.onSelectionChange(() => {\n      const mode = im.value?.getActiveMode();\n      if (mode === 'default') {\n        rects.value = sel.value!.getHighlightRectsForPage(props.pageIndex);\n        boundingRect.value = sel.value!.getBoundingRectForPage(props.pageIndex);\n      } else {\n        rects.value = [];\n        boundingRect.value = null;\n      }\n    });\n    onCleanup(unsubscribe);\n  }\n});\n\n// Cache page geometry for faster hit-testing during pointer moves\nlet geoCache: PdfPageGeometry | undefined;\nwatchEffect((onCleanup) => {\n  if (sel.value) {\n    const task = sel.value.getGeometry(props.pageIndex);\n    task.wait((g) => (geoCache = g), ignore);\n\n    onCleanup(() => {\n      task.abort({\n        code: PdfErrorCode.Cancelled,\n        message: 'SelectionLayer unmounted',\n      });\n    });\n  }\n});\n\nconst handlers = computed(\n  (): PointerEventHandlersWithLifecycle<PointerEvent> => ({\n    onPointerDown: (point, _evt, modeId) => {\n      if (!sel.value || !sel.value.isEnabledForMode(modeId)) return;\n      sel.value.clear();\n      const task = sel.value.getGeometry(props.pageIndex);\n      task.wait((geo) => {\n        const g = glyphAt(geo, point);\n        if (g !== -1) sel.value!.begin(props.pageIndex, g);\n      }, ignore);\n    },\n    onPointerMove: (point, _evt, modeId) => {\n      if (!sel.value || !sel.value.isEnabledForMode(modeId)) return;\n      const g = geoCache ? glyphAt(geoCache, point) : -1;\n      if (g !== -1) {\n        setCursor('selection-text', 'text', 10);\n        sel.value.update(props.pageIndex, g);\n      } else {\n        removeCursor('selection-text');\n      }\n    },\n    onPointerUp: (_point, _evt, modeId) => {\n      if (!sel.value || !sel.value.isEnabledForMode(modeId)) return;\n      sel.value.end();\n    },\n    onHandlerActiveEnd: (modeId) => {\n      if (!sel.value || !sel.value.isEnabledForMode(modeId)) return;\n      sel.value.clear();\n    },\n  }),\n);\n\n// Register the pointer handlers with the interaction manager\nwatchEffect((onCleanup) => {\n  if (register) {\n    const cleanup = register(handlers.value);\n    if (cleanup) onCleanup(cleanup);\n  }\n});\n</script>\n\n<template>\n  <div\n    v-if=\"boundingRect\"\n    :style=\"{\n      position: 'absolute',\n      left: `${boundingRect.origin.x * scale}px`,\n      top: `${boundingRect.origin.y * scale}px`,\n      width: `${boundingRect.size.width * scale}px`,\n      height: `${boundingRect.size.height * scale}px`,\n      mixBlendMode: 'multiply',\n      isolation: 'isolate',\n      pointerEvents: 'none',\n    }\"\n  >\n    <div\n      v-for=\"(rect, i) in rects\"\n      :key=\"i\"\n      :style=\"{\n        position: 'absolute',\n        left: `${(rect.origin.x - boundingRect.origin.x) * scale}px`,\n        top: `${(rect.origin.y - boundingRect.origin.y) * scale}px`,\n        width: `${rect.size.width * scale}px`,\n        height: `${rect.size.height * scale}px`,\n        background: background,\n      }\"\n    />\n  </div>\n</template>\n","<script setup lang=\"ts\">\nimport { watchEffect } from 'vue';\nimport { useSelectionCapability } from '../hooks';\n\nconst { provides: sel } = useSelectionCapability();\n\n// This effect runs when the component is mounted and the capability is available.\n// It automatically handles unsubscribing when the component is unmounted.\nwatchEffect((onCleanup) => {\n  if (sel.value) {\n    const unsubscribe = sel.value.onCopyToClipboard((text) => {\n      // Use the Clipboard API to write the text\n      navigator.clipboard.writeText(text).catch((err) => {\n        console.error('Failed to copy text to clipboard:', err);\n      });\n    });\n\n    // Register the cleanup function to run on unmount or re-run\n    onCleanup(unsubscribe);\n  }\n});\n</script>\n\n<template>\n  <!-- This component renders nothing to the DOM -->\n</template>\n"],"names":["f","c","r","p","R","e","o","d","u","s","n","g","a","v","z","y","useSelectionCapability","useCapability","SelectionPlugin","useSelectionPlugin","usePlugin","$","H","t","E","I","x","i","b","C","S","l","h","j","D","props","__props","sel","im","useInteractionManagerCapability","register","usePointerHandlers","setCursor","removeCursor","useCursor","rects","ref","boundingRect","watchEffect","onCleanup","unsubscribe","_a","geoCache","task","ignore","PdfErrorCode","handlers","computed","point","_evt","modeId","geo","glyphAt","_point","cleanup","_createElementBlock","_normalizeStyle","scale","_openBlock","_Fragment","_renderList","rect","background","text","err"],"mappings":"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"}