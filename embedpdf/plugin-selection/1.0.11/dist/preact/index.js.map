{"version":3,"file":"index.js","sources":["../../../core/dist/preact/index.js","../../src/preact/hooks/use-selection.ts","../../../plugin-interaction-manager/dist/preact/index.js","../../src/preact/components/selection-layer.tsx","../../src/preact/components/copy-to-clipboard.tsx"],"sourcesContent":["import { createContext as b } from \"preact\";\nimport { u as w } from \"../jsxRuntime.module-Bzuv3cXw.js\";\nimport { useState as a, useRef as m, useEffect as f, useContext as S } from \"preact/hooks\";\nimport { P as v, a as C } from \"../math-ChSRQF3r.js\";\nconst P = b({\n  registry: null,\n  isInitializing: !0,\n  pluginsReady: !1\n});\nfunction F({ engine: t, onInitialized: r, plugins: e, children: i }) {\n  const [o, s] = a(null), [u, c] = a(!0), [y, d] = a(!1), l = m(r);\n  return f(() => {\n    l.current = r;\n  }, [r]), f(() => {\n    const n = new v(t);\n    return n.registerPluginBatch(e), (async () => {\n      var p;\n      await n.initialize(), !n.isDestroyed() && (await ((p = l.current) == null ? void 0 : p.call(l, n)), !n.isDestroyed() && (n.pluginsReady().then(() => {\n        n.isDestroyed() || d(!0);\n      }), s(n), c(!1)));\n    })().catch(console.error), () => {\n      n.destroy(), s(null), c(!0), d(!1);\n    };\n  }, [t, e]), /* @__PURE__ */ w(P.Provider, { value: { registry: o, isInitializing: u, pluginsReady: y }, children: typeof i == \"function\" ? i({ registry: o, isInitializing: u, pluginsReady: y }) : i });\n}\nfunction g() {\n  const t = S(P);\n  if (t === void 0)\n    throw new Error(\"useCapability must be used within a PDFContext.Provider\");\n  const { registry: r, isInitializing: e } = t;\n  if (e)\n    return t;\n  if (r === null)\n    throw new Error(\"PDF registry failed to initialize properly\");\n  return t;\n}\nfunction h(t) {\n  const { registry: r } = g();\n  if (r === null)\n    return {\n      plugin: null,\n      isLoading: !0,\n      ready: new Promise(() => {\n      })\n    };\n  const e = r.getPlugin(t);\n  if (!e)\n    throw new Error(`Plugin ${t} not found`);\n  return {\n    plugin: e,\n    isLoading: !1,\n    ready: e.ready()\n  };\n}\nfunction L(t) {\n  const { plugin: r, isLoading: e, ready: i } = h(t);\n  if (!r)\n    return {\n      provides: null,\n      isLoading: e,\n      ready: i\n    };\n  if (!r.provides)\n    throw new Error(`Plugin ${t} does not provide a capability`);\n  return {\n    provides: r.provides(),\n    isLoading: e,\n    ready: i\n  };\n}\nfunction V() {\n  const { registry: t } = g(), [r, e] = a(null);\n  return f(() => {\n    if (!t) return;\n    e(t.getStore().getState());\n    const i = t.getStore().subscribe((o, s) => {\n      e(s);\n    });\n    return () => i();\n  }, [t]), r;\n}\nfunction $() {\n  const { registry: t } = g(), [r, e] = a(null);\n  return f(() => {\n    if (!t) return;\n    const i = t.getStore();\n    e(i.getState().core);\n    const o = i.subscribe((s, u, c) => {\n      i.isCoreAction(s) && !C(u.core, c.core) && e(u.core);\n    });\n    return () => o();\n  }, [t]), r;\n}\nexport {\n  F as EmbedPDF,\n  P as PDFContext,\n  L as useCapability,\n  $ as useCoreState,\n  h as usePlugin,\n  g as useRegistry,\n  V as useStoreState\n};\n//# sourceMappingURL=index.js.map\n","import { useCapability, usePlugin } from '@embedpdf/core/preact';\nimport { SelectionPlugin } from '@embedpdf/plugin-selection';\n\nexport const useSelectionCapability = () => useCapability<SelectionPlugin>(SelectionPlugin.id);\nexport const useSelectionPlugin = () => usePlugin<SelectionPlugin>(SelectionPlugin.id);\n","import { u as g } from \"../jsxRuntime.module-D89ud_rY.js\";\nimport { useContext as E, useState as y, useEffect as a, useRef as P, useCallback as M } from \"preact/hooks\";\nimport { c as v, r as L } from \"../index-Q-vI1_iw.js\";\nimport { createContext as z } from \"preact\";\nimport { I, i as S } from \"../reducer-Dda407Go.js\";\nconst A = z({\n  registry: null,\n  isInitializing: !0,\n  pluginsReady: !1\n});\nfunction R() {\n  const e = E(A);\n  if (e === void 0)\n    throw new Error(\"useCapability must be used within a PDFContext.Provider\");\n  const { registry: n, isInitializing: t } = e;\n  if (t)\n    return e;\n  if (n === null)\n    throw new Error(\"PDF registry failed to initialize properly\");\n  return e;\n}\nfunction x(e) {\n  const { registry: n } = R();\n  if (n === null)\n    return {\n      plugin: null,\n      isLoading: !0,\n      ready: new Promise(() => {\n      })\n    };\n  const t = n.getPlugin(e);\n  if (!t)\n    throw new Error(`Plugin ${e} not found`);\n  return {\n    plugin: t,\n    isLoading: !1,\n    ready: t.ready()\n  };\n}\nfunction D(e) {\n  const { plugin: n, isLoading: t, ready: r } = x(e);\n  if (!n)\n    return {\n      provides: null,\n      isLoading: t,\n      ready: r\n    };\n  if (!n.provides)\n    throw new Error(`Plugin ${e} does not provide a capability`);\n  return {\n    provides: n.provides(),\n    isLoading: t,\n    ready: r\n  };\n}\nconst X = () => x(I.id), s = () => D(I.id);\nfunction Y() {\n  const { provides: e } = s(), [n, t] = y(S);\n  return a(() => {\n    if (e)\n      return e.onStateChange((r) => {\n        t(r);\n      });\n  }, [e]), {\n    provides: e,\n    state: n\n  };\n}\nfunction j() {\n  const { provides: e } = s();\n  return {\n    setCursor: (n, t, r = 0) => {\n      e == null || e.setCursor(n, t, r);\n    },\n    removeCursor: (n) => {\n      e == null || e.removeCursor(n);\n    }\n  };\n}\nfunction q({ modeId: e, pageIndex: n }) {\n  const { provides: t } = s();\n  return {\n    register: (r, i) => {\n      const u = (i == null ? void 0 : i.modeId) ?? e, o = (i == null ? void 0 : i.pageIndex) ?? n;\n      return u ? t == null ? void 0 : t.registerHandlers({\n        modeId: u,\n        handlers: r,\n        pageIndex: o\n      }) : t == null ? void 0 : t.registerAlways({\n        scope: o !== void 0 ? { type: \"page\", pageIndex: o } : { type: \"global\" },\n        handlers: r\n      });\n    }\n  };\n}\nfunction F() {\n  const { provides: e } = s(), [n, t] = y(() => {\n    const r = e == null ? void 0 : e.getActiveInteractionMode();\n    return (r == null ? void 0 : r.scope) === \"page\" && !!r.exclusive;\n  });\n  return a(() => {\n    if (e)\n      return e.onModeChange(() => {\n        const r = e.getActiveInteractionMode();\n        t((r == null ? void 0 : r.scope) === \"page\" && !!(r != null && r.exclusive));\n      });\n  }, [e]), n;\n}\nconst J = ({\n  children: e,\n  style: n,\n  ...t\n}) => {\n  const r = P(null), { provides: i } = s();\n  return a(() => {\n    if (!(!i || !r.current))\n      return v(i, { type: \"global\" }, r.current);\n  }, [i]), /* @__PURE__ */ g(\n    \"div\",\n    {\n      ref: r,\n      style: {\n        width: \"100%\",\n        height: \"100%\",\n        ...n\n      },\n      ...t,\n      children: e\n    }\n  );\n}, K = ({\n  pageIndex: e,\n  children: n,\n  pageWidth: t,\n  pageHeight: r,\n  rotation: i,\n  scale: u,\n  convertEventToPoint: o,\n  style: C,\n  ...h\n}) => {\n  const c = P(null), { provides: l } = s(), m = F(), d = M(\n    (f, w) => {\n      const p = w.getBoundingClientRect(), b = {\n        x: f.clientX - p.left,\n        y: f.clientY - p.top\n      };\n      return L(\n        { width: t, height: r },\n        b,\n        i,\n        u\n      );\n    },\n    [t, r, i, u]\n  );\n  return a(() => {\n    if (!(!l || !c.current))\n      return v(\n        l,\n        { type: \"page\", pageIndex: e },\n        c.current,\n        o || d\n      );\n  }, [l, e, o, d]), /* @__PURE__ */ g(\n    \"div\",\n    {\n      ref: c,\n      style: {\n        ...C\n      },\n      ...h,\n      children: [\n        n,\n        m && /* @__PURE__ */ g(\"div\", { style: { position: \"absolute\", top: 0, left: 0, right: 0, bottom: 0, zIndex: 10 } })\n      ]\n    }\n  );\n};\nexport {\n  J as GlobalPointerProvider,\n  K as PagePointerProvider,\n  j as useCursor,\n  Y as useInteractionManager,\n  s as useInteractionManagerCapability,\n  X as useInteractionManagerPlugin,\n  F as useIsPageExclusive,\n  q as usePointerHandlers\n};\n//# sourceMappingURL=index.js.map\n","/** @jsxImportSource preact */\nimport { useCallback, useEffect, useMemo, useRef, useState } from 'preact/hooks';\nimport { ignore, PdfErrorCode, PdfPageGeometry, Position, Rect } from '@embedpdf/models';\nimport {\n  useCursor,\n  useInteractionManagerCapability,\n  usePointerHandlers,\n} from '@embedpdf/plugin-interaction-manager/preact';\nimport { PointerEventHandlersWithLifecycle } from '@embedpdf/plugin-interaction-manager';\nimport { glyphAt } from '@embedpdf/plugin-selection';\n\nimport { useSelectionCapability } from '../hooks';\n\ntype Props = {\n  pageIndex: number;\n  scale: number;\n  background?: string;\n};\n\nexport function SelectionLayer({ pageIndex, scale, background = 'rgba(33,150,243)' }: Props) {\n  const { provides: sel } = useSelectionCapability();\n  const { provides: im } = useInteractionManagerCapability();\n  const { register } = usePointerHandlers({ pageIndex });\n  const [rects, setRects] = useState<Array<Rect>>([]);\n  const [boundingRect, setBoundingRect] = useState<Rect | null>(null);\n  const { setCursor, removeCursor } = useCursor();\n  const geoCacheRef = useRef<PdfPageGeometry | null>(null);\n\n  /* subscribe to rect updates */\n  useEffect(() => {\n    if (!sel) return;\n    return sel.onSelectionChange(() => {\n      const mode = im?.getActiveMode();\n      if (mode === 'default') {\n        setRects(sel.getHighlightRectsForPage(pageIndex));\n        setBoundingRect(sel.getBoundingRectForPage(pageIndex));\n      } else {\n        setRects([]);\n        setBoundingRect(null);\n      }\n    });\n  }, [sel, pageIndex]);\n\n  /* cheap glyphAt cache for the active page */\n  const cachedGlyphAt = useCallback((pt: Position) => {\n    const geo = geoCacheRef.current;\n    return geo ? glyphAt(geo, pt) : -1;\n  }, []);\n\n  // Initialize geometry cache\n  useEffect(() => {\n    if (!sel) return;\n    const task = sel.getGeometry(pageIndex);\n    task.wait((g) => (geoCacheRef.current = g), ignore);\n\n    return () => {\n      task.abort({\n        code: PdfErrorCode.Cancelled,\n        message: 'Cancelled',\n      });\n      geoCacheRef.current = null;\n    };\n  }, [sel, pageIndex]);\n\n  const handlers = useMemo(\n    (): PointerEventHandlersWithLifecycle<PointerEvent> => ({\n      onPointerDown: (point, _evt, modeId) => {\n        if (!sel) return;\n        if (!sel.isEnabledForMode(modeId)) return;\n        // clear the selection\n        sel.clear();\n        const task = sel.getGeometry(pageIndex);\n        task.wait((geo) => {\n          const g = glyphAt(geo, point);\n          if (g !== -1) sel.begin(pageIndex, g);\n        }, ignore);\n      },\n      onPointerMove: (point, _evt, modeId) => {\n        if (!sel) return;\n        if (!sel.isEnabledForMode(modeId)) return;\n        const g = cachedGlyphAt(point);\n        if (g !== -1) {\n          setCursor('selection-text', 'text', 10);\n        } else {\n          removeCursor('selection-text');\n        }\n        if (g !== -1) sel.update(pageIndex, g);\n      },\n      onPointerUp: (_point, _evt, modeId) => {\n        if (!sel) return;\n        if (!sel.isEnabledForMode(modeId)) return;\n        sel.end();\n      },\n      onHandlerActiveEnd(modeId) {\n        if (!sel) return;\n        if (!sel.isEnabledForMode(modeId)) return;\n\n        sel.clear();\n      },\n    }),\n    [sel, pageIndex, cachedGlyphAt],\n  );\n\n  useEffect(() => {\n    if (!register) return;\n    return register(handlers);\n  }, [register, handlers]);\n\n  if (!boundingRect) return null;\n\n  return (\n    <div\n      style={{\n        position: 'absolute',\n        left: boundingRect.origin.x * scale,\n        top: boundingRect.origin.y * scale,\n        width: boundingRect.size.width * scale,\n        height: boundingRect.size.height * scale,\n        mixBlendMode: 'multiply',\n        isolation: 'isolate',\n      }}\n    >\n      {rects.map((b, i) => (\n        <div\n          key={i}\n          style={{\n            position: 'absolute',\n            left: (b.origin.x - boundingRect.origin.x) * scale,\n            top: (b.origin.y - boundingRect.origin.y) * scale,\n            width: b.size.width * scale,\n            height: b.size.height * scale,\n            background,\n            pointerEvents: 'none',\n          }}\n        />\n      ))}\n    </div>\n  );\n}\n","import { useEffect } from 'preact/hooks';\n\nimport { useSelectionCapability } from '../hooks';\n\nexport function CopyToClipboard() {\n  const { provides: sel } = useSelectionCapability();\n\n  useEffect(() => {\n    if (!sel) return;\n    return sel.onCopyToClipboard((text) => {\n      navigator.clipboard.writeText(text);\n    });\n  }, [sel]);\n\n  return null;\n}\n"],"names":["P","b","g","t","S","e","h","L","useSelectionCapability","useCapability","SelectionPlugin","useSelectionPlugin","usePlugin","A","z","R","E","n","x","D","r","s","I","j","q","i","o","SelectionLayer","pageIndex","scale","background","sel","im","useInteractionManagerCapability","register","usePointerHandlers","rects","setRects","useState","boundingRect","setBoundingRect","setCursor","removeCursor","useCursor","geoCacheRef","useRef","useEffect","cachedGlyphAt","useCallback","pt","geo","glyphAt","task","ignore","PdfErrorCode","handlers","useMemo","point","_evt","modeId","_point","jsx","CopyToClipboard","text"],"mappings":"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"}