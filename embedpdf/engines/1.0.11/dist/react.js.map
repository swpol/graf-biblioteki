{"version":3,"file":"react.js","sources":["../src/react/hooks/use-pdfium-engine.ts"],"sourcesContent":["import { useEffect, useRef, useState } from 'react';\nimport { Logger, PdfEngine } from '@embedpdf/models';\n\nconst defaultWasmUrl = `https://cdn.jsdelivr.net/npm/@embedpdf/pdfium@__PDFIUM_VERSION__/dist/pdfium.wasm`;\n\ninterface UsePdfiumEngineProps {\n  wasmUrl?: string;\n  worker?: boolean;\n  logger?: Logger;\n}\n\nexport function usePdfiumEngine(config?: UsePdfiumEngineProps) {\n  const { wasmUrl = defaultWasmUrl, worker = true, logger } = config ?? {};\n\n  const [engine, setEngine] = useState<PdfEngine | null>(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState<Error | null>(null);\n  const engineRef = useRef<{ destroy(): void } | null>(null);\n\n  useEffect(() => {\n    let cancelled = false;\n\n    (async () => {\n      try {\n        const { createPdfiumEngine } = worker\n          ? await import('@embedpdf/engines/pdfium-worker-engine')\n          : await import('@embedpdf/engines/pdfium-direct-engine');\n\n        const pdfEngine = await createPdfiumEngine(wasmUrl, logger);\n        engineRef.current = pdfEngine;\n        setEngine(pdfEngine);\n        setLoading(false);\n      } catch (e) {\n        if (!cancelled) {\n          setError(e as Error);\n          setLoading(false);\n        }\n      }\n    })();\n\n    return () => {\n      cancelled = true;\n      engineRef.current?.destroy();\n      engineRef.current = null;\n    };\n  }, [wasmUrl, worker, logger]);\n\n  return { engine, isLoading: loading, error };\n}\n"],"names":[],"mappings":";;AAGA,MAAM,cAAc,GAAG,CAAA,qEAAA,CAAA,CAAA;AAQjB,SAAU,eAAe,CAAC,MAA6B,EAAA;AAC3D,IAAA,MAAM,EAAE,OAAO,GAAG,cAAc,EAAE,MAAM,GAAG,IAAI,EAAE,MAAM,EAAE,GAAG,MAAM,IAAI,EAAE,CAAC;IAEzE,MAAM,CAAC,MAAM,EAAE,SAAS,CAAC,GAAG,QAAQ,CAAmB,IAAI,CAAC,CAAC;IAC7D,MAAM,CAAC,OAAO,EAAE,UAAU,CAAC,GAAG,QAAQ,CAAC,IAAI,CAAC,CAAC;IAC7C,MAAM,CAAC,KAAK,EAAE,QAAQ,CAAC,GAAG,QAAQ,CAAe,IAAI,CAAC,CAAC;AACvD,IAAA,MAAM,SAAS,GAAG,MAAM,CAA6B,IAAI,CAAC,CAAC;IAE3D,SAAS,CAAC,MAAK;QACb,IAAI,SAAS,GAAG,KAAK,CAAC;QAEtB,CAAC,YAAW;AACV,YAAA,IAAI;AACF,gBAAA,MAAM,EAAE,kBAAkB,EAAE,GAAG,MAAM;AACnC,sBAAE,MAAM,OAAO,wCAAwC,CAAC;AACxD,sBAAE,MAAM,OAAO,wCAAwC,CAAC,CAAC;gBAE3D,MAAM,SAAS,GAAG,MAAM,kBAAkB,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;AAC5D,gBAAA,SAAS,CAAC,OAAO,GAAG,SAAS,CAAC;gBAC9B,SAAS,CAAC,SAAS,CAAC,CAAC;gBACrB,UAAU,CAAC,KAAK,CAAC,CAAC;aACnB;YAAC,OAAO,CAAC,EAAE;gBACV,IAAI,CAAC,SAAS,EAAE;oBACd,QAAQ,CAAC,CAAU,CAAC,CAAC;oBACrB,UAAU,CAAC,KAAK,CAAC,CAAC;iBACnB;aACF;SACF,GAAG,CAAC;AAEL,QAAA,OAAO,MAAK;YACV,SAAS,GAAG,IAAI,CAAC;AACjB,YAAA,SAAS,CAAC,OAAO,EAAE,OAAO,EAAE,CAAC;AAC7B,YAAA,SAAS,CAAC,OAAO,GAAG,IAAI,CAAC;AAC3B,SAAC,CAAC;KACH,EAAE,CAAC,OAAO,EAAE,MAAM,EAAE,MAAM,CAAC,CAAC,CAAC;IAE9B,OAAO,EAAE,MAAM,EAAE,SAAS,EAAE,OAAO,EAAE,KAAK,EAAE,CAAC;AAC/C;;;;"}