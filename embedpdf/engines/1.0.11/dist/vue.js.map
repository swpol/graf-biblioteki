{"version":3,"file":"vue.js","sources":["../src/vue/hooks/use-pdfium-engine.ts"],"sourcesContent":["import { ref, onMounted, onBeforeUnmount, watch, Ref } from 'vue';\nimport type { Logger, PdfEngine } from '@embedpdf/models';\n\nconst defaultWasmUrl =\n  'https://cdn.jsdelivr.net/npm/@embedpdf/pdfium@__PDFIUM_VERSION__/dist/pdfium.wasm';\n\ninterface UsePdfiumEngineProps {\n  wasmUrl?: string;\n  worker?: boolean;\n  logger?: Logger;\n}\n\ninterface UsePdfiumEngineResult {\n  engine: Ref<PdfEngine | null>;\n  isLoading: Ref<boolean>;\n  error: Ref<Error | null>;\n}\n\n/**\n * Vue composable that loads a PdfiumEngine (worker or direct)\n * and keeps its lifetime tied to the component.\n */\nexport function usePdfiumEngine(props: UsePdfiumEngineProps = {}): UsePdfiumEngineResult {\n  const { wasmUrl = defaultWasmUrl, worker = true, logger } = props;\n\n  const engine = ref<PdfEngine | null>(null);\n  const isLoading = ref(true);\n  const error = ref<Error | null>(null);\n\n  /* create / destroy tied to component lifecycle ----------------- */\n  onMounted(loadEngine);\n  onBeforeUnmount(destroyEngine);\n\n  /* reâ€‘load if reactive props change ----------------------------- */\n  watch(\n    () => [wasmUrl, worker, logger] as const,\n    () => {\n      destroyEngine();\n      loadEngine();\n    },\n  );\n\n  async function loadEngine() {\n    try {\n      const { createPdfiumEngine } = worker\n        ? await import('@embedpdf/engines/pdfium-worker-engine')\n        : await import('@embedpdf/engines/pdfium-direct-engine');\n\n      engine.value = await createPdfiumEngine(wasmUrl, logger);\n      isLoading.value = false;\n    } catch (e) {\n      error.value = e as Error;\n      isLoading.value = false;\n    }\n  }\n\n  function destroyEngine() {\n    engine.value?.destroy?.();\n    engine.value = null;\n    isLoading.value = true;\n    error.value = null;\n  }\n\n  return { engine, isLoading, error };\n}\n"],"names":[],"mappings":";;AAGA,MAAM,cAAc,GAClB,uEAAA,CAAA;AAcF;;;AAGG;AACa,SAAA,eAAe,CAAC,KAAA,GAA8B,EAAE,EAAA;AAC9D,IAAA,MAAM,EAAE,OAAO,GAAG,cAAc,EAAE,MAAM,GAAG,IAAI,EAAE,MAAM,EAAE,GAAG,KAAK,CAAC;AAElE,IAAA,MAAM,MAAM,GAAG,GAAG,CAAmB,IAAI,CAAC,CAAC;AAC3C,IAAA,MAAM,SAAS,GAAG,GAAG,CAAC,IAAI,CAAC,CAAC;AAC5B,IAAA,MAAM,KAAK,GAAG,GAAG,CAAe,IAAI,CAAC,CAAC;;IAGtC,SAAS,CAAC,UAAU,CAAC,CAAC;IACtB,eAAe,CAAC,aAAa,CAAC,CAAC;;AAG/B,IAAA,KAAK,CACH,MAAM,CAAC,OAAO,EAAE,MAAM,EAAE,MAAM,CAAU,EACxC,MAAK;AACH,QAAA,aAAa,EAAE,CAAC;AAChB,QAAA,UAAU,EAAE,CAAC;AACf,KAAC,CACF,CAAC;AAEF,IAAA,eAAe,UAAU,GAAA;AACvB,QAAA,IAAI;AACF,YAAA,MAAM,EAAE,kBAAkB,EAAE,GAAG,MAAM;AACnC,kBAAE,MAAM,OAAO,wCAAwC,CAAC;AACxD,kBAAE,MAAM,OAAO,wCAAwC,CAAC,CAAC;YAE3D,MAAM,CAAC,KAAK,GAAG,MAAM,kBAAkB,CAAC,OAAO,EAAE,MAAM,CAAC,CAAC;AACzD,YAAA,SAAS,CAAC,KAAK,GAAG,KAAK,CAAC;SACzB;QAAC,OAAO,CAAC,EAAE;AACV,YAAA,KAAK,CAAC,KAAK,GAAG,CAAU,CAAC;AACzB,YAAA,SAAS,CAAC,KAAK,GAAG,KAAK,CAAC;SACzB;KACF;AAED,IAAA,SAAS,aAAa,GAAA;AACpB,QAAA,MAAM,CAAC,KAAK,EAAE,OAAO,IAAI,CAAC;AAC1B,QAAA,MAAM,CAAC,KAAK,GAAG,IAAI,CAAC;AACpB,QAAA,SAAS,CAAC,KAAK,GAAG,IAAI,CAAC;AACvB,QAAA,KAAK,CAAC,KAAK,GAAG,IAAI,CAAC;KACpB;AAED,IAAA,OAAO,EAAE,MAAM,EAAE,SAAS,EAAE,KAAK,EAAE,CAAC;AACtC;;;;"}