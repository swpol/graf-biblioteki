{"version":3,"file":"index.cjs","sources":["../src/lib/store/selectors.ts","../src/lib/utils/plugin-helpers.ts","../src/lib/base/base-plugin.ts","../src/lib/utils/event-control.ts","../src/lib/utils/eventing.ts","../src/lib/utils/typed-object.ts"],"sourcesContent":["import { CoreState } from './initial-state';\nimport { transformSize, PdfPageObjectWithRotatedSize } from '@embedpdf/models';\n\nexport const getPagesWithRotatedSize = (state: CoreState): PdfPageObjectWithRotatedSize[][] => {\n  return state.pages.map((page) =>\n    page.map((p) => ({\n      ...p,\n      rotatedSize: transformSize(p.size, state.rotation, 1),\n    })),\n  );\n};\n","import { Action } from '../store';\nimport { IPlugin, PluginBatchRegistration, PluginPackage } from '../types/plugin';\n\n/**\n * Helper function to create a properly typed plugin registration\n */\nexport function createPluginRegistration<\n  T extends IPlugin<TConfig>,\n  TConfig,\n  TState,\n  TAction extends Action,\n>(\n  pluginPackage: PluginPackage<T, TConfig, TState, TAction>,\n  config?: Partial<TConfig>,\n): PluginBatchRegistration<T, TConfig, any, any> {\n  return {\n    package: pluginPackage,\n    config,\n  };\n}\n","import { IPlugin } from '../types/plugin';\nimport { PluginRegistry } from '../registry/plugin-registry';\nimport { Action, CoreAction, CoreState, PluginStore, Store, StoreState } from '../store';\n\nexport interface StateChangeHandler<TState> {\n  (state: TState): void;\n}\n\nexport abstract class BasePlugin<\n  TConfig = unknown,\n  TCapability = unknown,\n  TState = unknown,\n  TAction extends Action = Action,\n> implements IPlugin<TConfig>\n{\n  static readonly id: string;\n\n  protected pluginStore: PluginStore<TState, TAction>;\n  protected coreStore: Store<CoreState, CoreAction>;\n  // Track debounced actions\n  private debouncedActions: Record<string, number> = {};\n  private unsubscribeFromState: (() => void) | null = null;\n  private unsubscribeFromCoreStore: (() => void) | null = null;\n\n  private _capability?: Readonly<TCapability>;\n\n  private readyPromise: Promise<void>;\n  private readyResolve!: () => void;\n\n  constructor(\n    public readonly id: string,\n    protected registry: PluginRegistry,\n  ) {\n    if (id !== (this.constructor as typeof BasePlugin).id) {\n      throw new Error(\n        `Plugin ID mismatch: ${id} !== ${(this.constructor as typeof BasePlugin).id}`,\n      );\n    }\n    this.coreStore = this.registry.getStore();\n    this.pluginStore = this.coreStore.getPluginStore<TState, TAction>(this.id);\n    this.unsubscribeFromState = this.pluginStore.subscribeToState((action, newState, oldState) => {\n      this.onStoreUpdated(oldState, newState);\n    });\n    this.unsubscribeFromCoreStore = this.coreStore.subscribe((action, newState, oldState) => {\n      this.onCoreStoreUpdated(oldState, newState);\n    });\n\n    // Initialize ready state\n    this.readyPromise = new Promise((resolve) => {\n      this.readyResolve = resolve;\n    });\n    // By default, plugins are ready immediately\n    this.readyResolve();\n  }\n\n  /** Construct the public capability (called once & cached). */\n  protected abstract buildCapability(): TCapability;\n\n  public provides(): Readonly<TCapability> {\n    if (!this._capability) {\n      const cap = this.buildCapability();\n\n      this._capability = Object.freeze(cap);\n    }\n    return this._capability;\n  }\n\n  /**\n   * Initialize plugin with config\n   */\n  abstract initialize(config: TConfig): Promise<void>;\n\n  /**\n   *  Get a copy of the current state\n   */\n  protected get state(): Readonly<TState> {\n    return this.pluginStore.getState();\n  }\n\n  /**\n   *  Get a copy of the current core state\n   */\n  protected get coreState(): Readonly<StoreState<CoreState>> {\n    return this.coreStore.getState();\n  }\n\n  /**\n   * @deprecated  use `this.state` Get a copy of the current state\n   */\n  protected getState(): TState {\n    return this.pluginStore.getState();\n  }\n\n  /**\n   * @deprecated  use `this.coreState` Get a copy of the current core state\n   */\n  protected getCoreState(): StoreState<CoreState> {\n    return this.coreStore.getState();\n  }\n\n  /**\n   * Core Dispatch\n   */\n  protected dispatchCoreAction(action: CoreAction): StoreState<CoreState> {\n    return this.coreStore.dispatchToCore(action);\n  }\n\n  /**\n   * Dispatch an action to all plugins\n   */\n  protected dispatchToAllPlugins(action: TAction): StoreState<CoreState> {\n    return this.coreStore.dispatch(action);\n  }\n\n  /**\n   * Dispatch an action\n   */\n  protected dispatch(action: TAction): TState {\n    return this.pluginStore.dispatch(action);\n  }\n\n  /**\n   * Dispatch an action with debouncing to prevent rapid repeated calls\n   * @param action The action to dispatch\n   * @param debounceTime Time in ms to debounce (default: 100ms)\n   * @returns boolean indicating whether the action was dispatched or debounced\n   */\n  protected debouncedDispatch(action: TAction, debounceTime: number = 100): boolean {\n    const now = Date.now();\n    const lastActionTime = this.debouncedActions[action.type] || 0;\n\n    if (now - lastActionTime >= debounceTime) {\n      this.debouncedActions[action.type] = now;\n      this.dispatch(action);\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Subscribe to state changes\n   */\n  protected subscribe(listener: (action: TAction, state: TState) => void): () => void {\n    return this.pluginStore.subscribeToState(listener);\n  }\n\n  /**\n   * Subscribe to core store changes\n   */\n  protected subscribeToCoreStore(\n    listener: (action: Action, state: StoreState<CoreState>) => void,\n  ): () => void {\n    return this.coreStore.subscribe(listener);\n  }\n\n  /**\n   * Called when the plugin store state is updated\n   * @param oldState Previous state\n   * @param newState New state\n   */\n  protected onStoreUpdated(oldState: TState, newState: TState): void {\n    // Default implementation does nothing - can be overridden by plugins\n  }\n\n  /**\n   * Called when the core store state is updated\n   * @param oldState Previous state\n   * @param newState New state\n   */\n  protected onCoreStoreUpdated(\n    oldState: StoreState<CoreState>,\n    newState: StoreState<CoreState>,\n  ): void {\n    // Default implementation does nothing - can be overridden by plugins\n  }\n\n  /**\n   * Cleanup method to be called when plugin is being destroyed\n   */\n  public destroy(): void {\n    if (this.unsubscribeFromState) {\n      this.unsubscribeFromState();\n      this.unsubscribeFromState = null;\n    }\n    if (this.unsubscribeFromCoreStore) {\n      this.unsubscribeFromCoreStore();\n      this.unsubscribeFromCoreStore = null;\n    }\n  }\n\n  /**\n   * Returns a promise that resolves when the plugin is ready\n   */\n  public ready(): Promise<void> {\n    return this.readyPromise;\n  }\n\n  /**\n   * Mark the plugin as ready\n   */\n  protected markReady(): void {\n    this.readyResolve();\n  }\n\n  /**\n   * Reset the ready state (useful for plugins that need to reinitialize)\n   */\n  protected resetReady(): void {\n    this.readyPromise = new Promise((resolve) => {\n      this.readyResolve = resolve;\n    });\n  }\n}\n","export type EventHandler<T> = (data: T) => void;\n\nexport interface BaseEventControlOptions {\n  wait: number;\n}\n\nexport interface DebounceOptions extends BaseEventControlOptions {\n  mode: 'debounce';\n}\n\nexport interface ThrottleOptions extends BaseEventControlOptions {\n  mode: 'throttle';\n  throttleMode?: 'leading-trailing' | 'trailing';\n}\n\nexport type EventControlOptions = DebounceOptions | ThrottleOptions;\n\nexport class EventControl<T> {\n  private timeoutId?: number;\n  private lastRun: number = 0;\n\n  constructor(\n    private handler: EventHandler<T>,\n    private options: EventControlOptions,\n  ) {}\n\n  handle = (data: T): void => {\n    if (this.options.mode === 'debounce') {\n      this.debounce(data);\n    } else {\n      this.throttle(data);\n    }\n  };\n\n  private debounce(data: T): void {\n    if (this.timeoutId) {\n      window.clearTimeout(this.timeoutId);\n    }\n\n    this.timeoutId = window.setTimeout(() => {\n      this.handler(data);\n      this.timeoutId = undefined;\n    }, this.options.wait);\n  }\n\n  private throttle(data: T): void {\n    if (this.options.mode === 'debounce') return;\n\n    const now = Date.now();\n    const throttleMode = this.options.throttleMode || 'leading-trailing';\n\n    if (now - this.lastRun >= this.options.wait) {\n      if (throttleMode === 'leading-trailing') {\n        this.handler(data);\n      }\n      this.lastRun = now;\n    }\n\n    // Always schedule the trailing execution\n    if (this.timeoutId) {\n      window.clearTimeout(this.timeoutId);\n    }\n\n    this.timeoutId = window.setTimeout(\n      () => {\n        this.handler(data);\n        this.lastRun = Date.now();\n        this.timeoutId = undefined;\n      },\n      this.options.wait - (now - this.lastRun),\n    );\n  }\n\n  destroy(): void {\n    if (this.timeoutId) {\n      window.clearTimeout(this.timeoutId);\n    }\n  }\n}\n","import { EventControl, EventControlOptions } from './event-control';\nimport { arePropsEqual } from './math';\n\n/* ------------------------------------------------------------------ */\n/* basic types                                                        */\n/* ------------------------------------------------------------------ */\nexport type Listener<T = any> = (value: T) => void;\nexport type Unsubscribe = () => void;\n\n/* ------------------------------------------------------------------ */\n/* EventListener                                                      */\n/* ------------------------------------------------------------------ */\nexport type EventListener<T> =\n  | ((listener: Listener<T>) => Unsubscribe)\n  | ((listener: Listener<T>, options?: EventControlOptions) => Unsubscribe);\n\n/* ------------------------------------------------------------ */\n/* helpers for typing `.on()` with an optional second argument  */\n/* ------------------------------------------------------------ */\nexport type EventHook<T = any> = EventListener<T>;\n/* ------------------------------------------------------------------ */\n/* minimal “dumb” emitter (no value cache, no equality)               */\n/* ------------------------------------------------------------------ */\nexport interface Emitter<T = any> {\n  emit(value?: T): void;\n  on(listener: Listener<T>): Unsubscribe;\n  off(listener: Listener<T>): void;\n  clear(): void;\n}\n\nexport function createEmitter<T = any>(): Emitter<T> {\n  const listeners = new Set<Listener<T>>();\n\n  const on: EventHook<T> = (l: Listener<T>) => {\n    listeners.add(l);\n    return () => listeners.delete(l);\n  };\n\n  return {\n    emit: (v = undefined as T) => listeners.forEach((l) => l(v)),\n    on,\n    off: (l) => listeners.delete(l),\n    clear: () => listeners.clear(),\n  };\n}\n\n/* ------------------------------------------------------------ */\n/* public interface                                              */\n/* ------------------------------------------------------------ */\nexport interface BehaviorEmitter<T = any> extends Omit<Emitter<T>, 'on' | 'off'> {\n  readonly value?: T;\n  on: EventHook<T>;\n  off(listener: Listener<T>): void;\n  select<U>(selector: (v: T) => U, equality?: (a: U, b: U) => boolean): EventHook<U>;\n}\n\n/* ------------------------------------------------------------ */\n/* implementation                                               */\n/* ------------------------------------------------------------ */\nexport function createBehaviorEmitter<T = any>(\n  initial?: T,\n  equality: (a: T, b: T) => boolean = arePropsEqual,\n): BehaviorEmitter<T> {\n  const listeners = new Set<Listener<T>>();\n  const proxyMap = new Map<Listener<T>, { wrapped: Listener<T>; destroy: () => void }>();\n  let _value = initial; // cached value\n\n  /* -------------- helpers ----------------------------------- */\n  const notify = (v: T) => listeners.forEach((l) => l(v));\n\n  const baseOn: EventHook<T> = (listener: Listener<T>, options?: EventControlOptions) => {\n    /* wrap & remember if we have control options ------------------ */\n    let realListener = listener;\n    let destroy = () => {};\n\n    if (options) {\n      const ctl = new EventControl(listener, options);\n      realListener = ctl.handle as Listener<T>;\n      destroy = () => ctl.destroy();\n      proxyMap.set(listener, { wrapped: realListener, destroy });\n    }\n\n    /* immediate replay of last value ------------------------------ */\n    if (_value !== undefined) realListener(_value);\n\n    listeners.add(realListener);\n\n    return () => {\n      listeners.delete(realListener);\n      destroy();\n      proxyMap.delete(listener);\n    };\n  };\n\n  /* -------------- public object ------------------------------ */\n  return {\n    /* emitter behaviour ---------------------------------------- */\n    get value() {\n      return _value;\n    },\n\n    emit(v = undefined as T) {\n      if (_value === undefined || !equality(_value, v)) {\n        _value = v;\n        notify(v);\n      }\n    },\n\n    on: baseOn,\n    off(listener: Listener<T>) {\n      /* did we wrap this listener? */\n      const proxy = proxyMap.get(listener);\n      if (proxy) {\n        listeners.delete(proxy.wrapped);\n        proxy.destroy();\n        proxyMap.delete(listener);\n      } else {\n        listeners.delete(listener);\n      }\n    },\n\n    clear() {\n      listeners.clear();\n      proxyMap.forEach((p) => p.destroy());\n      proxyMap.clear();\n    },\n\n    /* derived hook --------------------------------------------- */\n    select<U>(selector: (v: T) => U, eq: (a: U, b: U) => boolean = arePropsEqual): EventHook<U> {\n      return (listener: Listener<U>, options?: EventControlOptions) => {\n        let prev: U | undefined;\n\n        /* replay */\n        if (_value !== undefined) {\n          const mapped = selector(_value);\n          prev = mapped;\n          listener(mapped);\n        }\n\n        /* subscribe to parent */\n        return baseOn(\n          (next) => {\n            const mapped = selector(next);\n            if (prev === undefined || !eq(prev, mapped)) {\n              prev = mapped;\n              listener(mapped);\n            }\n          },\n          options as EventControlOptions | undefined,\n        ); // pass control opts straight through\n      };\n    },\n  };\n}\n","/* ------------------------------------------------------------------ */\n/*  enumEntries – iterate over enum-keyed Records with strong typing  */\n/* ------------------------------------------------------------------ */\n\ntype EnumKey = string | number;\n\n/**\n * Iterate over a Record whose keys are enum members (numeric or string),\n * getting back a fully-typed `[key, value]` tuple array.\n *\n * Usage:\n *   for (const [subtype, defaults] of enumEntries(this.state.toolDefaults)) {\n *     // subtype is inferred as keyof ToolDefaultsBySubtype\n *   }\n */\nexport function enumEntries<E extends EnumKey, V>(record: Record<E, V>): Array<[E, V]> {\n  // Tell TS the values are V (not unknown) *before* we map.\n  return (Object.entries(record) as [string, V][]).map(([k, v]) => {\n    // Numeric enums come out of Object.entries as \"0\", \"1\", …  → convert.\n    const maybeNum = Number(k);\n    const typedKey: E =\n      Number.isFinite(maybeNum) && k.trim() !== '' // looks like a number?\n        ? (maybeNum as unknown as E) // numeric enum key\n        : (k as unknown as E); // string enum key\n\n    return [typedKey, v]; // v is already typed as V\n  });\n}\n"],"names":["getPagesWithRotatedSize","state","page","p","transformSize","createPluginRegistration","pluginPackage","config","BasePlugin","id","registry","action","newState","oldState","resolve","cap","debounceTime","now","lastActionTime","listener","EventControl","handler","options","data","throttleMode","createEmitter","listeners","v","l","createBehaviorEmitter","initial","equality","arePropsEqual","proxyMap","_value","notify","baseOn","realListener","destroy","ctl","proxy","selector","eq","prev","mapped","next","enumEntries","record","k","maybeNum"],"mappings":"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"}